{"remainingRequest":"/home/coding/workspace/node_modules/ts-loader/index.js?{\"happyPackMode\":true,\"compilerOptions\":{\"target\":\"es5\",\"lib\":[\"dom\",\"esnext\"]}}!/home/coding/workspace/lib/vscode/src/vs/editor/contrib/zoneWidget/zoneWidget.ts","dependencies":[{"path":"/home/coding/workspace/lib/vscode/src/vs/editor/contrib/zoneWidget/zoneWidget.ts","mtime":1555102317000},{"path":"/home/coding/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1555844183884},{"path":"/home/coding/workspace/node_modules/ts-loader/index.js","mtime":1555844217316}],"contextDependencies":[],"result":["\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"vs/css!./zoneWidget\");\nvar dom = require(\"vs/base/browser/dom\");\nvar sash_1 = require(\"vs/base/browser/ui/sash/sash\");\nvar color_1 = require(\"vs/base/common/color\");\nvar idGenerator_1 = require(\"vs/base/common/idGenerator\");\nvar lifecycle_1 = require(\"vs/base/common/lifecycle\");\nvar objects = require(\"vs/base/common/objects\");\nvar range_1 = require(\"vs/editor/common/core/range\");\nvar editorCommon_1 = require(\"vs/editor/common/editorCommon\");\nvar model_1 = require(\"vs/editor/common/model\");\nvar textModel_1 = require(\"vs/editor/common/model/textModel\");\nvar defaultColor = new color_1.Color(new color_1.RGBA(0, 122, 204));\nvar defaultOptions = {\n    showArrow: true,\n    showFrame: true,\n    className: '',\n    frameColor: defaultColor,\n    arrowColor: defaultColor,\n    keepEditorSelection: false\n};\nvar WIDGET_ID = 'vs.editor.contrib.zoneWidget';\nvar ViewZoneDelegate = /** @class */ (function () {\n    function ViewZoneDelegate(domNode, afterLineNumber, afterColumn, heightInLines, onDomNodeTop, onComputedHeight) {\n        this.domNode = domNode;\n        this.afterLineNumber = afterLineNumber;\n        this.afterColumn = afterColumn;\n        this.heightInLines = heightInLines;\n        this._onDomNodeTop = onDomNodeTop;\n        this._onComputedHeight = onComputedHeight;\n    }\n    ViewZoneDelegate.prototype.onDomNodeTop = function (top) {\n        this._onDomNodeTop(top);\n    };\n    ViewZoneDelegate.prototype.onComputedHeight = function (height) {\n        this._onComputedHeight(height);\n    };\n    return ViewZoneDelegate;\n}());\nexports.ViewZoneDelegate = ViewZoneDelegate;\nvar OverlayWidgetDelegate = /** @class */ (function () {\n    function OverlayWidgetDelegate(id, domNode) {\n        this._id = id;\n        this._domNode = domNode;\n    }\n    OverlayWidgetDelegate.prototype.getId = function () {\n        return this._id;\n    };\n    OverlayWidgetDelegate.prototype.getDomNode = function () {\n        return this._domNode;\n    };\n    OverlayWidgetDelegate.prototype.getPosition = function () {\n        return null;\n    };\n    return OverlayWidgetDelegate;\n}());\nexports.OverlayWidgetDelegate = OverlayWidgetDelegate;\nvar Arrow = /** @class */ (function () {\n    function Arrow(_editor) {\n        this._editor = _editor;\n        this._ruleName = Arrow._IdGenerator.nextId();\n        this._decorations = [];\n        //\n    }\n    Arrow.prototype.dispose = function () {\n        this.hide();\n        dom.removeCSSRulesContainingSelector(this._ruleName);\n    };\n    Object.defineProperty(Arrow.prototype, \"color\", {\n        set: function (value) {\n            if (this._color !== value) {\n                this._color = value;\n                this._updateStyle();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Arrow.prototype, \"height\", {\n        set: function (value) {\n            if (this._height !== value) {\n                this._height = value;\n                this._updateStyle();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Arrow.prototype._updateStyle = function () {\n        dom.removeCSSRulesContainingSelector(this._ruleName);\n        dom.createCSSRule(\".monaco-editor \" + this._ruleName, \"border-style: solid; border-color: transparent; border-bottom-color: \" + this._color + \"; border-width: \" + this._height + \"px; bottom: -\" + this._height + \"px; margin-left: -\" + this._height + \"px; \");\n    };\n    Arrow.prototype.show = function (where) {\n        this._decorations = this._editor.deltaDecorations(this._decorations, [{ range: range_1.Range.fromPositions(where), options: { className: this._ruleName, stickiness: model_1.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges } }]);\n    };\n    Arrow.prototype.hide = function () {\n        this._editor.deltaDecorations(this._decorations, []);\n    };\n    Arrow._IdGenerator = new idGenerator_1.IdGenerator('.arrow-decoration-');\n    return Arrow;\n}());\nvar ZoneWidget = /** @class */ (function () {\n    function ZoneWidget(editor, options) {\n        if (options === void 0) { options = {}; }\n        var _this = this;\n        this._positionMarkerId = [];\n        this._disposables = [];\n        this._isShowing = false;\n        this.editor = editor;\n        this.options = objects.deepClone(options);\n        objects.mixin(this.options, defaultOptions, false);\n        this.domNode = document.createElement('div');\n        if (!this.options.isAccessible) {\n            this.domNode.setAttribute('aria-hidden', 'true');\n            this.domNode.setAttribute('role', 'presentation');\n        }\n        this._disposables.push(this.editor.onDidLayoutChange(function (info) {\n            var width = _this._getWidth(info);\n            _this.domNode.style.width = width + 'px';\n            _this.domNode.style.left = _this._getLeft(info) + 'px';\n            _this._onWidth(width);\n        }));\n    }\n    ZoneWidget.prototype.dispose = function () {\n        var _this = this;\n        lifecycle_1.dispose(this._disposables);\n        if (this._overlayWidget) {\n            this.editor.removeOverlayWidget(this._overlayWidget);\n            this._overlayWidget = null;\n        }\n        if (this._viewZone) {\n            this.editor.changeViewZones(function (accessor) {\n                if (_this._viewZone) {\n                    accessor.removeZone(_this._viewZone.id);\n                }\n                _this._viewZone = null;\n            });\n        }\n        this.editor.deltaDecorations(this._positionMarkerId, []);\n        this._positionMarkerId = [];\n    };\n    ZoneWidget.prototype.create = function () {\n        dom.addClass(this.domNode, 'zone-widget');\n        if (this.options.className) {\n            dom.addClass(this.domNode, this.options.className);\n        }\n        this.container = document.createElement('div');\n        dom.addClass(this.container, 'zone-widget-container');\n        this.domNode.appendChild(this.container);\n        if (this.options.showArrow) {\n            this._arrow = new Arrow(this.editor);\n            this._disposables.push(this._arrow);\n        }\n        this._fillContainer(this.container);\n        this._initSash();\n        this._applyStyles();\n    };\n    ZoneWidget.prototype.style = function (styles) {\n        if (styles.frameColor) {\n            this.options.frameColor = styles.frameColor;\n        }\n        if (styles.arrowColor) {\n            this.options.arrowColor = styles.arrowColor;\n        }\n        this._applyStyles();\n    };\n    ZoneWidget.prototype._applyStyles = function () {\n        if (this.container && this.options.frameColor) {\n            var frameColor = this.options.frameColor.toString();\n            this.container.style.borderTopColor = frameColor;\n            this.container.style.borderBottomColor = frameColor;\n        }\n        if (this._arrow && this.options.arrowColor) {\n            var arrowColor = this.options.arrowColor.toString();\n            this._arrow.color = arrowColor;\n        }\n    };\n    ZoneWidget.prototype._getWidth = function (info) {\n        return info.width - info.minimapWidth - info.verticalScrollbarWidth;\n    };\n    ZoneWidget.prototype._getLeft = function (info) {\n        // If minimap is to the left, we move beyond it\n        if (info.minimapWidth > 0 && info.minimapLeft === 0) {\n            return info.minimapWidth;\n        }\n        return 0;\n    };\n    ZoneWidget.prototype._onViewZoneTop = function (top) {\n        this.domNode.style.top = top + 'px';\n    };\n    ZoneWidget.prototype._onViewZoneHeight = function (height) {\n        this.domNode.style.height = height + \"px\";\n        var containerHeight = height - this._decoratingElementsHeight();\n        this.container.style.height = containerHeight + \"px\";\n        var layoutInfo = this.editor.getLayoutInfo();\n        this._doLayout(containerHeight, this._getWidth(layoutInfo));\n        this._resizeSash.layout();\n    };\n    Object.defineProperty(ZoneWidget.prototype, \"position\", {\n        get: function () {\n            var id = this._positionMarkerId[0];\n            if (!id) {\n                return undefined;\n            }\n            var model = this.editor.getModel();\n            if (!model) {\n                return undefined;\n            }\n            var range = model.getDecorationRange(id);\n            if (!range) {\n                return undefined;\n            }\n            return range.getStartPosition();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ZoneWidget.prototype.show = function (rangeOrPos, heightInLines) {\n        var range = range_1.Range.isIRange(rangeOrPos)\n            ? rangeOrPos\n            : new range_1.Range(rangeOrPos.lineNumber, rangeOrPos.column, rangeOrPos.lineNumber, rangeOrPos.column);\n        this._isShowing = true;\n        this._showImpl(range, heightInLines);\n        this._isShowing = false;\n        this._positionMarkerId = this.editor.deltaDecorations(this._positionMarkerId, [{ range: range, options: textModel_1.ModelDecorationOptions.EMPTY }]);\n    };\n    ZoneWidget.prototype.hide = function () {\n        var _this = this;\n        if (this._viewZone) {\n            this.editor.changeViewZones(function (accessor) {\n                if (_this._viewZone) {\n                    accessor.removeZone(_this._viewZone.id);\n                }\n            });\n            this._viewZone = null;\n        }\n        if (this._overlayWidget) {\n            this.editor.removeOverlayWidget(this._overlayWidget);\n            this._overlayWidget = null;\n        }\n        if (this._arrow) {\n            this._arrow.hide();\n        }\n    };\n    ZoneWidget.prototype._decoratingElementsHeight = function () {\n        var lineHeight = this.editor.getConfiguration().lineHeight;\n        var result = 0;\n        if (this.options.showArrow) {\n            var arrowHeight = Math.round(lineHeight / 3);\n            result += 2 * arrowHeight;\n        }\n        if (this.options.showFrame) {\n            var frameThickness = Math.round(lineHeight / 9);\n            result += 2 * frameThickness;\n        }\n        return result;\n    };\n    ZoneWidget.prototype._showImpl = function (where, heightInLines) {\n        var _this = this;\n        var position = {\n            lineNumber: where.startLineNumber,\n            column: where.startColumn\n        };\n        var layoutInfo = this.editor.getLayoutInfo();\n        var width = this._getWidth(layoutInfo);\n        this.domNode.style.width = width + \"px\";\n        this.domNode.style.left = this._getLeft(layoutInfo) + 'px';\n        // Render the widget as zone (rendering) and widget (lifecycle)\n        var viewZoneDomNode = document.createElement('div');\n        viewZoneDomNode.style.overflow = 'hidden';\n        var lineHeight = this.editor.getConfiguration().lineHeight;\n        // adjust heightInLines to viewport\n        var maxHeightInLines = (this.editor.getLayoutInfo().height / lineHeight) * 0.8;\n        if (heightInLines >= maxHeightInLines) {\n            heightInLines = maxHeightInLines;\n        }\n        var arrowHeight = 0;\n        var frameThickness = 0;\n        // Render the arrow one 1/3 of an editor line height\n        if (this.options.showArrow) {\n            arrowHeight = Math.round(lineHeight / 3);\n            this._arrow.height = arrowHeight;\n            this._arrow.show(position);\n        }\n        // Render the frame as 1/9 of an editor line height\n        if (this.options.showFrame) {\n            frameThickness = Math.round(lineHeight / 9);\n        }\n        // insert zone widget\n        this.editor.changeViewZones(function (accessor) {\n            if (_this._viewZone) {\n                accessor.removeZone(_this._viewZone.id);\n            }\n            if (_this._overlayWidget) {\n                _this.editor.removeOverlayWidget(_this._overlayWidget);\n                _this._overlayWidget = null;\n            }\n            _this.domNode.style.top = '-1000px';\n            _this._viewZone = new ViewZoneDelegate(viewZoneDomNode, position.lineNumber, position.column, heightInLines, function (top) { return _this._onViewZoneTop(top); }, function (height) { return _this._onViewZoneHeight(height); });\n            _this._viewZone.id = accessor.addZone(_this._viewZone);\n            _this._overlayWidget = new OverlayWidgetDelegate(WIDGET_ID + _this._viewZone.id, _this.domNode);\n            _this.editor.addOverlayWidget(_this._overlayWidget);\n        });\n        if (this.options.showFrame) {\n            var width_1 = this.options.frameWidth ? this.options.frameWidth : frameThickness;\n            this.container.style.borderTopWidth = width_1 + 'px';\n            this.container.style.borderBottomWidth = width_1 + 'px';\n        }\n        var containerHeight = heightInLines * lineHeight - this._decoratingElementsHeight();\n        this.container.style.top = arrowHeight + 'px';\n        this.container.style.height = containerHeight + 'px';\n        this.container.style.overflow = 'hidden';\n        this._doLayout(containerHeight, width);\n        if (!this.options.keepEditorSelection) {\n            this.editor.setSelection(where);\n        }\n        var model = this.editor.getModel();\n        if (model) {\n            // Reveal the line above or below the zone widget, to get the zone widget in the viewport\n            var revealLineNumber = Math.min(model.getLineCount(), Math.max(1, where.endLineNumber + 1));\n            this.revealLine(revealLineNumber);\n        }\n    };\n    ZoneWidget.prototype.revealLine = function (lineNumber) {\n        this.editor.revealLine(lineNumber, editorCommon_1.ScrollType.Smooth);\n    };\n    ZoneWidget.prototype.setCssClass = function (className, classToReplace) {\n        if (classToReplace) {\n            this.container.classList.remove(classToReplace);\n        }\n        dom.addClass(this.container, className);\n    };\n    ZoneWidget.prototype._onWidth = function (widthInPixel) {\n        // implement in subclass\n    };\n    ZoneWidget.prototype._doLayout = function (heightInPixel, widthInPixel) {\n        // implement in subclass\n    };\n    ZoneWidget.prototype._relayout = function (newHeightInLines) {\n        var _this = this;\n        if (this._viewZone && this._viewZone.heightInLines !== newHeightInLines) {\n            this.editor.changeViewZones(function (accessor) {\n                if (_this._viewZone) {\n                    _this._viewZone.heightInLines = newHeightInLines;\n                    accessor.layoutZone(_this._viewZone.id);\n                }\n            });\n        }\n    };\n    // --- sash\n    ZoneWidget.prototype._initSash = function () {\n        var _this = this;\n        this._resizeSash = new sash_1.Sash(this.domNode, this, { orientation: sash_1.Orientation.HORIZONTAL });\n        if (!this.options.isResizeable) {\n            this._resizeSash.hide();\n            this._resizeSash.state = sash_1.SashState.Disabled;\n        }\n        var data;\n        this._disposables.push(this._resizeSash.onDidStart(function (e) {\n            if (_this._viewZone) {\n                data = {\n                    startY: e.startY,\n                    heightInLines: _this._viewZone.heightInLines,\n                };\n            }\n        }));\n        this._disposables.push(this._resizeSash.onDidEnd(function () {\n            data = undefined;\n        }));\n        this._disposables.push(this._resizeSash.onDidChange(function (evt) {\n            if (data) {\n                var lineDelta = (evt.currentY - data.startY) / _this.editor.getConfiguration().lineHeight;\n                var roundedLineDelta = lineDelta < 0 ? Math.ceil(lineDelta) : Math.floor(lineDelta);\n                var newHeightInLines = data.heightInLines + roundedLineDelta;\n                if (newHeightInLines > 5 && newHeightInLines < 35) {\n                    _this._relayout(newHeightInLines);\n                }\n            }\n        }));\n    };\n    ZoneWidget.prototype.getHorizontalSashLeft = function () {\n        return 0;\n    };\n    ZoneWidget.prototype.getHorizontalSashTop = function () {\n        return (this.domNode.style.height === null ? 0 : parseInt(this.domNode.style.height)) - (this._decoratingElementsHeight() / 2);\n    };\n    ZoneWidget.prototype.getHorizontalSashWidth = function () {\n        var layoutInfo = this.editor.getLayoutInfo();\n        return layoutInfo.width - layoutInfo.minimapWidth;\n    };\n    return ZoneWidget;\n}());\nexports.ZoneWidget = ZoneWidget;\n",{"version":3,"file":"/home/coding/workspace/lib/vscode/src/vs/editor/contrib/zoneWidget/zoneWidget.ts","sourceRoot":"","sources":["/home/coding/workspace/lib/vscode/src/vs/editor/contrib/zoneWidget/zoneWidget.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./zoneWidget';\nimport * as dom from 'vs/base/browser/dom';\nimport { IHorizontalSashLayoutProvider, ISashEvent, Orientation, Sash, SashState } from 'vs/base/browser/ui/sash/sash';\nimport { Color, RGBA } from 'vs/base/common/color';\nimport { IdGenerator } from 'vs/base/common/idGenerator';\nimport { IDisposable, dispose } from 'vs/base/common/lifecycle';\nimport * as objects from 'vs/base/common/objects';\nimport { ICodeEditor, IOverlayWidget, IOverlayWidgetPosition, IViewZone, IViewZoneChangeAccessor } from 'vs/editor/browser/editorBrowser';\nimport { EditorLayoutInfo } from 'vs/editor/common/config/editorOptions';\nimport { IPosition, Position } from 'vs/editor/common/core/position';\nimport { IRange, Range } from 'vs/editor/common/core/range';\nimport { ScrollType } from 'vs/editor/common/editorCommon';\nimport { TrackedRangeStickiness } from 'vs/editor/common/model';\nimport { ModelDecorationOptions } from 'vs/editor/common/model/textModel';\n\nexport interface IOptions {\n\tshowFrame?: boolean;\n\tshowArrow?: boolean;\n\tframeWidth?: number;\n\tclassName?: string;\n\tisAccessible?: boolean;\n\tisResizeable?: boolean;\n\tframeColor?: Color;\n\tarrowColor?: Color;\n\tkeepEditorSelection?: boolean;\n}\n\nexport interface IStyles {\n\tframeColor?: Color | null;\n\tarrowColor?: Color | null;\n}\n\nconst defaultColor = new Color(new RGBA(0, 122, 204));\n\nconst defaultOptions: IOptions = {\n\tshowArrow: true,\n\tshowFrame: true,\n\tclassName: '',\n\tframeColor: defaultColor,\n\tarrowColor: defaultColor,\n\tkeepEditorSelection: false\n};\n\nconst WIDGET_ID = 'vs.editor.contrib.zoneWidget';\n\nexport class ViewZoneDelegate implements IViewZone {\n\n\tpublic domNode: HTMLElement;\n\tpublic id: number;\n\tpublic afterLineNumber: number;\n\tpublic afterColumn: number;\n\tpublic heightInLines: number;\n\n\tprivate readonly _onDomNodeTop: (top: number) => void;\n\tprivate readonly _onComputedHeight: (height: number) => void;\n\n\tconstructor(domNode: HTMLElement, afterLineNumber: number, afterColumn: number, heightInLines: number,\n\t\tonDomNodeTop: (top: number) => void,\n\t\tonComputedHeight: (height: number) => void\n\t) {\n\t\tthis.domNode = domNode;\n\t\tthis.afterLineNumber = afterLineNumber;\n\t\tthis.afterColumn = afterColumn;\n\t\tthis.heightInLines = heightInLines;\n\t\tthis._onDomNodeTop = onDomNodeTop;\n\t\tthis._onComputedHeight = onComputedHeight;\n\t}\n\n\tpublic onDomNodeTop(top: number): void {\n\t\tthis._onDomNodeTop(top);\n\t}\n\n\tpublic onComputedHeight(height: number): void {\n\t\tthis._onComputedHeight(height);\n\t}\n}\n\nexport class OverlayWidgetDelegate implements IOverlayWidget {\n\n\tprivate readonly _id: string;\n\tprivate readonly _domNode: HTMLElement;\n\n\tconstructor(id: string, domNode: HTMLElement) {\n\t\tthis._id = id;\n\t\tthis._domNode = domNode;\n\t}\n\n\tpublic getId(): string {\n\t\treturn this._id;\n\t}\n\n\tpublic getDomNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n\n\tpublic getPosition(): IOverlayWidgetPosition | null {\n\t\treturn null;\n\t}\n}\n\nclass Arrow {\n\n\tprivate static readonly _IdGenerator = new IdGenerator('.arrow-decoration-');\n\n\tprivate readonly _ruleName = Arrow._IdGenerator.nextId();\n\tprivate _decorations: string[] = [];\n\tprivate _color: string;\n\tprivate _height: number;\n\n\tconstructor(\n\t\tprivate readonly _editor: ICodeEditor\n\t) {\n\t\t//\n\t}\n\n\tdispose(): void {\n\t\tthis.hide();\n\t\tdom.removeCSSRulesContainingSelector(this._ruleName);\n\t}\n\n\tset color(value: string) {\n\t\tif (this._color !== value) {\n\t\t\tthis._color = value;\n\t\t\tthis._updateStyle();\n\t\t}\n\t}\n\n\tset height(value: number) {\n\t\tif (this._height !== value) {\n\t\t\tthis._height = value;\n\t\t\tthis._updateStyle();\n\t\t}\n\t}\n\n\tprivate _updateStyle(): void {\n\t\tdom.removeCSSRulesContainingSelector(this._ruleName);\n\t\tdom.createCSSRule(\n\t\t\t`.monaco-editor ${this._ruleName}`,\n\t\t\t`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px; margin-left: -${this._height}px; `\n\t\t);\n\t}\n\n\tshow(where: IPosition): void {\n\t\tthis._decorations = this._editor.deltaDecorations(\n\t\t\tthis._decorations,\n\t\t\t[{ range: Range.fromPositions(where), options: { className: this._ruleName, stickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges } }]\n\t\t);\n\t}\n\n\thide(): void {\n\t\tthis._editor.deltaDecorations(this._decorations, []);\n\t}\n}\n\nexport abstract class ZoneWidget implements IHorizontalSashLayoutProvider {\n\n\tprivate _arrow: Arrow;\n\tprivate _overlayWidget: OverlayWidgetDelegate | null;\n\tprivate _resizeSash: Sash;\n\tprivate _positionMarkerId: string[] = [];\n\n\tprotected _viewZone: ViewZoneDelegate | null;\n\tprotected _disposables: IDisposable[] = [];\n\n\tpublic container: HTMLElement;\n\tpublic domNode: HTMLElement;\n\tpublic editor: ICodeEditor;\n\tpublic options: IOptions;\n\n\n\tconstructor(editor: ICodeEditor, options: IOptions = {}) {\n\t\tthis.editor = editor;\n\t\tthis.options = objects.deepClone(options);\n\t\tobjects.mixin(this.options, defaultOptions, false);\n\t\tthis.domNode = document.createElement('div');\n\t\tif (!this.options.isAccessible) {\n\t\t\tthis.domNode.setAttribute('aria-hidden', 'true');\n\t\t\tthis.domNode.setAttribute('role', 'presentation');\n\t\t}\n\n\t\tthis._disposables.push(this.editor.onDidLayoutChange((info: EditorLayoutInfo) => {\n\t\t\tconst width = this._getWidth(info);\n\t\t\tthis.domNode.style.width = width + 'px';\n\t\t\tthis.domNode.style.left = this._getLeft(info) + 'px';\n\t\t\tthis._onWidth(width);\n\t\t}));\n\t}\n\n\tpublic dispose(): void {\n\n\t\tdispose(this._disposables);\n\n\t\tif (this._overlayWidget) {\n\t\t\tthis.editor.removeOverlayWidget(this._overlayWidget);\n\t\t\tthis._overlayWidget = null;\n\t\t}\n\n\t\tif (this._viewZone) {\n\t\t\tthis.editor.changeViewZones(accessor => {\n\t\t\t\tif (this._viewZone) {\n\t\t\t\t\taccessor.removeZone(this._viewZone.id);\n\t\t\t\t}\n\t\t\t\tthis._viewZone = null;\n\t\t\t});\n\t\t}\n\n\t\tthis.editor.deltaDecorations(this._positionMarkerId, []);\n\t\tthis._positionMarkerId = [];\n\t}\n\n\tpublic create(): void {\n\n\t\tdom.addClass(this.domNode, 'zone-widget');\n\t\tif (this.options.className) {\n\t\t\tdom.addClass(this.domNode, this.options.className);\n\t\t}\n\n\t\tthis.container = document.createElement('div');\n\t\tdom.addClass(this.container, 'zone-widget-container');\n\t\tthis.domNode.appendChild(this.container);\n\t\tif (this.options.showArrow) {\n\t\t\tthis._arrow = new Arrow(this.editor);\n\t\t\tthis._disposables.push(this._arrow);\n\t\t}\n\t\tthis._fillContainer(this.container);\n\t\tthis._initSash();\n\t\tthis._applyStyles();\n\t}\n\n\tpublic style(styles: IStyles): void {\n\t\tif (styles.frameColor) {\n\t\t\tthis.options.frameColor = styles.frameColor;\n\t\t}\n\t\tif (styles.arrowColor) {\n\t\t\tthis.options.arrowColor = styles.arrowColor;\n\t\t}\n\t\tthis._applyStyles();\n\t}\n\n\tprotected _applyStyles(): void {\n\t\tif (this.container && this.options.frameColor) {\n\t\t\tlet frameColor = this.options.frameColor.toString();\n\t\t\tthis.container.style.borderTopColor = frameColor;\n\t\t\tthis.container.style.borderBottomColor = frameColor;\n\t\t}\n\t\tif (this._arrow && this.options.arrowColor) {\n\t\t\tlet arrowColor = this.options.arrowColor.toString();\n\t\t\tthis._arrow.color = arrowColor;\n\t\t}\n\t}\n\n\tprivate _getWidth(info: EditorLayoutInfo): number {\n\t\treturn info.width - info.minimapWidth - info.verticalScrollbarWidth;\n\t}\n\n\tprivate _getLeft(info: EditorLayoutInfo): number {\n\t\t// If minimap is to the left, we move beyond it\n\t\tif (info.minimapWidth > 0 && info.minimapLeft === 0) {\n\t\t\treturn info.minimapWidth;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprivate _onViewZoneTop(top: number): void {\n\t\tthis.domNode.style.top = top + 'px';\n\t}\n\n\tprivate _onViewZoneHeight(height: number): void {\n\t\tthis.domNode.style.height = `${height}px`;\n\n\t\tlet containerHeight = height - this._decoratingElementsHeight();\n\t\tthis.container.style.height = `${containerHeight}px`;\n\t\tconst layoutInfo = this.editor.getLayoutInfo();\n\t\tthis._doLayout(containerHeight, this._getWidth(layoutInfo));\n\n\t\tthis._resizeSash.layout();\n\t}\n\n\tpublic get position(): Position | undefined {\n\t\tconst [id] = this._positionMarkerId;\n\t\tif (!id) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst model = this.editor.getModel();\n\t\tif (!model) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst range = model.getDecorationRange(id);\n\t\tif (!range) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn range.getStartPosition();\n\t}\n\n\tprotected _isShowing: boolean = false;\n\n\tpublic show(rangeOrPos: IRange | IPosition, heightInLines: number): void {\n\t\tconst range = Range.isIRange(rangeOrPos)\n\t\t\t? rangeOrPos\n\t\t\t: new Range(rangeOrPos.lineNumber, rangeOrPos.column, rangeOrPos.lineNumber, rangeOrPos.column);\n\n\t\tthis._isShowing = true;\n\t\tthis._showImpl(range, heightInLines);\n\t\tthis._isShowing = false;\n\t\tthis._positionMarkerId = this.editor.deltaDecorations(this._positionMarkerId, [{ range, options: ModelDecorationOptions.EMPTY }]);\n\t}\n\n\tpublic hide(): void {\n\t\tif (this._viewZone) {\n\t\t\tthis.editor.changeViewZones(accessor => {\n\t\t\t\tif (this._viewZone) {\n\t\t\t\t\taccessor.removeZone(this._viewZone.id);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis._viewZone = null;\n\t\t}\n\t\tif (this._overlayWidget) {\n\t\t\tthis.editor.removeOverlayWidget(this._overlayWidget);\n\t\t\tthis._overlayWidget = null;\n\t\t}\n\t\tif (this._arrow) {\n\t\t\tthis._arrow.hide();\n\t\t}\n\t}\n\n\tprivate _decoratingElementsHeight(): number {\n\t\tlet lineHeight = this.editor.getConfiguration().lineHeight;\n\t\tlet result = 0;\n\n\t\tif (this.options.showArrow) {\n\t\t\tlet arrowHeight = Math.round(lineHeight / 3);\n\t\t\tresult += 2 * arrowHeight;\n\t\t}\n\n\t\tif (this.options.showFrame) {\n\t\t\tlet frameThickness = Math.round(lineHeight / 9);\n\t\t\tresult += 2 * frameThickness;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate _showImpl(where: IRange, heightInLines: number): void {\n\t\tconst position = {\n\t\t\tlineNumber: where.startLineNumber,\n\t\t\tcolumn: where.startColumn\n\t\t};\n\n\t\tconst layoutInfo = this.editor.getLayoutInfo();\n\t\tconst width = this._getWidth(layoutInfo);\n\t\tthis.domNode.style.width = `${width}px`;\n\t\tthis.domNode.style.left = this._getLeft(layoutInfo) + 'px';\n\n\t\t// Render the widget as zone (rendering) and widget (lifecycle)\n\t\tconst viewZoneDomNode = document.createElement('div');\n\t\tviewZoneDomNode.style.overflow = 'hidden';\n\t\tconst lineHeight = this.editor.getConfiguration().lineHeight;\n\n\t\t// adjust heightInLines to viewport\n\t\tconst maxHeightInLines = (this.editor.getLayoutInfo().height / lineHeight) * 0.8;\n\t\tif (heightInLines >= maxHeightInLines) {\n\t\t\theightInLines = maxHeightInLines;\n\t\t}\n\n\t\tlet arrowHeight = 0;\n\t\tlet frameThickness = 0;\n\n\t\t// Render the arrow one 1/3 of an editor line height\n\t\tif (this.options.showArrow) {\n\t\t\tarrowHeight = Math.round(lineHeight / 3);\n\t\t\tthis._arrow.height = arrowHeight;\n\t\t\tthis._arrow.show(position);\n\t\t}\n\n\t\t// Render the frame as 1/9 of an editor line height\n\t\tif (this.options.showFrame) {\n\t\t\tframeThickness = Math.round(lineHeight / 9);\n\t\t}\n\n\t\t// insert zone widget\n\t\tthis.editor.changeViewZones((accessor: IViewZoneChangeAccessor) => {\n\t\t\tif (this._viewZone) {\n\t\t\t\taccessor.removeZone(this._viewZone.id);\n\t\t\t}\n\t\t\tif (this._overlayWidget) {\n\t\t\t\tthis.editor.removeOverlayWidget(this._overlayWidget);\n\t\t\t\tthis._overlayWidget = null;\n\t\t\t}\n\t\t\tthis.domNode.style.top = '-1000px';\n\t\t\tthis._viewZone = new ViewZoneDelegate(\n\t\t\t\tviewZoneDomNode,\n\t\t\t\tposition.lineNumber,\n\t\t\t\tposition.column,\n\t\t\t\theightInLines,\n\t\t\t\t(top: number) => this._onViewZoneTop(top),\n\t\t\t\t(height: number) => this._onViewZoneHeight(height)\n\t\t\t);\n\t\t\tthis._viewZone.id = accessor.addZone(this._viewZone);\n\t\t\tthis._overlayWidget = new OverlayWidgetDelegate(WIDGET_ID + this._viewZone.id, this.domNode);\n\t\t\tthis.editor.addOverlayWidget(this._overlayWidget);\n\t\t});\n\n\t\tif (this.options.showFrame) {\n\t\t\tconst width = this.options.frameWidth ? this.options.frameWidth : frameThickness;\n\t\t\tthis.container.style.borderTopWidth = width + 'px';\n\t\t\tthis.container.style.borderBottomWidth = width + 'px';\n\t\t}\n\n\t\tlet containerHeight = heightInLines * lineHeight - this._decoratingElementsHeight();\n\t\tthis.container.style.top = arrowHeight + 'px';\n\t\tthis.container.style.height = containerHeight + 'px';\n\t\tthis.container.style.overflow = 'hidden';\n\n\n\t\tthis._doLayout(containerHeight, width);\n\n\t\tif (!this.options.keepEditorSelection) {\n\t\t\tthis.editor.setSelection(where);\n\t\t}\n\n\t\tconst model = this.editor.getModel();\n\t\tif (model) {\n\t\t\t// Reveal the line above or below the zone widget, to get the zone widget in the viewport\n\t\t\tconst revealLineNumber = Math.min(model.getLineCount(), Math.max(1, where.endLineNumber + 1));\n\t\t\tthis.revealLine(revealLineNumber);\n\t\t}\n\t}\n\n\tprotected revealLine(lineNumber: number) {\n\t\tthis.editor.revealLine(lineNumber, ScrollType.Smooth);\n\t}\n\n\tprotected setCssClass(className: string, classToReplace?: string): void {\n\t\tif (classToReplace) {\n\t\t\tthis.container.classList.remove(classToReplace);\n\t\t}\n\n\t\tdom.addClass(this.container, className);\n\n\t}\n\n\tprotected abstract _fillContainer(container: HTMLElement): void;\n\n\tprotected _onWidth(widthInPixel: number): void {\n\t\t// implement in subclass\n\t}\n\n\tprotected _doLayout(heightInPixel: number, widthInPixel: number): void {\n\t\t// implement in subclass\n\t}\n\n\tprotected _relayout(newHeightInLines: number): void {\n\t\tif (this._viewZone && this._viewZone.heightInLines !== newHeightInLines) {\n\t\t\tthis.editor.changeViewZones(accessor => {\n\t\t\t\tif (this._viewZone) {\n\t\t\t\t\tthis._viewZone.heightInLines = newHeightInLines;\n\t\t\t\t\taccessor.layoutZone(this._viewZone.id);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t// --- sash\n\n\tprivate _initSash(): void {\n\t\tthis._resizeSash = new Sash(this.domNode, this, { orientation: Orientation.HORIZONTAL });\n\n\t\tif (!this.options.isResizeable) {\n\t\t\tthis._resizeSash.hide();\n\t\t\tthis._resizeSash.state = SashState.Disabled;\n\t\t}\n\n\t\tlet data: { startY: number; heightInLines: number; } | undefined;\n\t\tthis._disposables.push(this._resizeSash.onDidStart((e: ISashEvent) => {\n\t\t\tif (this._viewZone) {\n\t\t\t\tdata = {\n\t\t\t\t\tstartY: e.startY,\n\t\t\t\t\theightInLines: this._viewZone.heightInLines,\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\tthis._disposables.push(this._resizeSash.onDidEnd(() => {\n\t\t\tdata = undefined;\n\t\t}));\n\n\t\tthis._disposables.push(this._resizeSash.onDidChange((evt: ISashEvent) => {\n\t\t\tif (data) {\n\t\t\t\tlet lineDelta = (evt.currentY - data.startY) / this.editor.getConfiguration().lineHeight;\n\t\t\t\tlet roundedLineDelta = lineDelta < 0 ? Math.ceil(lineDelta) : Math.floor(lineDelta);\n\t\t\t\tlet newHeightInLines = data.heightInLines + roundedLineDelta;\n\n\t\t\t\tif (newHeightInLines > 5 && newHeightInLines < 35) {\n\t\t\t\t\tthis._relayout(newHeightInLines);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tgetHorizontalSashLeft() {\n\t\treturn 0;\n\t}\n\n\tgetHorizontalSashTop() {\n\t\treturn (this.domNode.style.height === null ? 0 : parseInt(this.domNode.style.height)) - (this._decoratingElementsHeight() / 2);\n\t}\n\n\tgetHorizontalSashWidth() {\n\t\tconst layoutInfo = this.editor.getLayoutInfo();\n\t\treturn layoutInfo.width - layoutInfo.minimapWidth;\n\t}\n}\n"]}]}