{"remainingRequest":"/home/coding/workspace/node_modules/ts-loader/index.js?{\"happyPackMode\":true,\"compilerOptions\":{\"target\":\"es5\",\"lib\":[\"dom\",\"esnext\"]}}!/home/coding/workspace/lib/vscode/src/vs/editor/contrib/find/findWidget.ts","dependencies":[{"path":"/home/coding/workspace/lib/vscode/src/vs/editor/contrib/find/findWidget.ts","mtime":1555102316000},{"path":"/home/coding/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1555844183884},{"path":"/home/coding/workspace/node_modules/ts-loader/index.js","mtime":1555844217316}],"contextDependencies":[],"result":["\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nrequire(\"vs/css!./findWidget\");\nvar nls = require(\"vs/nls\");\nvar dom = require(\"vs/base/browser/dom\");\nvar sash_1 = require(\"vs/base/browser/ui/sash/sash\");\nvar widget_1 = require(\"vs/base/browser/ui/widget\");\nvar async_1 = require(\"vs/base/common/async\");\nvar errors_1 = require(\"vs/base/common/errors\");\nvar keyCodes_1 = require(\"vs/base/common/keyCodes\");\nvar lifecycle_1 = require(\"vs/base/common/lifecycle\");\nvar platform = require(\"vs/base/common/platform\");\nvar strings = require(\"vs/base/common/strings\");\nvar editorBrowser_1 = require(\"vs/editor/browser/editorBrowser\");\nvar range_1 = require(\"vs/editor/common/core/range\");\nvar findModel_1 = require(\"vs/editor/contrib/find/findModel\");\nvar colorRegistry_1 = require(\"vs/platform/theme/common/colorRegistry\");\nvar themeService_1 = require(\"vs/platform/theme/common/themeService\");\nvar contextScopedHistoryWidget_1 = require(\"vs/platform/browser/contextScopedHistoryWidget\");\nvar accessibility_1 = require(\"vs/platform/accessibility/common/accessibility\");\nvar NLS_FIND_INPUT_LABEL = nls.localize('label.find', \"Find\");\nvar NLS_FIND_INPUT_PLACEHOLDER = nls.localize('placeholder.find', \"Find\");\nvar NLS_PREVIOUS_MATCH_BTN_LABEL = nls.localize('label.previousMatchButton', \"Previous match\");\nvar NLS_NEXT_MATCH_BTN_LABEL = nls.localize('label.nextMatchButton', \"Next match\");\nvar NLS_TOGGLE_SELECTION_FIND_TITLE = nls.localize('label.toggleSelectionFind', \"Find in selection\");\nvar NLS_CLOSE_BTN_LABEL = nls.localize('label.closeButton', \"Close\");\nvar NLS_REPLACE_INPUT_LABEL = nls.localize('label.replace', \"Replace\");\nvar NLS_REPLACE_INPUT_PLACEHOLDER = nls.localize('placeholder.replace', \"Replace\");\nvar NLS_REPLACE_BTN_LABEL = nls.localize('label.replaceButton', \"Replace\");\nvar NLS_REPLACE_ALL_BTN_LABEL = nls.localize('label.replaceAllButton', \"Replace All\");\nvar NLS_TOGGLE_REPLACE_MODE_BTN_LABEL = nls.localize('label.toggleReplaceButton', \"Toggle Replace mode\");\nvar NLS_MATCHES_COUNT_LIMIT_TITLE = nls.localize('title.matchesCountLimit', \"Only the first {0} results are highlighted, but all find operations work on the entire text.\", findModel_1.MATCHES_LIMIT);\nvar NLS_MATCHES_LOCATION = nls.localize('label.matchesLocation', \"{0} of {1}\");\nvar NLS_NO_RESULTS = nls.localize('label.noResults', \"No Results\");\nvar FIND_WIDGET_INITIAL_WIDTH = 411;\nvar PART_WIDTH = 275;\nvar FIND_INPUT_AREA_WIDTH = PART_WIDTH - 54;\nvar REPLACE_INPUT_AREA_WIDTH = FIND_INPUT_AREA_WIDTH;\nvar MAX_MATCHES_COUNT_WIDTH = 69;\nvar FIND_ALL_CONTROLS_WIDTH = 17 /** Find Input margin-left */ + (MAX_MATCHES_COUNT_WIDTH + 3 + 1) /** Match Results */ + 23 /** Button */ * 4 + 2 /** sash */;\nvar FIND_INPUT_AREA_HEIGHT = 34; // The height of Find Widget when Replace Input is not visible.\nvar FIND_REPLACE_AREA_HEIGHT = 64; // The height of Find Widget when Replace Input is  visible.\nvar FindWidgetViewZone = /** @class */ (function () {\n    function FindWidgetViewZone(afterLineNumber) {\n        this.afterLineNumber = afterLineNumber;\n        this.heightInPx = FIND_INPUT_AREA_HEIGHT;\n        this.suppressMouseDown = false;\n        this.domNode = document.createElement('div');\n        this.domNode.className = 'dock-find-viewzone';\n    }\n    return FindWidgetViewZone;\n}());\nexports.FindWidgetViewZone = FindWidgetViewZone;\nvar FindWidget = /** @class */ (function (_super) {\n    tslib_1.__extends(FindWidget, _super);\n    function FindWidget(codeEditor, controller, state, contextViewProvider, keybindingService, contextKeyService, themeService) {\n        var _this = _super.call(this) || this;\n        _this._codeEditor = codeEditor;\n        _this._controller = controller;\n        _this._state = state;\n        _this._contextViewProvider = contextViewProvider;\n        _this._keybindingService = keybindingService;\n        _this._contextKeyService = contextKeyService;\n        _this._isVisible = false;\n        _this._isReplaceVisible = false;\n        _this._ignoreChangeEvent = false;\n        _this._updateHistoryDelayer = new async_1.Delayer(500);\n        _this._register(lifecycle_1.toDisposable(function () { return _this._updateHistoryDelayer.cancel(); }));\n        _this._register(_this._state.onFindReplaceStateChange(function (e) { return _this._onStateChanged(e); }));\n        _this._buildDomNode();\n        _this._updateButtons();\n        _this._tryUpdateWidgetWidth();\n        _this._register(_this._codeEditor.onDidChangeConfiguration(function (e) {\n            if (e.readOnly) {\n                if (_this._codeEditor.getConfiguration().readOnly) {\n                    // Hide replace part if editor becomes read only\n                    _this._state.change({ isReplaceRevealed: false }, false);\n                }\n                _this._updateButtons();\n            }\n            if (e.layoutInfo) {\n                _this._tryUpdateWidgetWidth();\n            }\n            if (e.accessibilitySupport) {\n                _this.updateAccessibilitySupport();\n            }\n            if (e.contribInfo) {\n                var addExtraSpaceOnTop = _this._codeEditor.getConfiguration().contribInfo.find.addExtraSpaceOnTop;\n                if (addExtraSpaceOnTop && !_this._viewZone) {\n                    _this._viewZone = new FindWidgetViewZone(0);\n                    _this._showViewZone();\n                }\n                if (!addExtraSpaceOnTop && _this._viewZone) {\n                    _this._removeViewZone();\n                }\n            }\n        }));\n        _this.updateAccessibilitySupport();\n        _this._register(_this._codeEditor.onDidChangeCursorSelection(function () {\n            if (_this._isVisible) {\n                _this._updateToggleSelectionFindButton();\n            }\n        }));\n        _this._register(_this._codeEditor.onDidFocusEditorWidget(function () {\n            if (_this._isVisible) {\n                var globalBufferTerm = _this._controller.getGlobalBufferTerm();\n                if (globalBufferTerm && globalBufferTerm !== _this._state.searchString) {\n                    _this._state.change({ searchString: globalBufferTerm }, true);\n                    _this._findInput.select();\n                }\n            }\n        }));\n        _this._findInputFocused = findModel_1.CONTEXT_FIND_INPUT_FOCUSED.bindTo(contextKeyService);\n        _this._findFocusTracker = _this._register(dom.trackFocus(_this._findInput.inputBox.inputElement));\n        _this._register(_this._findFocusTracker.onDidFocus(function () {\n            _this._findInputFocused.set(true);\n            _this._updateSearchScope();\n        }));\n        _this._register(_this._findFocusTracker.onDidBlur(function () {\n            _this._findInputFocused.set(false);\n        }));\n        _this._replaceInputFocused = findModel_1.CONTEXT_REPLACE_INPUT_FOCUSED.bindTo(contextKeyService);\n        _this._replaceFocusTracker = _this._register(dom.trackFocus(_this._replaceInputBox.inputElement));\n        _this._register(_this._replaceFocusTracker.onDidFocus(function () {\n            _this._replaceInputFocused.set(true);\n            _this._updateSearchScope();\n        }));\n        _this._register(_this._replaceFocusTracker.onDidBlur(function () {\n            _this._replaceInputFocused.set(false);\n        }));\n        _this._codeEditor.addOverlayWidget(_this);\n        if (_this._codeEditor.getConfiguration().contribInfo.find.addExtraSpaceOnTop) {\n            _this._viewZone = new FindWidgetViewZone(0); // Put it before the first line then users can scroll beyond the first line.\n        }\n        _this._applyTheme(themeService.getTheme());\n        _this._register(themeService.onThemeChange(_this._applyTheme.bind(_this)));\n        _this._register(_this._codeEditor.onDidChangeModel(function () {\n            if (!_this._isVisible) {\n                return;\n            }\n            if (_this._viewZoneId === undefined) {\n                return;\n            }\n            _this._codeEditor.changeViewZones(function (accessor) {\n                if (_this._viewZoneId) {\n                    accessor.removeZone(_this._viewZoneId);\n                }\n                _this._viewZoneId = undefined;\n            });\n        }));\n        _this._register(_this._codeEditor.onDidScrollChange(function (e) {\n            if (e.scrollTopChanged) {\n                _this._layoutViewZone();\n                return;\n            }\n            // for other scroll changes, layout the viewzone in next tick to avoid ruining current rendering.\n            setTimeout(function () {\n                _this._layoutViewZone();\n            }, 0);\n        }));\n        return _this;\n    }\n    // ----- IOverlayWidget API\n    FindWidget.prototype.getId = function () {\n        return FindWidget.ID;\n    };\n    FindWidget.prototype.getDomNode = function () {\n        return this._domNode;\n    };\n    FindWidget.prototype.getPosition = function () {\n        if (this._isVisible) {\n            return {\n                preference: editorBrowser_1.OverlayWidgetPositionPreference.TOP_RIGHT_CORNER\n            };\n        }\n        return null;\n    };\n    // ----- React to state changes\n    FindWidget.prototype._onStateChanged = function (e) {\n        if (e.searchString) {\n            try {\n                this._ignoreChangeEvent = true;\n                this._findInput.setValue(this._state.searchString);\n            }\n            finally {\n                this._ignoreChangeEvent = false;\n            }\n            this._updateButtons();\n        }\n        if (e.replaceString) {\n            this._replaceInputBox.value = this._state.replaceString;\n        }\n        if (e.isRevealed) {\n            if (this._state.isRevealed) {\n                this._reveal();\n            }\n            else {\n                this._hide(true);\n            }\n        }\n        if (e.isReplaceRevealed) {\n            if (this._state.isReplaceRevealed) {\n                if (!this._codeEditor.getConfiguration().readOnly && !this._isReplaceVisible) {\n                    this._isReplaceVisible = true;\n                    this._replaceInputBox.width = this._findInput.inputBox.width;\n                    this._updateButtons();\n                }\n            }\n            else {\n                if (this._isReplaceVisible) {\n                    this._isReplaceVisible = false;\n                    this._updateButtons();\n                }\n            }\n        }\n        if (e.isRegex) {\n            this._findInput.setRegex(this._state.isRegex);\n        }\n        if (e.wholeWord) {\n            this._findInput.setWholeWords(this._state.wholeWord);\n        }\n        if (e.matchCase) {\n            this._findInput.setCaseSensitive(this._state.matchCase);\n        }\n        if (e.searchScope) {\n            if (this._state.searchScope) {\n                this._toggleSelectionFind.checked = true;\n            }\n            else {\n                this._toggleSelectionFind.checked = false;\n            }\n            this._updateToggleSelectionFindButton();\n        }\n        if (e.searchString || e.matchesCount || e.matchesPosition) {\n            var showRedOutline = (this._state.searchString.length > 0 && this._state.matchesCount === 0);\n            dom.toggleClass(this._domNode, 'no-results', showRedOutline);\n            this._updateMatchesCount();\n            this._updateButtons();\n        }\n        if (e.searchString || e.currentMatch) {\n            this._layoutViewZone();\n        }\n        if (e.updateHistory) {\n            this._delayedUpdateHistory();\n        }\n    };\n    FindWidget.prototype._delayedUpdateHistory = function () {\n        this._updateHistoryDelayer.trigger(this._updateHistory.bind(this));\n    };\n    FindWidget.prototype._updateHistory = function () {\n        if (this._state.searchString) {\n            this._findInput.inputBox.addToHistory();\n        }\n        if (this._state.replaceString) {\n            this._replaceInputBox.addToHistory();\n        }\n    };\n    FindWidget.prototype._updateMatchesCount = function () {\n        this._matchesCount.style.minWidth = MAX_MATCHES_COUNT_WIDTH + 'px';\n        if (this._state.matchesCount >= findModel_1.MATCHES_LIMIT) {\n            this._matchesCount.title = NLS_MATCHES_COUNT_LIMIT_TITLE;\n        }\n        else {\n            this._matchesCount.title = '';\n        }\n        // remove previous content\n        if (this._matchesCount.firstChild) {\n            this._matchesCount.removeChild(this._matchesCount.firstChild);\n        }\n        var label;\n        if (this._state.matchesCount > 0) {\n            var matchesCount = String(this._state.matchesCount);\n            if (this._state.matchesCount >= findModel_1.MATCHES_LIMIT) {\n                matchesCount += '+';\n            }\n            var matchesPosition = String(this._state.matchesPosition);\n            if (matchesPosition === '0') {\n                matchesPosition = '?';\n            }\n            label = strings.format(NLS_MATCHES_LOCATION, matchesPosition, matchesCount);\n        }\n        else {\n            label = NLS_NO_RESULTS;\n        }\n        this._matchesCount.appendChild(document.createTextNode(label));\n        MAX_MATCHES_COUNT_WIDTH = Math.max(MAX_MATCHES_COUNT_WIDTH, this._matchesCount.clientWidth);\n    };\n    // ----- actions\n    /**\n     * If 'selection find' is ON we should not disable the button (its function is to cancel 'selection find').\n     * If 'selection find' is OFF we enable the button only if there is a selection.\n     */\n    FindWidget.prototype._updateToggleSelectionFindButton = function () {\n        var selection = this._codeEditor.getSelection();\n        var isSelection = selection ? (selection.startLineNumber !== selection.endLineNumber || selection.startColumn !== selection.endColumn) : false;\n        var isChecked = this._toggleSelectionFind.checked;\n        this._toggleSelectionFind.setEnabled(this._isVisible && (isChecked || isSelection));\n    };\n    FindWidget.prototype._updateButtons = function () {\n        this._findInput.setEnabled(this._isVisible);\n        this._replaceInputBox.setEnabled(this._isVisible && this._isReplaceVisible);\n        this._updateToggleSelectionFindButton();\n        this._closeBtn.setEnabled(this._isVisible);\n        var findInputIsNonEmpty = (this._state.searchString.length > 0);\n        var matchesCount = this._state.matchesCount ? true : false;\n        this._prevBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount);\n        this._nextBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount);\n        this._replaceBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\n        this._replaceAllBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\n        dom.toggleClass(this._domNode, 'replaceToggled', this._isReplaceVisible);\n        this._toggleReplaceBtn.toggleClass('collapse', !this._isReplaceVisible);\n        this._toggleReplaceBtn.toggleClass('expand', this._isReplaceVisible);\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\n        var canReplace = !this._codeEditor.getConfiguration().readOnly;\n        this._toggleReplaceBtn.setEnabled(this._isVisible && canReplace);\n    };\n    FindWidget.prototype._reveal = function () {\n        var _this = this;\n        if (!this._isVisible) {\n            this._isVisible = true;\n            var selection = this._codeEditor.getSelection();\n            var isSelection = selection ? (selection.startLineNumber !== selection.endLineNumber || selection.startColumn !== selection.endColumn) : false;\n            if (isSelection && this._codeEditor.getConfiguration().contribInfo.find.autoFindInSelection) {\n                this._toggleSelectionFind.checked = true;\n            }\n            else {\n                this._toggleSelectionFind.checked = false;\n            }\n            this._tryUpdateWidgetWidth();\n            this._updateButtons();\n            setTimeout(function () {\n                dom.addClass(_this._domNode, 'visible');\n                _this._domNode.setAttribute('aria-hidden', 'false');\n            }, 0);\n            // validate query again as it's being dismissed when we hide the find widget.\n            setTimeout(function () {\n                _this._findInput.validate();\n            }, 200);\n            this._codeEditor.layoutOverlayWidget(this);\n            var adjustEditorScrollTop = true;\n            if (this._codeEditor.getConfiguration().contribInfo.find.seedSearchStringFromSelection && selection) {\n                var domNode = this._codeEditor.getDomNode();\n                if (domNode) {\n                    var editorCoords = dom.getDomNodePagePosition(domNode);\n                    var startCoords = this._codeEditor.getScrolledVisiblePosition(selection.getStartPosition());\n                    var startLeft = editorCoords.left + (startCoords ? startCoords.left : 0);\n                    var startTop = startCoords ? startCoords.top : 0;\n                    if (this._viewZone && startTop < this._viewZone.heightInPx) {\n                        if (selection.endLineNumber > selection.startLineNumber) {\n                            adjustEditorScrollTop = false;\n                        }\n                        var leftOfFindWidget = dom.getTopLeftOffset(this._domNode).left;\n                        if (startLeft > leftOfFindWidget) {\n                            adjustEditorScrollTop = false;\n                        }\n                        var endCoords = this._codeEditor.getScrolledVisiblePosition(selection.getEndPosition());\n                        var endLeft = editorCoords.left + (endCoords ? endCoords.left : 0);\n                        if (endLeft > leftOfFindWidget) {\n                            adjustEditorScrollTop = false;\n                        }\n                    }\n                }\n            }\n            this._showViewZone(adjustEditorScrollTop);\n        }\n    };\n    FindWidget.prototype._hide = function (focusTheEditor) {\n        if (this._isVisible) {\n            this._isVisible = false;\n            this._updateButtons();\n            dom.removeClass(this._domNode, 'visible');\n            this._domNode.setAttribute('aria-hidden', 'true');\n            this._findInput.clearMessage();\n            if (focusTheEditor) {\n                this._codeEditor.focus();\n            }\n            this._codeEditor.layoutOverlayWidget(this);\n            this._removeViewZone();\n        }\n    };\n    FindWidget.prototype._layoutViewZone = function () {\n        var _this = this;\n        var addExtraSpaceOnTop = this._codeEditor.getConfiguration().contribInfo.find.addExtraSpaceOnTop;\n        if (!addExtraSpaceOnTop) {\n            this._removeViewZone();\n            return;\n        }\n        if (!this._isVisible) {\n            return;\n        }\n        var viewZone = this._viewZone;\n        if (this._viewZoneId !== undefined || !viewZone) {\n            return;\n        }\n        this._codeEditor.changeViewZones(function (accessor) {\n            if (_this._state.isReplaceRevealed) {\n                viewZone.heightInPx = FIND_REPLACE_AREA_HEIGHT;\n            }\n            else {\n                viewZone.heightInPx = FIND_INPUT_AREA_HEIGHT;\n            }\n            _this._viewZoneId = accessor.addZone(viewZone);\n            // scroll top adjust to make sure the editor doesn't scroll when adding viewzone at the beginning.\n            _this._codeEditor.setScrollTop(_this._codeEditor.getScrollTop() + viewZone.heightInPx);\n        });\n    };\n    FindWidget.prototype._showViewZone = function (adjustScroll) {\n        var _this = this;\n        if (adjustScroll === void 0) { adjustScroll = true; }\n        var viewZone = this._viewZone;\n        if (!this._isVisible || !viewZone) {\n            return;\n        }\n        this._codeEditor.changeViewZones(function (accessor) {\n            var scrollAdjustment = FIND_INPUT_AREA_HEIGHT;\n            if (_this._viewZoneId !== undefined) {\n                if (_this._state.isReplaceRevealed) {\n                    viewZone.heightInPx = FIND_REPLACE_AREA_HEIGHT;\n                    scrollAdjustment = FIND_REPLACE_AREA_HEIGHT - FIND_INPUT_AREA_HEIGHT;\n                }\n                else {\n                    viewZone.heightInPx = FIND_INPUT_AREA_HEIGHT;\n                    scrollAdjustment = FIND_INPUT_AREA_HEIGHT - FIND_REPLACE_AREA_HEIGHT;\n                }\n                accessor.removeZone(_this._viewZoneId);\n            }\n            else {\n                viewZone.heightInPx = FIND_INPUT_AREA_HEIGHT;\n            }\n            _this._viewZoneId = accessor.addZone(viewZone);\n            if (adjustScroll) {\n                _this._codeEditor.setScrollTop(_this._codeEditor.getScrollTop() + scrollAdjustment);\n            }\n        });\n    };\n    FindWidget.prototype._removeViewZone = function () {\n        var _this = this;\n        this._codeEditor.changeViewZones(function (accessor) {\n            if (_this._viewZoneId !== undefined) {\n                accessor.removeZone(_this._viewZoneId);\n                _this._viewZoneId = undefined;\n                if (_this._viewZone) {\n                    _this._codeEditor.setScrollTop(_this._codeEditor.getScrollTop() - _this._viewZone.heightInPx);\n                    _this._viewZone = undefined;\n                }\n            }\n        });\n    };\n    FindWidget.prototype._applyTheme = function (theme) {\n        var inputStyles = {\n            inputActiveOptionBorder: theme.getColor(colorRegistry_1.inputActiveOptionBorder),\n            inputBackground: theme.getColor(colorRegistry_1.inputBackground),\n            inputForeground: theme.getColor(colorRegistry_1.inputForeground),\n            inputBorder: theme.getColor(colorRegistry_1.inputBorder),\n            inputValidationInfoBackground: theme.getColor(colorRegistry_1.inputValidationInfoBackground),\n            inputValidationInfoForeground: theme.getColor(colorRegistry_1.inputValidationInfoForeground),\n            inputValidationInfoBorder: theme.getColor(colorRegistry_1.inputValidationInfoBorder),\n            inputValidationWarningBackground: theme.getColor(colorRegistry_1.inputValidationWarningBackground),\n            inputValidationWarningForeground: theme.getColor(colorRegistry_1.inputValidationWarningForeground),\n            inputValidationWarningBorder: theme.getColor(colorRegistry_1.inputValidationWarningBorder),\n            inputValidationErrorBackground: theme.getColor(colorRegistry_1.inputValidationErrorBackground),\n            inputValidationErrorForeground: theme.getColor(colorRegistry_1.inputValidationErrorForeground),\n            inputValidationErrorBorder: theme.getColor(colorRegistry_1.inputValidationErrorBorder),\n        };\n        this._findInput.style(inputStyles);\n        this._replaceInputBox.style(inputStyles);\n    };\n    FindWidget.prototype._tryUpdateWidgetWidth = function () {\n        if (!this._isVisible) {\n            return;\n        }\n        var editorWidth = this._codeEditor.getConfiguration().layoutInfo.width;\n        var minimapWidth = this._codeEditor.getConfiguration().layoutInfo.minimapWidth;\n        var collapsedFindWidget = false;\n        var reducedFindWidget = false;\n        var narrowFindWidget = false;\n        if (this._resized) {\n            var widgetWidth = dom.getTotalWidth(this._domNode);\n            if (widgetWidth > FIND_WIDGET_INITIAL_WIDTH) {\n                // as the widget is resized by users, we may need to change the max width of the widget as the editor width changes.\n                this._domNode.style.maxWidth = editorWidth - 28 - minimapWidth - 15 + \"px\";\n                this._replaceInputBox.inputElement.style.width = dom.getTotalWidth(this._findInput.inputBox.inputElement) + \"px\";\n                return;\n            }\n        }\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth >= editorWidth) {\n            reducedFindWidget = true;\n        }\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth) {\n            narrowFindWidget = true;\n        }\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth + 50) {\n            collapsedFindWidget = true;\n        }\n        dom.toggleClass(this._domNode, 'collapsed-find-widget', collapsedFindWidget);\n        dom.toggleClass(this._domNode, 'narrow-find-widget', narrowFindWidget);\n        dom.toggleClass(this._domNode, 'reduced-find-widget', reducedFindWidget);\n        if (!narrowFindWidget && !collapsedFindWidget) {\n            // the minimal left offset of findwidget is 15px.\n            this._domNode.style.maxWidth = editorWidth - 28 - minimapWidth - 15 + \"px\";\n        }\n        if (this._resized) {\n            var findInputWidth = dom.getTotalWidth(this._findInput.inputBox.inputElement);\n            if (findInputWidth > 0) {\n                this._replaceInputBox.inputElement.style.width = findInputWidth + \"px\";\n            }\n        }\n    };\n    // ----- Public\n    FindWidget.prototype.focusFindInput = function () {\n        this._findInput.select();\n        // Edge browser requires focus() in addition to select()\n        this._findInput.focus();\n    };\n    FindWidget.prototype.focusReplaceInput = function () {\n        this._replaceInputBox.select();\n        // Edge browser requires focus() in addition to select()\n        this._replaceInputBox.focus();\n    };\n    FindWidget.prototype.highlightFindOptions = function () {\n        this._findInput.highlightFindOptions();\n    };\n    FindWidget.prototype._updateSearchScope = function () {\n        if (!this._codeEditor.hasModel()) {\n            return;\n        }\n        if (this._toggleSelectionFind.checked) {\n            var selection = this._codeEditor.getSelection();\n            if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n                selection = selection.setEndPosition(selection.endLineNumber - 1, this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n            }\n            var currentMatch = this._state.currentMatch;\n            if (selection.startLineNumber !== selection.endLineNumber) {\n                if (!range_1.Range.equalsRange(selection, currentMatch)) {\n                    // Reseed find scope\n                    this._state.change({ searchScope: selection }, true);\n                }\n            }\n        }\n    };\n    FindWidget.prototype._onFindInputMouseDown = function (e) {\n        // on linux, middle key does pasting.\n        if (e.middleButton) {\n            e.stopPropagation();\n        }\n    };\n    FindWidget.prototype._onFindInputKeyDown = function (e) {\n        if (e.equals(keyCodes_1.KeyCode.Enter)) {\n            this._codeEditor.getAction(findModel_1.FIND_IDS.NextMatchFindAction).run().then(undefined, errors_1.onUnexpectedError);\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.Enter)) {\n            this._codeEditor.getAction(findModel_1.FIND_IDS.PreviousMatchFindAction).run().then(undefined, errors_1.onUnexpectedError);\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(keyCodes_1.KeyCode.Tab)) {\n            if (this._isReplaceVisible) {\n                this._replaceInputBox.focus();\n            }\n            else {\n                this._findInput.focusOnCaseSensitive();\n            }\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.DownArrow)) {\n            this._codeEditor.focus();\n            e.preventDefault();\n            return;\n        }\n    };\n    FindWidget.prototype._onReplaceInputKeyDown = function (e) {\n        if (e.equals(keyCodes_1.KeyCode.Enter)) {\n            this._controller.replace();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.Enter)) {\n            this._controller.replaceAll();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(keyCodes_1.KeyCode.Tab)) {\n            this._findInput.focusOnCaseSensitive();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.Tab)) {\n            this._findInput.focus();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.DownArrow)) {\n            this._codeEditor.focus();\n            e.preventDefault();\n            return;\n        }\n    };\n    // ----- sash\n    FindWidget.prototype.getHorizontalSashTop = function (_sash) {\n        return 0;\n    };\n    FindWidget.prototype.getHorizontalSashLeft = function (_sash) {\n        return 0;\n    };\n    FindWidget.prototype.getHorizontalSashWidth = function (_sash) {\n        return 500;\n    };\n    // ----- initialization\n    FindWidget.prototype._keybindingLabelFor = function (actionId) {\n        var kb = this._keybindingService.lookupKeybinding(actionId);\n        if (!kb) {\n            return '';\n        }\n        return \" (\" + kb.getLabel() + \")\";\n    };\n    FindWidget.prototype._buildFindPart = function () {\n        var _this = this;\n        // Find input\n        this._findInput = this._register(new contextScopedHistoryWidget_1.ContextScopedFindInput(null, this._contextViewProvider, {\n            width: FIND_INPUT_AREA_WIDTH,\n            label: NLS_FIND_INPUT_LABEL,\n            placeholder: NLS_FIND_INPUT_PLACEHOLDER,\n            appendCaseSensitiveLabel: this._keybindingLabelFor(findModel_1.FIND_IDS.ToggleCaseSensitiveCommand),\n            appendWholeWordsLabel: this._keybindingLabelFor(findModel_1.FIND_IDS.ToggleWholeWordCommand),\n            appendRegexLabel: this._keybindingLabelFor(findModel_1.FIND_IDS.ToggleRegexCommand),\n            validation: function (value) {\n                if (value.length === 0) {\n                    return null;\n                }\n                if (!_this._findInput.getRegex()) {\n                    return null;\n                }\n                try {\n                    /* tslint:disable:no-unused-expression */\n                    new RegExp(value);\n                    /* tslint:enable:no-unused-expression */\n                    return null;\n                }\n                catch (e) {\n                    return { content: e.message };\n                }\n            }\n        }, this._contextKeyService, true));\n        this._findInput.setRegex(!!this._state.isRegex);\n        this._findInput.setCaseSensitive(!!this._state.matchCase);\n        this._findInput.setWholeWords(!!this._state.wholeWord);\n        this._register(this._findInput.onKeyDown(function (e) { return _this._onFindInputKeyDown(e); }));\n        this._register(this._findInput.inputBox.onDidChange(function () {\n            if (_this._ignoreChangeEvent) {\n                return;\n            }\n            _this._state.change({ searchString: _this._findInput.getValue() }, true);\n        }));\n        this._register(this._findInput.onDidOptionChange(function () {\n            _this._state.change({\n                isRegex: _this._findInput.getRegex(),\n                wholeWord: _this._findInput.getWholeWords(),\n                matchCase: _this._findInput.getCaseSensitive()\n            }, true);\n        }));\n        this._register(this._findInput.onCaseSensitiveKeyDown(function (e) {\n            if (e.equals(keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.Tab)) {\n                if (_this._isReplaceVisible) {\n                    _this._replaceInputBox.focus();\n                    e.preventDefault();\n                }\n            }\n        }));\n        if (platform.isLinux) {\n            this._register(this._findInput.onMouseDown(function (e) { return _this._onFindInputMouseDown(e); }));\n        }\n        this._matchesCount = document.createElement('div');\n        this._matchesCount.className = 'matchesCount';\n        this._updateMatchesCount();\n        // Previous button\n        this._prevBtn = this._register(new SimpleButton({\n            label: NLS_PREVIOUS_MATCH_BTN_LABEL + this._keybindingLabelFor(findModel_1.FIND_IDS.PreviousMatchFindAction),\n            className: 'previous',\n            onTrigger: function () {\n                _this._codeEditor.getAction(findModel_1.FIND_IDS.PreviousMatchFindAction).run().then(undefined, errors_1.onUnexpectedError);\n            }\n        }));\n        // Next button\n        this._nextBtn = this._register(new SimpleButton({\n            label: NLS_NEXT_MATCH_BTN_LABEL + this._keybindingLabelFor(findModel_1.FIND_IDS.NextMatchFindAction),\n            className: 'next',\n            onTrigger: function () {\n                _this._codeEditor.getAction(findModel_1.FIND_IDS.NextMatchFindAction).run().then(undefined, errors_1.onUnexpectedError);\n            }\n        }));\n        var findPart = document.createElement('div');\n        findPart.className = 'find-part';\n        findPart.appendChild(this._findInput.domNode);\n        findPart.appendChild(this._matchesCount);\n        findPart.appendChild(this._prevBtn.domNode);\n        findPart.appendChild(this._nextBtn.domNode);\n        // Toggle selection button\n        this._toggleSelectionFind = this._register(new SimpleCheckbox({\n            parent: findPart,\n            title: NLS_TOGGLE_SELECTION_FIND_TITLE + this._keybindingLabelFor(findModel_1.FIND_IDS.ToggleSearchScopeCommand),\n            onChange: function () {\n                if (_this._toggleSelectionFind.checked) {\n                    if (_this._codeEditor.hasModel()) {\n                        var selection = _this._codeEditor.getSelection();\n                        if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n                            selection = selection.setEndPosition(selection.endLineNumber - 1, _this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n                        }\n                        if (!selection.isEmpty()) {\n                            _this._state.change({ searchScope: selection }, true);\n                        }\n                    }\n                }\n                else {\n                    _this._state.change({ searchScope: null }, true);\n                }\n            }\n        }));\n        // Close button\n        this._closeBtn = this._register(new SimpleButton({\n            label: NLS_CLOSE_BTN_LABEL + this._keybindingLabelFor(findModel_1.FIND_IDS.CloseFindWidgetCommand),\n            className: 'close-fw',\n            onTrigger: function () {\n                _this._state.change({ isRevealed: false, searchScope: null }, false);\n            },\n            onKeyDown: function (e) {\n                if (e.equals(keyCodes_1.KeyCode.Tab)) {\n                    if (_this._isReplaceVisible) {\n                        if (_this._replaceBtn.isEnabled()) {\n                            _this._replaceBtn.focus();\n                        }\n                        else {\n                            _this._codeEditor.focus();\n                        }\n                        e.preventDefault();\n                    }\n                }\n            }\n        }));\n        findPart.appendChild(this._closeBtn.domNode);\n        return findPart;\n    };\n    FindWidget.prototype._buildReplacePart = function () {\n        var _this = this;\n        // Replace input\n        var replaceInput = document.createElement('div');\n        replaceInput.className = 'replace-input';\n        replaceInput.style.width = REPLACE_INPUT_AREA_WIDTH + 'px';\n        this._replaceInputBox = this._register(new contextScopedHistoryWidget_1.ContextScopedHistoryInputBox(replaceInput, undefined, {\n            ariaLabel: NLS_REPLACE_INPUT_LABEL,\n            placeholder: NLS_REPLACE_INPUT_PLACEHOLDER,\n            history: []\n        }, this._contextKeyService));\n        this._register(dom.addStandardDisposableListener(this._replaceInputBox.inputElement, 'keydown', function (e) { return _this._onReplaceInputKeyDown(e); }));\n        this._register(this._replaceInputBox.onDidChange(function () {\n            _this._state.change({ replaceString: _this._replaceInputBox.value }, false);\n        }));\n        // Replace one button\n        this._replaceBtn = this._register(new SimpleButton({\n            label: NLS_REPLACE_BTN_LABEL + this._keybindingLabelFor(findModel_1.FIND_IDS.ReplaceOneAction),\n            className: 'replace',\n            onTrigger: function () {\n                _this._controller.replace();\n            },\n            onKeyDown: function (e) {\n                if (e.equals(keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.Tab)) {\n                    _this._closeBtn.focus();\n                    e.preventDefault();\n                }\n            }\n        }));\n        // Replace all button\n        this._replaceAllBtn = this._register(new SimpleButton({\n            label: NLS_REPLACE_ALL_BTN_LABEL + this._keybindingLabelFor(findModel_1.FIND_IDS.ReplaceAllAction),\n            className: 'replace-all',\n            onTrigger: function () {\n                _this._controller.replaceAll();\n            }\n        }));\n        var replacePart = document.createElement('div');\n        replacePart.className = 'replace-part';\n        replacePart.appendChild(replaceInput);\n        replacePart.appendChild(this._replaceBtn.domNode);\n        replacePart.appendChild(this._replaceAllBtn.domNode);\n        return replacePart;\n    };\n    FindWidget.prototype._buildDomNode = function () {\n        var _this = this;\n        // Find part\n        var findPart = this._buildFindPart();\n        // Replace part\n        var replacePart = this._buildReplacePart();\n        // Toggle replace button\n        this._toggleReplaceBtn = this._register(new SimpleButton({\n            label: NLS_TOGGLE_REPLACE_MODE_BTN_LABEL,\n            className: 'toggle left',\n            onTrigger: function () {\n                _this._state.change({ isReplaceRevealed: !_this._isReplaceVisible }, false);\n                if (_this._isReplaceVisible) {\n                    _this._replaceInputBox.width = _this._findInput.inputBox.width;\n                }\n                _this._showViewZone();\n            }\n        }));\n        this._toggleReplaceBtn.toggleClass('expand', this._isReplaceVisible);\n        this._toggleReplaceBtn.toggleClass('collapse', !this._isReplaceVisible);\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\n        // Widget\n        this._domNode = document.createElement('div');\n        this._domNode.className = 'editor-widget find-widget';\n        this._domNode.setAttribute('aria-hidden', 'true');\n        // We need to set this explicitly, otherwise on IE11, the width inheritence of flex doesn't work.\n        this._domNode.style.width = FIND_WIDGET_INITIAL_WIDTH + \"px\";\n        this._domNode.appendChild(this._toggleReplaceBtn.domNode);\n        this._domNode.appendChild(findPart);\n        this._domNode.appendChild(replacePart);\n        this._buildSash();\n    };\n    FindWidget.prototype._buildSash = function () {\n        var _this = this;\n        this._resizeSash = new sash_1.Sash(this._domNode, this, { orientation: sash_1.Orientation.VERTICAL });\n        this._resized = false;\n        var originalWidth = FIND_WIDGET_INITIAL_WIDTH;\n        this._register(this._resizeSash.onDidStart(function () {\n            originalWidth = dom.getTotalWidth(_this._domNode);\n        }));\n        this._register(this._resizeSash.onDidChange(function (evt) {\n            _this._resized = true;\n            var width = originalWidth + evt.startX - evt.currentX;\n            if (width < FIND_WIDGET_INITIAL_WIDTH) {\n                // narrow down the find widget should be handled by CSS.\n                return;\n            }\n            var inputBoxWidth = width - FIND_ALL_CONTROLS_WIDTH;\n            var maxWidth = parseFloat(dom.getComputedStyle(_this._domNode).maxWidth) || 0;\n            if (width > maxWidth) {\n                return;\n            }\n            _this._domNode.style.width = width + \"px\";\n            if (_this._isReplaceVisible) {\n                _this._replaceInputBox.width = inputBoxWidth;\n            }\n        }));\n    };\n    FindWidget.prototype.updateAccessibilitySupport = function () {\n        var value = this._codeEditor.getConfiguration().accessibilitySupport;\n        this._findInput.setFocusInputOnOptionClick(value !== accessibility_1.AccessibilitySupport.Enabled);\n    };\n    FindWidget.ID = 'editor.contrib.findWidget';\n    return FindWidget;\n}(widget_1.Widget));\nexports.FindWidget = FindWidget;\nvar SimpleCheckbox = /** @class */ (function (_super) {\n    tslib_1.__extends(SimpleCheckbox, _super);\n    function SimpleCheckbox(opts) {\n        var _this = _super.call(this) || this;\n        _this._opts = opts;\n        _this._domNode = document.createElement('div');\n        _this._domNode.className = 'monaco-checkbox';\n        _this._domNode.title = _this._opts.title;\n        _this._domNode.tabIndex = 0;\n        _this._checkbox = document.createElement('input');\n        _this._checkbox.type = 'checkbox';\n        _this._checkbox.className = 'checkbox';\n        _this._checkbox.id = 'checkbox-' + SimpleCheckbox._COUNTER++;\n        _this._checkbox.tabIndex = -1;\n        _this._label = document.createElement('label');\n        _this._label.className = 'label';\n        // Connect the label and the checkbox. Checkbox will get checked when the label receives a click.\n        _this._label.htmlFor = _this._checkbox.id;\n        _this._label.tabIndex = -1;\n        _this._domNode.appendChild(_this._checkbox);\n        _this._domNode.appendChild(_this._label);\n        _this._opts.parent.appendChild(_this._domNode);\n        _this.onchange(_this._checkbox, function () {\n            _this._opts.onChange();\n        });\n        return _this;\n    }\n    Object.defineProperty(SimpleCheckbox.prototype, \"domNode\", {\n        get: function () {\n            return this._domNode;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SimpleCheckbox.prototype, \"checked\", {\n        get: function () {\n            return this._checkbox.checked;\n        },\n        set: function (newValue) {\n            this._checkbox.checked = newValue;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SimpleCheckbox.prototype.focus = function () {\n        this._checkbox.focus();\n    };\n    SimpleCheckbox.prototype.enable = function () {\n        this._checkbox.removeAttribute('disabled');\n    };\n    SimpleCheckbox.prototype.disable = function () {\n        this._checkbox.disabled = true;\n    };\n    SimpleCheckbox.prototype.setEnabled = function (enabled) {\n        if (enabled) {\n            this.enable();\n            this.domNode.tabIndex = 0;\n        }\n        else {\n            this.disable();\n            this.domNode.tabIndex = -1;\n        }\n    };\n    SimpleCheckbox._COUNTER = 0;\n    return SimpleCheckbox;\n}(widget_1.Widget));\nvar SimpleButton = /** @class */ (function (_super) {\n    tslib_1.__extends(SimpleButton, _super);\n    function SimpleButton(opts) {\n        var _this = _super.call(this) || this;\n        _this._opts = opts;\n        _this._domNode = document.createElement('div');\n        _this._domNode.title = _this._opts.label;\n        _this._domNode.tabIndex = 0;\n        _this._domNode.className = 'button ' + _this._opts.className;\n        _this._domNode.setAttribute('role', 'button');\n        _this._domNode.setAttribute('aria-label', _this._opts.label);\n        _this.onclick(_this._domNode, function (e) {\n            _this._opts.onTrigger();\n            e.preventDefault();\n        });\n        _this.onkeydown(_this._domNode, function (e) {\n            if (e.equals(keyCodes_1.KeyCode.Space) || e.equals(keyCodes_1.KeyCode.Enter)) {\n                _this._opts.onTrigger();\n                e.preventDefault();\n                return;\n            }\n            if (_this._opts.onKeyDown) {\n                _this._opts.onKeyDown(e);\n            }\n        });\n        return _this;\n    }\n    Object.defineProperty(SimpleButton.prototype, \"domNode\", {\n        get: function () {\n            return this._domNode;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SimpleButton.prototype.isEnabled = function () {\n        return (this._domNode.tabIndex >= 0);\n    };\n    SimpleButton.prototype.focus = function () {\n        this._domNode.focus();\n    };\n    SimpleButton.prototype.setEnabled = function (enabled) {\n        dom.toggleClass(this._domNode, 'disabled', !enabled);\n        this._domNode.setAttribute('aria-disabled', String(!enabled));\n        this._domNode.tabIndex = enabled ? 0 : -1;\n    };\n    SimpleButton.prototype.setExpanded = function (expanded) {\n        this._domNode.setAttribute('aria-expanded', String(!!expanded));\n    };\n    SimpleButton.prototype.toggleClass = function (className, shouldHaveIt) {\n        dom.toggleClass(this._domNode, className, shouldHaveIt);\n    };\n    return SimpleButton;\n}(widget_1.Widget));\nexports.SimpleButton = SimpleButton;\n// theming\nthemeService_1.registerThemingParticipant(function (theme, collector) {\n    var addBackgroundColorRule = function (selector, color) {\n        if (color) {\n            collector.addRule(\".monaco-editor \" + selector + \" { background-color: \" + color + \"; }\");\n        }\n    };\n    addBackgroundColorRule('.findMatch', theme.getColor(colorRegistry_1.editorFindMatchHighlight));\n    addBackgroundColorRule('.currentFindMatch', theme.getColor(colorRegistry_1.editorFindMatch));\n    addBackgroundColorRule('.findScope', theme.getColor(colorRegistry_1.editorFindRangeHighlight));\n    var widgetBackground = theme.getColor(colorRegistry_1.editorWidgetBackground);\n    addBackgroundColorRule('.find-widget', widgetBackground);\n    var widgetShadowColor = theme.getColor(colorRegistry_1.widgetShadow);\n    if (widgetShadowColor) {\n        collector.addRule(\".monaco-editor .find-widget { box-shadow: 0 2px 8px \" + widgetShadowColor + \"; }\");\n    }\n    var findMatchHighlightBorder = theme.getColor(colorRegistry_1.editorFindMatchHighlightBorder);\n    if (findMatchHighlightBorder) {\n        collector.addRule(\".monaco-editor .findMatch { border: 1px \" + (theme.type === 'hc' ? 'dotted' : 'solid') + \" \" + findMatchHighlightBorder + \"; box-sizing: border-box; }\");\n    }\n    var findMatchBorder = theme.getColor(colorRegistry_1.editorFindMatchBorder);\n    if (findMatchBorder) {\n        collector.addRule(\".monaco-editor .currentFindMatch { border: 2px solid \" + findMatchBorder + \"; padding: 1px; box-sizing: border-box; }\");\n    }\n    var findRangeHighlightBorder = theme.getColor(colorRegistry_1.editorFindRangeHighlightBorder);\n    if (findRangeHighlightBorder) {\n        collector.addRule(\".monaco-editor .findScope { border: 1px \" + (theme.type === 'hc' ? 'dashed' : 'solid') + \" \" + findRangeHighlightBorder + \"; }\");\n    }\n    var hcBorder = theme.getColor(colorRegistry_1.contrastBorder);\n    if (hcBorder) {\n        collector.addRule(\".monaco-editor .find-widget { border: 2px solid \" + hcBorder + \"; }\");\n    }\n    var error = theme.getColor(colorRegistry_1.errorForeground);\n    if (error) {\n        collector.addRule(\".monaco-editor .find-widget.no-results .matchesCount { color: \" + error + \"; }\");\n    }\n    var resizeBorderBackground = theme.getColor(colorRegistry_1.editorWidgetResizeBorder);\n    if (resizeBorderBackground) {\n        collector.addRule(\".monaco-editor .find-widget .monaco-sash { background-color: \" + resizeBorderBackground + \"; width: 3px !important; margin-left: -4px;}\");\n    }\n    else {\n        var border = theme.getColor(colorRegistry_1.editorWidgetBorder);\n        if (border) {\n            collector.addRule(\".monaco-editor .find-widget .monaco-sash { background-color: \" + border + \"; width: 3px !important; margin-left: -4px;}\");\n        }\n    }\n    var inputActiveBorder = theme.getColor(colorRegistry_1.inputActiveOptionBorder);\n    if (inputActiveBorder) {\n        collector.addRule(\".monaco-editor .find-widget .monaco-checkbox .checkbox:checked + .label { border: 1px solid \" + inputActiveBorder.toString() + \"; }\");\n    }\n});\n",{"version":3,"file":"/home/coding/workspace/lib/vscode/src/vs/editor/contrib/find/findWidget.ts","sourceRoot":"","sources":["/home/coding/workspace/lib/vscode/src/vs/editor/contrib/find/findWidget.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./findWidget';\nimport * as nls from 'vs/nls';\nimport * as dom from 'vs/base/browser/dom';\nimport { IKeyboardEvent } from 'vs/base/browser/keyboardEvent';\nimport { IMouseEvent } from 'vs/base/browser/mouseEvent';\nimport { IContextViewProvider } from 'vs/base/browser/ui/contextview/contextview';\nimport { FindInput, IFindInputStyles } from 'vs/base/browser/ui/findinput/findInput';\nimport { HistoryInputBox, IMessage as InputBoxMessage } from 'vs/base/browser/ui/inputbox/inputBox';\nimport { IHorizontalSashLayoutProvider, ISashEvent, Orientation, Sash } from 'vs/base/browser/ui/sash/sash';\nimport { Widget } from 'vs/base/browser/ui/widget';\nimport { Delayer } from 'vs/base/common/async';\nimport { Color } from 'vs/base/common/color';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { KeyCode, KeyMod } from 'vs/base/common/keyCodes';\nimport { toDisposable } from 'vs/base/common/lifecycle';\nimport * as platform from 'vs/base/common/platform';\nimport * as strings from 'vs/base/common/strings';\nimport { ICodeEditor, IOverlayWidget, IOverlayWidgetPosition, IViewZone, OverlayWidgetPositionPreference } from 'vs/editor/browser/editorBrowser';\nimport { IConfigurationChangedEvent } from 'vs/editor/common/config/editorOptions';\nimport { Range } from 'vs/editor/common/core/range';\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_REPLACE_INPUT_FOCUSED, FIND_IDS, MATCHES_LIMIT } from 'vs/editor/contrib/find/findModel';\nimport { FindReplaceState, FindReplaceStateChangedEvent } from 'vs/editor/contrib/find/findState';\nimport { IContextKey, IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { contrastBorder, editorFindMatch, editorFindMatchBorder, editorFindMatchHighlight, editorFindMatchHighlightBorder, editorFindRangeHighlight, editorFindRangeHighlightBorder, editorWidgetBackground, editorWidgetBorder, editorWidgetResizeBorder, errorForeground, inputActiveOptionBorder, inputBackground, inputBorder, inputForeground, inputValidationErrorBackground, inputValidationErrorBorder, inputValidationErrorForeground, inputValidationInfoBackground, inputValidationInfoBorder, inputValidationInfoForeground, inputValidationWarningBackground, inputValidationWarningBorder, inputValidationWarningForeground, widgetShadow } from 'vs/platform/theme/common/colorRegistry';\nimport { ITheme, IThemeService, registerThemingParticipant } from 'vs/platform/theme/common/themeService';\nimport { ContextScopedFindInput, ContextScopedHistoryInputBox } from 'vs/platform/browser/contextScopedHistoryWidget';\nimport { AccessibilitySupport } from 'vs/platform/accessibility/common/accessibility';\n\nexport interface IFindController {\n\treplace(): void;\n\treplaceAll(): void;\n\tgetGlobalBufferTerm(): string;\n}\n\nconst NLS_FIND_INPUT_LABEL = nls.localize('label.find', \"Find\");\nconst NLS_FIND_INPUT_PLACEHOLDER = nls.localize('placeholder.find', \"Find\");\nconst NLS_PREVIOUS_MATCH_BTN_LABEL = nls.localize('label.previousMatchButton', \"Previous match\");\nconst NLS_NEXT_MATCH_BTN_LABEL = nls.localize('label.nextMatchButton', \"Next match\");\nconst NLS_TOGGLE_SELECTION_FIND_TITLE = nls.localize('label.toggleSelectionFind', \"Find in selection\");\nconst NLS_CLOSE_BTN_LABEL = nls.localize('label.closeButton', \"Close\");\nconst NLS_REPLACE_INPUT_LABEL = nls.localize('label.replace', \"Replace\");\nconst NLS_REPLACE_INPUT_PLACEHOLDER = nls.localize('placeholder.replace', \"Replace\");\nconst NLS_REPLACE_BTN_LABEL = nls.localize('label.replaceButton', \"Replace\");\nconst NLS_REPLACE_ALL_BTN_LABEL = nls.localize('label.replaceAllButton', \"Replace All\");\nconst NLS_TOGGLE_REPLACE_MODE_BTN_LABEL = nls.localize('label.toggleReplaceButton', \"Toggle Replace mode\");\nconst NLS_MATCHES_COUNT_LIMIT_TITLE = nls.localize('title.matchesCountLimit', \"Only the first {0} results are highlighted, but all find operations work on the entire text.\", MATCHES_LIMIT);\nconst NLS_MATCHES_LOCATION = nls.localize('label.matchesLocation', \"{0} of {1}\");\nconst NLS_NO_RESULTS = nls.localize('label.noResults', \"No Results\");\n\nconst FIND_WIDGET_INITIAL_WIDTH = 411;\nconst PART_WIDTH = 275;\nconst FIND_INPUT_AREA_WIDTH = PART_WIDTH - 54;\nconst REPLACE_INPUT_AREA_WIDTH = FIND_INPUT_AREA_WIDTH;\n\nlet MAX_MATCHES_COUNT_WIDTH = 69;\nlet FIND_ALL_CONTROLS_WIDTH = 17/** Find Input margin-left */ + (MAX_MATCHES_COUNT_WIDTH + 3 + 1) /** Match Results */ + 23 /** Button */ * 4 + 2/** sash */;\n\nconst FIND_INPUT_AREA_HEIGHT = 34; // The height of Find Widget when Replace Input is not visible.\nconst FIND_REPLACE_AREA_HEIGHT = 64; // The height of Find Widget when Replace Input is  visible.\n\n\nexport class FindWidgetViewZone implements IViewZone {\n\tpublic readonly afterLineNumber: number;\n\tpublic heightInPx: number;\n\tpublic readonly suppressMouseDown: boolean;\n\tpublic readonly domNode: HTMLElement;\n\n\tconstructor(afterLineNumber: number) {\n\t\tthis.afterLineNumber = afterLineNumber;\n\n\t\tthis.heightInPx = FIND_INPUT_AREA_HEIGHT;\n\t\tthis.suppressMouseDown = false;\n\t\tthis.domNode = document.createElement('div');\n\t\tthis.domNode.className = 'dock-find-viewzone';\n\t}\n}\n\nexport class FindWidget extends Widget implements IOverlayWidget, IHorizontalSashLayoutProvider {\n\tprivate static readonly ID = 'editor.contrib.findWidget';\n\tprivate readonly _codeEditor: ICodeEditor;\n\tprivate readonly _state: FindReplaceState;\n\tprivate readonly _controller: IFindController;\n\tprivate readonly _contextViewProvider: IContextViewProvider;\n\tprivate readonly _keybindingService: IKeybindingService;\n\tprivate readonly _contextKeyService: IContextKeyService;\n\n\tprivate _domNode: HTMLElement;\n\tprivate _findInput: FindInput;\n\tprivate _replaceInputBox: HistoryInputBox;\n\n\tprivate _toggleReplaceBtn: SimpleButton;\n\tprivate _matchesCount: HTMLElement;\n\tprivate _prevBtn: SimpleButton;\n\tprivate _nextBtn: SimpleButton;\n\tprivate _toggleSelectionFind: SimpleCheckbox;\n\tprivate _closeBtn: SimpleButton;\n\tprivate _replaceBtn: SimpleButton;\n\tprivate _replaceAllBtn: SimpleButton;\n\n\tprivate _isVisible: boolean;\n\tprivate _isReplaceVisible: boolean;\n\tprivate _ignoreChangeEvent: boolean;\n\n\tprivate readonly _findFocusTracker: dom.IFocusTracker;\n\tprivate readonly _findInputFocused: IContextKey<boolean>;\n\tprivate readonly _replaceFocusTracker: dom.IFocusTracker;\n\tprivate readonly _replaceInputFocused: IContextKey<boolean>;\n\tprivate _viewZone?: FindWidgetViewZone;\n\tprivate _viewZoneId?: number;\n\n\tprivate _resizeSash: Sash;\n\tprivate _resized: boolean;\n\tprivate readonly _updateHistoryDelayer: Delayer<void>;\n\n\tconstructor(\n\t\tcodeEditor: ICodeEditor,\n\t\tcontroller: IFindController,\n\t\tstate: FindReplaceState,\n\t\tcontextViewProvider: IContextViewProvider,\n\t\tkeybindingService: IKeybindingService,\n\t\tcontextKeyService: IContextKeyService,\n\t\tthemeService: IThemeService\n\t) {\n\t\tsuper();\n\t\tthis._codeEditor = codeEditor;\n\t\tthis._controller = controller;\n\t\tthis._state = state;\n\t\tthis._contextViewProvider = contextViewProvider;\n\t\tthis._keybindingService = keybindingService;\n\t\tthis._contextKeyService = contextKeyService;\n\n\t\tthis._isVisible = false;\n\t\tthis._isReplaceVisible = false;\n\t\tthis._ignoreChangeEvent = false;\n\n\t\tthis._updateHistoryDelayer = new Delayer<void>(500);\n\t\tthis._register(toDisposable(() => this._updateHistoryDelayer.cancel()));\n\t\tthis._register(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\n\t\tthis._buildDomNode();\n\t\tthis._updateButtons();\n\t\tthis._tryUpdateWidgetWidth();\n\n\t\tthis._register(this._codeEditor.onDidChangeConfiguration((e: IConfigurationChangedEvent) => {\n\t\t\tif (e.readOnly) {\n\t\t\t\tif (this._codeEditor.getConfiguration().readOnly) {\n\t\t\t\t\t// Hide replace part if editor becomes read only\n\t\t\t\t\tthis._state.change({ isReplaceRevealed: false }, false);\n\t\t\t\t}\n\t\t\t\tthis._updateButtons();\n\t\t\t}\n\t\t\tif (e.layoutInfo) {\n\t\t\t\tthis._tryUpdateWidgetWidth();\n\t\t\t}\n\n\t\t\tif (e.accessibilitySupport) {\n\t\t\t\tthis.updateAccessibilitySupport();\n\t\t\t}\n\n\t\t\tif (e.contribInfo) {\n\t\t\t\tconst addExtraSpaceOnTop = this._codeEditor.getConfiguration().contribInfo.find.addExtraSpaceOnTop;\n\t\t\t\tif (addExtraSpaceOnTop && !this._viewZone) {\n\t\t\t\t\tthis._viewZone = new FindWidgetViewZone(0);\n\t\t\t\t\tthis._showViewZone();\n\t\t\t\t}\n\t\t\t\tif (!addExtraSpaceOnTop && this._viewZone) {\n\t\t\t\t\tthis._removeViewZone();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis.updateAccessibilitySupport();\n\t\tthis._register(this._codeEditor.onDidChangeCursorSelection(() => {\n\t\t\tif (this._isVisible) {\n\t\t\t\tthis._updateToggleSelectionFindButton();\n\t\t\t}\n\t\t}));\n\t\tthis._register(this._codeEditor.onDidFocusEditorWidget(() => {\n\t\t\tif (this._isVisible) {\n\t\t\t\tlet globalBufferTerm = this._controller.getGlobalBufferTerm();\n\t\t\t\tif (globalBufferTerm && globalBufferTerm !== this._state.searchString) {\n\t\t\t\t\tthis._state.change({ searchString: globalBufferTerm }, true);\n\t\t\t\t\tthis._findInput.select();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis._findInputFocused = CONTEXT_FIND_INPUT_FOCUSED.bindTo(contextKeyService);\n\t\tthis._findFocusTracker = this._register(dom.trackFocus(this._findInput.inputBox.inputElement));\n\t\tthis._register(this._findFocusTracker.onDidFocus(() => {\n\t\t\tthis._findInputFocused.set(true);\n\t\t\tthis._updateSearchScope();\n\t\t}));\n\t\tthis._register(this._findFocusTracker.onDidBlur(() => {\n\t\t\tthis._findInputFocused.set(false);\n\t\t}));\n\n\t\tthis._replaceInputFocused = CONTEXT_REPLACE_INPUT_FOCUSED.bindTo(contextKeyService);\n\t\tthis._replaceFocusTracker = this._register(dom.trackFocus(this._replaceInputBox.inputElement));\n\t\tthis._register(this._replaceFocusTracker.onDidFocus(() => {\n\t\t\tthis._replaceInputFocused.set(true);\n\t\t\tthis._updateSearchScope();\n\t\t}));\n\t\tthis._register(this._replaceFocusTracker.onDidBlur(() => {\n\t\t\tthis._replaceInputFocused.set(false);\n\t\t}));\n\n\t\tthis._codeEditor.addOverlayWidget(this);\n\t\tif (this._codeEditor.getConfiguration().contribInfo.find.addExtraSpaceOnTop) {\n\t\t\tthis._viewZone = new FindWidgetViewZone(0); // Put it before the first line then users can scroll beyond the first line.\n\t\t}\n\n\t\tthis._applyTheme(themeService.getTheme());\n\t\tthis._register(themeService.onThemeChange(this._applyTheme.bind(this)));\n\n\t\tthis._register(this._codeEditor.onDidChangeModel(() => {\n\t\t\tif (!this._isVisible) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this._viewZoneId === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._codeEditor.changeViewZones((accessor) => {\n\t\t\t\tif (this._viewZoneId) {\n\t\t\t\t\taccessor.removeZone(this._viewZoneId);\n\t\t\t\t}\n\t\t\t\tthis._viewZoneId = undefined;\n\t\t\t});\n\t\t}));\n\n\n\t\tthis._register(this._codeEditor.onDidScrollChange((e) => {\n\t\t\tif (e.scrollTopChanged) {\n\t\t\t\tthis._layoutViewZone();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// for other scroll changes, layout the viewzone in next tick to avoid ruining current rendering.\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis._layoutViewZone();\n\t\t\t}, 0);\n\t\t}));\n\t}\n\n\t// ----- IOverlayWidget API\n\n\tpublic getId(): string {\n\t\treturn FindWidget.ID;\n\t}\n\n\tpublic getDomNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n\n\tpublic getPosition(): IOverlayWidgetPosition | null {\n\t\tif (this._isVisible) {\n\t\t\treturn {\n\t\t\t\tpreference: OverlayWidgetPositionPreference.TOP_RIGHT_CORNER\n\t\t\t};\n\t\t}\n\t\treturn null;\n\t}\n\n\t// ----- React to state changes\n\n\tprivate _onStateChanged(e: FindReplaceStateChangedEvent): void {\n\t\tif (e.searchString) {\n\t\t\ttry {\n\t\t\t\tthis._ignoreChangeEvent = true;\n\t\t\t\tthis._findInput.setValue(this._state.searchString);\n\t\t\t} finally {\n\t\t\t\tthis._ignoreChangeEvent = false;\n\t\t\t}\n\t\t\tthis._updateButtons();\n\t\t}\n\t\tif (e.replaceString) {\n\t\t\tthis._replaceInputBox.value = this._state.replaceString;\n\t\t}\n\t\tif (e.isRevealed) {\n\t\t\tif (this._state.isRevealed) {\n\t\t\t\tthis._reveal();\n\t\t\t} else {\n\t\t\t\tthis._hide(true);\n\t\t\t}\n\t\t}\n\t\tif (e.isReplaceRevealed) {\n\t\t\tif (this._state.isReplaceRevealed) {\n\t\t\t\tif (!this._codeEditor.getConfiguration().readOnly && !this._isReplaceVisible) {\n\t\t\t\t\tthis._isReplaceVisible = true;\n\t\t\t\t\tthis._replaceInputBox.width = this._findInput.inputBox.width;\n\t\t\t\t\tthis._updateButtons();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this._isReplaceVisible) {\n\t\t\t\t\tthis._isReplaceVisible = false;\n\t\t\t\t\tthis._updateButtons();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (e.isRegex) {\n\t\t\tthis._findInput.setRegex(this._state.isRegex);\n\t\t}\n\t\tif (e.wholeWord) {\n\t\t\tthis._findInput.setWholeWords(this._state.wholeWord);\n\t\t}\n\t\tif (e.matchCase) {\n\t\t\tthis._findInput.setCaseSensitive(this._state.matchCase);\n\t\t}\n\t\tif (e.searchScope) {\n\t\t\tif (this._state.searchScope) {\n\t\t\t\tthis._toggleSelectionFind.checked = true;\n\t\t\t} else {\n\t\t\t\tthis._toggleSelectionFind.checked = false;\n\t\t\t}\n\t\t\tthis._updateToggleSelectionFindButton();\n\t\t}\n\t\tif (e.searchString || e.matchesCount || e.matchesPosition) {\n\t\t\tlet showRedOutline = (this._state.searchString.length > 0 && this._state.matchesCount === 0);\n\t\t\tdom.toggleClass(this._domNode, 'no-results', showRedOutline);\n\n\t\t\tthis._updateMatchesCount();\n\t\t\tthis._updateButtons();\n\t\t}\n\t\tif (e.searchString || e.currentMatch) {\n\t\t\tthis._layoutViewZone();\n\t\t}\n\t\tif (e.updateHistory) {\n\t\t\tthis._delayedUpdateHistory();\n\t\t}\n\t}\n\n\tprivate _delayedUpdateHistory() {\n\t\tthis._updateHistoryDelayer.trigger(this._updateHistory.bind(this));\n\t}\n\n\tprivate _updateHistory() {\n\t\tif (this._state.searchString) {\n\t\t\tthis._findInput.inputBox.addToHistory();\n\t\t}\n\t\tif (this._state.replaceString) {\n\t\t\tthis._replaceInputBox.addToHistory();\n\t\t}\n\t}\n\n\tprivate _updateMatchesCount(): void {\n\t\tthis._matchesCount.style.minWidth = MAX_MATCHES_COUNT_WIDTH + 'px';\n\t\tif (this._state.matchesCount >= MATCHES_LIMIT) {\n\t\t\tthis._matchesCount.title = NLS_MATCHES_COUNT_LIMIT_TITLE;\n\t\t} else {\n\t\t\tthis._matchesCount.title = '';\n\t\t}\n\n\t\t// remove previous content\n\t\tif (this._matchesCount.firstChild) {\n\t\t\tthis._matchesCount.removeChild(this._matchesCount.firstChild);\n\t\t}\n\n\t\tlet label: string;\n\t\tif (this._state.matchesCount > 0) {\n\t\t\tlet matchesCount: string = String(this._state.matchesCount);\n\t\t\tif (this._state.matchesCount >= MATCHES_LIMIT) {\n\t\t\t\tmatchesCount += '+';\n\t\t\t}\n\t\t\tlet matchesPosition: string = String(this._state.matchesPosition);\n\t\t\tif (matchesPosition === '0') {\n\t\t\t\tmatchesPosition = '?';\n\t\t\t}\n\t\t\tlabel = strings.format(NLS_MATCHES_LOCATION, matchesPosition, matchesCount);\n\t\t} else {\n\t\t\tlabel = NLS_NO_RESULTS;\n\t\t}\n\t\tthis._matchesCount.appendChild(document.createTextNode(label));\n\n\t\tMAX_MATCHES_COUNT_WIDTH = Math.max(MAX_MATCHES_COUNT_WIDTH, this._matchesCount.clientWidth);\n\t}\n\n\t// ----- actions\n\n\t/**\n\t * If 'selection find' is ON we should not disable the button (its function is to cancel 'selection find').\n\t * If 'selection find' is OFF we enable the button only if there is a selection.\n\t */\n\tprivate _updateToggleSelectionFindButton(): void {\n\t\tlet selection = this._codeEditor.getSelection();\n\t\tlet isSelection = selection ? (selection.startLineNumber !== selection.endLineNumber || selection.startColumn !== selection.endColumn) : false;\n\t\tlet isChecked = this._toggleSelectionFind.checked;\n\n\t\tthis._toggleSelectionFind.setEnabled(this._isVisible && (isChecked || isSelection));\n\t}\n\n\tprivate _updateButtons(): void {\n\t\tthis._findInput.setEnabled(this._isVisible);\n\t\tthis._replaceInputBox.setEnabled(this._isVisible && this._isReplaceVisible);\n\t\tthis._updateToggleSelectionFindButton();\n\t\tthis._closeBtn.setEnabled(this._isVisible);\n\n\t\tlet findInputIsNonEmpty = (this._state.searchString.length > 0);\n\t\tlet matchesCount = this._state.matchesCount ? true : false;\n\t\tthis._prevBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount);\n\t\tthis._nextBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount);\n\t\tthis._replaceBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\n\t\tthis._replaceAllBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\n\n\t\tdom.toggleClass(this._domNode, 'replaceToggled', this._isReplaceVisible);\n\t\tthis._toggleReplaceBtn.toggleClass('collapse', !this._isReplaceVisible);\n\t\tthis._toggleReplaceBtn.toggleClass('expand', this._isReplaceVisible);\n\t\tthis._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\n\n\t\tlet canReplace = !this._codeEditor.getConfiguration().readOnly;\n\t\tthis._toggleReplaceBtn.setEnabled(this._isVisible && canReplace);\n\t}\n\n\tprivate _reveal(): void {\n\t\tif (!this._isVisible) {\n\t\t\tthis._isVisible = true;\n\n\t\t\tconst selection = this._codeEditor.getSelection();\n\t\t\tconst isSelection = selection ? (selection.startLineNumber !== selection.endLineNumber || selection.startColumn !== selection.endColumn) : false;\n\t\t\tif (isSelection && this._codeEditor.getConfiguration().contribInfo.find.autoFindInSelection) {\n\t\t\t\tthis._toggleSelectionFind.checked = true;\n\t\t\t} else {\n\t\t\t\tthis._toggleSelectionFind.checked = false;\n\t\t\t}\n\t\t\tthis._tryUpdateWidgetWidth();\n\t\t\tthis._updateButtons();\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tdom.addClass(this._domNode, 'visible');\n\t\t\t\tthis._domNode.setAttribute('aria-hidden', 'false');\n\t\t\t}, 0);\n\n\t\t\t// validate query again as it's being dismissed when we hide the find widget.\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis._findInput.validate();\n\t\t\t}, 200);\n\n\t\t\tthis._codeEditor.layoutOverlayWidget(this);\n\n\t\t\tlet adjustEditorScrollTop = true;\n\t\t\tif (this._codeEditor.getConfiguration().contribInfo.find.seedSearchStringFromSelection && selection) {\n\t\t\t\tconst domNode = this._codeEditor.getDomNode();\n\t\t\t\tif (domNode) {\n\t\t\t\t\tconst editorCoords = dom.getDomNodePagePosition(domNode);\n\t\t\t\t\tconst startCoords = this._codeEditor.getScrolledVisiblePosition(selection.getStartPosition());\n\t\t\t\t\tconst startLeft = editorCoords.left + (startCoords ? startCoords.left : 0);\n\t\t\t\t\tconst startTop = startCoords ? startCoords.top : 0;\n\n\t\t\t\t\tif (this._viewZone && startTop < this._viewZone.heightInPx) {\n\t\t\t\t\t\tif (selection.endLineNumber > selection.startLineNumber) {\n\t\t\t\t\t\t\tadjustEditorScrollTop = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst leftOfFindWidget = dom.getTopLeftOffset(this._domNode).left;\n\t\t\t\t\t\tif (startLeft > leftOfFindWidget) {\n\t\t\t\t\t\t\tadjustEditorScrollTop = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst endCoords = this._codeEditor.getScrolledVisiblePosition(selection.getEndPosition());\n\t\t\t\t\t\tconst endLeft = editorCoords.left + (endCoords ? endCoords.left : 0);\n\t\t\t\t\t\tif (endLeft > leftOfFindWidget) {\n\t\t\t\t\t\t\tadjustEditorScrollTop = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._showViewZone(adjustEditorScrollTop);\n\t\t}\n\t}\n\n\tprivate _hide(focusTheEditor: boolean): void {\n\t\tif (this._isVisible) {\n\t\t\tthis._isVisible = false;\n\n\t\t\tthis._updateButtons();\n\n\t\t\tdom.removeClass(this._domNode, 'visible');\n\t\t\tthis._domNode.setAttribute('aria-hidden', 'true');\n\t\t\tthis._findInput.clearMessage();\n\t\t\tif (focusTheEditor) {\n\t\t\t\tthis._codeEditor.focus();\n\t\t\t}\n\t\t\tthis._codeEditor.layoutOverlayWidget(this);\n\t\t\tthis._removeViewZone();\n\t\t}\n\t}\n\n\tprivate _layoutViewZone() {\n\t\tconst addExtraSpaceOnTop = this._codeEditor.getConfiguration().contribInfo.find.addExtraSpaceOnTop;\n\n\t\tif (!addExtraSpaceOnTop) {\n\t\t\tthis._removeViewZone();\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._isVisible) {\n\t\t\treturn;\n\t\t}\n\t\tconst viewZone = this._viewZone;\n\t\tif (this._viewZoneId !== undefined || !viewZone) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._codeEditor.changeViewZones((accessor) => {\n\t\t\tif (this._state.isReplaceRevealed) {\n\t\t\t\tviewZone.heightInPx = FIND_REPLACE_AREA_HEIGHT;\n\t\t\t} else {\n\t\t\t\tviewZone.heightInPx = FIND_INPUT_AREA_HEIGHT;\n\t\t\t}\n\n\t\t\tthis._viewZoneId = accessor.addZone(viewZone);\n\t\t\t// scroll top adjust to make sure the editor doesn't scroll when adding viewzone at the beginning.\n\t\t\tthis._codeEditor.setScrollTop(this._codeEditor.getScrollTop() + viewZone.heightInPx);\n\t\t});\n\t}\n\n\tprivate _showViewZone(adjustScroll: boolean = true) {\n\t\tconst viewZone = this._viewZone;\n\t\tif (!this._isVisible || !viewZone) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._codeEditor.changeViewZones((accessor) => {\n\t\t\tlet scrollAdjustment = FIND_INPUT_AREA_HEIGHT;\n\n\t\t\tif (this._viewZoneId !== undefined) {\n\t\t\t\tif (this._state.isReplaceRevealed) {\n\t\t\t\t\tviewZone.heightInPx = FIND_REPLACE_AREA_HEIGHT;\n\t\t\t\t\tscrollAdjustment = FIND_REPLACE_AREA_HEIGHT - FIND_INPUT_AREA_HEIGHT;\n\t\t\t\t} else {\n\t\t\t\t\tviewZone.heightInPx = FIND_INPUT_AREA_HEIGHT;\n\t\t\t\t\tscrollAdjustment = FIND_INPUT_AREA_HEIGHT - FIND_REPLACE_AREA_HEIGHT;\n\t\t\t\t}\n\t\t\t\taccessor.removeZone(this._viewZoneId);\n\t\t\t} else {\n\t\t\t\tviewZone.heightInPx = FIND_INPUT_AREA_HEIGHT;\n\t\t\t}\n\t\t\tthis._viewZoneId = accessor.addZone(viewZone);\n\n\t\t\tif (adjustScroll) {\n\t\t\t\tthis._codeEditor.setScrollTop(this._codeEditor.getScrollTop() + scrollAdjustment);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _removeViewZone() {\n\t\tthis._codeEditor.changeViewZones((accessor) => {\n\t\t\tif (this._viewZoneId !== undefined) {\n\t\t\t\taccessor.removeZone(this._viewZoneId);\n\t\t\t\tthis._viewZoneId = undefined;\n\t\t\t\tif (this._viewZone) {\n\t\t\t\t\tthis._codeEditor.setScrollTop(this._codeEditor.getScrollTop() - this._viewZone.heightInPx);\n\t\t\t\t\tthis._viewZone = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _applyTheme(theme: ITheme) {\n\t\tlet inputStyles: IFindInputStyles = {\n\t\t\tinputActiveOptionBorder: theme.getColor(inputActiveOptionBorder),\n\t\t\tinputBackground: theme.getColor(inputBackground),\n\t\t\tinputForeground: theme.getColor(inputForeground),\n\t\t\tinputBorder: theme.getColor(inputBorder),\n\t\t\tinputValidationInfoBackground: theme.getColor(inputValidationInfoBackground),\n\t\t\tinputValidationInfoForeground: theme.getColor(inputValidationInfoForeground),\n\t\t\tinputValidationInfoBorder: theme.getColor(inputValidationInfoBorder),\n\t\t\tinputValidationWarningBackground: theme.getColor(inputValidationWarningBackground),\n\t\t\tinputValidationWarningForeground: theme.getColor(inputValidationWarningForeground),\n\t\t\tinputValidationWarningBorder: theme.getColor(inputValidationWarningBorder),\n\t\t\tinputValidationErrorBackground: theme.getColor(inputValidationErrorBackground),\n\t\t\tinputValidationErrorForeground: theme.getColor(inputValidationErrorForeground),\n\t\t\tinputValidationErrorBorder: theme.getColor(inputValidationErrorBorder),\n\t\t};\n\t\tthis._findInput.style(inputStyles);\n\t\tthis._replaceInputBox.style(inputStyles);\n\t}\n\n\tprivate _tryUpdateWidgetWidth() {\n\t\tif (!this._isVisible) {\n\t\t\treturn;\n\t\t}\n\t\tlet editorWidth = this._codeEditor.getConfiguration().layoutInfo.width;\n\t\tlet minimapWidth = this._codeEditor.getConfiguration().layoutInfo.minimapWidth;\n\t\tlet collapsedFindWidget = false;\n\t\tlet reducedFindWidget = false;\n\t\tlet narrowFindWidget = false;\n\n\t\tif (this._resized) {\n\t\t\tlet widgetWidth = dom.getTotalWidth(this._domNode);\n\n\t\t\tif (widgetWidth > FIND_WIDGET_INITIAL_WIDTH) {\n\t\t\t\t// as the widget is resized by users, we may need to change the max width of the widget as the editor width changes.\n\t\t\t\tthis._domNode.style.maxWidth = `${editorWidth - 28 - minimapWidth - 15}px`;\n\t\t\t\tthis._replaceInputBox.inputElement.style.width = `${dom.getTotalWidth(this._findInput.inputBox.inputElement)}px`;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth >= editorWidth) {\n\t\t\treducedFindWidget = true;\n\t\t}\n\t\tif (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth) {\n\t\t\tnarrowFindWidget = true;\n\t\t}\n\t\tif (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth + 50) {\n\t\t\tcollapsedFindWidget = true;\n\t\t}\n\t\tdom.toggleClass(this._domNode, 'collapsed-find-widget', collapsedFindWidget);\n\t\tdom.toggleClass(this._domNode, 'narrow-find-widget', narrowFindWidget);\n\t\tdom.toggleClass(this._domNode, 'reduced-find-widget', reducedFindWidget);\n\n\t\tif (!narrowFindWidget && !collapsedFindWidget) {\n\t\t\t// the minimal left offset of findwidget is 15px.\n\t\t\tthis._domNode.style.maxWidth = `${editorWidth - 28 - minimapWidth - 15}px`;\n\t\t}\n\n\t\tif (this._resized) {\n\t\t\tlet findInputWidth = dom.getTotalWidth(this._findInput.inputBox.inputElement);\n\t\t\tif (findInputWidth > 0) {\n\t\t\t\tthis._replaceInputBox.inputElement.style.width = `${findInputWidth}px`;\n\t\t\t}\n\t\t}\n\t}\n\n\t// ----- Public\n\n\tpublic focusFindInput(): void {\n\t\tthis._findInput.select();\n\t\t// Edge browser requires focus() in addition to select()\n\t\tthis._findInput.focus();\n\t}\n\n\tpublic focusReplaceInput(): void {\n\t\tthis._replaceInputBox.select();\n\t\t// Edge browser requires focus() in addition to select()\n\t\tthis._replaceInputBox.focus();\n\t}\n\n\tpublic highlightFindOptions(): void {\n\t\tthis._findInput.highlightFindOptions();\n\t}\n\n\tprivate _updateSearchScope(): void {\n\t\tif (!this._codeEditor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._toggleSelectionFind.checked) {\n\t\t\tlet selection = this._codeEditor.getSelection();\n\t\t\tif (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n\t\t\t\tselection = selection.setEndPosition(selection.endLineNumber - 1, this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n\t\t\t}\n\t\t\tconst currentMatch = this._state.currentMatch;\n\t\t\tif (selection.startLineNumber !== selection.endLineNumber) {\n\t\t\t\tif (!Range.equalsRange(selection, currentMatch)) {\n\t\t\t\t\t// Reseed find scope\n\t\t\t\t\tthis._state.change({ searchScope: selection }, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _onFindInputMouseDown(e: IMouseEvent): void {\n\t\t// on linux, middle key does pasting.\n\t\tif (e.middleButton) {\n\t\t\te.stopPropagation();\n\t\t}\n\t}\n\n\tprivate _onFindInputKeyDown(e: IKeyboardEvent): void {\n\n\t\tif (e.equals(KeyCode.Enter)) {\n\t\t\tthis._codeEditor.getAction(FIND_IDS.NextMatchFindAction).run().then(undefined, onUnexpectedError);\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.equals(KeyMod.Shift | KeyCode.Enter)) {\n\t\t\tthis._codeEditor.getAction(FIND_IDS.PreviousMatchFindAction).run().then(undefined, onUnexpectedError);\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.equals(KeyCode.Tab)) {\n\t\t\tif (this._isReplaceVisible) {\n\t\t\t\tthis._replaceInputBox.focus();\n\t\t\t} else {\n\t\t\t\tthis._findInput.focusOnCaseSensitive();\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.equals(KeyMod.CtrlCmd | KeyCode.DownArrow)) {\n\t\t\tthis._codeEditor.focus();\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\t}\n\n\tprivate _onReplaceInputKeyDown(e: IKeyboardEvent): void {\n\n\t\tif (e.equals(KeyCode.Enter)) {\n\t\t\tthis._controller.replace();\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.equals(KeyMod.CtrlCmd | KeyCode.Enter)) {\n\t\t\tthis._controller.replaceAll();\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.equals(KeyCode.Tab)) {\n\t\t\tthis._findInput.focusOnCaseSensitive();\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.equals(KeyMod.Shift | KeyCode.Tab)) {\n\t\t\tthis._findInput.focus();\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.equals(KeyMod.CtrlCmd | KeyCode.DownArrow)) {\n\t\t\tthis._codeEditor.focus();\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\t}\n\n\t// ----- sash\n\tpublic getHorizontalSashTop(_sash: Sash): number {\n\t\treturn 0;\n\t}\n\tpublic getHorizontalSashLeft?(_sash: Sash): number {\n\t\treturn 0;\n\t}\n\tpublic getHorizontalSashWidth?(_sash: Sash): number {\n\t\treturn 500;\n\t}\n\n\t// ----- initialization\n\n\tprivate _keybindingLabelFor(actionId: string): string {\n\t\tlet kb = this._keybindingService.lookupKeybinding(actionId);\n\t\tif (!kb) {\n\t\t\treturn '';\n\t\t}\n\t\treturn ` (${kb.getLabel()})`;\n\t}\n\n\tprivate _buildFindPart(): HTMLElement {\n\t\t// Find input\n\t\tthis._findInput = this._register(new ContextScopedFindInput(null, this._contextViewProvider, {\n\t\t\twidth: FIND_INPUT_AREA_WIDTH,\n\t\t\tlabel: NLS_FIND_INPUT_LABEL,\n\t\t\tplaceholder: NLS_FIND_INPUT_PLACEHOLDER,\n\t\t\tappendCaseSensitiveLabel: this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),\n\t\t\tappendWholeWordsLabel: this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),\n\t\t\tappendRegexLabel: this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),\n\t\t\tvalidation: (value: string): InputBoxMessage | null => {\n\t\t\t\tif (value.length === 0) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tif (!this._findInput.getRegex()) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\t/* tslint:disable:no-unused-expression */\n\t\t\t\t\tnew RegExp(value);\n\t\t\t\t\t/* tslint:enable:no-unused-expression */\n\t\t\t\t\treturn null;\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn { content: e.message };\n\t\t\t\t}\n\t\t\t}\n\t\t}, this._contextKeyService, true));\n\t\tthis._findInput.setRegex(!!this._state.isRegex);\n\t\tthis._findInput.setCaseSensitive(!!this._state.matchCase);\n\t\tthis._findInput.setWholeWords(!!this._state.wholeWord);\n\t\tthis._register(this._findInput.onKeyDown((e) => this._onFindInputKeyDown(e)));\n\t\tthis._register(this._findInput.inputBox.onDidChange(() => {\n\t\t\tif (this._ignoreChangeEvent) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._state.change({ searchString: this._findInput.getValue() }, true);\n\t\t}));\n\t\tthis._register(this._findInput.onDidOptionChange(() => {\n\t\t\tthis._state.change({\n\t\t\t\tisRegex: this._findInput.getRegex(),\n\t\t\t\twholeWord: this._findInput.getWholeWords(),\n\t\t\t\tmatchCase: this._findInput.getCaseSensitive()\n\t\t\t}, true);\n\t\t}));\n\t\tthis._register(this._findInput.onCaseSensitiveKeyDown((e) => {\n\t\t\tif (e.equals(KeyMod.Shift | KeyCode.Tab)) {\n\t\t\t\tif (this._isReplaceVisible) {\n\t\t\t\t\tthis._replaceInputBox.focus();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tif (platform.isLinux) {\n\t\t\tthis._register(this._findInput.onMouseDown((e) => this._onFindInputMouseDown(e)));\n\t\t}\n\n\t\tthis._matchesCount = document.createElement('div');\n\t\tthis._matchesCount.className = 'matchesCount';\n\t\tthis._updateMatchesCount();\n\n\t\t// Previous button\n\t\tthis._prevBtn = this._register(new SimpleButton({\n\t\t\tlabel: NLS_PREVIOUS_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.PreviousMatchFindAction),\n\t\t\tclassName: 'previous',\n\t\t\tonTrigger: () => {\n\t\t\t\tthis._codeEditor.getAction(FIND_IDS.PreviousMatchFindAction).run().then(undefined, onUnexpectedError);\n\t\t\t}\n\t\t}));\n\n\t\t// Next button\n\t\tthis._nextBtn = this._register(new SimpleButton({\n\t\t\tlabel: NLS_NEXT_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.NextMatchFindAction),\n\t\t\tclassName: 'next',\n\t\t\tonTrigger: () => {\n\t\t\t\tthis._codeEditor.getAction(FIND_IDS.NextMatchFindAction).run().then(undefined, onUnexpectedError);\n\t\t\t}\n\t\t}));\n\n\t\tlet findPart = document.createElement('div');\n\t\tfindPart.className = 'find-part';\n\t\tfindPart.appendChild(this._findInput.domNode);\n\t\tfindPart.appendChild(this._matchesCount);\n\t\tfindPart.appendChild(this._prevBtn.domNode);\n\t\tfindPart.appendChild(this._nextBtn.domNode);\n\n\t\t// Toggle selection button\n\t\tthis._toggleSelectionFind = this._register(new SimpleCheckbox({\n\t\t\tparent: findPart,\n\t\t\ttitle: NLS_TOGGLE_SELECTION_FIND_TITLE + this._keybindingLabelFor(FIND_IDS.ToggleSearchScopeCommand),\n\t\t\tonChange: () => {\n\t\t\t\tif (this._toggleSelectionFind.checked) {\n\t\t\t\t\tif (this._codeEditor.hasModel()) {\n\t\t\t\t\t\tlet selection = this._codeEditor.getSelection();\n\t\t\t\t\t\tif (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n\t\t\t\t\t\t\tselection = selection.setEndPosition(selection.endLineNumber - 1, this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!selection.isEmpty()) {\n\t\t\t\t\t\t\tthis._state.change({ searchScope: selection }, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis._state.change({ searchScope: null }, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\t// Close button\n\t\tthis._closeBtn = this._register(new SimpleButton({\n\t\t\tlabel: NLS_CLOSE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.CloseFindWidgetCommand),\n\t\t\tclassName: 'close-fw',\n\t\t\tonTrigger: () => {\n\t\t\t\tthis._state.change({ isRevealed: false, searchScope: null }, false);\n\t\t\t},\n\t\t\tonKeyDown: (e) => {\n\t\t\t\tif (e.equals(KeyCode.Tab)) {\n\t\t\t\t\tif (this._isReplaceVisible) {\n\t\t\t\t\t\tif (this._replaceBtn.isEnabled()) {\n\t\t\t\t\t\t\tthis._replaceBtn.focus();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._codeEditor.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tfindPart.appendChild(this._closeBtn.domNode);\n\n\t\treturn findPart;\n\t}\n\n\tprivate _buildReplacePart(): HTMLElement {\n\t\t// Replace input\n\t\tlet replaceInput = document.createElement('div');\n\t\treplaceInput.className = 'replace-input';\n\t\treplaceInput.style.width = REPLACE_INPUT_AREA_WIDTH + 'px';\n\t\tthis._replaceInputBox = this._register(new ContextScopedHistoryInputBox(replaceInput, undefined, {\n\t\t\tariaLabel: NLS_REPLACE_INPUT_LABEL,\n\t\t\tplaceholder: NLS_REPLACE_INPUT_PLACEHOLDER,\n\t\t\thistory: []\n\t\t}, this._contextKeyService));\n\n\n\t\tthis._register(dom.addStandardDisposableListener(this._replaceInputBox.inputElement, 'keydown', (e) => this._onReplaceInputKeyDown(e)));\n\t\tthis._register(this._replaceInputBox.onDidChange(() => {\n\t\t\tthis._state.change({ replaceString: this._replaceInputBox.value }, false);\n\t\t}));\n\n\t\t// Replace one button\n\t\tthis._replaceBtn = this._register(new SimpleButton({\n\t\t\tlabel: NLS_REPLACE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceOneAction),\n\t\t\tclassName: 'replace',\n\t\t\tonTrigger: () => {\n\t\t\t\tthis._controller.replace();\n\t\t\t},\n\t\t\tonKeyDown: (e) => {\n\t\t\t\tif (e.equals(KeyMod.Shift | KeyCode.Tab)) {\n\t\t\t\t\tthis._closeBtn.focus();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\t// Replace all button\n\t\tthis._replaceAllBtn = this._register(new SimpleButton({\n\t\t\tlabel: NLS_REPLACE_ALL_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceAllAction),\n\t\t\tclassName: 'replace-all',\n\t\t\tonTrigger: () => {\n\t\t\t\tthis._controller.replaceAll();\n\t\t\t}\n\t\t}));\n\n\t\tlet replacePart = document.createElement('div');\n\t\treplacePart.className = 'replace-part';\n\t\treplacePart.appendChild(replaceInput);\n\t\treplacePart.appendChild(this._replaceBtn.domNode);\n\t\treplacePart.appendChild(this._replaceAllBtn.domNode);\n\n\t\treturn replacePart;\n\t}\n\n\tprivate _buildDomNode(): void {\n\t\t// Find part\n\t\tlet findPart = this._buildFindPart();\n\n\t\t// Replace part\n\t\tlet replacePart = this._buildReplacePart();\n\n\t\t// Toggle replace button\n\t\tthis._toggleReplaceBtn = this._register(new SimpleButton({\n\t\t\tlabel: NLS_TOGGLE_REPLACE_MODE_BTN_LABEL,\n\t\t\tclassName: 'toggle left',\n\t\t\tonTrigger: () => {\n\t\t\t\tthis._state.change({ isReplaceRevealed: !this._isReplaceVisible }, false);\n\t\t\t\tif (this._isReplaceVisible) {\n\t\t\t\t\tthis._replaceInputBox.width = this._findInput.inputBox.width;\n\t\t\t\t}\n\t\t\t\tthis._showViewZone();\n\t\t\t}\n\t\t}));\n\t\tthis._toggleReplaceBtn.toggleClass('expand', this._isReplaceVisible);\n\t\tthis._toggleReplaceBtn.toggleClass('collapse', !this._isReplaceVisible);\n\t\tthis._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\n\n\t\t// Widget\n\t\tthis._domNode = document.createElement('div');\n\t\tthis._domNode.className = 'editor-widget find-widget';\n\t\tthis._domNode.setAttribute('aria-hidden', 'true');\n\t\t// We need to set this explicitly, otherwise on IE11, the width inheritence of flex doesn't work.\n\t\tthis._domNode.style.width = `${FIND_WIDGET_INITIAL_WIDTH}px`;\n\n\t\tthis._domNode.appendChild(this._toggleReplaceBtn.domNode);\n\t\tthis._domNode.appendChild(findPart);\n\t\tthis._domNode.appendChild(replacePart);\n\n\t\tthis._buildSash();\n\t}\n\n\tprivate _buildSash() {\n\t\tthis._resizeSash = new Sash(this._domNode, this, { orientation: Orientation.VERTICAL });\n\t\tthis._resized = false;\n\t\tlet originalWidth = FIND_WIDGET_INITIAL_WIDTH;\n\n\t\tthis._register(this._resizeSash.onDidStart(() => {\n\t\t\toriginalWidth = dom.getTotalWidth(this._domNode);\n\t\t}));\n\n\t\tthis._register(this._resizeSash.onDidChange((evt: ISashEvent) => {\n\t\t\tthis._resized = true;\n\t\t\tlet width = originalWidth + evt.startX - evt.currentX;\n\n\t\t\tif (width < FIND_WIDGET_INITIAL_WIDTH) {\n\t\t\t\t// narrow down the find widget should be handled by CSS.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst inputBoxWidth = width - FIND_ALL_CONTROLS_WIDTH;\n\t\t\tconst maxWidth = parseFloat(dom.getComputedStyle(this._domNode).maxWidth!) || 0;\n\t\t\tif (width > maxWidth) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._domNode.style.width = `${width}px`;\n\t\t\tif (this._isReplaceVisible) {\n\t\t\t\tthis._replaceInputBox.width = inputBoxWidth;\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate updateAccessibilitySupport(): void {\n\t\tconst value = this._codeEditor.getConfiguration().accessibilitySupport;\n\t\tthis._findInput.setFocusInputOnOptionClick(value !== AccessibilitySupport.Enabled);\n\t}\n}\n\ninterface ISimpleCheckboxOpts {\n\treadonly parent: HTMLElement;\n\treadonly title: string;\n\treadonly onChange: () => void;\n}\n\nclass SimpleCheckbox extends Widget {\n\n\tprivate static _COUNTER = 0;\n\n\tprivate readonly _opts: ISimpleCheckboxOpts;\n\tprivate readonly _domNode: HTMLElement;\n\tprivate readonly _checkbox: HTMLInputElement;\n\tprivate readonly _label: HTMLLabelElement;\n\n\tconstructor(opts: ISimpleCheckboxOpts) {\n\t\tsuper();\n\t\tthis._opts = opts;\n\n\t\tthis._domNode = document.createElement('div');\n\t\tthis._domNode.className = 'monaco-checkbox';\n\t\tthis._domNode.title = this._opts.title;\n\t\tthis._domNode.tabIndex = 0;\n\n\t\tthis._checkbox = document.createElement('input');\n\t\tthis._checkbox.type = 'checkbox';\n\t\tthis._checkbox.className = 'checkbox';\n\t\tthis._checkbox.id = 'checkbox-' + SimpleCheckbox._COUNTER++;\n\t\tthis._checkbox.tabIndex = -1;\n\n\t\tthis._label = document.createElement('label');\n\t\tthis._label.className = 'label';\n\t\t// Connect the label and the checkbox. Checkbox will get checked when the label receives a click.\n\t\tthis._label.htmlFor = this._checkbox.id;\n\t\tthis._label.tabIndex = -1;\n\n\t\tthis._domNode.appendChild(this._checkbox);\n\t\tthis._domNode.appendChild(this._label);\n\n\t\tthis._opts.parent.appendChild(this._domNode);\n\n\t\tthis.onchange(this._checkbox, () => {\n\t\t\tthis._opts.onChange();\n\t\t});\n\t}\n\n\tpublic get domNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n\n\tpublic get checked(): boolean {\n\t\treturn this._checkbox.checked;\n\t}\n\n\tpublic set checked(newValue: boolean) {\n\t\tthis._checkbox.checked = newValue;\n\t}\n\n\tpublic focus(): void {\n\t\tthis._checkbox.focus();\n\t}\n\n\tprivate enable(): void {\n\t\tthis._checkbox.removeAttribute('disabled');\n\t}\n\n\tprivate disable(): void {\n\t\tthis._checkbox.disabled = true;\n\t}\n\n\tpublic setEnabled(enabled: boolean): void {\n\t\tif (enabled) {\n\t\t\tthis.enable();\n\t\t\tthis.domNode.tabIndex = 0;\n\t\t} else {\n\t\t\tthis.disable();\n\t\t\tthis.domNode.tabIndex = -1;\n\t\t}\n\t}\n}\n\nexport interface ISimpleButtonOpts {\n\treadonly label: string;\n\treadonly className: string;\n\treadonly onTrigger: () => void;\n\treadonly onKeyDown?: (e: IKeyboardEvent) => void;\n}\n\nexport class SimpleButton extends Widget {\n\n\tprivate readonly _opts: ISimpleButtonOpts;\n\tprivate readonly _domNode: HTMLElement;\n\n\tconstructor(opts: ISimpleButtonOpts) {\n\t\tsuper();\n\t\tthis._opts = opts;\n\n\t\tthis._domNode = document.createElement('div');\n\t\tthis._domNode.title = this._opts.label;\n\t\tthis._domNode.tabIndex = 0;\n\t\tthis._domNode.className = 'button ' + this._opts.className;\n\t\tthis._domNode.setAttribute('role', 'button');\n\t\tthis._domNode.setAttribute('aria-label', this._opts.label);\n\n\t\tthis.onclick(this._domNode, (e) => {\n\t\t\tthis._opts.onTrigger();\n\t\t\te.preventDefault();\n\t\t});\n\n\t\tthis.onkeydown(this._domNode, (e) => {\n\t\t\tif (e.equals(KeyCode.Space) || e.equals(KeyCode.Enter)) {\n\t\t\t\tthis._opts.onTrigger();\n\t\t\t\te.preventDefault();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this._opts.onKeyDown) {\n\t\t\t\tthis._opts.onKeyDown(e);\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic get domNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n\n\tpublic isEnabled(): boolean {\n\t\treturn (this._domNode.tabIndex >= 0);\n\t}\n\n\tpublic focus(): void {\n\t\tthis._domNode.focus();\n\t}\n\n\tpublic setEnabled(enabled: boolean): void {\n\t\tdom.toggleClass(this._domNode, 'disabled', !enabled);\n\t\tthis._domNode.setAttribute('aria-disabled', String(!enabled));\n\t\tthis._domNode.tabIndex = enabled ? 0 : -1;\n\t}\n\n\tpublic setExpanded(expanded: boolean): void {\n\t\tthis._domNode.setAttribute('aria-expanded', String(!!expanded));\n\t}\n\n\tpublic toggleClass(className: string, shouldHaveIt: boolean): void {\n\t\tdom.toggleClass(this._domNode, className, shouldHaveIt);\n\t}\n}\n\n// theming\n\nregisterThemingParticipant((theme, collector) => {\n\tconst addBackgroundColorRule = (selector: string, color: Color | undefined): void => {\n\t\tif (color) {\n\t\t\tcollector.addRule(`.monaco-editor ${selector} { background-color: ${color}; }`);\n\t\t}\n\t};\n\n\taddBackgroundColorRule('.findMatch', theme.getColor(editorFindMatchHighlight));\n\taddBackgroundColorRule('.currentFindMatch', theme.getColor(editorFindMatch));\n\taddBackgroundColorRule('.findScope', theme.getColor(editorFindRangeHighlight));\n\n\tconst widgetBackground = theme.getColor(editorWidgetBackground);\n\taddBackgroundColorRule('.find-widget', widgetBackground);\n\n\tconst widgetShadowColor = theme.getColor(widgetShadow);\n\tif (widgetShadowColor) {\n\t\tcollector.addRule(`.monaco-editor .find-widget { box-shadow: 0 2px 8px ${widgetShadowColor}; }`);\n\t}\n\n\tconst findMatchHighlightBorder = theme.getColor(editorFindMatchHighlightBorder);\n\tif (findMatchHighlightBorder) {\n\t\tcollector.addRule(`.monaco-editor .findMatch { border: 1px ${theme.type === 'hc' ? 'dotted' : 'solid'} ${findMatchHighlightBorder}; box-sizing: border-box; }`);\n\t}\n\n\tconst findMatchBorder = theme.getColor(editorFindMatchBorder);\n\tif (findMatchBorder) {\n\t\tcollector.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${findMatchBorder}; padding: 1px; box-sizing: border-box; }`);\n\t}\n\n\tconst findRangeHighlightBorder = theme.getColor(editorFindRangeHighlightBorder);\n\tif (findRangeHighlightBorder) {\n\t\tcollector.addRule(`.monaco-editor .findScope { border: 1px ${theme.type === 'hc' ? 'dashed' : 'solid'} ${findRangeHighlightBorder}; }`);\n\t}\n\n\tconst hcBorder = theme.getColor(contrastBorder);\n\tif (hcBorder) {\n\t\tcollector.addRule(`.monaco-editor .find-widget { border: 2px solid ${hcBorder}; }`);\n\t}\n\n\tconst error = theme.getColor(errorForeground);\n\tif (error) {\n\t\tcollector.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${error}; }`);\n\t}\n\n\tconst resizeBorderBackground = theme.getColor(editorWidgetResizeBorder);\n\tif (resizeBorderBackground) {\n\t\tcollector.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${resizeBorderBackground}; width: 3px !important; margin-left: -4px;}`);\n\t} else {\n\t\tconst border = theme.getColor(editorWidgetBorder);\n\t\tif (border) {\n\t\t\tcollector.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${border}; width: 3px !important; margin-left: -4px;}`);\n\t\t}\n\t}\n\n\tconst inputActiveBorder = theme.getColor(inputActiveOptionBorder);\n\tif (inputActiveBorder) {\n\t\tcollector.addRule(`.monaco-editor .find-widget .monaco-checkbox .checkbox:checked + .label { border: 1px solid ${inputActiveBorder.toString()}; }`);\n\t}\n});\n"]}]}