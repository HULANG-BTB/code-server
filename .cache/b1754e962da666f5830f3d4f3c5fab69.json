{"remainingRequest":"/home/coding/workspace/node_modules/ts-loader/index.js?{\"happyPackMode\":true,\"compilerOptions\":{\"target\":\"es5\",\"lib\":[\"dom\",\"esnext\"]}}!/home/coding/workspace/packages/ide/src/fill/dialog.ts","dependencies":[{"path":"/home/coding/workspace/packages/ide/src/fill/dialog.ts","mtime":1555841535682},{"path":"/home/coding/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1555844183884},{"path":"/home/coding/workspace/node_modules/ts-loader/index.js","mtime":1555844217316}],"contextDependencies":[],"result":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar events_1 = require(\"@coder/events\");\nrequire(\"./dialog.scss\");\nvar IKey;\n(function (IKey) {\n    IKey[\"Enter\"] = \"Enter\";\n    IKey[\"Escape\"] = \"Escape\";\n})(IKey = exports.IKey || (exports.IKey = {}));\nvar Dialog = /** @class */ (function () {\n    function Dialog(options) {\n        var _this = this;\n        this.options = options;\n        this.actionEmitter = new events_1.Emitter();\n        this.onAction = this.actionEmitter.event;\n        /**\n         * Capture escape.\n         */\n        this.onKeydown = function (event) {\n            if (event.key === \"Escape\") {\n                event.preventDefault();\n                event.stopPropagation();\n                _this.actionEmitter.emit({\n                    buttonIndex: undefined,\n                    key: IKey.Escape,\n                });\n            }\n        };\n        this.msgBox = document.createElement(\"div\");\n        this.msgBox.classList.add(\"msgbox\");\n        if (this.options.message) {\n            var messageDiv = document.createElement(\"div\");\n            messageDiv.classList.add(\"msg\");\n            messageDiv.innerText = this.options.message;\n            this.msgBox.appendChild(messageDiv);\n        }\n        if (this.options.detail) {\n            var detailDiv = document.createElement(\"div\");\n            detailDiv.classList.add(\"detail\");\n            detailDiv.innerText = this.options.detail;\n            this.msgBox.appendChild(detailDiv);\n        }\n        if (this.options.input) {\n            this.msgBox.classList.add(\"input\");\n            this.input = document.createElement(\"input\");\n            this.input.classList.add(\"input\");\n            this.input.value = this.options.input.value;\n            this.input.addEventListener(\"keydown\", function (event) {\n                if (event.key === IKey.Enter) {\n                    event.preventDefault();\n                    _this.actionEmitter.emit({\n                        buttonIndex: undefined,\n                        key: IKey.Enter,\n                    });\n                }\n            });\n            this.msgBox.appendChild(this.input);\n        }\n        this.errors = document.createElement(\"div\");\n        this.errors.classList.add(\"errors\");\n        if (this.options.buttons && this.options.buttons.length > 0) {\n            this.buttons = this.options.buttons.map(function (buttonText, buttonIndex) {\n                var button = document.createElement(\"button\");\n                // TODO: support mnemonics.\n                button.innerText = buttonText.replace(\"&&\", \"\");\n                button.addEventListener(\"click\", function () {\n                    _this.actionEmitter.emit({\n                        buttonIndex: buttonIndex,\n                        key: undefined,\n                    });\n                });\n                return button;\n            });\n            var buttonWrapper_1 = document.createElement(\"div\");\n            buttonWrapper_1.classList.add(\"button-wrapper\");\n            this.buttons.forEach(function (b) { return buttonWrapper_1.appendChild(b); });\n            this.msgBox.appendChild(buttonWrapper_1);\n        }\n        this.overlay = document.createElement(\"div\");\n        this.overlay.className = \"msgbox-overlay\";\n        this.overlay.appendChild(this.msgBox);\n        setTimeout(function () {\n            _this.overlay.style.opacity = \"1\";\n        });\n    }\n    Object.defineProperty(Dialog.prototype, \"inputValue\", {\n        /**\n         * Input value if this dialog has an input.\n         */\n        get: function () {\n            return this.input ? this.input.value : undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Dialog.prototype, \"error\", {\n        /**\n         * Display or remove an error.\n         */\n        set: function (error) {\n            while (this.errors.lastChild) {\n                this.errors.removeChild(this.errors.lastChild);\n            }\n            if (error) {\n                var errorDiv = document.createElement(\"error\");\n                errorDiv.innerText = error;\n                this.errors.appendChild(errorDiv);\n                this.msgBox.appendChild(this.errors);\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Show the dialog.\n     */\n    Dialog.prototype.show = function () {\n        if (!this.cachedActiveElement) {\n            this.cachedActiveElement = document.activeElement;\n            (document.querySelector(\".monaco-workbench\") || document.body).appendChild(this.overlay);\n            document.addEventListener(\"keydown\", this.onKeydown);\n            if (this.input) {\n                this.input.focus();\n                if (this.options.input && this.options.input.selection) {\n                    this.input.setSelectionRange(this.options.input.selection.start, this.options.input.selection.end);\n                }\n            }\n            else if (this.buttons) {\n                this.buttons[0].focus();\n            }\n        }\n    };\n    /**\n     * Remove the dialog and clean up.\n     */\n    Dialog.prototype.hide = function () {\n        if (this.cachedActiveElement) {\n            this.overlay.remove();\n            document.removeEventListener(\"keydown\", this.onKeydown);\n            this.cachedActiveElement.focus();\n            this.cachedActiveElement = undefined;\n        }\n    };\n    return Dialog;\n}());\nexports.Dialog = Dialog;\n",{"version":3,"file":"/home/coding/workspace/packages/ide/src/fill/dialog.ts","sourceRoot":"","sources":["/home/coding/workspace/packages/ide/src/fill/dialog.ts"],"names":[],"mappings":"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","sourcesContent":["import { Emitter } from \"@coder/events\";\n\nimport \"./dialog.scss\";\n\nexport interface IDialogOptions {\n\tmessage?: string;\n\tdetail?: string;\n\tbuttons?: string[];\n\tinput?: {\n\t\tvalue: string;\n\t\tselection?: {\n\t\t\tstart: number;\n\t\t\tend: number;\n\t\t};\n\t};\n}\n\nexport interface IDialogAction {\n\tbuttonIndex?: number;\n\tkey?: IKey;\n}\n\nexport enum IKey {\n\tEnter = \"Enter\",\n\tEscape = \"Escape\",\n}\n\nexport class Dialog {\n\tprivate readonly overlay: HTMLElement;\n\tprivate cachedActiveElement: HTMLElement | undefined;\n\tprivate input: HTMLInputElement | undefined;\n\tprivate errors: HTMLElement;\n\tprivate buttons: HTMLElement[] | undefined;\n\tprivate readonly msgBox: HTMLElement;\n\n\tprivate actionEmitter = new Emitter<IDialogAction>();\n\tpublic onAction = this.actionEmitter.event;\n\n\tpublic constructor(private readonly options: IDialogOptions) {\n\t\tthis.msgBox = document.createElement(\"div\");\n\t\tthis.msgBox.classList.add(\"msgbox\");\n\n\t\tif (this.options.message) {\n\t\t\tconst messageDiv = document.createElement(\"div\");\n\t\t\tmessageDiv.classList.add(\"msg\");\n\t\t\tmessageDiv.innerText = this.options.message;\n\t\t\tthis.msgBox.appendChild(messageDiv);\n\t\t}\n\n\t\tif (this.options.detail) {\n\t\t\tconst detailDiv = document.createElement(\"div\");\n\t\t\tdetailDiv.classList.add(\"detail\");\n\t\t\tdetailDiv.innerText = this.options.detail;\n\t\t\tthis.msgBox.appendChild(detailDiv);\n\t\t}\n\n\t\tif (this.options.input) {\n\t\t\tthis.msgBox.classList.add(\"input\");\n\t\t\tthis.input = document.createElement(\"input\");\n\t\t\tthis.input.classList.add(\"input\");\n\t\t\tthis.input.value = this.options.input.value;\n\t\t\tthis.input.addEventListener(\"keydown\", (event) => {\n\t\t\t\tif (event.key === IKey.Enter) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tthis.actionEmitter.emit({\n\t\t\t\t\t\tbuttonIndex: undefined,\n\t\t\t\t\t\tkey: IKey.Enter,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.msgBox.appendChild(this.input);\n\t\t}\n\n\t\tthis.errors = document.createElement(\"div\");\n\t\tthis.errors.classList.add(\"errors\");\n\n\t\tif (this.options.buttons && this.options.buttons.length > 0) {\n\t\t\tthis.buttons = this.options.buttons.map((buttonText, buttonIndex) => {\n\t\t\t\tconst button = document.createElement(\"button\");\n\t\t\t\t// TODO: support mnemonics.\n\t\t\t\tbutton.innerText = buttonText.replace(\"&&\", \"\");\n\t\t\t\tbutton.addEventListener(\"click\", () => {\n\t\t\t\t\tthis.actionEmitter.emit({\n\t\t\t\t\t\tbuttonIndex,\n\t\t\t\t\t\tkey: undefined,\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\treturn button;\n\t\t\t});\n\n\t\t\tconst buttonWrapper = document.createElement(\"div\");\n\t\t\tbuttonWrapper.classList.add(\"button-wrapper\");\n\t\t\tthis.buttons.forEach((b) => buttonWrapper.appendChild(b));\n\t\t\tthis.msgBox.appendChild(buttonWrapper);\n\t\t}\n\n\t\tthis.overlay = document.createElement(\"div\");\n\t\tthis.overlay.className = \"msgbox-overlay\";\n\t\tthis.overlay.appendChild(this.msgBox);\n\n\t\tsetTimeout(() => {\n\t\t\tthis.overlay.style.opacity = \"1\";\n\t\t});\n\t}\n\n\t/**\n\t * Input value if this dialog has an input.\n\t */\n\tpublic get inputValue(): string | undefined {\n\t\treturn this.input ? this.input.value : undefined;\n\t}\n\n\t/**\n\t * Display or remove an error.\n\t */\n\tpublic set error(error: string | undefined) {\n\t\twhile (this.errors.lastChild) {\n\t\t\tthis.errors.removeChild(this.errors.lastChild);\n\t\t}\n\t\tif (error) {\n\t\t\tconst errorDiv = document.createElement(\"error\");\n\t\t\terrorDiv.innerText = error;\n\t\t\tthis.errors.appendChild(errorDiv);\n\t\t\tthis.msgBox.appendChild(this.errors);\n\t\t}\n\t}\n\n\t/**\n\t * Show the dialog.\n\t */\n\tpublic show(): void {\n\t\tif (!this.cachedActiveElement) {\n\t\t\tthis.cachedActiveElement = document.activeElement as HTMLElement;\n\t\t\t(document.querySelector(\".monaco-workbench\") || document.body).appendChild(this.overlay);\n\t\t\tdocument.addEventListener(\"keydown\", this.onKeydown);\n\t\t\tif (this.input) {\n\t\t\t\tthis.input.focus();\n\t\t\t\tif (this.options.input && this.options.input.selection) {\n\t\t\t\t\tthis.input.setSelectionRange(\n\t\t\t\t\t\tthis.options.input.selection.start,\n\t\t\t\t\t\tthis.options.input.selection.end,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else if (this.buttons) {\n\t\t\t\tthis.buttons[0].focus();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Remove the dialog and clean up.\n\t */\n\tpublic hide(): void {\n\t\tif (this.cachedActiveElement) {\n\t\t\tthis.overlay.remove();\n\t\t\tdocument.removeEventListener(\"keydown\", this.onKeydown);\n\t\t\tthis.cachedActiveElement.focus();\n\t\t\tthis.cachedActiveElement = undefined;\n\t\t}\n\t}\n\n\t/**\n\t * Capture escape.\n\t */\n\tprivate onKeydown = (event: KeyboardEvent): void => {\n\t\tif (event.key === \"Escape\") {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\tthis.actionEmitter.emit({\n\t\t\t\tbuttonIndex: undefined,\n\t\t\t\tkey: IKey.Escape,\n\t\t\t});\n\t\t}\n\t}\n}\n"]}]}