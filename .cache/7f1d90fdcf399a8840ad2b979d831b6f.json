{"remainingRequest":"/home/coding/workspace/node_modules/ts-loader/index.js?{\"happyPackMode\":true,\"compilerOptions\":{\"target\":\"es5\",\"lib\":[\"dom\",\"esnext\"]}}!/home/coding/workspace/lib/vscode/src/vs/editor/browser/viewParts/viewCursors/viewCursor.ts","dependencies":[{"path":"/home/coding/workspace/lib/vscode/src/vs/editor/browser/viewParts/viewCursors/viewCursor.ts","mtime":1555102316000},{"path":"/home/coding/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1555844183884},{"path":"/home/coding/workspace/node_modules/ts-loader/index.js","mtime":1555844217316}],"contextDependencies":[],"result":["\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar dom = require(\"vs/base/browser/dom\");\nvar fastDomNode_1 = require(\"vs/base/browser/fastDomNode\");\nvar strings = require(\"vs/base/common/strings\");\nvar configuration_1 = require(\"vs/editor/browser/config/configuration\");\nvar editorOptions_1 = require(\"vs/editor/common/config/editorOptions\");\nvar position_1 = require(\"vs/editor/common/core/position\");\nvar range_1 = require(\"vs/editor/common/core/range\");\nvar ViewCursorRenderData = /** @class */ (function () {\n    function ViewCursorRenderData(top, left, width, height, textContent, textContentClassName) {\n        this.top = top;\n        this.left = left;\n        this.width = width;\n        this.height = height;\n        this.textContent = textContent;\n        this.textContentClassName = textContentClassName;\n    }\n    return ViewCursorRenderData;\n}());\nvar ViewCursor = /** @class */ (function () {\n    function ViewCursor(context) {\n        this._context = context;\n        this._cursorStyle = this._context.configuration.editor.viewInfo.cursorStyle;\n        this._lineHeight = this._context.configuration.editor.lineHeight;\n        this._typicalHalfwidthCharacterWidth = this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\n        this._lineCursorWidth = Math.min(this._context.configuration.editor.viewInfo.cursorWidth, this._typicalHalfwidthCharacterWidth);\n        this._isVisible = true;\n        // Create the dom node\n        this._domNode = fastDomNode_1.createFastDomNode(document.createElement('div'));\n        this._domNode.setClassName('cursor');\n        this._domNode.setHeight(this._lineHeight);\n        this._domNode.setTop(0);\n        this._domNode.setLeft(0);\n        configuration_1.Configuration.applyFontInfo(this._domNode, this._context.configuration.editor.fontInfo);\n        this._domNode.setDisplay('none');\n        this.updatePosition(new position_1.Position(1, 1));\n        this._lastRenderedContent = '';\n        this._renderData = null;\n    }\n    ViewCursor.prototype.getDomNode = function () {\n        return this._domNode;\n    };\n    ViewCursor.prototype.getPosition = function () {\n        return this._position;\n    };\n    ViewCursor.prototype.show = function () {\n        if (!this._isVisible) {\n            this._domNode.setVisibility('inherit');\n            this._isVisible = true;\n        }\n    };\n    ViewCursor.prototype.hide = function () {\n        if (this._isVisible) {\n            this._domNode.setVisibility('hidden');\n            this._isVisible = false;\n        }\n    };\n    ViewCursor.prototype.onConfigurationChanged = function (e) {\n        if (e.lineHeight) {\n            this._lineHeight = this._context.configuration.editor.lineHeight;\n        }\n        if (e.fontInfo) {\n            configuration_1.Configuration.applyFontInfo(this._domNode, this._context.configuration.editor.fontInfo);\n            this._typicalHalfwidthCharacterWidth = this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\n        }\n        if (e.viewInfo) {\n            this._cursorStyle = this._context.configuration.editor.viewInfo.cursorStyle;\n            this._lineCursorWidth = Math.min(this._context.configuration.editor.viewInfo.cursorWidth, this._typicalHalfwidthCharacterWidth);\n        }\n        return true;\n    };\n    ViewCursor.prototype.onCursorPositionChanged = function (position) {\n        this.updatePosition(position);\n        return true;\n    };\n    ViewCursor.prototype._prepareRender = function (ctx) {\n        var textContent = '';\n        var textContentClassName = '';\n        if (this._cursorStyle === editorOptions_1.TextEditorCursorStyle.Line || this._cursorStyle === editorOptions_1.TextEditorCursorStyle.LineThin) {\n            var visibleRange = ctx.visibleRangeForPosition(this._position);\n            if (!visibleRange) {\n                // Outside viewport\n                return null;\n            }\n            var width_1;\n            if (this._cursorStyle === editorOptions_1.TextEditorCursorStyle.Line) {\n                width_1 = dom.computeScreenAwareSize(this._lineCursorWidth > 0 ? this._lineCursorWidth : 2);\n                if (width_1 > 2) {\n                    var lineContent = this._context.model.getLineContent(this._position.lineNumber);\n                    textContent = lineContent.charAt(this._position.column - 1);\n                }\n            }\n            else {\n                width_1 = dom.computeScreenAwareSize(1);\n            }\n            var left = visibleRange.left;\n            if (width_1 >= 2 && left >= 1) {\n                // try to center cursor\n                left -= 1;\n            }\n            var top_1 = ctx.getVerticalOffsetForLineNumber(this._position.lineNumber) - ctx.bigNumbersDelta;\n            return new ViewCursorRenderData(top_1, left, width_1, this._lineHeight, textContent, textContentClassName);\n        }\n        var visibleRangeForCharacter = ctx.linesVisibleRangesForRange(new range_1.Range(this._position.lineNumber, this._position.column, this._position.lineNumber, this._position.column + 1), false);\n        if (!visibleRangeForCharacter || visibleRangeForCharacter.length === 0 || visibleRangeForCharacter[0].ranges.length === 0) {\n            // Outside viewport\n            return null;\n        }\n        var range = visibleRangeForCharacter[0].ranges[0];\n        var width = range.width < 1 ? this._typicalHalfwidthCharacterWidth : range.width;\n        if (this._cursorStyle === editorOptions_1.TextEditorCursorStyle.Block) {\n            var lineData = this._context.model.getViewLineData(this._position.lineNumber);\n            textContent = lineData.content.charAt(this._position.column - 1);\n            if (strings.isHighSurrogate(lineData.content.charCodeAt(this._position.column - 1))) {\n                textContent += lineData.content.charAt(this._position.column);\n            }\n            var tokenIndex = lineData.tokens.findTokenIndexAtOffset(this._position.column - 1);\n            textContentClassName = lineData.tokens.getClassName(tokenIndex);\n        }\n        var top = ctx.getVerticalOffsetForLineNumber(this._position.lineNumber) - ctx.bigNumbersDelta;\n        var height = this._lineHeight;\n        // Underline might interfere with clicking\n        if (this._cursorStyle === editorOptions_1.TextEditorCursorStyle.Underline || this._cursorStyle === editorOptions_1.TextEditorCursorStyle.UnderlineThin) {\n            top += this._lineHeight - 2;\n            height = 2;\n        }\n        return new ViewCursorRenderData(top, range.left, width, height, textContent, textContentClassName);\n    };\n    ViewCursor.prototype.prepareRender = function (ctx) {\n        this._renderData = this._prepareRender(ctx);\n    };\n    ViewCursor.prototype.render = function (ctx) {\n        if (!this._renderData) {\n            this._domNode.setDisplay('none');\n            return null;\n        }\n        if (this._lastRenderedContent !== this._renderData.textContent) {\n            this._lastRenderedContent = this._renderData.textContent;\n            this._domNode.domNode.textContent = this._lastRenderedContent;\n        }\n        this._domNode.setClassName('cursor ' + this._renderData.textContentClassName);\n        this._domNode.setDisplay('block');\n        this._domNode.setTop(this._renderData.top);\n        this._domNode.setLeft(this._renderData.left);\n        this._domNode.setWidth(this._renderData.width);\n        this._domNode.setLineHeight(this._renderData.height);\n        this._domNode.setHeight(this._renderData.height);\n        return {\n            domNode: this._domNode.domNode,\n            position: this._position,\n            contentLeft: this._renderData.left,\n            height: this._renderData.height,\n            width: 2\n        };\n    };\n    ViewCursor.prototype.updatePosition = function (newPosition) {\n        this._position = newPosition;\n    };\n    return ViewCursor;\n}());\nexports.ViewCursor = ViewCursor;\n",{"version":3,"file":"/home/coding/workspace/lib/vscode/src/vs/editor/browser/viewParts/viewCursors/viewCursor.ts","sourceRoot":"","sources":["/home/coding/workspace/lib/vscode/src/vs/editor/browser/viewParts/viewCursors/viewCursor.ts"],"names":[],"mappings":";AAAA;;;gGAGgG;;AAEhG,yCAA2C;AAC3C,2DAA6E;AAC7E,gDAAkD;AAClD,wEAAuE;AACvE,uEAA8E;AAC9E,2DAA0D;AAC1D,qDAAoD;AAapD;IACC,8BACiB,GAAW,EACX,IAAY,EACZ,KAAa,EACb,MAAc,EACd,WAAmB,EACnB,oBAA4B;QAL5B,QAAG,GAAH,GAAG,CAAQ;QACX,SAAI,GAAJ,IAAI,CAAQ;QACZ,UAAK,GAAL,KAAK,CAAQ;QACb,WAAM,GAAN,MAAM,CAAQ;QACd,gBAAW,GAAX,WAAW,CAAQ;QACnB,yBAAoB,GAApB,oBAAoB,CAAQ;IACzC,CAAC;IACN,2BAAC;AAAD,CAAC,AATD,IASC;AAED;IAgBC,oBAAY,OAAoB;QAC/B,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;QAExB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAC;QAC5E,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,UAAU,CAAC;QACjE,IAAI,CAAC,+BAA+B,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,CAAC,8BAA8B,CAAC;QAClH,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,+BAA+B,CAAC,CAAC;QAEhI,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QAEvB,sBAAsB;QACtB,IAAI,CAAC,QAAQ,GAAG,+BAAiB,CAAC,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC;QACjE,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;QACrC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAC1C,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QACxB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QACzB,6BAAa,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QACxF,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;QAEjC,IAAI,CAAC,cAAc,CAAC,IAAI,mBAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAExC,IAAI,CAAC,oBAAoB,GAAG,EAAE,CAAC;QAC/B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;IACzB,CAAC;IAEM,+BAAU,GAAjB;QACC,OAAO,IAAI,CAAC,QAAQ,CAAC;IACtB,CAAC;IAEM,gCAAW,GAAlB;QACC,OAAO,IAAI,CAAC,SAAS,CAAC;IACvB,CAAC;IAEM,yBAAI,GAAX;QACC,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YACrB,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;YACvC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;SACvB;IACF,CAAC;IAEM,yBAAI,GAAX;QACC,IAAI,IAAI,CAAC,UAAU,EAAE;YACpB,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACtC,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;SACxB;IACF,CAAC;IAEM,2CAAsB,GAA7B,UAA8B,CAA2C;QACxE,IAAI,CAAC,CAAC,UAAU,EAAE;YACjB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,UAAU,CAAC;SACjE;QACD,IAAI,CAAC,CAAC,QAAQ,EAAE;YACf,6BAAa,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;YACxF,IAAI,CAAC,+BAA+B,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,CAAC,8BAA8B,CAAC;SAClH;QACD,IAAI,CAAC,CAAC,QAAQ,EAAE;YACf,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAC;YAC5E,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,CAAC,+BAA+B,CAAC,CAAC;SAChI;QAED,OAAO,IAAI,CAAC;IACb,CAAC;IAEM,4CAAuB,GAA9B,UAA+B,QAAkB;QAChD,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;QAC9B,OAAO,IAAI,CAAC;IACb,CAAC;IAEO,mCAAc,GAAtB,UAAuB,GAAqB;QAC3C,IAAI,WAAW,GAAG,EAAE,CAAC;QACrB,IAAI,oBAAoB,GAAG,EAAE,CAAC;QAE9B,IAAI,IAAI,CAAC,YAAY,KAAK,qCAAqB,CAAC,IAAI,IAAI,IAAI,CAAC,YAAY,KAAK,qCAAqB,CAAC,QAAQ,EAAE;YAC7G,IAAM,YAAY,GAAG,GAAG,CAAC,uBAAuB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACjE,IAAI,CAAC,YAAY,EAAE;gBAClB,mBAAmB;gBACnB,OAAO,IAAI,CAAC;aACZ;YACD,IAAI,OAAa,CAAC;YAClB,IAAI,IAAI,CAAC,YAAY,KAAK,qCAAqB,CAAC,IAAI,EAAE;gBACrD,OAAK,GAAG,GAAG,CAAC,sBAAsB,CAAC,IAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC1F,IAAI,OAAK,GAAG,CAAC,EAAE;oBACd,IAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;oBAClF,WAAW,GAAG,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;iBAC5D;aACD;iBAAM;gBACN,OAAK,GAAG,GAAG,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC;aACtC;YACD,IAAI,IAAI,GAAG,YAAY,CAAC,IAAI,CAAC;YAC7B,IAAI,OAAK,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,EAAE;gBAC5B,uBAAuB;gBACvB,IAAI,IAAI,CAAC,CAAC;aACV;YACD,IAAM,KAAG,GAAG,GAAG,CAAC,8BAA8B,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC,eAAe,CAAC;YAChG,OAAO,IAAI,oBAAoB,CAAC,KAAG,EAAE,IAAI,EAAE,OAAK,EAAE,IAAI,CAAC,WAAW,EAAE,WAAW,EAAE,oBAAoB,CAAC,CAAC;SACvG;QAED,IAAM,wBAAwB,GAAG,GAAG,CAAC,0BAA0B,CAAC,IAAI,aAAK,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;QAE1L,IAAI,CAAC,wBAAwB,IAAI,wBAAwB,CAAC,MAAM,KAAK,CAAC,IAAI,wBAAwB,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;YAC1H,mBAAmB;YACnB,OAAO,IAAI,CAAC;SACZ;QAED,IAAM,KAAK,GAAG,wBAAwB,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QACpD,IAAM,KAAK,GAAG,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,+BAA+B,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC;QAEnF,IAAI,IAAI,CAAC,YAAY,KAAK,qCAAqB,CAAC,KAAK,EAAE;YACtD,IAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;YAChF,WAAW,GAAG,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YACjE,IAAI,OAAO,CAAC,eAAe,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,EAAE;gBACpF,WAAW,IAAI,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;aAC9D;YACD,IAAM,UAAU,GAAG,QAAQ,CAAC,MAAM,CAAC,sBAAsB,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YACrF,oBAAoB,GAAG,QAAQ,CAAC,MAAM,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;SAChE;QAED,IAAI,GAAG,GAAG,GAAG,CAAC,8BAA8B,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC,eAAe,CAAC;QAC9F,IAAI,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC;QAE9B,0CAA0C;QAC1C,IAAI,IAAI,CAAC,YAAY,KAAK,qCAAqB,CAAC,SAAS,IAAI,IAAI,CAAC,YAAY,KAAK,qCAAqB,CAAC,aAAa,EAAE;YACvH,GAAG,IAAI,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC;YAC5B,MAAM,GAAG,CAAC,CAAC;SACX;QAED,OAAO,IAAI,oBAAoB,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,EAAE,KAAK,EAAE,MAAM,EAAE,WAAW,EAAE,oBAAoB,CAAC,CAAC;IACpG,CAAC;IAEM,kCAAa,GAApB,UAAqB,GAAqB;QACzC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC;IAC7C,CAAC;IAEM,2BAAM,GAAb,UAAc,GAA+B;QAC5C,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACtB,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;YACjC,OAAO,IAAI,CAAC;SACZ;QAED,IAAI,IAAI,CAAC,oBAAoB,KAAK,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE;YAC/D,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC;YACzD,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC,oBAAoB,CAAC;SAC9D;QAED,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC;QAE9E,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;QAClC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;QAC3C,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QAC7C,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QAC/C,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QACrD,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QAEjD,OAAO;YACN,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC,OAAO;YAC9B,QAAQ,EAAE,IAAI,CAAC,SAAS;YACxB,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI;YAClC,MAAM,EAAE,IAAI,CAAC,WAAW,CAAC,MAAM;YAC/B,KAAK,EAAE,CAAC;SACR,CAAC;IACH,CAAC;IAEO,mCAAc,GAAtB,UAAuB,WAAqB;QAC3C,IAAI,CAAC,SAAS,GAAG,WAAW,CAAC;IAC9B,CAAC;IACF,iBAAC;AAAD,CAAC,AArLD,IAqLC;AArLY,gCAAU","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from 'vs/base/browser/dom';\nimport { FastDomNode, createFastDomNode } from 'vs/base/browser/fastDomNode';\nimport * as strings from 'vs/base/common/strings';\nimport { Configuration } from 'vs/editor/browser/config/configuration';\nimport { TextEditorCursorStyle } from 'vs/editor/common/config/editorOptions';\nimport { Position } from 'vs/editor/common/core/position';\nimport { Range } from 'vs/editor/common/core/range';\nimport { RenderingContext, RestrictedRenderingContext } from 'vs/editor/common/view/renderingContext';\nimport { ViewContext } from 'vs/editor/common/view/viewContext';\nimport * as viewEvents from 'vs/editor/common/view/viewEvents';\n\nexport interface IViewCursorRenderData {\n\tdomNode: HTMLElement;\n\tposition: Position;\n\tcontentLeft: number;\n\twidth: number;\n\theight: number;\n}\n\nclass ViewCursorRenderData {\n\tconstructor(\n\t\tpublic readonly top: number,\n\t\tpublic readonly left: number,\n\t\tpublic readonly width: number,\n\t\tpublic readonly height: number,\n\t\tpublic readonly textContent: string,\n\t\tpublic readonly textContentClassName: string\n\t) { }\n}\n\nexport class ViewCursor {\n\tprivate readonly _context: ViewContext;\n\tprivate readonly _domNode: FastDomNode<HTMLElement>;\n\n\tprivate _cursorStyle: TextEditorCursorStyle;\n\tprivate _lineCursorWidth: number;\n\tprivate _lineHeight: number;\n\tprivate _typicalHalfwidthCharacterWidth: number;\n\n\tprivate _isVisible: boolean;\n\n\tprivate _position: Position;\n\n\tprivate _lastRenderedContent: string;\n\tprivate _renderData: ViewCursorRenderData | null;\n\n\tconstructor(context: ViewContext) {\n\t\tthis._context = context;\n\n\t\tthis._cursorStyle = this._context.configuration.editor.viewInfo.cursorStyle;\n\t\tthis._lineHeight = this._context.configuration.editor.lineHeight;\n\t\tthis._typicalHalfwidthCharacterWidth = this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\n\t\tthis._lineCursorWidth = Math.min(this._context.configuration.editor.viewInfo.cursorWidth, this._typicalHalfwidthCharacterWidth);\n\n\t\tthis._isVisible = true;\n\n\t\t// Create the dom node\n\t\tthis._domNode = createFastDomNode(document.createElement('div'));\n\t\tthis._domNode.setClassName('cursor');\n\t\tthis._domNode.setHeight(this._lineHeight);\n\t\tthis._domNode.setTop(0);\n\t\tthis._domNode.setLeft(0);\n\t\tConfiguration.applyFontInfo(this._domNode, this._context.configuration.editor.fontInfo);\n\t\tthis._domNode.setDisplay('none');\n\n\t\tthis.updatePosition(new Position(1, 1));\n\n\t\tthis._lastRenderedContent = '';\n\t\tthis._renderData = null;\n\t}\n\n\tpublic getDomNode(): FastDomNode<HTMLElement> {\n\t\treturn this._domNode;\n\t}\n\n\tpublic getPosition(): Position {\n\t\treturn this._position;\n\t}\n\n\tpublic show(): void {\n\t\tif (!this._isVisible) {\n\t\t\tthis._domNode.setVisibility('inherit');\n\t\t\tthis._isVisible = true;\n\t\t}\n\t}\n\n\tpublic hide(): void {\n\t\tif (this._isVisible) {\n\t\t\tthis._domNode.setVisibility('hidden');\n\t\t\tthis._isVisible = false;\n\t\t}\n\t}\n\n\tpublic onConfigurationChanged(e: viewEvents.ViewConfigurationChangedEvent): boolean {\n\t\tif (e.lineHeight) {\n\t\t\tthis._lineHeight = this._context.configuration.editor.lineHeight;\n\t\t}\n\t\tif (e.fontInfo) {\n\t\t\tConfiguration.applyFontInfo(this._domNode, this._context.configuration.editor.fontInfo);\n\t\t\tthis._typicalHalfwidthCharacterWidth = this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth;\n\t\t}\n\t\tif (e.viewInfo) {\n\t\t\tthis._cursorStyle = this._context.configuration.editor.viewInfo.cursorStyle;\n\t\t\tthis._lineCursorWidth = Math.min(this._context.configuration.editor.viewInfo.cursorWidth, this._typicalHalfwidthCharacterWidth);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tpublic onCursorPositionChanged(position: Position): boolean {\n\t\tthis.updatePosition(position);\n\t\treturn true;\n\t}\n\n\tprivate _prepareRender(ctx: RenderingContext): ViewCursorRenderData | null {\n\t\tlet textContent = '';\n\t\tlet textContentClassName = '';\n\n\t\tif (this._cursorStyle === TextEditorCursorStyle.Line || this._cursorStyle === TextEditorCursorStyle.LineThin) {\n\t\t\tconst visibleRange = ctx.visibleRangeForPosition(this._position);\n\t\t\tif (!visibleRange) {\n\t\t\t\t// Outside viewport\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tlet width: number;\n\t\t\tif (this._cursorStyle === TextEditorCursorStyle.Line) {\n\t\t\t\twidth = dom.computeScreenAwareSize(this._lineCursorWidth > 0 ? this._lineCursorWidth : 2);\n\t\t\t\tif (width > 2) {\n\t\t\t\t\tconst lineContent = this._context.model.getLineContent(this._position.lineNumber);\n\t\t\t\t\ttextContent = lineContent.charAt(this._position.column - 1);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\twidth = dom.computeScreenAwareSize(1);\n\t\t\t}\n\t\t\tlet left = visibleRange.left;\n\t\t\tif (width >= 2 && left >= 1) {\n\t\t\t\t// try to center cursor\n\t\t\t\tleft -= 1;\n\t\t\t}\n\t\t\tconst top = ctx.getVerticalOffsetForLineNumber(this._position.lineNumber) - ctx.bigNumbersDelta;\n\t\t\treturn new ViewCursorRenderData(top, left, width, this._lineHeight, textContent, textContentClassName);\n\t\t}\n\n\t\tconst visibleRangeForCharacter = ctx.linesVisibleRangesForRange(new Range(this._position.lineNumber, this._position.column, this._position.lineNumber, this._position.column + 1), false);\n\n\t\tif (!visibleRangeForCharacter || visibleRangeForCharacter.length === 0 || visibleRangeForCharacter[0].ranges.length === 0) {\n\t\t\t// Outside viewport\n\t\t\treturn null;\n\t\t}\n\n\t\tconst range = visibleRangeForCharacter[0].ranges[0];\n\t\tconst width = range.width < 1 ? this._typicalHalfwidthCharacterWidth : range.width;\n\n\t\tif (this._cursorStyle === TextEditorCursorStyle.Block) {\n\t\t\tconst lineData = this._context.model.getViewLineData(this._position.lineNumber);\n\t\t\ttextContent = lineData.content.charAt(this._position.column - 1);\n\t\t\tif (strings.isHighSurrogate(lineData.content.charCodeAt(this._position.column - 1))) {\n\t\t\t\ttextContent += lineData.content.charAt(this._position.column);\n\t\t\t}\n\t\t\tconst tokenIndex = lineData.tokens.findTokenIndexAtOffset(this._position.column - 1);\n\t\t\ttextContentClassName = lineData.tokens.getClassName(tokenIndex);\n\t\t}\n\n\t\tlet top = ctx.getVerticalOffsetForLineNumber(this._position.lineNumber) - ctx.bigNumbersDelta;\n\t\tlet height = this._lineHeight;\n\n\t\t// Underline might interfere with clicking\n\t\tif (this._cursorStyle === TextEditorCursorStyle.Underline || this._cursorStyle === TextEditorCursorStyle.UnderlineThin) {\n\t\t\ttop += this._lineHeight - 2;\n\t\t\theight = 2;\n\t\t}\n\n\t\treturn new ViewCursorRenderData(top, range.left, width, height, textContent, textContentClassName);\n\t}\n\n\tpublic prepareRender(ctx: RenderingContext): void {\n\t\tthis._renderData = this._prepareRender(ctx);\n\t}\n\n\tpublic render(ctx: RestrictedRenderingContext): IViewCursorRenderData | null {\n\t\tif (!this._renderData) {\n\t\t\tthis._domNode.setDisplay('none');\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this._lastRenderedContent !== this._renderData.textContent) {\n\t\t\tthis._lastRenderedContent = this._renderData.textContent;\n\t\t\tthis._domNode.domNode.textContent = this._lastRenderedContent;\n\t\t}\n\n\t\tthis._domNode.setClassName('cursor ' + this._renderData.textContentClassName);\n\n\t\tthis._domNode.setDisplay('block');\n\t\tthis._domNode.setTop(this._renderData.top);\n\t\tthis._domNode.setLeft(this._renderData.left);\n\t\tthis._domNode.setWidth(this._renderData.width);\n\t\tthis._domNode.setLineHeight(this._renderData.height);\n\t\tthis._domNode.setHeight(this._renderData.height);\n\n\t\treturn {\n\t\t\tdomNode: this._domNode.domNode,\n\t\t\tposition: this._position,\n\t\t\tcontentLeft: this._renderData.left,\n\t\t\theight: this._renderData.height,\n\t\t\twidth: 2\n\t\t};\n\t}\n\n\tprivate updatePosition(newPosition: Position): void {\n\t\tthis._position = newPosition;\n\t}\n}\n"]}]}