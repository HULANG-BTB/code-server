{"remainingRequest":"/home/coding/workspace/node_modules/ts-loader/index.js?{\"happyPackMode\":true,\"compilerOptions\":{\"target\":\"es5\",\"lib\":[\"dom\",\"esnext\"]}}!/home/coding/workspace/lib/vscode/src/vs/base/browser/ui/list/listWidget.ts","dependencies":[{"path":"/home/coding/workspace/lib/vscode/src/vs/base/browser/ui/list/listWidget.ts","mtime":1555846338028},{"path":"/home/coding/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1555844183884},{"path":"/home/coding/workspace/node_modules/ts-loader/index.js","mtime":1555844217316}],"contextDependencies":[],"result":["\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nrequire(\"vs/css!./list\");\nvar nls_1 = require(\"vs/nls\");\nvar lifecycle_1 = require(\"vs/base/common/lifecycle\");\nvar types_1 = require(\"vs/base/common/types\");\nvar arrays_1 = require(\"vs/base/common/arrays\");\nvar decorators_1 = require(\"vs/base/common/decorators\");\nvar DOM = require(\"vs/base/browser/dom\");\nvar browser = require(\"vs/base/browser/browser\");\nvar touch_1 = require(\"vs/base/browser/touch\");\nvar keyCodes_1 = require(\"vs/base/common/keyCodes\");\nvar keyboardEvent_1 = require(\"vs/base/browser/keyboardEvent\");\nvar event_1 = require(\"vs/base/common/event\");\nvar event_2 = require(\"vs/base/browser/event\");\nvar list_1 = require(\"./list\");\nvar listView_1 = require(\"./listView\");\nvar color_1 = require(\"vs/base/common/color\");\nvar objects_1 = require(\"vs/base/common/objects\");\nvar splice_1 = require(\"vs/base/browser/ui/list/splice\");\nvar numbers_1 = require(\"vs/base/common/numbers\");\nvar filters_1 = require(\"vs/base/common/filters\");\nvar TraitRenderer = /** @class */ (function () {\n    function TraitRenderer(trait) {\n        this.trait = trait;\n        this.renderedElements = [];\n    }\n    Object.defineProperty(TraitRenderer.prototype, \"templateId\", {\n        get: function () {\n            return \"template:\" + this.trait.trait;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TraitRenderer.prototype.renderTemplate = function (container) {\n        return container;\n    };\n    TraitRenderer.prototype.renderElement = function (element, index, templateData) {\n        var renderedElementIndex = arrays_1.firstIndex(this.renderedElements, function (el) { return el.templateData === templateData; });\n        if (renderedElementIndex >= 0) {\n            var rendered = this.renderedElements[renderedElementIndex];\n            this.trait.unrender(templateData);\n            rendered.index = index;\n        }\n        else {\n            var rendered = { index: index, templateData: templateData };\n            this.renderedElements.push(rendered);\n        }\n        this.trait.renderIndex(index, templateData);\n    };\n    TraitRenderer.prototype.splice = function (start, deleteCount, insertCount) {\n        var rendered = [];\n        for (var _i = 0, _a = this.renderedElements; _i < _a.length; _i++) {\n            var renderedElement = _a[_i];\n            if (renderedElement.index < start) {\n                rendered.push(renderedElement);\n            }\n            else if (renderedElement.index >= start + deleteCount) {\n                rendered.push({\n                    index: renderedElement.index + insertCount - deleteCount,\n                    templateData: renderedElement.templateData\n                });\n            }\n        }\n        this.renderedElements = rendered;\n    };\n    TraitRenderer.prototype.renderIndexes = function (indexes) {\n        for (var _i = 0, _a = this.renderedElements; _i < _a.length; _i++) {\n            var _b = _a[_i], index = _b.index, templateData = _b.templateData;\n            if (indexes.indexOf(index) > -1) {\n                this.trait.renderIndex(index, templateData);\n            }\n        }\n    };\n    TraitRenderer.prototype.disposeTemplate = function (templateData) {\n        var index = arrays_1.firstIndex(this.renderedElements, function (el) { return el.templateData === templateData; });\n        if (index < 0) {\n            return;\n        }\n        this.renderedElements.splice(index, 1);\n    };\n    return TraitRenderer;\n}());\nvar Trait = /** @class */ (function () {\n    function Trait(_trait) {\n        this._trait = _trait;\n        this.indexes = [];\n        this.sortedIndexes = [];\n        this._onChange = new event_1.Emitter();\n    }\n    Object.defineProperty(Trait.prototype, \"onChange\", {\n        get: function () { return this._onChange.event; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Trait.prototype, \"trait\", {\n        get: function () { return this._trait; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Trait.prototype, \"renderer\", {\n        get: function () {\n            return new TraitRenderer(this);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Trait.prototype.splice = function (start, deleteCount, elements) {\n        var diff = elements.length - deleteCount;\n        var end = start + deleteCount;\n        var indexes = this.sortedIndexes.filter(function (i) { return i < start; }).concat(elements.map(function (hasTrait, i) { return hasTrait ? i + start : -1; }).filter(function (i) { return i !== -1; }), this.sortedIndexes.filter(function (i) { return i >= end; }).map(function (i) { return i + diff; }));\n        this.renderer.splice(start, deleteCount, elements.length);\n        this._set(indexes, indexes);\n    };\n    Trait.prototype.renderIndex = function (index, container) {\n        DOM.toggleClass(container, this._trait, this.contains(index));\n    };\n    Trait.prototype.unrender = function (container) {\n        DOM.removeClass(container, this._trait);\n    };\n    /**\n     * Sets the indexes which should have this trait.\n     *\n     * @param indexes Indexes which should have this trait.\n     * @return The old indexes which had this trait.\n     */\n    Trait.prototype.set = function (indexes, browserEvent) {\n        return this._set(indexes, indexes.slice().sort(numericSort), browserEvent);\n    };\n    Trait.prototype._set = function (indexes, sortedIndexes, browserEvent) {\n        var result = this.indexes;\n        var sortedResult = this.sortedIndexes;\n        this.indexes = indexes;\n        this.sortedIndexes = sortedIndexes;\n        var toRender = disjunction(sortedResult, indexes);\n        this.renderer.renderIndexes(toRender);\n        this._onChange.fire({ indexes: indexes, browserEvent: browserEvent });\n        return result;\n    };\n    Trait.prototype.get = function () {\n        return this.indexes;\n    };\n    Trait.prototype.contains = function (index) {\n        return arrays_1.binarySearch(this.sortedIndexes, index, numericSort) >= 0;\n    };\n    Trait.prototype.dispose = function () {\n        this._onChange = lifecycle_1.dispose(this._onChange);\n    };\n    tslib_1.__decorate([\n        decorators_1.memoize\n    ], Trait.prototype, \"renderer\", null);\n    return Trait;\n}());\nvar FocusTrait = /** @class */ (function (_super) {\n    tslib_1.__extends(FocusTrait, _super);\n    function FocusTrait() {\n        return _super.call(this, 'focused') || this;\n    }\n    FocusTrait.prototype.renderIndex = function (index, container) {\n        _super.prototype.renderIndex.call(this, index, container);\n        if (this.contains(index)) {\n            container.setAttribute('aria-selected', 'true');\n        }\n        else {\n            container.removeAttribute('aria-selected');\n        }\n    };\n    return FocusTrait;\n}(Trait));\n/**\n * The TraitSpliceable is used as a util class to be able\n * to preserve traits across splice calls, given an identity\n * provider.\n */\nvar TraitSpliceable = /** @class */ (function () {\n    function TraitSpliceable(trait, view, identityProvider) {\n        this.trait = trait;\n        this.view = view;\n        this.identityProvider = identityProvider;\n    }\n    TraitSpliceable.prototype.splice = function (start, deleteCount, elements) {\n        var _this = this;\n        if (!this.identityProvider) {\n            return this.trait.splice(start, deleteCount, elements.map(function () { return false; }));\n        }\n        var pastElementsWithTrait = this.trait.get().map(function (i) { return _this.identityProvider.getId(_this.view.element(i)).toString(); });\n        var elementsWithTrait = elements.map(function (e) { return pastElementsWithTrait.indexOf(_this.identityProvider.getId(e).toString()) > -1; });\n        this.trait.splice(start, deleteCount, elementsWithTrait);\n    };\n    return TraitSpliceable;\n}());\nfunction isInputElement(e) {\n    return e.tagName === 'INPUT' || e.tagName === 'TEXTAREA';\n}\nvar KeyboardController = /** @class */ (function () {\n    function KeyboardController(list, view, options) {\n        this.list = list;\n        this.view = view;\n        var multipleSelectionSupport = !(options.multipleSelectionSupport === false);\n        this.disposables = [];\n        this.openController = options.openController || DefaultOpenController;\n        var onKeyDown = event_1.Event.chain(event_2.domEvent(view.domNode, 'keydown'))\n            .filter(function (e) { return !isInputElement(e.target); })\n            .map(function (e) { return new keyboardEvent_1.StandardKeyboardEvent(e); });\n        onKeyDown.filter(function (e) { return e.keyCode === keyCodes_1.KeyCode.Enter; }).on(this.onEnter, this, this.disposables);\n        onKeyDown.filter(function (e) { return e.keyCode === keyCodes_1.KeyCode.UpArrow; }).on(this.onUpArrow, this, this.disposables);\n        onKeyDown.filter(function (e) { return e.keyCode === keyCodes_1.KeyCode.DownArrow; }).on(this.onDownArrow, this, this.disposables);\n        onKeyDown.filter(function (e) { return e.keyCode === keyCodes_1.KeyCode.PageUp; }).on(this.onPageUpArrow, this, this.disposables);\n        onKeyDown.filter(function (e) { return e.keyCode === keyCodes_1.KeyCode.PageDown; }).on(this.onPageDownArrow, this, this.disposables);\n        onKeyDown.filter(function (e) { return e.keyCode === keyCodes_1.KeyCode.Escape; }).on(this.onEscape, this, this.disposables);\n        if (multipleSelectionSupport) {\n            onKeyDown.filter(function (e) { return (browser.isMacintosh ? e.metaKey : e.ctrlKey) && e.keyCode === keyCodes_1.KeyCode.KEY_A; }).on(this.onCtrlA, this, this.disposables);\n        }\n    }\n    KeyboardController.prototype.onEnter = function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.setSelection(this.list.getFocus(), e.browserEvent);\n        if (this.openController.shouldOpen(e.browserEvent)) {\n            this.list.open(this.list.getFocus(), e.browserEvent);\n        }\n    };\n    KeyboardController.prototype.onUpArrow = function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusPrevious(1, false, e.browserEvent);\n        this.list.reveal(this.list.getFocus()[0]);\n        this.view.domNode.focus();\n    };\n    KeyboardController.prototype.onDownArrow = function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusNext(1, false, e.browserEvent);\n        this.list.reveal(this.list.getFocus()[0]);\n        this.view.domNode.focus();\n    };\n    KeyboardController.prototype.onPageUpArrow = function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusPreviousPage(e.browserEvent);\n        this.list.reveal(this.list.getFocus()[0]);\n        this.view.domNode.focus();\n    };\n    KeyboardController.prototype.onPageDownArrow = function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusNextPage(e.browserEvent);\n        this.list.reveal(this.list.getFocus()[0]);\n        this.view.domNode.focus();\n    };\n    KeyboardController.prototype.onCtrlA = function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.setSelection(arrays_1.range(this.list.length), e.browserEvent);\n        this.view.domNode.focus();\n    };\n    KeyboardController.prototype.onEscape = function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.setSelection([], e.browserEvent);\n        this.view.domNode.focus();\n    };\n    KeyboardController.prototype.dispose = function () {\n        this.disposables = lifecycle_1.dispose(this.disposables);\n    };\n    return KeyboardController;\n}());\nvar TypeLabelControllerState;\n(function (TypeLabelControllerState) {\n    TypeLabelControllerState[TypeLabelControllerState[\"Idle\"] = 0] = \"Idle\";\n    TypeLabelControllerState[TypeLabelControllerState[\"Typing\"] = 1] = \"Typing\";\n})(TypeLabelControllerState || (TypeLabelControllerState = {}));\nfunction mightProducePrintableCharacter(event) {\n    if (event.ctrlKey || event.metaKey || event.altKey) {\n        return false;\n    }\n    return (event.keyCode >= keyCodes_1.KeyCode.KEY_A && event.keyCode <= keyCodes_1.KeyCode.KEY_Z)\n        || (event.keyCode >= keyCodes_1.KeyCode.KEY_0 && event.keyCode <= keyCodes_1.KeyCode.KEY_9)\n        || (event.keyCode >= keyCodes_1.KeyCode.US_SEMICOLON && event.keyCode <= keyCodes_1.KeyCode.US_QUOTE);\n}\nexports.mightProducePrintableCharacter = mightProducePrintableCharacter;\nvar TypeLabelController = /** @class */ (function () {\n    function TypeLabelController(list, view, keyboardNavigationLabelProvider) {\n        this.list = list;\n        this.view = view;\n        this.keyboardNavigationLabelProvider = keyboardNavigationLabelProvider;\n        this.enabled = false;\n        this.state = TypeLabelControllerState.Idle;\n        this.automaticKeyboardNavigation = true;\n        this.triggered = false;\n        this.enabledDisposables = [];\n        this.disposables = [];\n        this.updateOptions(list.options);\n    }\n    TypeLabelController.prototype.updateOptions = function (options) {\n        var enableKeyboardNavigation = typeof options.enableKeyboardNavigation === 'undefined' ? true : !!options.enableKeyboardNavigation;\n        if (enableKeyboardNavigation) {\n            this.enable();\n        }\n        else {\n            this.disable();\n        }\n        if (typeof options.automaticKeyboardNavigation !== 'undefined') {\n            this.automaticKeyboardNavigation = options.automaticKeyboardNavigation;\n        }\n    };\n    TypeLabelController.prototype.toggle = function () {\n        this.triggered = !this.triggered;\n    };\n    TypeLabelController.prototype.enable = function () {\n        var _this = this;\n        if (this.enabled) {\n            return;\n        }\n        var onChar = event_1.Event.chain(event_2.domEvent(this.view.domNode, 'keydown'))\n            .filter(function (e) { return !isInputElement(e.target); })\n            .filter(function () { return _this.automaticKeyboardNavigation || _this.triggered; })\n            .map(function (event) { return new keyboardEvent_1.StandardKeyboardEvent(event); })\n            .filter(this.keyboardNavigationLabelProvider.mightProducePrintableCharacter ? function (e) { return _this.keyboardNavigationLabelProvider.mightProducePrintableCharacter(e); } : function (e) { return mightProducePrintableCharacter(e); })\n            .forEach(function (e) { e.stopPropagation(); e.preventDefault(); })\n            .map(function (event) { return event.browserEvent.key; })\n            .event;\n        var onClear = event_1.Event.debounce(onChar, function () { return null; }, 800);\n        var onInput = event_1.Event.reduce(event_1.Event.any(onChar, onClear), function (r, i) { return i === null ? null : ((r || '') + i); });\n        onInput(this.onInput, this, this.enabledDisposables);\n        this.enabled = true;\n        this.triggered = false;\n    };\n    TypeLabelController.prototype.disable = function () {\n        if (!this.enabled) {\n            return;\n        }\n        this.enabledDisposables = lifecycle_1.dispose(this.enabledDisposables);\n        this.enabled = false;\n        this.triggered = false;\n    };\n    TypeLabelController.prototype.onInput = function (word) {\n        if (!word) {\n            this.state = TypeLabelControllerState.Idle;\n            this.triggered = false;\n            return;\n        }\n        var focus = this.list.getFocus();\n        var start = focus.length > 0 ? focus[0] : 0;\n        var delta = this.state === TypeLabelControllerState.Idle ? 1 : 0;\n        this.state = TypeLabelControllerState.Typing;\n        for (var i = 0; i < this.list.length; i++) {\n            var index = (start + i + delta) % this.list.length;\n            var label = this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(index));\n            var labelStr = label && label.toString();\n            if (typeof labelStr === 'undefined' || filters_1.matchesPrefix(word, labelStr)) {\n                this.list.setFocus([index]);\n                this.list.reveal(index);\n                return;\n            }\n        }\n    };\n    TypeLabelController.prototype.dispose = function () {\n        this.disable();\n        this.disposables = lifecycle_1.dispose(this.disposables);\n    };\n    return TypeLabelController;\n}());\nvar DOMFocusController = /** @class */ (function () {\n    function DOMFocusController(list, view) {\n        this.list = list;\n        this.view = view;\n        this.disposables = [];\n        this.disposables = [];\n        var onKeyDown = event_1.Event.chain(event_2.domEvent(view.domNode, 'keydown'))\n            .filter(function (e) { return !isInputElement(e.target); })\n            .map(function (e) { return new keyboardEvent_1.StandardKeyboardEvent(e); });\n        onKeyDown.filter(function (e) { return e.keyCode === keyCodes_1.KeyCode.Tab && !e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey; })\n            .on(this.onTab, this, this.disposables);\n    }\n    DOMFocusController.prototype.onTab = function (e) {\n        if (e.target !== this.view.domNode) {\n            return;\n        }\n        var focus = this.list.getFocus();\n        if (focus.length === 0) {\n            return;\n        }\n        var focusedDomElement = this.view.domElement(focus[0]);\n        if (!focusedDomElement) {\n            return;\n        }\n        var tabIndexElement = focusedDomElement.querySelector('[tabIndex]');\n        if (!tabIndexElement || !(tabIndexElement instanceof HTMLElement) || tabIndexElement.tabIndex === -1) {\n            return;\n        }\n        var style = window.getComputedStyle(tabIndexElement);\n        if (style.visibility === 'hidden' || style.display === 'none') {\n            return;\n        }\n        e.preventDefault();\n        e.stopPropagation();\n        tabIndexElement.focus();\n    };\n    DOMFocusController.prototype.dispose = function () {\n        this.disposables = lifecycle_1.dispose(this.disposables);\n    };\n    return DOMFocusController;\n}());\nfunction isSelectionSingleChangeEvent(event) {\n    return browser.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\n}\nexports.isSelectionSingleChangeEvent = isSelectionSingleChangeEvent;\nfunction isSelectionRangeChangeEvent(event) {\n    return event.browserEvent.shiftKey;\n}\nexports.isSelectionRangeChangeEvent = isSelectionRangeChangeEvent;\nfunction isMouseRightClick(event) {\n    return event instanceof MouseEvent && event.button === 2;\n}\nvar DefaultMultipleSelectionContoller = {\n    isSelectionSingleChangeEvent: isSelectionSingleChangeEvent,\n    isSelectionRangeChangeEvent: isSelectionRangeChangeEvent\n};\nvar DefaultOpenController = {\n    shouldOpen: function (event) {\n        if (event instanceof MouseEvent) {\n            return !isMouseRightClick(event);\n        }\n        return true;\n    }\n};\nvar MouseController = /** @class */ (function () {\n    function MouseController(list) {\n        this.list = list;\n        this.disposables = [];\n        this.multipleSelectionSupport = !(list.options.multipleSelectionSupport === false);\n        if (this.multipleSelectionSupport) {\n            this.multipleSelectionController = list.options.multipleSelectionController || DefaultMultipleSelectionContoller;\n        }\n        this.openController = list.options.openController || DefaultOpenController;\n        this.mouseSupport = typeof list.options.mouseSupport === 'undefined' || !!list.options.mouseSupport;\n        if (this.mouseSupport) {\n            list.onMouseDown(this.onMouseDown, this, this.disposables);\n            list.onContextMenu(this.onContextMenu, this, this.disposables);\n            list.onMouseDblClick(this.onDoubleClick, this, this.disposables);\n            list.onTouchStart(this.onMouseDown, this, this.disposables);\n            touch_1.Gesture.addTarget(list.getHTMLElement());\n        }\n        list.onMouseClick(this.onPointer, this, this.disposables);\n        list.onMouseMiddleClick(this.onPointer, this, this.disposables);\n        list.onTap(this.onPointer, this, this.disposables);\n    }\n    MouseController.prototype.isSelectionSingleChangeEvent = function (event) {\n        if (this.multipleSelectionController) {\n            return this.multipleSelectionController.isSelectionSingleChangeEvent(event);\n        }\n        return browser.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\n    };\n    MouseController.prototype.isSelectionRangeChangeEvent = function (event) {\n        if (this.multipleSelectionController) {\n            return this.multipleSelectionController.isSelectionRangeChangeEvent(event);\n        }\n        return event.browserEvent.shiftKey;\n    };\n    MouseController.prototype.isSelectionChangeEvent = function (event) {\n        return this.isSelectionSingleChangeEvent(event) || this.isSelectionRangeChangeEvent(event);\n    };\n    MouseController.prototype.onMouseDown = function (e) {\n        if (document.activeElement !== e.browserEvent.target) {\n            this.list.domFocus();\n        }\n    };\n    MouseController.prototype.onContextMenu = function (e) {\n        var focus = typeof e.index === 'undefined' ? [] : [e.index];\n        this.list.setFocus(focus, e.browserEvent);\n    };\n    MouseController.prototype.onPointer = function (e) {\n        if (!this.mouseSupport) {\n            return;\n        }\n        if (isInputElement(e.browserEvent.target)) {\n            return;\n        }\n        var reference = this.list.getFocus()[0];\n        var selection = this.list.getSelection();\n        reference = reference === undefined ? selection[0] : reference;\n        var focus = e.index;\n        if (typeof focus === 'undefined') {\n            this.list.setFocus([], e.browserEvent);\n            this.list.setSelection([], e.browserEvent);\n            return;\n        }\n        if (this.multipleSelectionSupport && this.isSelectionRangeChangeEvent(e)) {\n            return this.changeSelection(e, reference);\n        }\n        if (this.multipleSelectionSupport && this.isSelectionChangeEvent(e)) {\n            return this.changeSelection(e, reference);\n        }\n        this.list.setFocus([focus], e.browserEvent);\n        if (!isMouseRightClick(e.browserEvent)) {\n            this.list.setSelection([focus], e.browserEvent);\n            if (this.openController.shouldOpen(e.browserEvent)) {\n                this.list.open([focus], e.browserEvent);\n            }\n        }\n    };\n    MouseController.prototype.onDoubleClick = function (e) {\n        if (isInputElement(e.browserEvent.target)) {\n            return;\n        }\n        if (this.multipleSelectionSupport && this.isSelectionChangeEvent(e)) {\n            return;\n        }\n        var focus = this.list.getFocus();\n        this.list.setSelection(focus, e.browserEvent);\n        this.list.pin(focus);\n    };\n    MouseController.prototype.changeSelection = function (e, reference) {\n        var focus = e.index;\n        if (this.isSelectionRangeChangeEvent(e) && reference !== undefined) {\n            var min = Math.min(reference, focus);\n            var max = Math.max(reference, focus);\n            var rangeSelection = arrays_1.range(min, max + 1);\n            var selection = this.list.getSelection();\n            var contiguousRange = getContiguousRangeContaining(disjunction(selection, [reference]), reference);\n            if (contiguousRange.length === 0) {\n                return;\n            }\n            var newSelection = disjunction(rangeSelection, relativeComplement(selection, contiguousRange));\n            this.list.setSelection(newSelection, e.browserEvent);\n        }\n        else if (this.isSelectionSingleChangeEvent(e)) {\n            var selection = this.list.getSelection();\n            var newSelection = selection.filter(function (i) { return i !== focus; });\n            if (selection.length === newSelection.length) {\n                this.list.setSelection(newSelection.concat([focus]), e.browserEvent);\n            }\n            else {\n                this.list.setSelection(newSelection, e.browserEvent);\n            }\n        }\n    };\n    MouseController.prototype.dispose = function () {\n        this.disposables = lifecycle_1.dispose(this.disposables);\n    };\n    return MouseController;\n}());\nexports.MouseController = MouseController;\nvar DefaultStyleController = /** @class */ (function () {\n    function DefaultStyleController(styleElement, selectorSuffix) {\n        this.styleElement = styleElement;\n        this.selectorSuffix = selectorSuffix;\n    }\n    DefaultStyleController.prototype.style = function (styles) {\n        var suffix = this.selectorSuffix ? \".\" + this.selectorSuffix : '';\n        var content = [];\n        if (styles.listFocusBackground) {\n            content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.focused { background-color: \" + styles.listFocusBackground + \"; }\");\n            content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.focused:hover { background-color: \" + styles.listFocusBackground + \"; }\"); // overwrite :hover style in this case!\n        }\n        if (styles.listFocusForeground) {\n            content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.focused { color: \" + styles.listFocusForeground + \"; }\");\n        }\n        if (styles.listActiveSelectionBackground) {\n            content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.selected { background-color: \" + styles.listActiveSelectionBackground + \"; }\");\n            content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.selected:hover { background-color: \" + styles.listActiveSelectionBackground + \"; }\"); // overwrite :hover style in this case!\n        }\n        if (styles.listActiveSelectionForeground) {\n            content.push(\".monaco-list\" + suffix + \":focus .monaco-list-row.selected { color: \" + styles.listActiveSelectionForeground + \"; }\");\n        }\n        if (styles.listFocusAndSelectionBackground) {\n            content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \":focus .monaco-list-row.selected.focused { background-color: \" + styles.listFocusAndSelectionBackground + \"; }\\n\\t\\t\\t\");\n        }\n        if (styles.listFocusAndSelectionForeground) {\n            content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \":focus .monaco-list-row.selected.focused { color: \" + styles.listFocusAndSelectionForeground + \"; }\\n\\t\\t\\t\");\n        }\n        if (styles.listInactiveFocusBackground) {\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.focused { background-color:  \" + styles.listInactiveFocusBackground + \"; }\");\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.focused:hover { background-color:  \" + styles.listInactiveFocusBackground + \"; }\"); // overwrite :hover style in this case!\n        }\n        if (styles.listInactiveSelectionBackground) {\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.selected { background-color:  \" + styles.listInactiveSelectionBackground + \"; }\");\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.selected:hover { background-color:  \" + styles.listInactiveSelectionBackground + \"; }\"); // overwrite :hover style in this case!\n        }\n        if (styles.listInactiveSelectionForeground) {\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.selected { color: \" + styles.listInactiveSelectionForeground + \"; }\");\n        }\n        if (styles.listHoverBackground) {\n            content.push(\".monaco-list\" + suffix + \":not(.drop-target) .monaco-list-row:hover:not(.selected):not(.focused) { background-color:  \" + styles.listHoverBackground + \"; }\");\n        }\n        if (styles.listHoverForeground) {\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row:hover:not(.selected):not(.focused) { color:  \" + styles.listHoverForeground + \"; }\");\n        }\n        if (styles.listSelectionOutline) {\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.selected { outline: 1px dotted \" + styles.listSelectionOutline + \"; outline-offset: -1px; }\");\n        }\n        if (styles.listFocusOutline) {\n            content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \":focus .monaco-list-row.focused { outline: 1px solid \" + styles.listFocusOutline + \"; outline-offset: -1px; }\\n\\t\\t\\t\");\n        }\n        if (styles.listInactiveFocusOutline) {\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row.focused { outline: 1px dotted \" + styles.listInactiveFocusOutline + \"; outline-offset: -1px; }\");\n        }\n        if (styles.listHoverOutline) {\n            content.push(\".monaco-list\" + suffix + \" .monaco-list-row:hover { outline: 1px dashed \" + styles.listHoverOutline + \"; outline-offset: -1px; }\");\n        }\n        if (styles.listDropBackground) {\n            content.push(\"\\n\\t\\t\\t\\t.monaco-list\" + suffix + \".drop-target,\\n\\t\\t\\t\\t.monaco-list\" + suffix + \" .monaco-list-row.drop-target { background-color: \" + styles.listDropBackground + \" !important; color: inherit !important; }\\n\\t\\t\\t\");\n        }\n        if (styles.listFilterWidgetBackground) {\n            content.push(\".monaco-list-type-filter { background-color: \" + styles.listFilterWidgetBackground + \" }\");\n        }\n        if (styles.listFilterWidgetOutline) {\n            content.push(\".monaco-list-type-filter { border: 1px solid \" + styles.listFilterWidgetOutline + \"; }\");\n        }\n        if (styles.listFilterWidgetNoMatchesOutline) {\n            content.push(\".monaco-list-type-filter.no-matches { border: 1px solid \" + styles.listFilterWidgetNoMatchesOutline + \"; }\");\n        }\n        if (styles.listMatchesShadow) {\n            content.push(\".monaco-list-type-filter { box-shadow: 1px 1px 1px \" + styles.listMatchesShadow + \"; }\");\n        }\n        var newStyles = content.join('\\n');\n        if (newStyles !== this.styleElement.innerHTML) {\n            this.styleElement.innerHTML = newStyles;\n        }\n    };\n    return DefaultStyleController;\n}());\nexports.DefaultStyleController = DefaultStyleController;\nvar defaultStyles = {\n    listFocusBackground: color_1.Color.fromHex('#073655'),\n    listActiveSelectionBackground: color_1.Color.fromHex('#0E639C'),\n    listActiveSelectionForeground: color_1.Color.fromHex('#FFFFFF'),\n    listFocusAndSelectionBackground: color_1.Color.fromHex('#094771'),\n    listFocusAndSelectionForeground: color_1.Color.fromHex('#FFFFFF'),\n    listInactiveSelectionBackground: color_1.Color.fromHex('#3F3F46'),\n    listHoverBackground: color_1.Color.fromHex('#2A2D2E'),\n    listDropBackground: color_1.Color.fromHex('#383B3D')\n};\nvar DefaultOptions = {\n    keyboardSupport: true,\n    mouseSupport: true,\n    multipleSelectionSupport: true,\n    dnd: {\n        getDragURI: function () { return null; },\n        onDragStart: function () { },\n        onDragOver: function () { return false; },\n        drop: function () { }\n    },\n    ariaRootRole: list_1.ListAriaRootRole.TREE\n};\n// TODO@Joao: move these utils into a SortedArray class\nfunction getContiguousRangeContaining(range, value) {\n    var index = range.indexOf(value);\n    if (index === -1) {\n        return [];\n    }\n    var result = [];\n    var i = index - 1;\n    while (i >= 0 && range[i] === value - (index - i)) {\n        result.push(range[i--]);\n    }\n    result.reverse();\n    i = index;\n    while (i < range.length && range[i] === value + (i - index)) {\n        result.push(range[i++]);\n    }\n    return result;\n}\n/**\n * Given two sorted collections of numbers, returns the intersection\n * betweem them (OR).\n */\nfunction disjunction(one, other) {\n    var result = [];\n    var i = 0, j = 0;\n    while (i < one.length || j < other.length) {\n        if (i >= one.length) {\n            result.push(other[j++]);\n        }\n        else if (j >= other.length) {\n            result.push(one[i++]);\n        }\n        else if (one[i] === other[j]) {\n            result.push(one[i]);\n            i++;\n            j++;\n            continue;\n        }\n        else if (one[i] < other[j]) {\n            result.push(one[i++]);\n        }\n        else {\n            result.push(other[j++]);\n        }\n    }\n    return result;\n}\n/**\n * Given two sorted collections of numbers, returns the relative\n * complement between them (XOR).\n */\nfunction relativeComplement(one, other) {\n    var result = [];\n    var i = 0, j = 0;\n    while (i < one.length || j < other.length) {\n        if (i >= one.length) {\n            result.push(other[j++]);\n        }\n        else if (j >= other.length) {\n            result.push(one[i++]);\n        }\n        else if (one[i] === other[j]) {\n            i++;\n            j++;\n            continue;\n        }\n        else if (one[i] < other[j]) {\n            result.push(one[i++]);\n        }\n        else {\n            j++;\n        }\n    }\n    return result;\n}\nvar numericSort = function (a, b) { return a - b; };\nvar PipelineRenderer = /** @class */ (function () {\n    function PipelineRenderer(_templateId, renderers) {\n        this._templateId = _templateId;\n        this.renderers = renderers;\n    }\n    Object.defineProperty(PipelineRenderer.prototype, \"templateId\", {\n        get: function () {\n            return this._templateId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    PipelineRenderer.prototype.renderTemplate = function (container) {\n        return this.renderers.map(function (r) { return r.renderTemplate(container); });\n    };\n    PipelineRenderer.prototype.renderElement = function (element, index, templateData, dynamicHeightProbing) {\n        var i = 0;\n        for (var _i = 0, _a = this.renderers; _i < _a.length; _i++) {\n            var renderer = _a[_i];\n            renderer.renderElement(element, index, templateData[i++], dynamicHeightProbing);\n        }\n    };\n    PipelineRenderer.prototype.disposeElement = function (element, index, templateData, dynamicHeightProbing) {\n        var i = 0;\n        for (var _i = 0, _a = this.renderers; _i < _a.length; _i++) {\n            var renderer = _a[_i];\n            if (renderer.disposeElement) {\n                renderer.disposeElement(element, index, templateData[i], dynamicHeightProbing);\n            }\n            i += 1;\n        }\n    };\n    PipelineRenderer.prototype.disposeTemplate = function (templateData) {\n        var i = 0;\n        for (var _i = 0, _a = this.renderers; _i < _a.length; _i++) {\n            var renderer = _a[_i];\n            renderer.disposeTemplate(templateData[i++]);\n        }\n    };\n    return PipelineRenderer;\n}());\nvar AccessibiltyRenderer = /** @class */ (function () {\n    function AccessibiltyRenderer(accessibilityProvider) {\n        this.accessibilityProvider = accessibilityProvider;\n        this.templateId = 'a18n';\n    }\n    AccessibiltyRenderer.prototype.renderTemplate = function (container) {\n        return container;\n    };\n    AccessibiltyRenderer.prototype.renderElement = function (element, index, container) {\n        var ariaLabel = this.accessibilityProvider.getAriaLabel(element);\n        if (ariaLabel) {\n            container.setAttribute('aria-label', ariaLabel);\n        }\n        else {\n            container.removeAttribute('aria-label');\n        }\n        var ariaLevel = this.accessibilityProvider.getAriaLevel && this.accessibilityProvider.getAriaLevel(element);\n        if (typeof ariaLevel === 'number') {\n            container.setAttribute('aria-level', \"\" + ariaLevel);\n        }\n        else {\n            container.removeAttribute('aria-level');\n        }\n    };\n    AccessibiltyRenderer.prototype.disposeTemplate = function (templateData) {\n        // noop\n    };\n    return AccessibiltyRenderer;\n}());\nvar ListViewDragAndDrop = /** @class */ (function () {\n    function ListViewDragAndDrop(list, dnd) {\n        this.list = list;\n        this.dnd = dnd;\n    }\n    ListViewDragAndDrop.prototype.getDragElements = function (element) {\n        var selection = this.list.getSelectedElements();\n        var elements = selection.indexOf(element) > -1 ? selection : [element];\n        return elements;\n    };\n    ListViewDragAndDrop.prototype.getDragURI = function (element) {\n        return this.dnd.getDragURI(element);\n    };\n    ListViewDragAndDrop.prototype.getDragLabel = function (elements) {\n        if (this.dnd.getDragLabel) {\n            return this.dnd.getDragLabel(elements);\n        }\n        return undefined;\n    };\n    ListViewDragAndDrop.prototype.onDragStart = function (data, originalEvent) {\n        if (this.dnd.onDragStart) {\n            this.dnd.onDragStart(data, originalEvent);\n        }\n    };\n    ListViewDragAndDrop.prototype.onDragOver = function (data, targetElement, targetIndex, originalEvent) {\n        return this.dnd.onDragOver(data, targetElement, targetIndex, originalEvent);\n    };\n    ListViewDragAndDrop.prototype.drop = function (data, targetElement, targetIndex, originalEvent) {\n        this.dnd.drop(data, targetElement, targetIndex, originalEvent);\n    };\n    return ListViewDragAndDrop;\n}());\nvar List = /** @class */ (function () {\n    function List(container, virtualDelegate, renderers, _options) {\n        if (_options === void 0) { _options = DefaultOptions; }\n        this._options = _options;\n        this.eventBufferer = new event_1.EventBufferer();\n        this._onDidOpen = new event_1.Emitter();\n        this.onDidOpen = this._onDidOpen.event;\n        this._onPin = new event_1.Emitter();\n        this.didJustPressContextMenuKey = false;\n        this._onDidDispose = new event_1.Emitter();\n        this.focus = new FocusTrait();\n        this.selection = new Trait('selected');\n        objects_1.mixin(_options, defaultStyles, false);\n        var baseRenderers = [this.focus.renderer, this.selection.renderer];\n        if (_options.accessibilityProvider) {\n            baseRenderers.push(new AccessibiltyRenderer(_options.accessibilityProvider));\n        }\n        renderers = renderers.map(function (r) { return new PipelineRenderer(r.templateId, baseRenderers.concat([r])); });\n        var viewOptions = tslib_1.__assign({}, _options, { dnd: _options.dnd && new ListViewDragAndDrop(this, _options.dnd) });\n        this.view = new listView_1.ListView(container, virtualDelegate, renderers, viewOptions);\n        if (typeof _options.ariaRole !== 'string') {\n            this.view.domNode.setAttribute('role', list_1.ListAriaRootRole.TREE);\n        }\n        else {\n            this.view.domNode.setAttribute('role', _options.ariaRole);\n        }\n        this.styleElement = DOM.createStyleSheet(this.view.domNode);\n        this.styleController = _options.styleController || new DefaultStyleController(this.styleElement, this.view.domId);\n        this.spliceable = new splice_1.CombinedSpliceable([\n            new TraitSpliceable(this.focus, this.view, _options.identityProvider),\n            new TraitSpliceable(this.selection, this.view, _options.identityProvider),\n            this.view\n        ]);\n        this.disposables = [this.focus, this.selection, this.view, this._onDidDispose];\n        this.onDidFocus = event_1.Event.map(event_2.domEvent(this.view.domNode, 'focus', true), function () { return null; });\n        this.onDidBlur = event_1.Event.map(event_2.domEvent(this.view.domNode, 'blur', true), function () { return null; });\n        this.disposables.push(new DOMFocusController(this, this.view));\n        if (typeof _options.keyboardSupport !== 'boolean' || _options.keyboardSupport) {\n            var controller = new KeyboardController(this, this.view, _options);\n            this.disposables.push(controller);\n        }\n        if (_options.keyboardNavigationLabelProvider) {\n            this.typeLabelController = new TypeLabelController(this, this.view, _options.keyboardNavigationLabelProvider);\n            this.disposables.push(this.typeLabelController);\n        }\n        this.disposables.push(this.createMouseController(_options));\n        this.onFocusChange(this._onFocusChange, this, this.disposables);\n        this.onSelectionChange(this._onSelectionChange, this, this.disposables);\n        if (_options.ariaLabel) {\n            this.view.domNode.setAttribute('aria-label', nls_1.localize('aria list', \"{0}. Use the navigation keys to navigate.\", _options.ariaLabel));\n        }\n        this.style(_options);\n    }\n    Object.defineProperty(List.prototype, \"onFocusChange\", {\n        get: function () {\n            var _this = this;\n            return event_1.Event.map(this.eventBufferer.wrapEvent(this.focus.onChange), function (e) { return _this.toListEvent(e); });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onSelectionChange\", {\n        get: function () {\n            var _this = this;\n            return event_1.Event.map(this.eventBufferer.wrapEvent(this.selection.onChange), function (e) { return _this.toListEvent(e); });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onPin\", {\n        get: function () {\n            var _this = this;\n            return event_1.Event.map(this._onPin.event, function (indexes) { return _this.toListEvent({ indexes: indexes }); });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onDidScroll\", {\n        get: function () { return this.view.onDidScroll; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onMouseClick\", {\n        get: function () { return this.view.onMouseClick; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onMouseDblClick\", {\n        get: function () { return this.view.onMouseDblClick; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onMouseMiddleClick\", {\n        get: function () { return this.view.onMouseMiddleClick; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onMouseUp\", {\n        get: function () { return this.view.onMouseUp; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onMouseDown\", {\n        get: function () { return this.view.onMouseDown; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onMouseOver\", {\n        get: function () { return this.view.onMouseOver; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onMouseMove\", {\n        get: function () { return this.view.onMouseMove; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onMouseOut\", {\n        get: function () { return this.view.onMouseOut; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onTouchStart\", {\n        get: function () { return this.view.onTouchStart; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onTap\", {\n        get: function () { return this.view.onTap; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onContextMenu\", {\n        get: function () {\n            var _this = this;\n            var fromKeydown = event_1.Event.chain(event_2.domEvent(this.view.domNode, 'keydown'))\n                .map(function (e) { return new keyboardEvent_1.StandardKeyboardEvent(e); })\n                .filter(function (e) { return _this.didJustPressContextMenuKey = e.keyCode === keyCodes_1.KeyCode.ContextMenu || (e.shiftKey && e.keyCode === keyCodes_1.KeyCode.F10); })\n                .filter(function (e) { e.preventDefault(); e.stopPropagation(); return false; })\n                .event;\n            var fromKeyup = event_1.Event.chain(event_2.domEvent(this.view.domNode, 'keyup'))\n                .filter(function () {\n                var didJustPressContextMenuKey = _this.didJustPressContextMenuKey;\n                _this.didJustPressContextMenuKey = false;\n                return didJustPressContextMenuKey;\n            })\n                .filter(function () { return _this.getFocus().length > 0 && !!_this.view.domElement(_this.getFocus()[0]); })\n                .map(function (browserEvent) {\n                var index = _this.getFocus()[0];\n                var element = _this.view.element(index);\n                var anchor = _this.view.domElement(index);\n                return { index: index, element: element, anchor: anchor, browserEvent: browserEvent };\n            })\n                .event;\n            var fromMouse = event_1.Event.chain(this.view.onContextMenu)\n                .filter(function () { return !_this.didJustPressContextMenuKey; })\n                .map(function (_a) {\n                var element = _a.element, index = _a.index, browserEvent = _a.browserEvent;\n                return ({ element: element, index: index, anchor: { x: browserEvent.clientX + 1, y: browserEvent.clientY }, browserEvent: browserEvent });\n            })\n                .event;\n            return event_1.Event.any(fromKeydown, fromKeyup, fromMouse);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onKeyDown\", {\n        get: function () { return event_2.domEvent(this.view.domNode, 'keydown'); },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onKeyUp\", {\n        get: function () { return event_2.domEvent(this.view.domNode, 'keyup'); },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onKeyPress\", {\n        get: function () { return event_2.domEvent(this.view.domNode, 'keypress'); },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onDidDispose\", {\n        get: function () { return this._onDidDispose.event; },\n        enumerable: true,\n        configurable: true\n    });\n    List.prototype.createMouseController = function (options) {\n        return new MouseController(this);\n    };\n    List.prototype.updateOptions = function (optionsUpdate) {\n        if (optionsUpdate === void 0) { optionsUpdate = {}; }\n        this._options = tslib_1.__assign({}, this._options, optionsUpdate);\n        if (this.typeLabelController) {\n            this.typeLabelController.updateOptions(this._options);\n        }\n    };\n    Object.defineProperty(List.prototype, \"options\", {\n        get: function () {\n            return this._options;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    List.prototype.splice = function (start, deleteCount, elements) {\n        var _this = this;\n        if (elements === void 0) { elements = []; }\n        if (start < 0 || start > this.view.length) {\n            throw new Error(\"Invalid start index: \" + start);\n        }\n        if (deleteCount < 0) {\n            throw new Error(\"Invalid delete count: \" + deleteCount);\n        }\n        if (deleteCount === 0 && elements.length === 0) {\n            return;\n        }\n        this.eventBufferer.bufferEvents(function () { return _this.spliceable.splice(start, deleteCount, elements); });\n    };\n    List.prototype.updateWidth = function (index) {\n        this.view.updateWidth(index);\n    };\n    List.prototype.rerender = function () {\n        this.view.rerender();\n    };\n    List.prototype.element = function (index) {\n        return this.view.element(index);\n    };\n    Object.defineProperty(List.prototype, \"length\", {\n        get: function () {\n            return this.view.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"contentHeight\", {\n        get: function () {\n            return this.view.contentHeight;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"onDidChangeContentHeight\", {\n        get: function () {\n            return this.view.onDidChangeContentHeight;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"scrollTop\", {\n        get: function () {\n            return this.view.getScrollTop();\n        },\n        set: function (scrollTop) {\n            this.view.setScrollTop(scrollTop);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"scrollHeight\", {\n        get: function () {\n            return this.view.scrollHeight;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"renderHeight\", {\n        get: function () {\n            return this.view.renderHeight;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"firstVisibleIndex\", {\n        get: function () {\n            return this.view.firstVisibleIndex;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(List.prototype, \"lastVisibleIndex\", {\n        get: function () {\n            return this.view.lastVisibleIndex;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    List.prototype.domFocus = function () {\n        this.view.domNode.focus();\n    };\n    List.prototype.layout = function (height, width) {\n        this.view.layout(height, width);\n    };\n    List.prototype.toggleKeyboardNavigation = function () {\n        if (this.typeLabelController) {\n            this.typeLabelController.toggle();\n        }\n    };\n    List.prototype.setSelection = function (indexes, browserEvent) {\n        for (var _i = 0, indexes_1 = indexes; _i < indexes_1.length; _i++) {\n            var index = indexes_1[_i];\n            if (index < 0 || index >= this.length) {\n                throw new Error(\"Invalid index \" + index);\n            }\n        }\n        this.selection.set(indexes, browserEvent);\n    };\n    List.prototype.getSelection = function () {\n        return this.selection.get();\n    };\n    List.prototype.getSelectedElements = function () {\n        var _this = this;\n        return this.getSelection().map(function (i) { return _this.view.element(i); });\n    };\n    List.prototype.setFocus = function (indexes, browserEvent) {\n        for (var _i = 0, indexes_2 = indexes; _i < indexes_2.length; _i++) {\n            var index = indexes_2[_i];\n            if (index < 0 || index >= this.length) {\n                throw new Error(\"Invalid index \" + index);\n            }\n        }\n        this.focus.set(indexes, browserEvent);\n    };\n    List.prototype.focusNext = function (n, loop, browserEvent, filter) {\n        if (n === void 0) { n = 1; }\n        if (loop === void 0) { loop = false; }\n        if (this.length === 0) {\n            return;\n        }\n        var focus = this.focus.get();\n        var index = this.findNextIndex(focus.length > 0 ? focus[0] + n : 0, loop, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    };\n    List.prototype.focusPrevious = function (n, loop, browserEvent, filter) {\n        if (n === void 0) { n = 1; }\n        if (loop === void 0) { loop = false; }\n        if (this.length === 0) {\n            return;\n        }\n        var focus = this.focus.get();\n        var index = this.findPreviousIndex(focus.length > 0 ? focus[0] - n : 0, loop, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    };\n    List.prototype.focusNextPage = function (browserEvent, filter) {\n        var _this = this;\n        var lastPageIndex = this.view.indexAt(this.view.getScrollTop() + this.view.renderHeight);\n        lastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\n        var lastPageElement = this.view.element(lastPageIndex);\n        var currentlyFocusedElement = this.getFocusedElements()[0];\n        if (currentlyFocusedElement !== lastPageElement) {\n            var lastGoodPageIndex = this.findPreviousIndex(lastPageIndex, false, filter);\n            if (lastGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(lastGoodPageIndex)) {\n                this.setFocus([lastGoodPageIndex], browserEvent);\n            }\n            else {\n                this.setFocus([lastPageIndex], browserEvent);\n            }\n        }\n        else {\n            var previousScrollTop = this.view.getScrollTop();\n            this.view.setScrollTop(previousScrollTop + this.view.renderHeight - this.view.elementHeight(lastPageIndex));\n            if (this.view.getScrollTop() !== previousScrollTop) {\n                // Let the scroll event listener run\n                setTimeout(function () { return _this.focusNextPage(browserEvent, filter); }, 0);\n            }\n        }\n    };\n    List.prototype.focusPreviousPage = function (browserEvent, filter) {\n        var _this = this;\n        var firstPageIndex;\n        var scrollTop = this.view.getScrollTop();\n        if (scrollTop === 0) {\n            firstPageIndex = this.view.indexAt(scrollTop);\n        }\n        else {\n            firstPageIndex = this.view.indexAfter(scrollTop - 1);\n        }\n        var firstPageElement = this.view.element(firstPageIndex);\n        var currentlyFocusedElement = this.getFocusedElements()[0];\n        if (currentlyFocusedElement !== firstPageElement) {\n            var firstGoodPageIndex = this.findNextIndex(firstPageIndex, false, filter);\n            if (firstGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(firstGoodPageIndex)) {\n                this.setFocus([firstGoodPageIndex], browserEvent);\n            }\n            else {\n                this.setFocus([firstPageIndex], browserEvent);\n            }\n        }\n        else {\n            var previousScrollTop = scrollTop;\n            this.view.setScrollTop(scrollTop - this.view.renderHeight);\n            if (this.view.getScrollTop() !== previousScrollTop) {\n                // Let the scroll event listener run\n                setTimeout(function () { return _this.focusPreviousPage(browserEvent, filter); }, 0);\n            }\n        }\n    };\n    List.prototype.focusLast = function (browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        var index = this.findPreviousIndex(this.length - 1, false, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    };\n    List.prototype.focusFirst = function (browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        var index = this.findNextIndex(0, false, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    };\n    List.prototype.findNextIndex = function (index, loop, filter) {\n        if (loop === void 0) { loop = false; }\n        for (var i = 0; i < this.length; i++) {\n            if (index >= this.length && !loop) {\n                return -1;\n            }\n            index = index % this.length;\n            if (!filter || filter(this.element(index))) {\n                return index;\n            }\n            index++;\n        }\n        return -1;\n    };\n    List.prototype.findPreviousIndex = function (index, loop, filter) {\n        if (loop === void 0) { loop = false; }\n        for (var i = 0; i < this.length; i++) {\n            if (index < 0 && !loop) {\n                return -1;\n            }\n            index = (this.length + (index % this.length)) % this.length;\n            if (!filter || filter(this.element(index))) {\n                return index;\n            }\n            index--;\n        }\n        return -1;\n    };\n    List.prototype.getFocus = function () {\n        return this.focus.get();\n    };\n    List.prototype.getFocusedElements = function () {\n        var _this = this;\n        return this.getFocus().map(function (i) { return _this.view.element(i); });\n    };\n    List.prototype.reveal = function (index, relativeTop) {\n        if (index < 0 || index >= this.length) {\n            throw new Error(\"Invalid index \" + index);\n        }\n        var scrollTop = this.view.getScrollTop();\n        var elementTop = this.view.elementTop(index);\n        var elementHeight = this.view.elementHeight(index);\n        if (types_1.isNumber(relativeTop)) {\n            // y = mx + b\n            var m = elementHeight - this.view.renderHeight;\n            this.view.setScrollTop(m * numbers_1.clamp(relativeTop, 0, 1) + elementTop);\n        }\n        else {\n            var viewItemBottom = elementTop + elementHeight;\n            var wrapperBottom = scrollTop + this.view.renderHeight;\n            if (elementTop < scrollTop) {\n                this.view.setScrollTop(elementTop);\n            }\n            else if (viewItemBottom >= wrapperBottom) {\n                this.view.setScrollTop(viewItemBottom - this.view.renderHeight);\n            }\n        }\n    };\n    /**\n     * Returns the relative position of an element rendered in the list.\n     * Returns `null` if the element isn't *entirely* in the visible viewport.\n     */\n    List.prototype.getRelativeTop = function (index) {\n        if (index < 0 || index >= this.length) {\n            throw new Error(\"Invalid index \" + index);\n        }\n        var scrollTop = this.view.getScrollTop();\n        var elementTop = this.view.elementTop(index);\n        var elementHeight = this.view.elementHeight(index);\n        if (elementTop < scrollTop || elementTop + elementHeight > scrollTop + this.view.renderHeight) {\n            return null;\n        }\n        // y = mx + b\n        var m = elementHeight - this.view.renderHeight;\n        return Math.abs((scrollTop - elementTop) / m);\n    };\n    List.prototype.isDOMFocused = function () {\n        return this.view.domNode === document.activeElement;\n    };\n    List.prototype.getHTMLElement = function () {\n        return this.view.domNode;\n    };\n    List.prototype.open = function (indexes, browserEvent) {\n        var _this = this;\n        for (var _i = 0, indexes_3 = indexes; _i < indexes_3.length; _i++) {\n            var index = indexes_3[_i];\n            if (index < 0 || index >= this.length) {\n                throw new Error(\"Invalid index \" + index);\n            }\n        }\n        this._onDidOpen.fire({ indexes: indexes, elements: indexes.map(function (i) { return _this.view.element(i); }), browserEvent: browserEvent });\n    };\n    List.prototype.pin = function (indexes) {\n        for (var _i = 0, indexes_4 = indexes; _i < indexes_4.length; _i++) {\n            var index = indexes_4[_i];\n            if (index < 0 || index >= this.length) {\n                throw new Error(\"Invalid index \" + index);\n            }\n        }\n        this._onPin.fire(indexes);\n    };\n    List.prototype.style = function (styles) {\n        this.styleController.style(styles);\n    };\n    List.prototype.toListEvent = function (_a) {\n        var _this = this;\n        var indexes = _a.indexes, browserEvent = _a.browserEvent;\n        return { indexes: indexes, elements: indexes.map(function (i) { return _this.view.element(i); }), browserEvent: browserEvent };\n    };\n    List.prototype._onFocusChange = function () {\n        var focus = this.focus.get();\n        if (focus.length > 0) {\n            this.view.domNode.setAttribute('aria-activedescendant', this.view.getElementDomId(focus[0]));\n        }\n        else {\n            this.view.domNode.removeAttribute('aria-activedescendant');\n        }\n        this.view.domNode.setAttribute('role', 'tree');\n        DOM.toggleClass(this.view.domNode, 'element-focused', focus.length > 0);\n    };\n    List.prototype._onSelectionChange = function () {\n        var selection = this.selection.get();\n        DOM.toggleClass(this.view.domNode, 'selection-none', selection.length === 0);\n        DOM.toggleClass(this.view.domNode, 'selection-single', selection.length === 1);\n        DOM.toggleClass(this.view.domNode, 'selection-multiple', selection.length > 1);\n    };\n    List.prototype.dispose = function () {\n        this._onDidDispose.fire();\n        this.disposables = lifecycle_1.dispose(this.disposables);\n        this._onDidOpen.dispose();\n        this._onPin.dispose();\n        this._onDidDispose.dispose();\n    };\n    tslib_1.__decorate([\n        decorators_1.memoize\n    ], List.prototype, \"onFocusChange\", null);\n    tslib_1.__decorate([\n        decorators_1.memoize\n    ], List.prototype, \"onSelectionChange\", null);\n    tslib_1.__decorate([\n        decorators_1.memoize\n    ], List.prototype, \"onPin\", null);\n    tslib_1.__decorate([\n        decorators_1.memoize\n    ], List.prototype, \"onContextMenu\", null);\n    return List;\n}());\nexports.List = List;\n",{"version":3,"file":"/home/coding/workspace/lib/vscode/src/vs/base/browser/ui/list/listWidget.ts","sourceRoot":"","sources":["/home/coding/workspace/lib/vscode/src/vs/base/browser/ui/list/listWidget.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./list';\nimport { localize } from 'vs/nls';\nimport { IDisposable, dispose } from 'vs/base/common/lifecycle';\nimport { isNumber } from 'vs/base/common/types';\nimport { range, firstIndex, binarySearch } from 'vs/base/common/arrays';\nimport { memoize } from 'vs/base/common/decorators';\nimport * as DOM from 'vs/base/browser/dom';\nimport * as browser from 'vs/base/browser/browser';\nimport { Gesture } from 'vs/base/browser/touch';\nimport { KeyCode } from 'vs/base/common/keyCodes';\nimport { StandardKeyboardEvent, IKeyboardEvent } from 'vs/base/browser/keyboardEvent';\nimport { Event, Emitter, EventBufferer } from 'vs/base/common/event';\nimport { domEvent } from 'vs/base/browser/event';\nimport { IListVirtualDelegate, IListRenderer, IListEvent, IListContextMenuEvent, IListMouseEvent, IListTouchEvent, IListGestureEvent, IIdentityProvider, IKeyboardNavigationLabelProvider, IListDragAndDrop, IListDragOverReaction, ListAriaRootRole } from './list';\nimport { ListView, IListViewOptions, IListViewDragAndDrop, IAriaSetProvider } from './listView';\nimport { Color } from 'vs/base/common/color';\nimport { mixin } from 'vs/base/common/objects';\nimport { ScrollbarVisibility, ScrollEvent } from 'vs/base/common/scrollable';\nimport { ISpliceable } from 'vs/base/common/sequence';\nimport { CombinedSpliceable } from 'vs/base/browser/ui/list/splice';\nimport { clamp } from 'vs/base/common/numbers';\nimport { matchesPrefix } from 'vs/base/common/filters';\nimport { IDragAndDropData } from 'vs/base/browser/dnd';\n\ninterface ITraitChangeEvent {\n\tindexes: number[];\n\tbrowserEvent?: UIEvent;\n}\n\ntype ITraitTemplateData = HTMLElement;\n\ninterface IRenderedContainer {\n\ttemplateData: ITraitTemplateData;\n\tindex: number;\n}\n\nclass TraitRenderer<T> implements IListRenderer<T, ITraitTemplateData>\n{\n\tprivate renderedElements: IRenderedContainer[] = [];\n\n\tconstructor(private trait: Trait<T>) { }\n\n\tget templateId(): string {\n\t\treturn `template:${this.trait.trait}`;\n\t}\n\n\trenderTemplate(container: HTMLElement): ITraitTemplateData {\n\t\treturn container;\n\t}\n\n\trenderElement(element: T, index: number, templateData: ITraitTemplateData): void {\n\t\tconst renderedElementIndex = firstIndex(this.renderedElements, el => el.templateData === templateData);\n\n\t\tif (renderedElementIndex >= 0) {\n\t\t\tconst rendered = this.renderedElements[renderedElementIndex];\n\t\t\tthis.trait.unrender(templateData);\n\t\t\trendered.index = index;\n\t\t} else {\n\t\t\tconst rendered = { index, templateData };\n\t\t\tthis.renderedElements.push(rendered);\n\t\t}\n\n\t\tthis.trait.renderIndex(index, templateData);\n\t}\n\n\tsplice(start: number, deleteCount: number, insertCount: number): void {\n\t\tconst rendered: IRenderedContainer[] = [];\n\n\t\tfor (const renderedElement of this.renderedElements) {\n\n\t\t\tif (renderedElement.index < start) {\n\t\t\t\trendered.push(renderedElement);\n\t\t\t} else if (renderedElement.index >= start + deleteCount) {\n\t\t\t\trendered.push({\n\t\t\t\t\tindex: renderedElement.index + insertCount - deleteCount,\n\t\t\t\t\ttemplateData: renderedElement.templateData\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.renderedElements = rendered;\n\t}\n\n\trenderIndexes(indexes: number[]): void {\n\t\tfor (const { index, templateData } of this.renderedElements) {\n\t\t\tif (indexes.indexOf(index) > -1) {\n\t\t\t\tthis.trait.renderIndex(index, templateData);\n\t\t\t}\n\t\t}\n\t}\n\n\tdisposeTemplate(templateData: ITraitTemplateData): void {\n\t\tconst index = firstIndex(this.renderedElements, el => el.templateData === templateData);\n\n\t\tif (index < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.renderedElements.splice(index, 1);\n\t}\n}\n\nclass Trait<T> implements ISpliceable<boolean>, IDisposable {\n\n\tprivate indexes: number[] = [];\n\tprivate sortedIndexes: number[] = [];\n\n\tprivate _onChange = new Emitter<ITraitChangeEvent>();\n\tget onChange(): Event<ITraitChangeEvent> { return this._onChange.event; }\n\n\tget trait(): string { return this._trait; }\n\n\t@memoize\n\tget renderer(): TraitRenderer<T> {\n\t\treturn new TraitRenderer<T>(this);\n\t}\n\n\tconstructor(private _trait: string) { }\n\n\tsplice(start: number, deleteCount: number, elements: boolean[]): void {\n\t\tconst diff = elements.length - deleteCount;\n\t\tconst end = start + deleteCount;\n\t\tconst indexes = [\n\t\t\t...this.sortedIndexes.filter(i => i < start),\n\t\t\t...elements.map((hasTrait, i) => hasTrait ? i + start : -1).filter(i => i !== -1),\n\t\t\t...this.sortedIndexes.filter(i => i >= end).map(i => i + diff)\n\t\t];\n\n\t\tthis.renderer.splice(start, deleteCount, elements.length);\n\t\tthis._set(indexes, indexes);\n\t}\n\n\trenderIndex(index: number, container: HTMLElement): void {\n\t\tDOM.toggleClass(container, this._trait, this.contains(index));\n\t}\n\n\tunrender(container: HTMLElement): void {\n\t\tDOM.removeClass(container, this._trait);\n\t}\n\n\t/**\n\t * Sets the indexes which should have this trait.\n\t *\n\t * @param indexes Indexes which should have this trait.\n\t * @return The old indexes which had this trait.\n\t */\n\tset(indexes: number[], browserEvent?: UIEvent): number[] {\n\t\treturn this._set(indexes, [...indexes].sort(numericSort), browserEvent);\n\t}\n\n\tprivate _set(indexes: number[], sortedIndexes: number[], browserEvent?: UIEvent): number[] {\n\t\tconst result = this.indexes;\n\t\tconst sortedResult = this.sortedIndexes;\n\n\t\tthis.indexes = indexes;\n\t\tthis.sortedIndexes = sortedIndexes;\n\n\t\tconst toRender = disjunction(sortedResult, indexes);\n\t\tthis.renderer.renderIndexes(toRender);\n\n\t\tthis._onChange.fire({ indexes, browserEvent });\n\t\treturn result;\n\t}\n\n\tget(): number[] {\n\t\treturn this.indexes;\n\t}\n\n\tcontains(index: number): boolean {\n\t\treturn binarySearch(this.sortedIndexes, index, numericSort) >= 0;\n\t}\n\n\tdispose() {\n\t\tthis._onChange = dispose(this._onChange);\n\t}\n}\n\nclass FocusTrait<T> extends Trait<T> {\n\n\tconstructor() {\n\t\tsuper('focused');\n\t}\n\n\trenderIndex(index: number, container: HTMLElement): void {\n\t\tsuper.renderIndex(index, container);\n\n\t\tif (this.contains(index)) {\n\t\t\tcontainer.setAttribute('aria-selected', 'true');\n\t\t} else {\n\t\t\tcontainer.removeAttribute('aria-selected');\n\t\t}\n\t}\n}\n\n/**\n * The TraitSpliceable is used as a util class to be able\n * to preserve traits across splice calls, given an identity\n * provider.\n */\nclass TraitSpliceable<T> implements ISpliceable<T> {\n\n\tconstructor(\n\t\tprivate trait: Trait<T>,\n\t\tprivate view: ListView<T>,\n\t\tprivate identityProvider?: IIdentityProvider<T>\n\t) { }\n\n\tsplice(start: number, deleteCount: number, elements: T[]): void {\n\t\tif (!this.identityProvider) {\n\t\t\treturn this.trait.splice(start, deleteCount, elements.map(() => false));\n\t\t}\n\n\t\tconst pastElementsWithTrait = this.trait.get().map(i => this.identityProvider!.getId(this.view.element(i)).toString());\n\t\tconst elementsWithTrait = elements.map(e => pastElementsWithTrait.indexOf(this.identityProvider!.getId(e).toString()) > -1);\n\n\t\tthis.trait.splice(start, deleteCount, elementsWithTrait);\n\t}\n}\n\nfunction isInputElement(e: HTMLElement): boolean {\n\treturn e.tagName === 'INPUT' || e.tagName === 'TEXTAREA';\n}\n\nclass KeyboardController<T> implements IDisposable {\n\n\tprivate disposables: IDisposable[];\n\tprivate openController: IOpenController;\n\n\tconstructor(\n\t\tprivate list: List<T>,\n\t\tprivate view: ListView<T>,\n\t\toptions: IListOptions<T>\n\t) {\n\t\tconst multipleSelectionSupport = !(options.multipleSelectionSupport === false);\n\t\tthis.disposables = [];\n\n\t\tthis.openController = options.openController || DefaultOpenController;\n\n\t\tconst onKeyDown = Event.chain(domEvent(view.domNode, 'keydown'))\n\t\t\t.filter(e => !isInputElement(e.target as HTMLElement))\n\t\t\t.map(e => new StandardKeyboardEvent(e));\n\n\t\tonKeyDown.filter(e => e.keyCode === KeyCode.Enter).on(this.onEnter, this, this.disposables);\n\t\tonKeyDown.filter(e => e.keyCode === KeyCode.UpArrow).on(this.onUpArrow, this, this.disposables);\n\t\tonKeyDown.filter(e => e.keyCode === KeyCode.DownArrow).on(this.onDownArrow, this, this.disposables);\n\t\tonKeyDown.filter(e => e.keyCode === KeyCode.PageUp).on(this.onPageUpArrow, this, this.disposables);\n\t\tonKeyDown.filter(e => e.keyCode === KeyCode.PageDown).on(this.onPageDownArrow, this, this.disposables);\n\t\tonKeyDown.filter(e => e.keyCode === KeyCode.Escape).on(this.onEscape, this, this.disposables);\n\n\t\tif (multipleSelectionSupport) {\n\t\t\tonKeyDown.filter(e => (browser.isMacintosh ? e.metaKey : e.ctrlKey) && e.keyCode === KeyCode.KEY_A).on(this.onCtrlA, this, this.disposables);\n\t\t}\n\t}\n\n\tprivate onEnter(e: StandardKeyboardEvent): void {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis.list.setSelection(this.list.getFocus(), e.browserEvent);\n\n\t\tif (this.openController.shouldOpen(e.browserEvent)) {\n\t\t\tthis.list.open(this.list.getFocus(), e.browserEvent);\n\t\t}\n\t}\n\n\tprivate onUpArrow(e: StandardKeyboardEvent): void {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis.list.focusPrevious(1, false, e.browserEvent);\n\t\tthis.list.reveal(this.list.getFocus()[0]);\n\t\tthis.view.domNode.focus();\n\t}\n\n\tprivate onDownArrow(e: StandardKeyboardEvent): void {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis.list.focusNext(1, false, e.browserEvent);\n\t\tthis.list.reveal(this.list.getFocus()[0]);\n\t\tthis.view.domNode.focus();\n\t}\n\n\tprivate onPageUpArrow(e: StandardKeyboardEvent): void {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis.list.focusPreviousPage(e.browserEvent);\n\t\tthis.list.reveal(this.list.getFocus()[0]);\n\t\tthis.view.domNode.focus();\n\t}\n\n\tprivate onPageDownArrow(e: StandardKeyboardEvent): void {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis.list.focusNextPage(e.browserEvent);\n\t\tthis.list.reveal(this.list.getFocus()[0]);\n\t\tthis.view.domNode.focus();\n\t}\n\n\tprivate onCtrlA(e: StandardKeyboardEvent): void {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis.list.setSelection(range(this.list.length), e.browserEvent);\n\t\tthis.view.domNode.focus();\n\t}\n\n\tprivate onEscape(e: StandardKeyboardEvent): void {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis.list.setSelection([], e.browserEvent);\n\t\tthis.view.domNode.focus();\n\t}\n\n\tdispose() {\n\t\tthis.disposables = dispose(this.disposables);\n\t}\n}\n\nenum TypeLabelControllerState {\n\tIdle,\n\tTyping\n}\n\nexport function mightProducePrintableCharacter(event: IKeyboardEvent): boolean {\n\tif (event.ctrlKey || event.metaKey || event.altKey) {\n\t\treturn false;\n\t}\n\n\treturn (event.keyCode >= KeyCode.KEY_A && event.keyCode <= KeyCode.KEY_Z)\n\t\t|| (event.keyCode >= KeyCode.KEY_0 && event.keyCode <= KeyCode.KEY_9)\n\t\t|| (event.keyCode >= KeyCode.US_SEMICOLON && event.keyCode <= KeyCode.US_QUOTE);\n}\n\nclass TypeLabelController<T> implements IDisposable {\n\n\tprivate enabled = false;\n\tprivate state: TypeLabelControllerState = TypeLabelControllerState.Idle;\n\n\tprivate automaticKeyboardNavigation = true;\n\tprivate triggered = false;\n\n\tprivate enabledDisposables: IDisposable[] = [];\n\tprivate disposables: IDisposable[] = [];\n\n\tconstructor(\n\t\tprivate list: List<T>,\n\t\tprivate view: ListView<T>,\n\t\tprivate keyboardNavigationLabelProvider: IKeyboardNavigationLabelProvider<T>\n\t) {\n\t\tthis.updateOptions(list.options);\n\t}\n\n\tupdateOptions(options: IListOptions<T>): void {\n\t\tconst enableKeyboardNavigation = typeof options.enableKeyboardNavigation === 'undefined' ? true : !!options.enableKeyboardNavigation;\n\n\t\tif (enableKeyboardNavigation) {\n\t\t\tthis.enable();\n\t\t} else {\n\t\t\tthis.disable();\n\t\t}\n\n\t\tif (typeof options.automaticKeyboardNavigation !== 'undefined') {\n\t\t\tthis.automaticKeyboardNavigation = options.automaticKeyboardNavigation;\n\t\t}\n\t}\n\n\ttoggle(): void {\n\t\tthis.triggered = !this.triggered;\n\t}\n\n\tprivate enable(): void {\n\t\tif (this.enabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst onChar = Event.chain(domEvent(this.view.domNode, 'keydown'))\n\t\t\t.filter(e => !isInputElement(e.target as HTMLElement))\n\t\t\t.filter(() => this.automaticKeyboardNavigation || this.triggered)\n\t\t\t.map(event => new StandardKeyboardEvent(event))\n\t\t\t.filter(this.keyboardNavigationLabelProvider.mightProducePrintableCharacter ? e => this.keyboardNavigationLabelProvider.mightProducePrintableCharacter!(e) : e => mightProducePrintableCharacter(e))\n\t\t\t.forEach(e => { e.stopPropagation(); e.preventDefault(); })\n\t\t\t.map(event => event.browserEvent.key)\n\t\t\t.event;\n\n\t\tconst onClear = Event.debounce<string, null>(onChar, () => null, 800);\n\t\tconst onInput = Event.reduce<string | null, string | null>(Event.any(onChar, onClear), (r, i) => i === null ? null : ((r || '') + i));\n\n\t\tonInput(this.onInput, this, this.enabledDisposables);\n\n\t\tthis.enabled = true;\n\t\tthis.triggered = false;\n\t}\n\n\tprivate disable(): void {\n\t\tif (!this.enabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.enabledDisposables = dispose(this.enabledDisposables);\n\t\tthis.enabled = false;\n\t\tthis.triggered = false;\n\t}\n\n\tprivate onInput(word: string | null): void {\n\t\tif (!word) {\n\t\t\tthis.state = TypeLabelControllerState.Idle;\n\t\t\tthis.triggered = false;\n\t\t\treturn;\n\t\t}\n\n\t\tconst focus = this.list.getFocus();\n\t\tconst start = focus.length > 0 ? focus[0] : 0;\n\t\tconst delta = this.state === TypeLabelControllerState.Idle ? 1 : 0;\n\t\tthis.state = TypeLabelControllerState.Typing;\n\n\t\tfor (let i = 0; i < this.list.length; i++) {\n\t\t\tconst index = (start + i + delta) % this.list.length;\n\t\t\tconst label = this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(index));\n\t\t\tconst labelStr = label && label.toString();\n\n\t\t\tif (typeof labelStr === 'undefined' || matchesPrefix(word, labelStr)) {\n\t\t\t\tthis.list.setFocus([index]);\n\t\t\t\tthis.list.reveal(index);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tdispose() {\n\t\tthis.disable();\n\t\tthis.disposables = dispose(this.disposables);\n\t}\n}\n\nclass DOMFocusController<T> implements IDisposable {\n\n\tprivate disposables: IDisposable[] = [];\n\n\tconstructor(\n\t\tprivate list: List<T>,\n\t\tprivate view: ListView<T>\n\t) {\n\t\tthis.disposables = [];\n\n\t\tconst onKeyDown = Event.chain(domEvent(view.domNode, 'keydown'))\n\t\t\t.filter(e => !isInputElement(e.target as HTMLElement))\n\t\t\t.map(e => new StandardKeyboardEvent(e));\n\n\t\tonKeyDown.filter(e => e.keyCode === KeyCode.Tab && !e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey)\n\t\t\t.on(this.onTab, this, this.disposables);\n\t}\n\n\tprivate onTab(e: StandardKeyboardEvent): void {\n\t\tif (e.target !== this.view.domNode) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focus = this.list.getFocus();\n\n\t\tif (focus.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focusedDomElement = this.view.domElement(focus[0]);\n\n\t\tif (!focusedDomElement) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst tabIndexElement = focusedDomElement.querySelector('[tabIndex]');\n\n\t\tif (!tabIndexElement || !(tabIndexElement instanceof HTMLElement) || tabIndexElement.tabIndex === -1) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst style = window.getComputedStyle(tabIndexElement);\n\t\tif (style.visibility === 'hidden' || style.display === 'none') {\n\t\t\treturn;\n\t\t}\n\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\ttabIndexElement.focus();\n\t}\n\n\tdispose() {\n\t\tthis.disposables = dispose(this.disposables);\n\t}\n}\n\nexport function isSelectionSingleChangeEvent(event: IListMouseEvent<any> | IListTouchEvent<any>): boolean {\n\treturn browser.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\n}\n\nexport function isSelectionRangeChangeEvent(event: IListMouseEvent<any> | IListTouchEvent<any>): boolean {\n\treturn event.browserEvent.shiftKey;\n}\n\nfunction isMouseRightClick(event: UIEvent): boolean {\n\treturn event instanceof MouseEvent && event.button === 2;\n}\n\nconst DefaultMultipleSelectionContoller = {\n\tisSelectionSingleChangeEvent,\n\tisSelectionRangeChangeEvent\n};\n\nconst DefaultOpenController: IOpenController = {\n\tshouldOpen: (event: UIEvent) => {\n\t\tif (event instanceof MouseEvent) {\n\t\t\treturn !isMouseRightClick(event);\n\t\t}\n\n\t\treturn true;\n\t}\n};\n\nexport class MouseController<T> implements IDisposable {\n\n\tprivate multipleSelectionSupport: boolean;\n\treadonly multipleSelectionController: IMultipleSelectionController<T>;\n\tprivate openController: IOpenController;\n\tprivate mouseSupport: boolean;\n\tprivate disposables: IDisposable[] = [];\n\n\tconstructor(protected list: List<T>) {\n\t\tthis.multipleSelectionSupport = !(list.options.multipleSelectionSupport === false);\n\n\t\tif (this.multipleSelectionSupport) {\n\t\t\tthis.multipleSelectionController = list.options.multipleSelectionController || DefaultMultipleSelectionContoller;\n\t\t}\n\n\t\tthis.openController = list.options.openController || DefaultOpenController;\n\t\tthis.mouseSupport = typeof list.options.mouseSupport === 'undefined' || !!list.options.mouseSupport;\n\n\t\tif (this.mouseSupport) {\n\t\t\tlist.onMouseDown(this.onMouseDown, this, this.disposables);\n\t\t\tlist.onContextMenu(this.onContextMenu, this, this.disposables);\n\t\t\tlist.onMouseDblClick(this.onDoubleClick, this, this.disposables);\n\t\t\tlist.onTouchStart(this.onMouseDown, this, this.disposables);\n\t\t\tGesture.addTarget(list.getHTMLElement());\n\t\t}\n\n\t\tlist.onMouseClick(this.onPointer, this, this.disposables);\n\t\tlist.onMouseMiddleClick(this.onPointer, this, this.disposables);\n\t\tlist.onTap(this.onPointer, this, this.disposables);\n\t}\n\n\tprotected isSelectionSingleChangeEvent(event: IListMouseEvent<any> | IListTouchEvent<any>): boolean {\n\t\tif (this.multipleSelectionController) {\n\t\t\treturn this.multipleSelectionController.isSelectionSingleChangeEvent(event);\n\t\t}\n\n\t\treturn browser.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\n\t}\n\n\tprotected isSelectionRangeChangeEvent(event: IListMouseEvent<any> | IListTouchEvent<any>): boolean {\n\t\tif (this.multipleSelectionController) {\n\t\t\treturn this.multipleSelectionController.isSelectionRangeChangeEvent(event);\n\t\t}\n\n\t\treturn event.browserEvent.shiftKey;\n\t}\n\n\tprivate isSelectionChangeEvent(event: IListMouseEvent<any> | IListTouchEvent<any>): boolean {\n\t\treturn this.isSelectionSingleChangeEvent(event) || this.isSelectionRangeChangeEvent(event);\n\t}\n\n\tprivate onMouseDown(e: IListMouseEvent<T> | IListTouchEvent<T>): void {\n\t\tif (document.activeElement !== e.browserEvent.target) {\n\t\t\tthis.list.domFocus();\n\t\t}\n\t}\n\n\tprivate onContextMenu(e: IListContextMenuEvent<T>): void {\n\t\tconst focus = typeof e.index === 'undefined' ? [] : [e.index];\n\t\tthis.list.setFocus(focus, e.browserEvent);\n\t}\n\n\tprotected onPointer(e: IListMouseEvent<T>): void {\n\t\tif (!this.mouseSupport) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (isInputElement(e.browserEvent.target as HTMLElement)) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet reference = this.list.getFocus()[0];\n\t\tconst selection = this.list.getSelection();\n\t\treference = reference === undefined ? selection[0] : reference;\n\n\t\tconst focus = e.index;\n\n\t\tif (typeof focus === 'undefined') {\n\t\t\tthis.list.setFocus([], e.browserEvent);\n\t\t\tthis.list.setSelection([], e.browserEvent);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.multipleSelectionSupport && this.isSelectionRangeChangeEvent(e)) {\n\t\t\treturn this.changeSelection(e, reference);\n\t\t}\n\n\t\tif (this.multipleSelectionSupport && this.isSelectionChangeEvent(e)) {\n\t\t\treturn this.changeSelection(e, reference);\n\t\t}\n\n\t\tthis.list.setFocus([focus], e.browserEvent);\n\n\t\tif (!isMouseRightClick(e.browserEvent)) {\n\t\t\tthis.list.setSelection([focus], e.browserEvent);\n\n\t\t\tif (this.openController.shouldOpen(e.browserEvent)) {\n\t\t\t\tthis.list.open([focus], e.browserEvent);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onDoubleClick(e: IListMouseEvent<T>): void {\n\t\tif (isInputElement(e.browserEvent.target as HTMLElement)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.multipleSelectionSupport && this.isSelectionChangeEvent(e)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focus = this.list.getFocus();\n\t\tthis.list.setSelection(focus, e.browserEvent);\n\t\tthis.list.pin(focus);\n\t}\n\n\tprivate changeSelection(e: IListMouseEvent<T> | IListTouchEvent<T>, reference: number | undefined): void {\n\t\tconst focus = e.index!;\n\n\t\tif (this.isSelectionRangeChangeEvent(e) && reference !== undefined) {\n\t\t\tconst min = Math.min(reference, focus);\n\t\t\tconst max = Math.max(reference, focus);\n\t\t\tconst rangeSelection = range(min, max + 1);\n\t\t\tconst selection = this.list.getSelection();\n\t\t\tconst contiguousRange = getContiguousRangeContaining(disjunction(selection, [reference]), reference);\n\n\t\t\tif (contiguousRange.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst newSelection = disjunction(rangeSelection, relativeComplement(selection, contiguousRange));\n\t\t\tthis.list.setSelection(newSelection, e.browserEvent);\n\n\t\t} else if (this.isSelectionSingleChangeEvent(e)) {\n\t\t\tconst selection = this.list.getSelection();\n\t\t\tconst newSelection = selection.filter(i => i !== focus);\n\n\t\t\tif (selection.length === newSelection.length) {\n\t\t\t\tthis.list.setSelection([...newSelection, focus], e.browserEvent);\n\t\t\t} else {\n\t\t\t\tthis.list.setSelection(newSelection, e.browserEvent);\n\t\t\t}\n\t\t}\n\t}\n\n\tdispose() {\n\t\tthis.disposables = dispose(this.disposables);\n\t}\n}\n\nexport interface IMultipleSelectionController<T> {\n\tisSelectionSingleChangeEvent(event: IListMouseEvent<T> | IListTouchEvent<T>): boolean;\n\tisSelectionRangeChangeEvent(event: IListMouseEvent<T> | IListTouchEvent<T>): boolean;\n}\n\nexport interface IOpenController {\n\tshouldOpen(event: UIEvent): boolean;\n}\n\nexport interface IStyleController {\n\tstyle(styles: IListStyles): void;\n}\n\nexport interface IAccessibilityProvider<T> {\n\n\t/**\n\t * Given an element in the tree, return the ARIA label that should be associated with the\n\t * item. This helps screen readers to provide a meaningful label for the currently focused\n\t * tree element.\n\t *\n\t * Returning null will not disable ARIA for the element. Instead it is up to the screen reader\n\t * to compute a meaningful label based on the contents of the element in the DOM\n\t *\n\t * See also: https://www.w3.org/TR/wai-aria/#aria-label\n\t */\n\tgetAriaLabel(element: T): string | null;\n\n\t/**\n\t * https://www.w3.org/TR/wai-aria/#aria-level\n\t */\n\tgetAriaLevel?(element: T): number | undefined;\n}\n\nexport class DefaultStyleController implements IStyleController {\n\n\tconstructor(private styleElement: HTMLStyleElement, private selectorSuffix?: string) { }\n\n\tstyle(styles: IListStyles): void {\n\t\tconst suffix = this.selectorSuffix ? `.${this.selectorSuffix}` : '';\n\t\tconst content: string[] = [];\n\n\t\tif (styles.listFocusBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { background-color: ${styles.listFocusBackground}; }`);\n\t\t\tcontent.push(`.monaco-list${suffix}:focus .monaco-list-row.focused:hover { background-color: ${styles.listFocusBackground}; }`); // overwrite :hover style in this case!\n\t\t}\n\n\t\tif (styles.listFocusForeground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { color: ${styles.listFocusForeground}; }`);\n\t\t}\n\n\t\tif (styles.listActiveSelectionBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { background-color: ${styles.listActiveSelectionBackground}; }`);\n\t\t\tcontent.push(`.monaco-list${suffix}:focus .monaco-list-row.selected:hover { background-color: ${styles.listActiveSelectionBackground}; }`); // overwrite :hover style in this case!\n\t\t}\n\n\t\tif (styles.listActiveSelectionForeground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { color: ${styles.listActiveSelectionForeground}; }`);\n\t\t}\n\n\t\tif (styles.listFocusAndSelectionBackground) {\n\t\t\tcontent.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { background-color: ${styles.listFocusAndSelectionBackground}; }\n\t\t\t`);\n\t\t}\n\n\t\tif (styles.listFocusAndSelectionForeground) {\n\t\t\tcontent.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { color: ${styles.listFocusAndSelectionForeground}; }\n\t\t\t`);\n\t\t}\n\n\t\tif (styles.listInactiveFocusBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix} .monaco-list-row.focused { background-color:  ${styles.listInactiveFocusBackground}; }`);\n\t\t\tcontent.push(`.monaco-list${suffix} .monaco-list-row.focused:hover { background-color:  ${styles.listInactiveFocusBackground}; }`); // overwrite :hover style in this case!\n\t\t}\n\n\t\tif (styles.listInactiveSelectionBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix} .monaco-list-row.selected { background-color:  ${styles.listInactiveSelectionBackground}; }`);\n\t\t\tcontent.push(`.monaco-list${suffix} .monaco-list-row.selected:hover { background-color:  ${styles.listInactiveSelectionBackground}; }`); // overwrite :hover style in this case!\n\t\t}\n\n\t\tif (styles.listInactiveSelectionForeground) {\n\t\t\tcontent.push(`.monaco-list${suffix} .monaco-list-row.selected { color: ${styles.listInactiveSelectionForeground}; }`);\n\t\t}\n\n\t\tif (styles.listHoverBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:not(.drop-target) .monaco-list-row:hover:not(.selected):not(.focused) { background-color:  ${styles.listHoverBackground}; }`);\n\t\t}\n\n\t\tif (styles.listHoverForeground) {\n\t\t\tcontent.push(`.monaco-list${suffix} .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${styles.listHoverForeground}; }`);\n\t\t}\n\n\t\tif (styles.listSelectionOutline) {\n\t\t\tcontent.push(`.monaco-list${suffix} .monaco-list-row.selected { outline: 1px dotted ${styles.listSelectionOutline}; outline-offset: -1px; }`);\n\t\t}\n\n\t\tif (styles.listFocusOutline) {\n\t\t\tcontent.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t`);\n\t\t}\n\n\t\tif (styles.listInactiveFocusOutline) {\n\t\t\tcontent.push(`.monaco-list${suffix} .monaco-list-row.focused { outline: 1px dotted ${styles.listInactiveFocusOutline}; outline-offset: -1px; }`);\n\t\t}\n\n\t\tif (styles.listHoverOutline) {\n\t\t\tcontent.push(`.monaco-list${suffix} .monaco-list-row:hover { outline: 1px dashed ${styles.listHoverOutline}; outline-offset: -1px; }`);\n\t\t}\n\n\t\tif (styles.listDropBackground) {\n\t\t\tcontent.push(`\n\t\t\t\t.monaco-list${suffix}.drop-target,\n\t\t\t\t.monaco-list${suffix} .monaco-list-row.drop-target { background-color: ${styles.listDropBackground} !important; color: inherit !important; }\n\t\t\t`);\n\t\t}\n\n\t\tif (styles.listFilterWidgetBackground) {\n\t\t\tcontent.push(`.monaco-list-type-filter { background-color: ${styles.listFilterWidgetBackground} }`);\n\t\t}\n\n\t\tif (styles.listFilterWidgetOutline) {\n\t\t\tcontent.push(`.monaco-list-type-filter { border: 1px solid ${styles.listFilterWidgetOutline}; }`);\n\t\t}\n\n\t\tif (styles.listFilterWidgetNoMatchesOutline) {\n\t\t\tcontent.push(`.monaco-list-type-filter.no-matches { border: 1px solid ${styles.listFilterWidgetNoMatchesOutline}; }`);\n\t\t}\n\n\t\tif (styles.listMatchesShadow) {\n\t\t\tcontent.push(`.monaco-list-type-filter { box-shadow: 1px 1px 1px ${styles.listMatchesShadow}; }`);\n\t\t}\n\n\t\tconst newStyles = content.join('\\n');\n\t\tif (newStyles !== this.styleElement.innerHTML) {\n\t\t\tthis.styleElement.innerHTML = newStyles;\n\t\t}\n\t}\n}\n\nexport interface IListOptions<T> extends IListStyles {\n\treadonly identityProvider?: IIdentityProvider<T>;\n\treadonly dnd?: IListDragAndDrop<T>;\n\treadonly enableKeyboardNavigation?: boolean;\n\treadonly automaticKeyboardNavigation?: boolean;\n\treadonly keyboardNavigationLabelProvider?: IKeyboardNavigationLabelProvider<T>;\n\treadonly ariaRole?: ListAriaRootRole;\n\treadonly ariaLabel?: string;\n\treadonly keyboardSupport?: boolean;\n\treadonly multipleSelectionSupport?: boolean;\n\treadonly multipleSelectionController?: IMultipleSelectionController<T>;\n\treadonly openController?: IOpenController;\n\treadonly styleController?: IStyleController;\n\treadonly accessibilityProvider?: IAccessibilityProvider<T>;\n\n\t// list view options\n\treadonly useShadows?: boolean;\n\treadonly verticalScrollMode?: ScrollbarVisibility;\n\treadonly setRowLineHeight?: boolean;\n\treadonly supportDynamicHeights?: boolean;\n\treadonly mouseSupport?: boolean;\n\treadonly horizontalScrolling?: boolean;\n\treadonly ariaSetProvider?: IAriaSetProvider<T>;\n}\n\nexport interface IListStyles {\n\tlistFocusBackground?: Color;\n\tlistFocusForeground?: Color;\n\tlistActiveSelectionBackground?: Color;\n\tlistActiveSelectionForeground?: Color;\n\tlistFocusAndSelectionBackground?: Color;\n\tlistFocusAndSelectionForeground?: Color;\n\tlistInactiveSelectionBackground?: Color;\n\tlistInactiveSelectionForeground?: Color;\n\tlistInactiveFocusBackground?: Color;\n\tlistHoverBackground?: Color;\n\tlistHoverForeground?: Color;\n\tlistDropBackground?: Color;\n\tlistFocusOutline?: Color;\n\tlistInactiveFocusOutline?: Color;\n\tlistSelectionOutline?: Color;\n\tlistHoverOutline?: Color;\n\tlistFilterWidgetBackground?: Color;\n\tlistFilterWidgetOutline?: Color;\n\tlistFilterWidgetNoMatchesOutline?: Color;\n\tlistMatchesShadow?: Color;\n}\n\nconst defaultStyles: IListStyles = {\n\tlistFocusBackground: Color.fromHex('#073655'),\n\tlistActiveSelectionBackground: Color.fromHex('#0E639C'),\n\tlistActiveSelectionForeground: Color.fromHex('#FFFFFF'),\n\tlistFocusAndSelectionBackground: Color.fromHex('#094771'),\n\tlistFocusAndSelectionForeground: Color.fromHex('#FFFFFF'),\n\tlistInactiveSelectionBackground: Color.fromHex('#3F3F46'),\n\tlistHoverBackground: Color.fromHex('#2A2D2E'),\n\tlistDropBackground: Color.fromHex('#383B3D')\n};\n\nconst DefaultOptions = {\n\tkeyboardSupport: true,\n\tmouseSupport: true,\n\tmultipleSelectionSupport: true,\n\tdnd: {\n\t\tgetDragURI() { return null; },\n\t\tonDragStart(): void { },\n\t\tonDragOver() { return false; },\n\t\tdrop() { }\n\t},\n\tariaRootRole: ListAriaRootRole.TREE\n};\n\n// TODO@Joao: move these utils into a SortedArray class\n\nfunction getContiguousRangeContaining(range: number[], value: number): number[] {\n\tconst index = range.indexOf(value);\n\n\tif (index === -1) {\n\t\treturn [];\n\t}\n\n\tconst result: number[] = [];\n\tlet i = index - 1;\n\twhile (i >= 0 && range[i] === value - (index - i)) {\n\t\tresult.push(range[i--]);\n\t}\n\n\tresult.reverse();\n\ti = index;\n\twhile (i < range.length && range[i] === value + (i - index)) {\n\t\tresult.push(range[i++]);\n\t}\n\n\treturn result;\n}\n\n/**\n * Given two sorted collections of numbers, returns the intersection\n * betweem them (OR).\n */\nfunction disjunction(one: number[], other: number[]): number[] {\n\tconst result: number[] = [];\n\tlet i = 0, j = 0;\n\n\twhile (i < one.length || j < other.length) {\n\t\tif (i >= one.length) {\n\t\t\tresult.push(other[j++]);\n\t\t} else if (j >= other.length) {\n\t\t\tresult.push(one[i++]);\n\t\t} else if (one[i] === other[j]) {\n\t\t\tresult.push(one[i]);\n\t\t\ti++;\n\t\t\tj++;\n\t\t\tcontinue;\n\t\t} else if (one[i] < other[j]) {\n\t\t\tresult.push(one[i++]);\n\t\t} else {\n\t\t\tresult.push(other[j++]);\n\t\t}\n\t}\n\n\treturn result;\n}\n\n/**\n * Given two sorted collections of numbers, returns the relative\n * complement between them (XOR).\n */\nfunction relativeComplement(one: number[], other: number[]): number[] {\n\tconst result: number[] = [];\n\tlet i = 0, j = 0;\n\n\twhile (i < one.length || j < other.length) {\n\t\tif (i >= one.length) {\n\t\t\tresult.push(other[j++]);\n\t\t} else if (j >= other.length) {\n\t\t\tresult.push(one[i++]);\n\t\t} else if (one[i] === other[j]) {\n\t\t\ti++;\n\t\t\tj++;\n\t\t\tcontinue;\n\t\t} else if (one[i] < other[j]) {\n\t\t\tresult.push(one[i++]);\n\t\t} else {\n\t\t\tj++;\n\t\t}\n\t}\n\n\treturn result;\n}\n\nconst numericSort = (a: number, b: number) => a - b;\n\nclass PipelineRenderer<T> implements IListRenderer<T, any> {\n\n\tconstructor(\n\t\tprivate _templateId: string,\n\t\tprivate renderers: IListRenderer<any /* TODO@joao */, any>[]\n\t) { }\n\n\tget templateId(): string {\n\t\treturn this._templateId;\n\t}\n\n\trenderTemplate(container: HTMLElement): any[] {\n\t\treturn this.renderers.map(r => r.renderTemplate(container));\n\t}\n\n\trenderElement(element: T, index: number, templateData: any[], dynamicHeightProbing?: boolean): void {\n\t\tlet i = 0;\n\n\t\tfor (const renderer of this.renderers) {\n\t\t\trenderer.renderElement(element, index, templateData[i++], dynamicHeightProbing);\n\t\t}\n\t}\n\n\tdisposeElement(element: T, index: number, templateData: any[], dynamicHeightProbing?: boolean): void {\n\t\tlet i = 0;\n\n\t\tfor (const renderer of this.renderers) {\n\t\t\tif (renderer.disposeElement) {\n\t\t\t\trenderer.disposeElement(element, index, templateData[i], dynamicHeightProbing);\n\t\t\t}\n\n\t\t\ti += 1;\n\t\t}\n\t}\n\n\tdisposeTemplate(templateData: any[]): void {\n\t\tlet i = 0;\n\n\t\tfor (const renderer of this.renderers) {\n\t\t\trenderer.disposeTemplate(templateData[i++]);\n\t\t}\n\t}\n}\n\nclass AccessibiltyRenderer<T> implements IListRenderer<T, HTMLElement> {\n\n\ttemplateId: string = 'a18n';\n\n\tconstructor(private accessibilityProvider: IAccessibilityProvider<T>) { }\n\n\trenderTemplate(container: HTMLElement): HTMLElement {\n\t\treturn container;\n\t}\n\n\trenderElement(element: T, index: number, container: HTMLElement): void {\n\t\tconst ariaLabel = this.accessibilityProvider.getAriaLabel(element);\n\n\t\tif (ariaLabel) {\n\t\t\tcontainer.setAttribute('aria-label', ariaLabel);\n\t\t} else {\n\t\t\tcontainer.removeAttribute('aria-label');\n\t\t}\n\n\t\tconst ariaLevel = this.accessibilityProvider.getAriaLevel && this.accessibilityProvider.getAriaLevel(element);\n\n\t\tif (typeof ariaLevel === 'number') {\n\t\t\tcontainer.setAttribute('aria-level', `${ariaLevel}`);\n\t\t} else {\n\t\t\tcontainer.removeAttribute('aria-level');\n\t\t}\n\t}\n\n\tdisposeTemplate(templateData: any): void {\n\t\t// noop\n\t}\n}\n\nclass ListViewDragAndDrop<T> implements IListViewDragAndDrop<T> {\n\n\tconstructor(private list: List<T>, private dnd: IListDragAndDrop<T>) { }\n\n\tgetDragElements(element: T): T[] {\n\t\tconst selection = this.list.getSelectedElements();\n\t\tconst elements = selection.indexOf(element) > -1 ? selection : [element];\n\t\treturn elements;\n\t}\n\n\tgetDragURI(element: T): string | null {\n\t\treturn this.dnd.getDragURI(element);\n\t}\n\n\tgetDragLabel?(elements: T[]): string | undefined {\n\t\tif (this.dnd.getDragLabel) {\n\t\t\treturn this.dnd.getDragLabel(elements);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tonDragStart(data: IDragAndDropData, originalEvent: DragEvent): void {\n\t\tif (this.dnd.onDragStart) {\n\t\t\tthis.dnd.onDragStart(data, originalEvent);\n\t\t}\n\t}\n\n\tonDragOver(data: IDragAndDropData, targetElement: T, targetIndex: number, originalEvent: DragEvent): boolean | IListDragOverReaction {\n\t\treturn this.dnd.onDragOver(data, targetElement, targetIndex, originalEvent);\n\t}\n\n\tdrop(data: IDragAndDropData, targetElement: T, targetIndex: number, originalEvent: DragEvent): void {\n\t\tthis.dnd.drop(data, targetElement, targetIndex, originalEvent);\n\t}\n}\n\nexport interface IListOptionsUpdate {\n\treadonly enableKeyboardNavigation?: boolean;\n\treadonly automaticKeyboardNavigation?: boolean;\n}\n\nexport class List<T> implements ISpliceable<T>, IDisposable {\n\n\tprivate focus: Trait<T>;\n\tprivate selection: Trait<T>;\n\tprivate eventBufferer = new EventBufferer();\n\tprivate view: ListView<T>;\n\tprivate spliceable: ISpliceable<T>;\n\tprivate styleElement: HTMLStyleElement;\n\tprivate styleController: IStyleController;\n\tprivate typeLabelController?: TypeLabelController<T>;\n\n\tprotected disposables: IDisposable[];\n\n\t@memoize get onFocusChange(): Event<IListEvent<T>> {\n\t\treturn Event.map(this.eventBufferer.wrapEvent(this.focus.onChange), e => this.toListEvent(e));\n\t}\n\n\t@memoize get onSelectionChange(): Event<IListEvent<T>> {\n\t\treturn Event.map(this.eventBufferer.wrapEvent(this.selection.onChange), e => this.toListEvent(e));\n\t}\n\n\tprivate _onDidOpen = new Emitter<IListEvent<T>>();\n\treadonly onDidOpen: Event<IListEvent<T>> = this._onDidOpen.event;\n\n\tprivate _onPin = new Emitter<number[]>();\n\t@memoize get onPin(): Event<IListEvent<T>> {\n\t\treturn Event.map(this._onPin.event, indexes => this.toListEvent({ indexes }));\n\t}\n\n\tget onDidScroll(): Event<ScrollEvent> { return this.view.onDidScroll; }\n\tget onMouseClick(): Event<IListMouseEvent<T>> { return this.view.onMouseClick; }\n\tget onMouseDblClick(): Event<IListMouseEvent<T>> { return this.view.onMouseDblClick; }\n\tget onMouseMiddleClick(): Event<IListMouseEvent<T>> { return this.view.onMouseMiddleClick; }\n\tget onMouseUp(): Event<IListMouseEvent<T>> { return this.view.onMouseUp; }\n\tget onMouseDown(): Event<IListMouseEvent<T>> { return this.view.onMouseDown; }\n\tget onMouseOver(): Event<IListMouseEvent<T>> { return this.view.onMouseOver; }\n\tget onMouseMove(): Event<IListMouseEvent<T>> { return this.view.onMouseMove; }\n\tget onMouseOut(): Event<IListMouseEvent<T>> { return this.view.onMouseOut; }\n\tget onTouchStart(): Event<IListTouchEvent<T>> { return this.view.onTouchStart; }\n\tget onTap(): Event<IListGestureEvent<T>> { return this.view.onTap; }\n\n\tprivate didJustPressContextMenuKey: boolean = false;\n\t@memoize get onContextMenu(): Event<IListContextMenuEvent<T>> {\n\t\tconst fromKeydown = Event.chain(domEvent(this.view.domNode, 'keydown'))\n\t\t\t.map(e => new StandardKeyboardEvent(e))\n\t\t\t.filter(e => this.didJustPressContextMenuKey = e.keyCode === KeyCode.ContextMenu || (e.shiftKey && e.keyCode === KeyCode.F10))\n\t\t\t.filter(e => { e.preventDefault(); e.stopPropagation(); return false; })\n\t\t\t.event as Event<any>;\n\n\t\tconst fromKeyup = Event.chain(domEvent(this.view.domNode, 'keyup'))\n\t\t\t.filter(() => {\n\t\t\t\tconst didJustPressContextMenuKey = this.didJustPressContextMenuKey;\n\t\t\t\tthis.didJustPressContextMenuKey = false;\n\t\t\t\treturn didJustPressContextMenuKey;\n\t\t\t})\n\t\t\t.filter(() => this.getFocus().length > 0 && !!this.view.domElement(this.getFocus()[0]))\n\t\t\t.map(browserEvent => {\n\t\t\t\tconst index = this.getFocus()[0];\n\t\t\t\tconst element = this.view.element(index);\n\t\t\t\tconst anchor = this.view.domElement(index) as HTMLElement;\n\t\t\t\treturn { index, element, anchor, browserEvent };\n\t\t\t})\n\t\t\t.event;\n\n\t\tconst fromMouse = Event.chain(this.view.onContextMenu)\n\t\t\t.filter(() => !this.didJustPressContextMenuKey)\n\t\t\t.map(({ element, index, browserEvent }) => ({ element, index, anchor: { x: browserEvent.clientX + 1, y: browserEvent.clientY }, browserEvent }))\n\t\t\t.event;\n\n\t\treturn Event.any<IListContextMenuEvent<T>>(fromKeydown, fromKeyup, fromMouse);\n\t}\n\n\tget onKeyDown(): Event<KeyboardEvent> { return domEvent(this.view.domNode, 'keydown'); }\n\tget onKeyUp(): Event<KeyboardEvent> { return domEvent(this.view.domNode, 'keyup'); }\n\tget onKeyPress(): Event<KeyboardEvent> { return domEvent(this.view.domNode, 'keypress'); }\n\n\treadonly onDidFocus: Event<void>;\n\treadonly onDidBlur: Event<void>;\n\n\tprivate _onDidDispose = new Emitter<void>();\n\tget onDidDispose(): Event<void> { return this._onDidDispose.event; }\n\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\tvirtualDelegate: IListVirtualDelegate<T>,\n\t\trenderers: IListRenderer<any /* TODO@joao */, any>[],\n\t\tprivate _options: IListOptions<T> = DefaultOptions\n\t) {\n\t\tthis.focus = new FocusTrait();\n\t\tthis.selection = new Trait('selected');\n\n\t\tmixin(_options, defaultStyles, false);\n\n\t\tconst baseRenderers: IListRenderer<T, ITraitTemplateData>[] = [this.focus.renderer, this.selection.renderer];\n\n\t\tif (_options.accessibilityProvider) {\n\t\t\tbaseRenderers.push(new AccessibiltyRenderer<T>(_options.accessibilityProvider));\n\t\t}\n\n\t\trenderers = renderers.map(r => new PipelineRenderer(r.templateId, [...baseRenderers, r]));\n\n\t\tconst viewOptions: IListViewOptions<T> = {\n\t\t\t..._options,\n\t\t\tdnd: _options.dnd && new ListViewDragAndDrop(this, _options.dnd)\n\t\t};\n\n\t\tthis.view = new ListView(container, virtualDelegate, renderers, viewOptions);\n\n\t\tif (typeof _options.ariaRole !== 'string') {\n\t\t\tthis.view.domNode.setAttribute('role', ListAriaRootRole.TREE);\n\t\t} else {\n\t\t\tthis.view.domNode.setAttribute('role', _options.ariaRole);\n\t\t}\n\n\t\tthis.styleElement = DOM.createStyleSheet(this.view.domNode);\n\n\t\tthis.styleController = _options.styleController || new DefaultStyleController(this.styleElement, this.view.domId);\n\n\t\tthis.spliceable = new CombinedSpliceable([\n\t\t\tnew TraitSpliceable(this.focus, this.view, _options.identityProvider),\n\t\t\tnew TraitSpliceable(this.selection, this.view, _options.identityProvider),\n\t\t\tthis.view\n\t\t]);\n\n\t\tthis.disposables = [this.focus, this.selection, this.view, this._onDidDispose];\n\n\t\tthis.onDidFocus = Event.map(domEvent(this.view.domNode, 'focus', true), () => null!);\n\t\tthis.onDidBlur = Event.map(domEvent(this.view.domNode, 'blur', true), () => null!);\n\n\t\tthis.disposables.push(new DOMFocusController(this, this.view));\n\n\t\tif (typeof _options.keyboardSupport !== 'boolean' || _options.keyboardSupport) {\n\t\t\tconst controller = new KeyboardController(this, this.view, _options);\n\t\t\tthis.disposables.push(controller);\n\t\t}\n\n\t\tif (_options.keyboardNavigationLabelProvider) {\n\t\t\tthis.typeLabelController = new TypeLabelController(this, this.view, _options.keyboardNavigationLabelProvider);\n\t\t\tthis.disposables.push(this.typeLabelController);\n\t\t}\n\n\t\tthis.disposables.push(this.createMouseController(_options));\n\n\t\tthis.onFocusChange(this._onFocusChange, this, this.disposables);\n\t\tthis.onSelectionChange(this._onSelectionChange, this, this.disposables);\n\n\t\tif (_options.ariaLabel) {\n\t\t\tthis.view.domNode.setAttribute('aria-label', localize('aria list', \"{0}. Use the navigation keys to navigate.\", _options.ariaLabel));\n\t\t}\n\n\t\tthis.style(_options);\n\t}\n\n\tprotected createMouseController(options: IListOptions<T>): MouseController<T> {\n\t\treturn new MouseController(this);\n\t}\n\n\tupdateOptions(optionsUpdate: IListOptionsUpdate = {}): void {\n\t\tthis._options = { ...this._options, ...optionsUpdate };\n\n\t\tif (this.typeLabelController) {\n\t\t\tthis.typeLabelController.updateOptions(this._options);\n\t\t}\n\t}\n\n\tget options(): IListOptions<T> {\n\t\treturn this._options;\n\t}\n\n\tsplice(start: number, deleteCount: number, elements: T[] = []): void {\n\t\tif (start < 0 || start > this.view.length) {\n\t\t\tthrow new Error(`Invalid start index: ${start}`);\n\t\t}\n\n\t\tif (deleteCount < 0) {\n\t\t\tthrow new Error(`Invalid delete count: ${deleteCount}`);\n\t\t}\n\n\t\tif (deleteCount === 0 && elements.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.eventBufferer.bufferEvents(() => this.spliceable.splice(start, deleteCount, elements));\n\t}\n\n\tupdateWidth(index: number): void {\n\t\tthis.view.updateWidth(index);\n\t}\n\n\trerender(): void {\n\t\tthis.view.rerender();\n\t}\n\n\telement(index: number): T {\n\t\treturn this.view.element(index);\n\t}\n\n\tget length(): number {\n\t\treturn this.view.length;\n\t}\n\n\tget contentHeight(): number {\n\t\treturn this.view.contentHeight;\n\t}\n\n\tget onDidChangeContentHeight(): Event<number> {\n\t\treturn this.view.onDidChangeContentHeight;\n\t}\n\n\tget scrollTop(): number {\n\t\treturn this.view.getScrollTop();\n\t}\n\n\tset scrollTop(scrollTop: number) {\n\t\tthis.view.setScrollTop(scrollTop);\n\t}\n\n\tget scrollHeight(): number {\n\t\treturn this.view.scrollHeight;\n\t}\n\n\tget renderHeight(): number {\n\t\treturn this.view.renderHeight;\n\t}\n\n\tget firstVisibleIndex(): number {\n\t\treturn this.view.firstVisibleIndex;\n\t}\n\n\tget lastVisibleIndex(): number {\n\t\treturn this.view.lastVisibleIndex;\n\t}\n\n\tdomFocus(): void {\n\t\tthis.view.domNode.focus();\n\t}\n\n\tlayout(height?: number, width?: number): void {\n\t\tthis.view.layout(height, width);\n\t}\n\n\ttoggleKeyboardNavigation(): void {\n\t\tif (this.typeLabelController) {\n\t\t\tthis.typeLabelController.toggle();\n\t\t}\n\t}\n\n\tsetSelection(indexes: number[], browserEvent?: UIEvent): void {\n\t\tfor (const index of indexes) {\n\t\t\tif (index < 0 || index >= this.length) {\n\t\t\t\tthrow new Error(`Invalid index ${index}`);\n\t\t\t}\n\t\t}\n\n\t\tthis.selection.set(indexes, browserEvent);\n\t}\n\n\tgetSelection(): number[] {\n\t\treturn this.selection.get();\n\t}\n\n\tgetSelectedElements(): T[] {\n\t\treturn this.getSelection().map(i => this.view.element(i));\n\t}\n\n\tsetFocus(indexes: number[], browserEvent?: UIEvent): void {\n\t\tfor (const index of indexes) {\n\t\t\tif (index < 0 || index >= this.length) {\n\t\t\t\tthrow new Error(`Invalid index ${index}`);\n\t\t\t}\n\t\t}\n\n\t\tthis.focus.set(indexes, browserEvent);\n\t}\n\n\tfocusNext(n = 1, loop = false, browserEvent?: UIEvent, filter?: (element: T) => boolean): void {\n\t\tif (this.length === 0) { return; }\n\n\t\tconst focus = this.focus.get();\n\t\tconst index = this.findNextIndex(focus.length > 0 ? focus[0] + n : 0, loop, filter);\n\n\t\tif (index > -1) {\n\t\t\tthis.setFocus([index], browserEvent);\n\t\t}\n\t}\n\n\tfocusPrevious(n = 1, loop = false, browserEvent?: UIEvent, filter?: (element: T) => boolean): void {\n\t\tif (this.length === 0) { return; }\n\n\t\tconst focus = this.focus.get();\n\t\tconst index = this.findPreviousIndex(focus.length > 0 ? focus[0] - n : 0, loop, filter);\n\n\t\tif (index > -1) {\n\t\t\tthis.setFocus([index], browserEvent);\n\t\t}\n\t}\n\n\tfocusNextPage(browserEvent?: UIEvent, filter?: (element: T) => boolean): void {\n\t\tlet lastPageIndex = this.view.indexAt(this.view.getScrollTop() + this.view.renderHeight);\n\t\tlastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\n\t\tconst lastPageElement = this.view.element(lastPageIndex);\n\t\tconst currentlyFocusedElement = this.getFocusedElements()[0];\n\n\t\tif (currentlyFocusedElement !== lastPageElement) {\n\t\t\tconst lastGoodPageIndex = this.findPreviousIndex(lastPageIndex, false, filter);\n\n\t\t\tif (lastGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(lastGoodPageIndex)) {\n\t\t\t\tthis.setFocus([lastGoodPageIndex], browserEvent);\n\t\t\t} else {\n\t\t\t\tthis.setFocus([lastPageIndex], browserEvent);\n\t\t\t}\n\t\t} else {\n\t\t\tconst previousScrollTop = this.view.getScrollTop();\n\t\t\tthis.view.setScrollTop(previousScrollTop + this.view.renderHeight - this.view.elementHeight(lastPageIndex));\n\n\t\t\tif (this.view.getScrollTop() !== previousScrollTop) {\n\t\t\t\t// Let the scroll event listener run\n\t\t\t\tsetTimeout(() => this.focusNextPage(browserEvent, filter), 0);\n\t\t\t}\n\t\t}\n\t}\n\n\tfocusPreviousPage(browserEvent?: UIEvent, filter?: (element: T) => boolean): void {\n\t\tlet firstPageIndex: number;\n\t\tconst scrollTop = this.view.getScrollTop();\n\n\t\tif (scrollTop === 0) {\n\t\t\tfirstPageIndex = this.view.indexAt(scrollTop);\n\t\t} else {\n\t\t\tfirstPageIndex = this.view.indexAfter(scrollTop - 1);\n\t\t}\n\n\t\tconst firstPageElement = this.view.element(firstPageIndex);\n\t\tconst currentlyFocusedElement = this.getFocusedElements()[0];\n\n\t\tif (currentlyFocusedElement !== firstPageElement) {\n\t\t\tconst firstGoodPageIndex = this.findNextIndex(firstPageIndex, false, filter);\n\n\t\t\tif (firstGoodPageIndex > -1 && currentlyFocusedElement !== this.view.element(firstGoodPageIndex)) {\n\t\t\t\tthis.setFocus([firstGoodPageIndex], browserEvent);\n\t\t\t} else {\n\t\t\t\tthis.setFocus([firstPageIndex], browserEvent);\n\t\t\t}\n\t\t} else {\n\t\t\tconst previousScrollTop = scrollTop;\n\t\t\tthis.view.setScrollTop(scrollTop - this.view.renderHeight);\n\n\t\t\tif (this.view.getScrollTop() !== previousScrollTop) {\n\t\t\t\t// Let the scroll event listener run\n\t\t\t\tsetTimeout(() => this.focusPreviousPage(browserEvent, filter), 0);\n\t\t\t}\n\t\t}\n\t}\n\n\tfocusLast(browserEvent?: UIEvent, filter?: (element: T) => boolean): void {\n\t\tif (this.length === 0) { return; }\n\n\t\tconst index = this.findPreviousIndex(this.length - 1, false, filter);\n\n\t\tif (index > -1) {\n\t\t\tthis.setFocus([index], browserEvent);\n\t\t}\n\t}\n\n\tfocusFirst(browserEvent?: UIEvent, filter?: (element: T) => boolean): void {\n\t\tif (this.length === 0) { return; }\n\n\t\tconst index = this.findNextIndex(0, false, filter);\n\n\t\tif (index > -1) {\n\t\t\tthis.setFocus([index], browserEvent);\n\t\t}\n\t}\n\n\tprivate findNextIndex(index: number, loop = false, filter?: (element: T) => boolean): number {\n\t\tfor (let i = 0; i < this.length; i++) {\n\t\t\tif (index >= this.length && !loop) {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tindex = index % this.length;\n\n\t\t\tif (!filter || filter(this.element(index))) {\n\t\t\t\treturn index;\n\t\t\t}\n\n\t\t\tindex++;\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\tprivate findPreviousIndex(index: number, loop = false, filter?: (element: T) => boolean): number {\n\t\tfor (let i = 0; i < this.length; i++) {\n\t\t\tif (index < 0 && !loop) {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tindex = (this.length + (index % this.length)) % this.length;\n\n\t\t\tif (!filter || filter(this.element(index))) {\n\t\t\t\treturn index;\n\t\t\t}\n\n\t\t\tindex--;\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\tgetFocus(): number[] {\n\t\treturn this.focus.get();\n\t}\n\n\tgetFocusedElements(): T[] {\n\t\treturn this.getFocus().map(i => this.view.element(i));\n\t}\n\n\treveal(index: number, relativeTop?: number): void {\n\t\tif (index < 0 || index >= this.length) {\n\t\t\tthrow new Error(`Invalid index ${index}`);\n\t\t}\n\n\t\tconst scrollTop = this.view.getScrollTop();\n\t\tconst elementTop = this.view.elementTop(index);\n\t\tconst elementHeight = this.view.elementHeight(index);\n\n\t\tif (isNumber(relativeTop)) {\n\t\t\t// y = mx + b\n\t\t\tconst m = elementHeight - this.view.renderHeight;\n\t\t\tthis.view.setScrollTop(m * clamp(relativeTop, 0, 1) + elementTop);\n\t\t} else {\n\t\t\tconst viewItemBottom = elementTop + elementHeight;\n\t\t\tconst wrapperBottom = scrollTop + this.view.renderHeight;\n\n\t\t\tif (elementTop < scrollTop) {\n\t\t\t\tthis.view.setScrollTop(elementTop);\n\t\t\t} else if (viewItemBottom >= wrapperBottom) {\n\t\t\t\tthis.view.setScrollTop(viewItemBottom - this.view.renderHeight);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns the relative position of an element rendered in the list.\n\t * Returns `null` if the element isn't *entirely* in the visible viewport.\n\t */\n\tgetRelativeTop(index: number): number | null {\n\t\tif (index < 0 || index >= this.length) {\n\t\t\tthrow new Error(`Invalid index ${index}`);\n\t\t}\n\n\t\tconst scrollTop = this.view.getScrollTop();\n\t\tconst elementTop = this.view.elementTop(index);\n\t\tconst elementHeight = this.view.elementHeight(index);\n\n\t\tif (elementTop < scrollTop || elementTop + elementHeight > scrollTop + this.view.renderHeight) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// y = mx + b\n\t\tconst m = elementHeight - this.view.renderHeight;\n\t\treturn Math.abs((scrollTop - elementTop) / m);\n\t}\n\n\tisDOMFocused(): boolean {\n\t\treturn this.view.domNode === document.activeElement;\n\t}\n\n\tgetHTMLElement(): HTMLElement {\n\t\treturn this.view.domNode;\n\t}\n\n\topen(indexes: number[], browserEvent?: UIEvent): void {\n\t\tfor (const index of indexes) {\n\t\t\tif (index < 0 || index >= this.length) {\n\t\t\t\tthrow new Error(`Invalid index ${index}`);\n\t\t\t}\n\t\t}\n\n\t\tthis._onDidOpen.fire({ indexes, elements: indexes.map(i => this.view.element(i)), browserEvent });\n\t}\n\n\tpin(indexes: number[]): void {\n\t\tfor (const index of indexes) {\n\t\t\tif (index < 0 || index >= this.length) {\n\t\t\t\tthrow new Error(`Invalid index ${index}`);\n\t\t\t}\n\t\t}\n\n\t\tthis._onPin.fire(indexes);\n\t}\n\n\tstyle(styles: IListStyles): void {\n\t\tthis.styleController.style(styles);\n\t}\n\n\tprivate toListEvent({ indexes, browserEvent }: ITraitChangeEvent) {\n\t\treturn { indexes, elements: indexes.map(i => this.view.element(i)), browserEvent };\n\t}\n\n\tprivate _onFocusChange(): void {\n\t\tconst focus = this.focus.get();\n\n\t\tif (focus.length > 0) {\n\t\t\tthis.view.domNode.setAttribute('aria-activedescendant', this.view.getElementDomId(focus[0]));\n\t\t} else {\n\t\t\tthis.view.domNode.removeAttribute('aria-activedescendant');\n\t\t}\n\n\t\tthis.view.domNode.setAttribute('role', 'tree');\n\t\tDOM.toggleClass(this.view.domNode, 'element-focused', focus.length > 0);\n\t}\n\n\tprivate _onSelectionChange(): void {\n\t\tconst selection = this.selection.get();\n\n\t\tDOM.toggleClass(this.view.domNode, 'selection-none', selection.length === 0);\n\t\tDOM.toggleClass(this.view.domNode, 'selection-single', selection.length === 1);\n\t\tDOM.toggleClass(this.view.domNode, 'selection-multiple', selection.length > 1);\n\t}\n\n\tdispose(): void {\n\t\tthis._onDidDispose.fire();\n\t\tthis.disposables = dispose(this.disposables);\n\n\t\tthis._onDidOpen.dispose();\n\t\tthis._onPin.dispose();\n\t\tthis._onDidDispose.dispose();\n\t}\n}\n"]}]}