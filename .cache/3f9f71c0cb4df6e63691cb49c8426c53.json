{"remainingRequest":"/home/coding/workspace/node_modules/ts-loader/index.js?{\"happyPackMode\":true,\"compilerOptions\":{\"target\":\"es5\",\"lib\":[\"dom\",\"esnext\"]}}!/home/coding/workspace/lib/vscode/src/vs/editor/contrib/suggest/suggestWidget.ts","dependencies":[{"path":"/home/coding/workspace/lib/vscode/src/vs/editor/contrib/suggest/suggestWidget.ts","mtime":1555102317000},{"path":"/home/coding/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1555844183884},{"path":"/home/coding/workspace/node_modules/ts-loader/index.js","mtime":1555844217316}],"contextDependencies":[],"result":["\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nrequire(\"vs/css!./media/suggest\");\nvar nls = require(\"vs/nls\");\nvar filters_1 = require(\"vs/base/common/filters\");\nvar strings = require(\"vs/base/common/strings\");\nvar event_1 = require(\"vs/base/common/event\");\nvar errors_1 = require(\"vs/base/common/errors\");\nvar lifecycle_1 = require(\"vs/base/common/lifecycle\");\nvar dom_1 = require(\"vs/base/browser/dom\");\nvar listWidget_1 = require(\"vs/base/browser/ui/list/listWidget\");\nvar scrollableElement_1 = require(\"vs/base/browser/ui/scrollbar/scrollableElement\");\nvar keybinding_1 = require(\"vs/platform/keybinding/common/keybinding\");\nvar contextkey_1 = require(\"vs/platform/contextkey/common/contextkey\");\nvar editorBrowser_1 = require(\"vs/editor/browser/editorBrowser\");\nvar suggest_1 = require(\"./suggest\");\nvar aria_1 = require(\"vs/base/browser/ui/aria/aria\");\nvar telemetry_1 = require(\"vs/platform/telemetry/common/telemetry\");\nvar styler_1 = require(\"vs/platform/theme/common/styler\");\nvar themeService_1 = require(\"vs/platform/theme/common/themeService\");\nvar colorRegistry_1 = require(\"vs/platform/theme/common/colorRegistry\");\nvar storage_1 = require(\"vs/platform/storage/common/storage\");\nvar markdownRenderer_1 = require(\"vs/editor/contrib/markdown/markdownRenderer\");\nvar modeService_1 = require(\"vs/editor/common/services/modeService\");\nvar opener_1 = require(\"vs/platform/opener/common/opener\");\nvar async_1 = require(\"vs/base/common/async\");\nvar cancellation_1 = require(\"vs/base/common/cancellation\");\nvar modes_1 = require(\"vs/editor/common/modes\");\nvar iconLabel_1 = require(\"vs/base/browser/ui/iconLabel/iconLabel\");\nvar getIconClasses_1 = require(\"vs/editor/common/services/getIconClasses\");\nvar modelService_1 = require(\"vs/editor/common/services/modelService\");\nvar uri_1 = require(\"vs/base/common/uri\");\nvar instantiation_1 = require(\"vs/platform/instantiation/common/instantiation\");\nvar files_1 = require(\"vs/platform/files/common/files\");\nvar expandSuggestionDocsByDefault = false;\n/**\n * Suggest widget colors\n */\nexports.editorSuggestWidgetBackground = colorRegistry_1.registerColor('editorSuggestWidget.background', { dark: colorRegistry_1.editorWidgetBackground, light: colorRegistry_1.editorWidgetBackground, hc: colorRegistry_1.editorWidgetBackground }, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\nexports.editorSuggestWidgetBorder = colorRegistry_1.registerColor('editorSuggestWidget.border', { dark: colorRegistry_1.editorWidgetBorder, light: colorRegistry_1.editorWidgetBorder, hc: colorRegistry_1.editorWidgetBorder }, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\nexports.editorSuggestWidgetForeground = colorRegistry_1.registerColor('editorSuggestWidget.foreground', { dark: colorRegistry_1.editorForeground, light: colorRegistry_1.editorForeground, hc: colorRegistry_1.editorForeground }, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\nexports.editorSuggestWidgetSelectedBackground = colorRegistry_1.registerColor('editorSuggestWidget.selectedBackground', { dark: colorRegistry_1.listFocusBackground, light: colorRegistry_1.listFocusBackground, hc: colorRegistry_1.listFocusBackground }, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\nexports.editorSuggestWidgetHighlightForeground = colorRegistry_1.registerColor('editorSuggestWidget.highlightForeground', { dark: colorRegistry_1.listHighlightForeground, light: colorRegistry_1.listHighlightForeground, hc: colorRegistry_1.listHighlightForeground }, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\nvar colorRegExp = /^(#([\\da-f]{3}){1,2}|(rgb|hsl)a\\(\\s*(\\d{1,3}%?\\s*,\\s*){3}(1|0?\\.\\d+)\\)|(rgb|hsl)\\(\\s*\\d{1,3}%?(\\s*,\\s*\\d{1,3}%?){2}\\s*\\))$/i;\nfunction extractColor(item, out) {\n    if (item.completion.label.match(colorRegExp)) {\n        out[0] = item.completion.label;\n        return true;\n    }\n    if (typeof item.completion.documentation === 'string' && item.completion.documentation.match(colorRegExp)) {\n        out[0] = item.completion.documentation;\n        return true;\n    }\n    return false;\n}\nfunction canExpandCompletionItem(item) {\n    if (!item) {\n        return false;\n    }\n    var suggestion = item.completion;\n    if (suggestion.documentation) {\n        return true;\n    }\n    return (suggestion.detail && suggestion.detail !== suggestion.label);\n}\nvar Renderer = /** @class */ (function () {\n    function Renderer(widget, editor, triggerKeybindingLabel, _modelService, _modeService, _themeService) {\n        this.widget = widget;\n        this.editor = editor;\n        this.triggerKeybindingLabel = triggerKeybindingLabel;\n        this._modelService = _modelService;\n        this._modeService = _modeService;\n        this._themeService = _themeService;\n    }\n    Object.defineProperty(Renderer.prototype, \"templateId\", {\n        get: function () {\n            return 'suggestion';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Renderer.prototype.renderTemplate = function (container) {\n        var _this = this;\n        var data = Object.create(null);\n        data.disposables = [];\n        data.root = container;\n        dom_1.addClass(data.root, 'show-file-icons');\n        data.icon = dom_1.append(container, dom_1.$('.icon'));\n        data.colorspan = dom_1.append(data.icon, dom_1.$('span.colorspan'));\n        var text = dom_1.append(container, dom_1.$('.contents'));\n        var main = dom_1.append(text, dom_1.$('.main'));\n        data.iconLabel = new iconLabel_1.IconLabel(main, { supportHighlights: true });\n        data.disposables.push(data.iconLabel);\n        data.typeLabel = dom_1.append(main, dom_1.$('span.type-label'));\n        data.readMore = dom_1.append(main, dom_1.$('span.readMore'));\n        data.readMore.title = nls.localize('readMore', \"Read More...{0}\", this.triggerKeybindingLabel);\n        var configureFont = function () {\n            var configuration = _this.editor.getConfiguration();\n            var fontFamily = configuration.fontInfo.fontFamily;\n            var fontSize = configuration.contribInfo.suggestFontSize || configuration.fontInfo.fontSize;\n            var lineHeight = configuration.contribInfo.suggestLineHeight || configuration.fontInfo.lineHeight;\n            var fontWeight = configuration.fontInfo.fontWeight;\n            var fontSizePx = fontSize + \"px\";\n            var lineHeightPx = lineHeight + \"px\";\n            data.root.style.fontSize = fontSizePx;\n            data.root.style.fontWeight = fontWeight;\n            main.style.fontFamily = fontFamily;\n            main.style.lineHeight = lineHeightPx;\n            data.icon.style.height = lineHeightPx;\n            data.icon.style.width = lineHeightPx;\n            data.readMore.style.height = lineHeightPx;\n            data.readMore.style.width = lineHeightPx;\n        };\n        configureFont();\n        event_1.Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor))\n            .filter(function (e) { return e.fontInfo || e.contribInfo; })\n            .on(configureFont, null, data.disposables);\n        return data;\n    };\n    Renderer.prototype.renderElement = function (element, _index, templateData) {\n        var _this = this;\n        var data = templateData;\n        var suggestion = element.completion;\n        data.icon.className = 'icon ' + modes_1.completionKindToCssClass(suggestion.kind);\n        data.colorspan.style.backgroundColor = '';\n        var labelOptions = {\n            labelEscapeNewLines: true,\n            matches: filters_1.createMatches(element.score)\n        };\n        var color = [];\n        if (suggestion.kind === modes_1.CompletionItemKind.Color && extractColor(element, color)) {\n            // special logic for 'color' completion items\n            data.icon.className = 'icon customcolor';\n            data.colorspan.style.backgroundColor = color[0];\n        }\n        else if (suggestion.kind === modes_1.CompletionItemKind.File && this._themeService.getIconTheme().hasFileIcons) {\n            // special logic for 'file' completion items\n            data.icon.className = 'icon hide';\n            labelOptions.extraClasses = [].concat(getIconClasses_1.getIconClasses(this._modelService, this._modeService, uri_1.URI.from({ scheme: 'fake', path: suggestion.label }), files_1.FileKind.FILE), getIconClasses_1.getIconClasses(this._modelService, this._modeService, uri_1.URI.from({ scheme: 'fake', path: suggestion.detail }), files_1.FileKind.FILE));\n        }\n        else if (suggestion.kind === modes_1.CompletionItemKind.Folder && this._themeService.getIconTheme().hasFolderIcons) {\n            // special logic for 'folder' completion items\n            data.icon.className = 'icon hide';\n            labelOptions.extraClasses = [].concat(getIconClasses_1.getIconClasses(this._modelService, this._modeService, uri_1.URI.from({ scheme: 'fake', path: suggestion.label }), files_1.FileKind.FOLDER), getIconClasses_1.getIconClasses(this._modelService, this._modeService, uri_1.URI.from({ scheme: 'fake', path: suggestion.detail }), files_1.FileKind.FOLDER));\n        }\n        else {\n            // normal icon\n            data.icon.className = 'icon hide';\n            labelOptions.extraClasses = [\n                \"suggest-icon \" + modes_1.completionKindToCssClass(suggestion.kind)\n            ];\n        }\n        data.iconLabel.setLabel(suggestion.label, undefined, labelOptions);\n        data.typeLabel.textContent = (suggestion.detail || '').replace(/\\n.*$/m, '');\n        if (canExpandCompletionItem(element)) {\n            dom_1.show(data.readMore);\n            data.readMore.onmousedown = function (e) {\n                e.stopPropagation();\n                e.preventDefault();\n            };\n            data.readMore.onclick = function (e) {\n                e.stopPropagation();\n                e.preventDefault();\n                _this.widget.toggleDetails();\n            };\n        }\n        else {\n            dom_1.hide(data.readMore);\n            data.readMore.onmousedown = null;\n            data.readMore.onclick = null;\n        }\n    };\n    Renderer.prototype.disposeTemplate = function (templateData) {\n        templateData.disposables = lifecycle_1.dispose(templateData.disposables);\n    };\n    Renderer = tslib_1.__decorate([\n        tslib_1.__param(3, modelService_1.IModelService),\n        tslib_1.__param(4, modeService_1.IModeService),\n        tslib_1.__param(5, themeService_1.IThemeService)\n    ], Renderer);\n    return Renderer;\n}());\nvar State;\n(function (State) {\n    State[State[\"Hidden\"] = 0] = \"Hidden\";\n    State[State[\"Loading\"] = 1] = \"Loading\";\n    State[State[\"Empty\"] = 2] = \"Empty\";\n    State[State[\"Open\"] = 3] = \"Open\";\n    State[State[\"Frozen\"] = 4] = \"Frozen\";\n    State[State[\"Details\"] = 5] = \"Details\";\n})(State || (State = {}));\nvar SuggestionDetails = /** @class */ (function () {\n    function SuggestionDetails(container, widget, editor, markdownRenderer, triggerKeybindingLabel) {\n        var _this = this;\n        this.widget = widget;\n        this.editor = editor;\n        this.markdownRenderer = markdownRenderer;\n        this.triggerKeybindingLabel = triggerKeybindingLabel;\n        this.borderWidth = 1;\n        this.disposables = [];\n        this.el = dom_1.append(container, dom_1.$('.details'));\n        this.disposables.push(lifecycle_1.toDisposable(function () { return container.removeChild(_this.el); }));\n        this.body = dom_1.$('.body');\n        this.scrollbar = new scrollableElement_1.DomScrollableElement(this.body, {});\n        dom_1.append(this.el, this.scrollbar.getDomNode());\n        this.disposables.push(this.scrollbar);\n        this.header = dom_1.append(this.body, dom_1.$('.header'));\n        this.close = dom_1.append(this.header, dom_1.$('span.close'));\n        this.close.title = nls.localize('readLess', \"Read less...{0}\", this.triggerKeybindingLabel);\n        this.type = dom_1.append(this.header, dom_1.$('p.type'));\n        this.docs = dom_1.append(this.body, dom_1.$('p.docs'));\n        this.ariaLabel = null;\n        this.configureFont();\n        event_1.Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor))\n            .filter(function (e) { return e.fontInfo; })\n            .on(this.configureFont, this, this.disposables);\n        markdownRenderer.onDidRenderCodeBlock(function () { return _this.scrollbar.scanDomNode(); }, this, this.disposables);\n    }\n    Object.defineProperty(SuggestionDetails.prototype, \"element\", {\n        get: function () {\n            return this.el;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SuggestionDetails.prototype.render = function (item) {\n        var _this = this;\n        this.renderDisposeable = lifecycle_1.dispose(this.renderDisposeable);\n        if (!item || !canExpandCompletionItem(item)) {\n            this.type.textContent = '';\n            this.docs.textContent = '';\n            dom_1.addClass(this.el, 'no-docs');\n            this.ariaLabel = null;\n            return;\n        }\n        dom_1.removeClass(this.el, 'no-docs');\n        if (typeof item.completion.documentation === 'string') {\n            dom_1.removeClass(this.docs, 'markdown-docs');\n            this.docs.textContent = item.completion.documentation;\n        }\n        else {\n            dom_1.addClass(this.docs, 'markdown-docs');\n            this.docs.innerHTML = '';\n            var renderedContents = this.markdownRenderer.render(item.completion.documentation);\n            this.renderDisposeable = renderedContents;\n            this.docs.appendChild(renderedContents.element);\n        }\n        if (item.completion.detail) {\n            this.type.innerText = item.completion.detail;\n            dom_1.show(this.type);\n        }\n        else {\n            this.type.innerText = '';\n            dom_1.hide(this.type);\n        }\n        this.el.style.height = this.header.offsetHeight + this.docs.offsetHeight + (this.borderWidth * 2) + 'px';\n        this.close.onmousedown = function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n        };\n        this.close.onclick = function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            _this.widget.toggleDetails();\n        };\n        this.body.scrollTop = 0;\n        this.scrollbar.scanDomNode();\n        this.ariaLabel = strings.format('{0}{1}', item.completion.detail || '', item.completion.documentation ? (typeof item.completion.documentation === 'string' ? item.completion.documentation : item.completion.documentation.value) : '');\n    };\n    SuggestionDetails.prototype.getAriaLabel = function () {\n        return this.ariaLabel;\n    };\n    SuggestionDetails.prototype.scrollDown = function (much) {\n        if (much === void 0) { much = 8; }\n        this.body.scrollTop += much;\n    };\n    SuggestionDetails.prototype.scrollUp = function (much) {\n        if (much === void 0) { much = 8; }\n        this.body.scrollTop -= much;\n    };\n    SuggestionDetails.prototype.scrollTop = function () {\n        this.body.scrollTop = 0;\n    };\n    SuggestionDetails.prototype.scrollBottom = function () {\n        this.body.scrollTop = this.body.scrollHeight;\n    };\n    SuggestionDetails.prototype.pageDown = function () {\n        this.scrollDown(80);\n    };\n    SuggestionDetails.prototype.pageUp = function () {\n        this.scrollUp(80);\n    };\n    SuggestionDetails.prototype.setBorderWidth = function (width) {\n        this.borderWidth = width;\n    };\n    SuggestionDetails.prototype.configureFont = function () {\n        var configuration = this.editor.getConfiguration();\n        var fontFamily = configuration.fontInfo.fontFamily;\n        var fontSize = configuration.contribInfo.suggestFontSize || configuration.fontInfo.fontSize;\n        var lineHeight = configuration.contribInfo.suggestLineHeight || configuration.fontInfo.lineHeight;\n        var fontWeight = configuration.fontInfo.fontWeight;\n        var fontSizePx = fontSize + \"px\";\n        var lineHeightPx = lineHeight + \"px\";\n        this.el.style.fontSize = fontSizePx;\n        this.el.style.fontWeight = fontWeight;\n        this.type.style.fontFamily = fontFamily;\n        this.close.style.height = lineHeightPx;\n        this.close.style.width = lineHeightPx;\n    };\n    SuggestionDetails.prototype.dispose = function () {\n        this.disposables = lifecycle_1.dispose(this.disposables);\n        this.renderDisposeable = lifecycle_1.dispose(this.renderDisposeable);\n    };\n    return SuggestionDetails;\n}());\nvar SuggestWidget = /** @class */ (function () {\n    function SuggestWidget(editor, telemetryService, contextKeyService, themeService, storageService, keybindingService, modeService, openerService, instantiationService) {\n        var _this = this;\n        this.editor = editor;\n        this.telemetryService = telemetryService;\n        // Editor.IContentWidget.allowEditorOverflow\n        this.allowEditorOverflow = true;\n        this.ignoreFocusEvents = false;\n        this.editorBlurTimeout = new async_1.TimeoutTimer();\n        this.showTimeout = new async_1.TimeoutTimer();\n        this.onDidSelectEmitter = new event_1.Emitter();\n        this.onDidFocusEmitter = new event_1.Emitter();\n        this.onDidHideEmitter = new event_1.Emitter();\n        this.onDidShowEmitter = new event_1.Emitter();\n        this.onDidSelect = this.onDidSelectEmitter.event;\n        this.onDidFocus = this.onDidFocusEmitter.event;\n        this.onDidHide = this.onDidHideEmitter.event;\n        this.onDidShow = this.onDidShowEmitter.event;\n        this.maxWidgetWidth = 660;\n        this.listWidth = 330;\n        this.firstFocusInCurrentList = false;\n        this.preferDocPositionTop = false;\n        var kb = keybindingService.lookupKeybinding('editor.action.triggerSuggest');\n        var triggerKeybindingLabel = !kb ? '' : \" (\" + kb.getLabel() + \")\";\n        var markdownRenderer = new markdownRenderer_1.MarkdownRenderer(editor, modeService, openerService);\n        this.isAuto = false;\n        this.focusedItem = null;\n        this.storageService = storageService;\n        this.element = dom_1.$('.editor-widget.suggest-widget');\n        this.messageElement = dom_1.append(this.element, dom_1.$('.message'));\n        this.listElement = dom_1.append(this.element, dom_1.$('.tree'));\n        this.details = new SuggestionDetails(this.element, this, this.editor, markdownRenderer, triggerKeybindingLabel);\n        var applyIconStyle = function () { return dom_1.toggleClass(_this.element, 'no-icons', !_this.editor.getConfiguration().contribInfo.suggest.showIcons); };\n        applyIconStyle();\n        var renderer = instantiationService.createInstance(Renderer, this, this.editor, triggerKeybindingLabel);\n        this.list = new listWidget_1.List(this.listElement, this, [renderer], {\n            useShadows: false,\n            openController: { shouldOpen: function () { return false; } },\n            mouseSupport: false\n        });\n        this.toDispose = [\n            styler_1.attachListStyler(this.list, themeService, {\n                listInactiveFocusBackground: exports.editorSuggestWidgetSelectedBackground,\n                listInactiveFocusOutline: colorRegistry_1.activeContrastBorder\n            }),\n            themeService.onThemeChange(function (t) { return _this.onThemeChange(t); }),\n            editor.onDidLayoutChange(function () { return _this.onEditorLayoutChange(); }),\n            this.list.onMouseDown(function (e) { return _this.onListMouseDown(e); }),\n            this.list.onSelectionChange(function (e) { return _this.onListSelection(e); }),\n            this.list.onFocusChange(function (e) { return _this.onListFocus(e); }),\n            this.editor.onDidChangeCursorSelection(function () { return _this.onCursorSelectionChanged(); }),\n            this.editor.onDidChangeConfiguration(function (e) { return e.contribInfo && applyIconStyle(); })\n        ];\n        this.suggestWidgetVisible = suggest_1.Context.Visible.bindTo(contextKeyService);\n        this.suggestWidgetMultipleSuggestions = suggest_1.Context.MultipleSuggestions.bindTo(contextKeyService);\n        this.editor.addContentWidget(this);\n        this.setState(State.Hidden);\n        this.onThemeChange(themeService.getTheme());\n    }\n    SuggestWidget.prototype.onCursorSelectionChanged = function () {\n        if (this.state === State.Hidden) {\n            return;\n        }\n        this.editor.layoutContentWidget(this);\n    };\n    SuggestWidget.prototype.onEditorLayoutChange = function () {\n        if ((this.state === State.Open || this.state === State.Details) && this.expandDocsSettingFromStorage()) {\n            this.expandSideOrBelow();\n        }\n    };\n    SuggestWidget.prototype.onListMouseDown = function (e) {\n        if (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\n            return;\n        }\n        // prevent stealing browser focus from the editor\n        e.browserEvent.preventDefault();\n        e.browserEvent.stopPropagation();\n        this.select(e.element, e.index);\n    };\n    SuggestWidget.prototype.onListSelection = function (e) {\n        if (!e.elements.length) {\n            return;\n        }\n        this.select(e.elements[0], e.indexes[0]);\n    };\n    SuggestWidget.prototype.select = function (item, index) {\n        var _this = this;\n        var completionModel = this.completionModel;\n        if (!completionModel) {\n            return;\n        }\n        item.resolve(cancellation_1.CancellationToken.None).then(function () {\n            _this.onDidSelectEmitter.fire({ item: item, index: index, model: completionModel });\n            _this.editor.focus();\n        });\n    };\n    SuggestWidget.prototype._getSuggestionAriaAlertLabel = function (item) {\n        if (this.expandDocsSettingFromStorage()) {\n            return nls.localize('ariaCurrenttSuggestionReadDetails', \"Item {0}, docs: {1}\", item.completion.label, this.details.getAriaLabel());\n        }\n        else {\n            return item.completion.label;\n        }\n    };\n    SuggestWidget.prototype._ariaAlert = function (newAriaAlertLabel) {\n        if (this._lastAriaAlertLabel === newAriaAlertLabel) {\n            return;\n        }\n        this._lastAriaAlertLabel = newAriaAlertLabel;\n        if (this._lastAriaAlertLabel) {\n            aria_1.alert(this._lastAriaAlertLabel, true);\n        }\n    };\n    SuggestWidget.prototype.onThemeChange = function (theme) {\n        var backgroundColor = theme.getColor(exports.editorSuggestWidgetBackground);\n        if (backgroundColor) {\n            this.listElement.style.backgroundColor = backgroundColor.toString();\n            this.details.element.style.backgroundColor = backgroundColor.toString();\n            this.messageElement.style.backgroundColor = backgroundColor.toString();\n        }\n        var borderColor = theme.getColor(exports.editorSuggestWidgetBorder);\n        if (borderColor) {\n            this.listElement.style.borderColor = borderColor.toString();\n            this.details.element.style.borderColor = borderColor.toString();\n            this.messageElement.style.borderColor = borderColor.toString();\n            this.detailsBorderColor = borderColor.toString();\n        }\n        var focusBorderColor = theme.getColor(colorRegistry_1.focusBorder);\n        if (focusBorderColor) {\n            this.detailsFocusBorderColor = focusBorderColor.toString();\n        }\n        this.details.setBorderWidth(theme.type === 'hc' ? 2 : 1);\n    };\n    SuggestWidget.prototype.onListFocus = function (e) {\n        var _this = this;\n        if (this.ignoreFocusEvents) {\n            return;\n        }\n        if (!e.elements.length) {\n            if (this.currentSuggestionDetails) {\n                this.currentSuggestionDetails.cancel();\n                this.currentSuggestionDetails = null;\n                this.focusedItem = null;\n            }\n            this._ariaAlert(null);\n            return;\n        }\n        if (!this.completionModel) {\n            return;\n        }\n        var item = e.elements[0];\n        var index = e.indexes[0];\n        this.firstFocusInCurrentList = !this.focusedItem;\n        if (item !== this.focusedItem) {\n            if (this.currentSuggestionDetails) {\n                this.currentSuggestionDetails.cancel();\n                this.currentSuggestionDetails = null;\n            }\n            this.focusedItem = item;\n            this.list.reveal(index);\n            this.currentSuggestionDetails = async_1.createCancelablePromise(function (token) { return item.resolve(token); });\n            this.currentSuggestionDetails.then(function () {\n                if (_this.list.length < index) {\n                    return;\n                }\n                // item can have extra information, so re-render\n                _this.ignoreFocusEvents = true;\n                _this.list.splice(index, 1, [item]);\n                _this.list.setFocus([index]);\n                _this.ignoreFocusEvents = false;\n                if (_this.expandDocsSettingFromStorage()) {\n                    _this.showDetails();\n                }\n                else {\n                    dom_1.removeClass(_this.element, 'docs-side');\n                }\n                _this._ariaAlert(_this._getSuggestionAriaAlertLabel(item));\n            }).catch(errors_1.onUnexpectedError).then(function () {\n                if (_this.focusedItem === item) {\n                    _this.currentSuggestionDetails = null;\n                }\n            });\n        }\n        // emit an event\n        this.onDidFocusEmitter.fire({ item: item, index: index, model: this.completionModel });\n    };\n    SuggestWidget.prototype.setState = function (state) {\n        if (!this.element) {\n            return;\n        }\n        var stateChanged = this.state !== state;\n        this.state = state;\n        dom_1.toggleClass(this.element, 'frozen', state === State.Frozen);\n        switch (state) {\n            case State.Hidden:\n                dom_1.hide(this.messageElement, this.details.element, this.listElement);\n                this.hide();\n                this.listHeight = 0;\n                if (stateChanged) {\n                    this.list.splice(0, this.list.length);\n                }\n                this.focusedItem = null;\n                break;\n            case State.Loading:\n                this.messageElement.textContent = SuggestWidget.LOADING_MESSAGE;\n                dom_1.hide(this.listElement, this.details.element);\n                dom_1.show(this.messageElement);\n                dom_1.removeClass(this.element, 'docs-side');\n                this.show();\n                this.focusedItem = null;\n                break;\n            case State.Empty:\n                this.messageElement.textContent = SuggestWidget.NO_SUGGESTIONS_MESSAGE;\n                dom_1.hide(this.listElement, this.details.element);\n                dom_1.show(this.messageElement);\n                dom_1.removeClass(this.element, 'docs-side');\n                this.show();\n                this.focusedItem = null;\n                break;\n            case State.Open:\n                dom_1.hide(this.messageElement);\n                dom_1.show(this.listElement);\n                this.show();\n                break;\n            case State.Frozen:\n                dom_1.hide(this.messageElement);\n                dom_1.show(this.listElement);\n                this.show();\n                break;\n            case State.Details:\n                dom_1.hide(this.messageElement);\n                dom_1.show(this.details.element, this.listElement);\n                this.show();\n                this._ariaAlert(this.details.getAriaLabel());\n                break;\n        }\n    };\n    SuggestWidget.prototype.showTriggered = function (auto, delay) {\n        var _this = this;\n        if (this.state !== State.Hidden) {\n            return;\n        }\n        this.isAuto = !!auto;\n        if (!this.isAuto) {\n            this.loadingTimeout = setTimeout(function () {\n                _this.loadingTimeout = null;\n                _this.setState(State.Loading);\n            }, delay);\n        }\n    };\n    SuggestWidget.prototype.showSuggestions = function (completionModel, selectionIndex, isFrozen, isAuto) {\n        this.preferDocPositionTop = false;\n        this.docsPositionPreviousWidgetY = null;\n        if (this.loadingTimeout) {\n            clearTimeout(this.loadingTimeout);\n            this.loadingTimeout = null;\n        }\n        if (this.currentSuggestionDetails) {\n            this.currentSuggestionDetails.cancel();\n            this.currentSuggestionDetails = null;\n        }\n        if (this.completionModel !== completionModel) {\n            this.completionModel = completionModel;\n        }\n        if (isFrozen && this.state !== State.Empty && this.state !== State.Hidden) {\n            this.setState(State.Frozen);\n            return;\n        }\n        var visibleCount = this.completionModel.items.length;\n        var isEmpty = visibleCount === 0;\n        this.suggestWidgetMultipleSuggestions.set(visibleCount > 1);\n        if (isEmpty) {\n            if (isAuto) {\n                this.setState(State.Hidden);\n            }\n            else {\n                this.setState(State.Empty);\n            }\n            this.completionModel = null;\n        }\n        else {\n            if (this.state !== State.Open) {\n                var stats = this.completionModel.stats;\n                stats['wasAutomaticallyTriggered'] = !!isAuto;\n                /* __GDPR__\n                    \"suggestWidget\" : {\n                        \"wasAutomaticallyTriggered\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n                        \"${include}\": [\n                            \"${ICompletionStats}\",\n                            \"${EditorTelemetryData}\"\n                        ]\n                    }\n                */\n                this.telemetryService.publicLog('suggestWidget', tslib_1.__assign({}, stats, this.editor.getTelemetryData()));\n            }\n            this.focusedItem = null;\n            this.list.splice(0, this.list.length, this.completionModel.items);\n            if (isFrozen) {\n                this.setState(State.Frozen);\n            }\n            else {\n                this.setState(State.Open);\n            }\n            this.list.reveal(selectionIndex, 0);\n            this.list.setFocus([selectionIndex]);\n            // Reset focus border\n            if (this.detailsBorderColor) {\n                this.details.element.style.borderColor = this.detailsBorderColor;\n            }\n        }\n    };\n    SuggestWidget.prototype.selectNextPage = function () {\n        switch (this.state) {\n            case State.Hidden:\n                return false;\n            case State.Details:\n                this.details.pageDown();\n                return true;\n            case State.Loading:\n                return !this.isAuto;\n            default:\n                this.list.focusNextPage();\n                return true;\n        }\n    };\n    SuggestWidget.prototype.selectNext = function () {\n        switch (this.state) {\n            case State.Hidden:\n                return false;\n            case State.Loading:\n                return !this.isAuto;\n            default:\n                this.list.focusNext(1, true);\n                return true;\n        }\n    };\n    SuggestWidget.prototype.selectLast = function () {\n        switch (this.state) {\n            case State.Hidden:\n                return false;\n            case State.Details:\n                this.details.scrollBottom();\n                return true;\n            case State.Loading:\n                return !this.isAuto;\n            default:\n                this.list.focusLast();\n                return true;\n        }\n    };\n    SuggestWidget.prototype.selectPreviousPage = function () {\n        switch (this.state) {\n            case State.Hidden:\n                return false;\n            case State.Details:\n                this.details.pageUp();\n                return true;\n            case State.Loading:\n                return !this.isAuto;\n            default:\n                this.list.focusPreviousPage();\n                return true;\n        }\n    };\n    SuggestWidget.prototype.selectPrevious = function () {\n        switch (this.state) {\n            case State.Hidden:\n                return false;\n            case State.Loading:\n                return !this.isAuto;\n            default:\n                this.list.focusPrevious(1, true);\n                return false;\n        }\n    };\n    SuggestWidget.prototype.selectFirst = function () {\n        switch (this.state) {\n            case State.Hidden:\n                return false;\n            case State.Details:\n                this.details.scrollTop();\n                return true;\n            case State.Loading:\n                return !this.isAuto;\n            default:\n                this.list.focusFirst();\n                return true;\n        }\n    };\n    SuggestWidget.prototype.getFocusedItem = function () {\n        if (this.state !== State.Hidden\n            && this.state !== State.Empty\n            && this.state !== State.Loading\n            && this.completionModel) {\n            return {\n                item: this.list.getFocusedElements()[0],\n                index: this.list.getFocus()[0],\n                model: this.completionModel\n            };\n        }\n        return undefined;\n    };\n    SuggestWidget.prototype.toggleDetailsFocus = function () {\n        if (this.state === State.Details) {\n            this.setState(State.Open);\n            if (this.detailsBorderColor) {\n                this.details.element.style.borderColor = this.detailsBorderColor;\n            }\n        }\n        else if (this.state === State.Open && this.expandDocsSettingFromStorage()) {\n            this.setState(State.Details);\n            if (this.detailsFocusBorderColor) {\n                this.details.element.style.borderColor = this.detailsFocusBorderColor;\n            }\n        }\n        /* __GDPR__\n            \"suggestWidget:toggleDetailsFocus\" : {\n                \"${include}\": [\n                    \"${EditorTelemetryData}\"\n                ]\n            }\n        */\n        this.telemetryService.publicLog('suggestWidget:toggleDetailsFocus', this.editor.getTelemetryData());\n    };\n    SuggestWidget.prototype.toggleDetails = function () {\n        if (!canExpandCompletionItem(this.list.getFocusedElements()[0])) {\n            return;\n        }\n        if (this.expandDocsSettingFromStorage()) {\n            this.updateExpandDocsSetting(false);\n            dom_1.hide(this.details.element);\n            dom_1.removeClass(this.element, 'docs-side');\n            dom_1.removeClass(this.element, 'docs-below');\n            this.editor.layoutContentWidget(this);\n            /* __GDPR__\n                \"suggestWidget:collapseDetails\" : {\n                    \"${include}\": [\n                        \"${EditorTelemetryData}\"\n                    ]\n                }\n            */\n            this.telemetryService.publicLog('suggestWidget:collapseDetails', this.editor.getTelemetryData());\n        }\n        else {\n            if (this.state !== State.Open && this.state !== State.Details && this.state !== State.Frozen) {\n                return;\n            }\n            this.updateExpandDocsSetting(true);\n            this.showDetails();\n            this._ariaAlert(this.details.getAriaLabel());\n            /* __GDPR__\n                \"suggestWidget:expandDetails\" : {\n                    \"${include}\": [\n                        \"${EditorTelemetryData}\"\n                    ]\n                }\n            */\n            this.telemetryService.publicLog('suggestWidget:expandDetails', this.editor.getTelemetryData());\n        }\n    };\n    SuggestWidget.prototype.showDetails = function () {\n        this.expandSideOrBelow();\n        dom_1.show(this.details.element);\n        this.details.render(this.list.getFocusedElements()[0]);\n        this.details.element.style.maxHeight = this.maxWidgetHeight + 'px';\n        // Reset margin-top that was set as Fix for #26416\n        this.listElement.style.marginTop = '0px';\n        // with docs showing up widget width/height may change, so reposition the widget\n        this.editor.layoutContentWidget(this);\n        this.adjustDocsPosition();\n        this.editor.focus();\n    };\n    SuggestWidget.prototype.show = function () {\n        var _this = this;\n        var newHeight = this.updateListHeight();\n        if (newHeight !== this.listHeight) {\n            this.editor.layoutContentWidget(this);\n            this.listHeight = newHeight;\n        }\n        this.suggestWidgetVisible.set(true);\n        this.showTimeout.cancelAndSet(function () {\n            dom_1.addClass(_this.element, 'visible');\n            _this.onDidShowEmitter.fire(_this);\n        }, 100);\n    };\n    SuggestWidget.prototype.hide = function () {\n        this.suggestWidgetVisible.reset();\n        this.suggestWidgetMultipleSuggestions.reset();\n        dom_1.removeClass(this.element, 'visible');\n    };\n    SuggestWidget.prototype.hideWidget = function () {\n        clearTimeout(this.loadingTimeout);\n        this.setState(State.Hidden);\n        this.onDidHideEmitter.fire(this);\n    };\n    SuggestWidget.prototype.getPosition = function () {\n        if (this.state === State.Hidden) {\n            return null;\n        }\n        var preference = [editorBrowser_1.ContentWidgetPositionPreference.BELOW, editorBrowser_1.ContentWidgetPositionPreference.ABOVE];\n        if (this.preferDocPositionTop) {\n            preference = [editorBrowser_1.ContentWidgetPositionPreference.ABOVE];\n        }\n        return {\n            position: this.editor.getPosition(),\n            preference: preference\n        };\n    };\n    SuggestWidget.prototype.getDomNode = function () {\n        return this.element;\n    };\n    SuggestWidget.prototype.getId = function () {\n        return SuggestWidget.ID;\n    };\n    SuggestWidget.prototype.updateListHeight = function () {\n        var height = 0;\n        if (this.state === State.Empty || this.state === State.Loading) {\n            height = this.unfocusedHeight;\n        }\n        else {\n            var suggestionCount = this.list.contentHeight / this.unfocusedHeight;\n            var maxVisibleSuggestions = this.editor.getConfiguration().contribInfo.suggest.maxVisibleSuggestions;\n            height = Math.min(suggestionCount, maxVisibleSuggestions) * this.unfocusedHeight;\n        }\n        this.element.style.lineHeight = this.unfocusedHeight + \"px\";\n        this.listElement.style.height = height + \"px\";\n        this.list.layout(height);\n        return height;\n    };\n    /**\n     * Adds the propert classes, margins when positioning the docs to the side\n     */\n    SuggestWidget.prototype.adjustDocsPosition = function () {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        var lineHeight = this.editor.getConfiguration().fontInfo.lineHeight;\n        var cursorCoords = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\n        var editorCoords = dom_1.getDomNodePagePosition(this.editor.getDomNode());\n        var cursorX = editorCoords.left + cursorCoords.left;\n        var cursorY = editorCoords.top + cursorCoords.top + cursorCoords.height;\n        var widgetCoords = dom_1.getDomNodePagePosition(this.element);\n        var widgetX = widgetCoords.left;\n        var widgetY = widgetCoords.top;\n        // Fixes #27649\n        // Check if the Y changed to the top of the cursor and keep the widget flagged to prefer top\n        if (this.docsPositionPreviousWidgetY &&\n            this.docsPositionPreviousWidgetY < widgetY &&\n            !this.preferDocPositionTop) {\n            this.preferDocPositionTop = true;\n            this.adjustDocsPosition();\n            return;\n        }\n        this.docsPositionPreviousWidgetY = widgetY;\n        if (widgetX < cursorX - this.listWidth) {\n            // Widget is too far to the left of cursor, swap list and docs\n            dom_1.addClass(this.element, 'list-right');\n        }\n        else {\n            dom_1.removeClass(this.element, 'list-right');\n        }\n        // Compare top of the cursor (cursorY - lineheight) with widgetTop to determine if\n        // margin-top needs to be applied on list to make it appear right above the cursor\n        // Cannot compare cursorY directly as it may be a few decimals off due to zoooming\n        if (dom_1.hasClass(this.element, 'docs-side')\n            && cursorY - lineHeight > widgetY\n            && this.details.element.offsetHeight > this.listElement.offsetHeight) {\n            // Fix for #26416\n            // Docs is bigger than list and widget is above cursor, apply margin-top so that list appears right above cursor\n            this.listElement.style.marginTop = this.details.element.offsetHeight - this.listElement.offsetHeight + \"px\";\n        }\n    };\n    /**\n     * Adds the proper classes for positioning the docs to the side or below\n     */\n    SuggestWidget.prototype.expandSideOrBelow = function () {\n        if (!canExpandCompletionItem(this.focusedItem) && this.firstFocusInCurrentList) {\n            dom_1.removeClass(this.element, 'docs-side');\n            dom_1.removeClass(this.element, 'docs-below');\n            return;\n        }\n        var matches = this.element.style.maxWidth.match(/(\\d+)px/);\n        if (!matches || Number(matches[1]) < this.maxWidgetWidth) {\n            dom_1.addClass(this.element, 'docs-below');\n            dom_1.removeClass(this.element, 'docs-side');\n        }\n        else if (canExpandCompletionItem(this.focusedItem)) {\n            dom_1.addClass(this.element, 'docs-side');\n            dom_1.removeClass(this.element, 'docs-below');\n        }\n    };\n    Object.defineProperty(SuggestWidget.prototype, \"maxWidgetHeight\", {\n        // Heights\n        get: function () {\n            return this.unfocusedHeight * this.editor.getConfiguration().contribInfo.suggest.maxVisibleSuggestions;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SuggestWidget.prototype, \"unfocusedHeight\", {\n        get: function () {\n            var configuration = this.editor.getConfiguration();\n            return configuration.contribInfo.suggestLineHeight || configuration.fontInfo.lineHeight;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // IDelegate\n    SuggestWidget.prototype.getHeight = function (element) {\n        return this.unfocusedHeight;\n    };\n    SuggestWidget.prototype.getTemplateId = function (element) {\n        return 'suggestion';\n    };\n    SuggestWidget.prototype.expandDocsSettingFromStorage = function () {\n        return this.storageService.getBoolean('expandSuggestionDocs', storage_1.StorageScope.GLOBAL, expandSuggestionDocsByDefault);\n    };\n    SuggestWidget.prototype.updateExpandDocsSetting = function (value) {\n        this.storageService.store('expandSuggestionDocs', value, storage_1.StorageScope.GLOBAL);\n    };\n    SuggestWidget.prototype.dispose = function () {\n        this.state = null;\n        this.currentSuggestionDetails = null;\n        this.focusedItem = null;\n        this.element = null; // StrictNullOverride: nulling out ok in dispose\n        this.messageElement = null; // StrictNullOverride: nulling out ok in dispose\n        this.listElement = null; // StrictNullOverride: nulling out ok in dispose\n        this.details.dispose();\n        this.details = null; // StrictNullOverride: nulling out ok in dispose\n        this.list.dispose();\n        this.list = null; // StrictNullOverride: nulling out ok in dispose\n        this.toDispose = lifecycle_1.dispose(this.toDispose);\n        if (this.loadingTimeout) {\n            clearTimeout(this.loadingTimeout);\n            this.loadingTimeout = null;\n        }\n        this.editorBlurTimeout.dispose();\n        this.showTimeout.dispose();\n    };\n    SuggestWidget.ID = 'editor.widget.suggestWidget';\n    SuggestWidget.LOADING_MESSAGE = nls.localize('suggestWidget.loading', \"Loading...\");\n    SuggestWidget.NO_SUGGESTIONS_MESSAGE = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\n    SuggestWidget = tslib_1.__decorate([\n        tslib_1.__param(1, telemetry_1.ITelemetryService),\n        tslib_1.__param(2, contextkey_1.IContextKeyService),\n        tslib_1.__param(3, themeService_1.IThemeService),\n        tslib_1.__param(4, storage_1.IStorageService),\n        tslib_1.__param(5, keybinding_1.IKeybindingService),\n        tslib_1.__param(6, modeService_1.IModeService),\n        tslib_1.__param(7, opener_1.IOpenerService),\n        tslib_1.__param(8, instantiation_1.IInstantiationService)\n    ], SuggestWidget);\n    return SuggestWidget;\n}());\nexports.SuggestWidget = SuggestWidget;\nthemeService_1.registerThemingParticipant(function (theme, collector) {\n    var matchHighlight = theme.getColor(exports.editorSuggestWidgetHighlightForeground);\n    if (matchHighlight) {\n        collector.addRule(\".monaco-editor .suggest-widget .monaco-list .monaco-list-row .monaco-highlighted-label .highlight { color: \" + matchHighlight + \"; }\");\n    }\n    var foreground = theme.getColor(exports.editorSuggestWidgetForeground);\n    if (foreground) {\n        collector.addRule(\".monaco-editor .suggest-widget { color: \" + foreground + \"; }\");\n    }\n    var link = theme.getColor(colorRegistry_1.textLinkForeground);\n    if (link) {\n        collector.addRule(\".monaco-editor .suggest-widget a { color: \" + link + \"; }\");\n    }\n    var codeBackground = theme.getColor(colorRegistry_1.textCodeBlockBackground);\n    if (codeBackground) {\n        collector.addRule(\".monaco-editor .suggest-widget code { background-color: \" + codeBackground + \"; }\");\n    }\n});\n",{"version":3,"file":"/home/coding/workspace/lib/vscode/src/vs/editor/contrib/suggest/suggestWidget.ts","sourceRoot":"","sources":["/home/coding/workspace/lib/vscode/src/vs/editor/contrib/suggest/suggestWidget.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./media/suggest';\nimport * as nls from 'vs/nls';\nimport { createMatches } from 'vs/base/common/filters';\nimport * as strings from 'vs/base/common/strings';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { IDisposable, dispose, toDisposable } from 'vs/base/common/lifecycle';\nimport { addClass, append, $, hide, removeClass, show, toggleClass, getDomNodePagePosition, hasClass } from 'vs/base/browser/dom';\nimport { IListVirtualDelegate, IListEvent, IListRenderer, IListMouseEvent } from 'vs/base/browser/ui/list/list';\nimport { List } from 'vs/base/browser/ui/list/listWidget';\nimport { DomScrollableElement } from 'vs/base/browser/ui/scrollbar/scrollableElement';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { IContextKey, IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IConfigurationChangedEvent } from 'vs/editor/common/config/editorOptions';\nimport { ContentWidgetPositionPreference, ICodeEditor, IContentWidget, IContentWidgetPosition } from 'vs/editor/browser/editorBrowser';\nimport { Context as SuggestContext, CompletionItem } from './suggest';\nimport { CompletionModel } from './completionModel';\nimport { alert } from 'vs/base/browser/ui/aria/aria';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { attachListStyler } from 'vs/platform/theme/common/styler';\nimport { IThemeService, ITheme, registerThemingParticipant } from 'vs/platform/theme/common/themeService';\nimport { registerColor, editorWidgetBackground, listFocusBackground, activeContrastBorder, listHighlightForeground, editorForeground, editorWidgetBorder, focusBorder, textLinkForeground, textCodeBlockBackground } from 'vs/platform/theme/common/colorRegistry';\nimport { IStorageService, StorageScope } from 'vs/platform/storage/common/storage';\nimport { MarkdownRenderer } from 'vs/editor/contrib/markdown/markdownRenderer';\nimport { IModeService } from 'vs/editor/common/services/modeService';\nimport { IOpenerService } from 'vs/platform/opener/common/opener';\nimport { TimeoutTimer, CancelablePromise, createCancelablePromise } from 'vs/base/common/async';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { CompletionItemKind, completionKindToCssClass } from 'vs/editor/common/modes';\nimport { IconLabel, IIconLabelValueOptions } from 'vs/base/browser/ui/iconLabel/iconLabel';\nimport { getIconClasses } from 'vs/editor/common/services/getIconClasses';\nimport { IModelService } from 'vs/editor/common/services/modelService';\nimport { URI } from 'vs/base/common/uri';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { FileKind } from 'vs/platform/files/common/files';\n\nconst expandSuggestionDocsByDefault = false;\n\ninterface ISuggestionTemplateData {\n\troot: HTMLElement;\n\ticon: HTMLElement;\n\tcolorspan: HTMLElement;\n\ticonLabel: IconLabel;\n\ttypeLabel: HTMLElement;\n\treadMore: HTMLElement;\n\tdisposables: IDisposable[];\n}\n\n/**\n * Suggest widget colors\n */\nexport const editorSuggestWidgetBackground = registerColor('editorSuggestWidget.background', { dark: editorWidgetBackground, light: editorWidgetBackground, hc: editorWidgetBackground }, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\nexport const editorSuggestWidgetBorder = registerColor('editorSuggestWidget.border', { dark: editorWidgetBorder, light: editorWidgetBorder, hc: editorWidgetBorder }, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\nexport const editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', { dark: editorForeground, light: editorForeground, hc: editorForeground }, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\nexport const editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', { dark: listFocusBackground, light: listFocusBackground, hc: listFocusBackground }, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetHighlightForeground = registerColor('editorSuggestWidget.highlightForeground', { dark: listHighlightForeground, light: listHighlightForeground, hc: listHighlightForeground }, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\n\n\nconst colorRegExp = /^(#([\\da-f]{3}){1,2}|(rgb|hsl)a\\(\\s*(\\d{1,3}%?\\s*,\\s*){3}(1|0?\\.\\d+)\\)|(rgb|hsl)\\(\\s*\\d{1,3}%?(\\s*,\\s*\\d{1,3}%?){2}\\s*\\))$/i;\nfunction extractColor(item: CompletionItem, out: string[]): boolean {\n\tif (item.completion.label.match(colorRegExp)) {\n\t\tout[0] = item.completion.label;\n\t\treturn true;\n\t}\n\tif (typeof item.completion.documentation === 'string' && item.completion.documentation.match(colorRegExp)) {\n\t\tout[0] = item.completion.documentation;\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction canExpandCompletionItem(item: CompletionItem | null) {\n\tif (!item) {\n\t\treturn false;\n\t}\n\tconst suggestion = item.completion;\n\tif (suggestion.documentation) {\n\t\treturn true;\n\t}\n\treturn (suggestion.detail && suggestion.detail !== suggestion.label);\n}\n\nclass Renderer implements IListRenderer<CompletionItem, ISuggestionTemplateData> {\n\n\tconstructor(\n\t\tprivate widget: SuggestWidget,\n\t\tprivate editor: ICodeEditor,\n\t\tprivate triggerKeybindingLabel: string,\n\t\t@IModelService private readonly _modelService: IModelService,\n\t\t@IModeService private readonly _modeService: IModeService,\n\t\t@IThemeService private readonly _themeService: IThemeService,\n\t) {\n\n\t}\n\n\tget templateId(): string {\n\t\treturn 'suggestion';\n\t}\n\n\trenderTemplate(container: HTMLElement): ISuggestionTemplateData {\n\t\tconst data = <ISuggestionTemplateData>Object.create(null);\n\t\tdata.disposables = [];\n\t\tdata.root = container;\n\t\taddClass(data.root, 'show-file-icons');\n\n\t\tdata.icon = append(container, $('.icon'));\n\t\tdata.colorspan = append(data.icon, $('span.colorspan'));\n\n\t\tconst text = append(container, $('.contents'));\n\t\tconst main = append(text, $('.main'));\n\n\t\tdata.iconLabel = new IconLabel(main, { supportHighlights: true });\n\t\tdata.disposables.push(data.iconLabel);\n\n\t\tdata.typeLabel = append(main, $('span.type-label'));\n\n\t\tdata.readMore = append(main, $('span.readMore'));\n\t\tdata.readMore.title = nls.localize('readMore', \"Read More...{0}\", this.triggerKeybindingLabel);\n\n\t\tconst configureFont = () => {\n\t\t\tconst configuration = this.editor.getConfiguration();\n\t\t\tconst fontFamily = configuration.fontInfo.fontFamily;\n\t\t\tconst fontSize = configuration.contribInfo.suggestFontSize || configuration.fontInfo.fontSize;\n\t\t\tconst lineHeight = configuration.contribInfo.suggestLineHeight || configuration.fontInfo.lineHeight;\n\t\t\tconst fontWeight = configuration.fontInfo.fontWeight;\n\t\t\tconst fontSizePx = `${fontSize}px`;\n\t\t\tconst lineHeightPx = `${lineHeight}px`;\n\n\t\t\tdata.root.style.fontSize = fontSizePx;\n\t\t\tdata.root.style.fontWeight = fontWeight;\n\t\t\tmain.style.fontFamily = fontFamily;\n\t\t\tmain.style.lineHeight = lineHeightPx;\n\t\t\tdata.icon.style.height = lineHeightPx;\n\t\t\tdata.icon.style.width = lineHeightPx;\n\t\t\tdata.readMore.style.height = lineHeightPx;\n\t\t\tdata.readMore.style.width = lineHeightPx;\n\t\t};\n\n\t\tconfigureFont();\n\n\t\tEvent.chain<IConfigurationChangedEvent>(this.editor.onDidChangeConfiguration.bind(this.editor))\n\t\t\t.filter(e => e.fontInfo || e.contribInfo)\n\t\t\t.on(configureFont, null, data.disposables);\n\n\t\treturn data;\n\t}\n\n\trenderElement(element: CompletionItem, _index: number, templateData: ISuggestionTemplateData): void {\n\t\tconst data = <ISuggestionTemplateData>templateData;\n\t\tconst suggestion = (<CompletionItem>element).completion;\n\n\t\tdata.icon.className = 'icon ' + completionKindToCssClass(suggestion.kind);\n\t\tdata.colorspan.style.backgroundColor = '';\n\n\n\t\tconst labelOptions: IIconLabelValueOptions = {\n\t\t\tlabelEscapeNewLines: true,\n\t\t\tmatches: createMatches(element.score)\n\t\t};\n\n\t\tlet color: string[] = [];\n\t\tif (suggestion.kind === CompletionItemKind.Color && extractColor(element, color)) {\n\t\t\t// special logic for 'color' completion items\n\t\t\tdata.icon.className = 'icon customcolor';\n\t\t\tdata.colorspan.style.backgroundColor = color[0];\n\n\t\t} else if (suggestion.kind === CompletionItemKind.File && this._themeService.getIconTheme().hasFileIcons) {\n\t\t\t// special logic for 'file' completion items\n\t\t\tdata.icon.className = 'icon hide';\n\t\t\tlabelOptions.extraClasses = ([] as string[]).concat(\n\t\t\t\tgetIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: suggestion.label }), FileKind.FILE),\n\t\t\t\tgetIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: suggestion.detail }), FileKind.FILE)\n\t\t\t);\n\n\t\t} else if (suggestion.kind === CompletionItemKind.Folder && this._themeService.getIconTheme().hasFolderIcons) {\n\t\t\t// special logic for 'folder' completion items\n\t\t\tdata.icon.className = 'icon hide';\n\t\t\tlabelOptions.extraClasses = ([] as string[]).concat(\n\t\t\t\tgetIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: suggestion.label }), FileKind.FOLDER),\n\t\t\t\tgetIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: suggestion.detail }), FileKind.FOLDER)\n\t\t\t);\n\t\t} else {\n\t\t\t// normal icon\n\t\t\tdata.icon.className = 'icon hide';\n\t\t\tlabelOptions.extraClasses = [\n\t\t\t\t`suggest-icon ${completionKindToCssClass(suggestion.kind)}`\n\t\t\t];\n\t\t}\n\n\t\tdata.iconLabel.setLabel(suggestion.label, undefined, labelOptions);\n\t\tdata.typeLabel.textContent = (suggestion.detail || '').replace(/\\n.*$/m, '');\n\n\t\tif (canExpandCompletionItem(element)) {\n\t\t\tshow(data.readMore);\n\t\t\tdata.readMore.onmousedown = e => {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\t\t\t};\n\t\t\tdata.readMore.onclick = e => {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.widget.toggleDetails();\n\t\t\t};\n\t\t} else {\n\t\t\thide(data.readMore);\n\t\t\tdata.readMore.onmousedown = null;\n\t\t\tdata.readMore.onclick = null;\n\t\t}\n\t}\n\n\tdisposeTemplate(templateData: ISuggestionTemplateData): void {\n\t\ttemplateData.disposables = dispose(templateData.disposables);\n\t}\n}\n\nconst enum State {\n\tHidden,\n\tLoading,\n\tEmpty,\n\tOpen,\n\tFrozen,\n\tDetails\n}\n\nclass SuggestionDetails {\n\n\tprivate el: HTMLElement;\n\tprivate close: HTMLElement;\n\tprivate scrollbar: DomScrollableElement;\n\tprivate body: HTMLElement;\n\tprivate header: HTMLElement;\n\tprivate type: HTMLElement;\n\tprivate docs: HTMLElement;\n\tprivate ariaLabel: string | null;\n\tprivate disposables: IDisposable[];\n\tprivate renderDisposeable: IDisposable;\n\tprivate borderWidth: number = 1;\n\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\tprivate readonly widget: SuggestWidget,\n\t\tprivate readonly editor: ICodeEditor,\n\t\tprivate readonly markdownRenderer: MarkdownRenderer,\n\t\tprivate readonly triggerKeybindingLabel: string\n\t) {\n\t\tthis.disposables = [];\n\n\t\tthis.el = append(container, $('.details'));\n\t\tthis.disposables.push(toDisposable(() => container.removeChild(this.el)));\n\n\t\tthis.body = $('.body');\n\n\t\tthis.scrollbar = new DomScrollableElement(this.body, {});\n\t\tappend(this.el, this.scrollbar.getDomNode());\n\t\tthis.disposables.push(this.scrollbar);\n\n\t\tthis.header = append(this.body, $('.header'));\n\t\tthis.close = append(this.header, $('span.close'));\n\t\tthis.close.title = nls.localize('readLess', \"Read less...{0}\", this.triggerKeybindingLabel);\n\t\tthis.type = append(this.header, $('p.type'));\n\n\t\tthis.docs = append(this.body, $('p.docs'));\n\t\tthis.ariaLabel = null;\n\n\t\tthis.configureFont();\n\n\t\tEvent.chain<IConfigurationChangedEvent>(this.editor.onDidChangeConfiguration.bind(this.editor))\n\t\t\t.filter(e => e.fontInfo)\n\t\t\t.on(this.configureFont, this, this.disposables);\n\n\t\tmarkdownRenderer.onDidRenderCodeBlock(() => this.scrollbar.scanDomNode(), this, this.disposables);\n\t}\n\n\tget element() {\n\t\treturn this.el;\n\t}\n\n\trender(item: CompletionItem): void {\n\t\tthis.renderDisposeable = dispose(this.renderDisposeable);\n\n\t\tif (!item || !canExpandCompletionItem(item)) {\n\t\t\tthis.type.textContent = '';\n\t\t\tthis.docs.textContent = '';\n\t\t\taddClass(this.el, 'no-docs');\n\t\t\tthis.ariaLabel = null;\n\t\t\treturn;\n\t\t}\n\t\tremoveClass(this.el, 'no-docs');\n\t\tif (typeof item.completion.documentation === 'string') {\n\t\t\tremoveClass(this.docs, 'markdown-docs');\n\t\t\tthis.docs.textContent = item.completion.documentation;\n\t\t} else {\n\t\t\taddClass(this.docs, 'markdown-docs');\n\t\t\tthis.docs.innerHTML = '';\n\t\t\tconst renderedContents = this.markdownRenderer.render(item.completion.documentation);\n\t\t\tthis.renderDisposeable = renderedContents;\n\t\t\tthis.docs.appendChild(renderedContents.element);\n\t\t}\n\n\t\tif (item.completion.detail) {\n\t\t\tthis.type.innerText = item.completion.detail;\n\t\t\tshow(this.type);\n\t\t} else {\n\t\t\tthis.type.innerText = '';\n\t\t\thide(this.type);\n\t\t}\n\n\t\tthis.el.style.height = this.header.offsetHeight + this.docs.offsetHeight + (this.borderWidth * 2) + 'px';\n\n\t\tthis.close.onmousedown = e => {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t};\n\t\tthis.close.onclick = e => {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tthis.widget.toggleDetails();\n\t\t};\n\n\t\tthis.body.scrollTop = 0;\n\t\tthis.scrollbar.scanDomNode();\n\n\t\tthis.ariaLabel = strings.format(\n\t\t\t'{0}{1}',\n\t\t\titem.completion.detail || '',\n\t\t\titem.completion.documentation ? (typeof item.completion.documentation === 'string' ? item.completion.documentation : item.completion.documentation.value) : '');\n\t}\n\n\tgetAriaLabel() {\n\t\treturn this.ariaLabel;\n\t}\n\n\tscrollDown(much = 8): void {\n\t\tthis.body.scrollTop += much;\n\t}\n\n\tscrollUp(much = 8): void {\n\t\tthis.body.scrollTop -= much;\n\t}\n\n\tscrollTop(): void {\n\t\tthis.body.scrollTop = 0;\n\t}\n\n\tscrollBottom(): void {\n\t\tthis.body.scrollTop = this.body.scrollHeight;\n\t}\n\n\tpageDown(): void {\n\t\tthis.scrollDown(80);\n\t}\n\n\tpageUp(): void {\n\t\tthis.scrollUp(80);\n\t}\n\n\tsetBorderWidth(width: number): void {\n\t\tthis.borderWidth = width;\n\t}\n\n\tprivate configureFont() {\n\t\tconst configuration = this.editor.getConfiguration();\n\t\tconst fontFamily = configuration.fontInfo.fontFamily;\n\t\tconst fontSize = configuration.contribInfo.suggestFontSize || configuration.fontInfo.fontSize;\n\t\tconst lineHeight = configuration.contribInfo.suggestLineHeight || configuration.fontInfo.lineHeight;\n\t\tconst fontWeight = configuration.fontInfo.fontWeight;\n\t\tconst fontSizePx = `${fontSize}px`;\n\t\tconst lineHeightPx = `${lineHeight}px`;\n\n\t\tthis.el.style.fontSize = fontSizePx;\n\t\tthis.el.style.fontWeight = fontWeight;\n\t\tthis.type.style.fontFamily = fontFamily;\n\t\tthis.close.style.height = lineHeightPx;\n\t\tthis.close.style.width = lineHeightPx;\n\t}\n\n\tdispose(): void {\n\t\tthis.disposables = dispose(this.disposables);\n\t\tthis.renderDisposeable = dispose(this.renderDisposeable);\n\t}\n}\n\nexport interface ISelectedSuggestion {\n\titem: CompletionItem;\n\tindex: number;\n\tmodel: CompletionModel;\n}\n\nexport class SuggestWidget implements IContentWidget, IListVirtualDelegate<CompletionItem>, IDisposable {\n\n\tprivate static readonly ID: string = 'editor.widget.suggestWidget';\n\n\tstatic LOADING_MESSAGE: string = nls.localize('suggestWidget.loading', \"Loading...\");\n\tstatic NO_SUGGESTIONS_MESSAGE: string = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\n\n\t// Editor.IContentWidget.allowEditorOverflow\n\treadonly allowEditorOverflow = true;\n\n\tprivate state: State | null;\n\tprivate isAuto: boolean;\n\tprivate loadingTimeout: any;\n\tprivate currentSuggestionDetails: CancelablePromise<void> | null;\n\tprivate focusedItem: CompletionItem | null;\n\tprivate ignoreFocusEvents = false;\n\tprivate completionModel: CompletionModel | null;\n\n\tprivate element: HTMLElement;\n\tprivate messageElement: HTMLElement;\n\tprivate listElement: HTMLElement;\n\tprivate details: SuggestionDetails;\n\tprivate list: List<CompletionItem>;\n\tprivate listHeight: number;\n\n\tprivate readonly suggestWidgetVisible: IContextKey<boolean>;\n\tprivate readonly suggestWidgetMultipleSuggestions: IContextKey<boolean>;\n\n\tprivate readonly editorBlurTimeout = new TimeoutTimer();\n\tprivate readonly showTimeout = new TimeoutTimer();\n\tprivate toDispose: IDisposable[];\n\n\tprivate onDidSelectEmitter = new Emitter<ISelectedSuggestion>();\n\tprivate onDidFocusEmitter = new Emitter<ISelectedSuggestion>();\n\tprivate onDidHideEmitter = new Emitter<this>();\n\tprivate onDidShowEmitter = new Emitter<this>();\n\n\n\treadonly onDidSelect: Event<ISelectedSuggestion> = this.onDidSelectEmitter.event;\n\treadonly onDidFocus: Event<ISelectedSuggestion> = this.onDidFocusEmitter.event;\n\treadonly onDidHide: Event<this> = this.onDidHideEmitter.event;\n\treadonly onDidShow: Event<this> = this.onDidShowEmitter.event;\n\n\tprivate readonly maxWidgetWidth = 660;\n\tprivate readonly listWidth = 330;\n\tprivate readonly storageService: IStorageService;\n\tprivate detailsFocusBorderColor: string;\n\tprivate detailsBorderColor: string;\n\n\tprivate firstFocusInCurrentList: boolean = false;\n\n\tprivate preferDocPositionTop: boolean = false;\n\tprivate docsPositionPreviousWidgetY: number | null;\n\n\tconstructor(\n\t\tprivate readonly editor: ICodeEditor,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IModeService modeService: IModeService,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\t\tconst kb = keybindingService.lookupKeybinding('editor.action.triggerSuggest');\n\t\tconst triggerKeybindingLabel = !kb ? '' : ` (${kb.getLabel()})`;\n\t\tconst markdownRenderer = new MarkdownRenderer(editor, modeService, openerService);\n\n\t\tthis.isAuto = false;\n\t\tthis.focusedItem = null;\n\t\tthis.storageService = storageService;\n\n\t\tthis.element = $('.editor-widget.suggest-widget');\n\n\t\tthis.messageElement = append(this.element, $('.message'));\n\t\tthis.listElement = append(this.element, $('.tree'));\n\t\tthis.details = new SuggestionDetails(this.element, this, this.editor, markdownRenderer, triggerKeybindingLabel);\n\n\t\tconst applyIconStyle = () => toggleClass(this.element, 'no-icons', !this.editor.getConfiguration().contribInfo.suggest.showIcons);\n\t\tapplyIconStyle();\n\n\t\tlet renderer = instantiationService.createInstance(Renderer, this, this.editor, triggerKeybindingLabel);\n\n\t\tthis.list = new List(this.listElement, this, [renderer], {\n\t\t\tuseShadows: false,\n\t\t\topenController: { shouldOpen: () => false },\n\t\t\tmouseSupport: false\n\t\t});\n\n\t\tthis.toDispose = [\n\t\t\tattachListStyler(this.list, themeService, {\n\t\t\t\tlistInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\n\t\t\t\tlistInactiveFocusOutline: activeContrastBorder\n\t\t\t}),\n\t\t\tthemeService.onThemeChange(t => this.onThemeChange(t)),\n\t\t\teditor.onDidLayoutChange(() => this.onEditorLayoutChange()),\n\t\t\tthis.list.onMouseDown(e => this.onListMouseDown(e)),\n\t\t\tthis.list.onSelectionChange(e => this.onListSelection(e)),\n\t\t\tthis.list.onFocusChange(e => this.onListFocus(e)),\n\t\t\tthis.editor.onDidChangeCursorSelection(() => this.onCursorSelectionChanged()),\n\t\t\tthis.editor.onDidChangeConfiguration(e => e.contribInfo && applyIconStyle())\n\t\t];\n\n\t\tthis.suggestWidgetVisible = SuggestContext.Visible.bindTo(contextKeyService);\n\t\tthis.suggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(contextKeyService);\n\n\t\tthis.editor.addContentWidget(this);\n\t\tthis.setState(State.Hidden);\n\n\t\tthis.onThemeChange(themeService.getTheme());\n\t}\n\n\tprivate onCursorSelectionChanged(): void {\n\t\tif (this.state === State.Hidden) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.editor.layoutContentWidget(this);\n\t}\n\n\tprivate onEditorLayoutChange(): void {\n\t\tif ((this.state === State.Open || this.state === State.Details) && this.expandDocsSettingFromStorage()) {\n\t\t\tthis.expandSideOrBelow();\n\t\t}\n\t}\n\n\tprivate onListMouseDown(e: IListMouseEvent<CompletionItem>): void {\n\t\tif (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\t// prevent stealing browser focus from the editor\n\t\te.browserEvent.preventDefault();\n\t\te.browserEvent.stopPropagation();\n\n\t\tthis.select(e.element, e.index);\n\t}\n\n\tprivate onListSelection(e: IListEvent<CompletionItem>): void {\n\t\tif (!e.elements.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.select(e.elements[0], e.indexes[0]);\n\t}\n\n\tprivate select(item: CompletionItem, index: number): void {\n\t\tconst completionModel = this.completionModel;\n\n\t\tif (!completionModel) {\n\t\t\treturn;\n\t\t}\n\n\t\titem.resolve(CancellationToken.None).then(() => {\n\t\t\tthis.onDidSelectEmitter.fire({ item, index, model: completionModel });\n\t\t\tthis.editor.focus();\n\t\t});\n\t}\n\n\tprivate _getSuggestionAriaAlertLabel(item: CompletionItem): string {\n\t\tif (this.expandDocsSettingFromStorage()) {\n\t\t\treturn nls.localize('ariaCurrenttSuggestionReadDetails', \"Item {0}, docs: {1}\", item.completion.label, this.details.getAriaLabel());\n\t\t} else {\n\t\t\treturn item.completion.label;\n\t\t}\n\t}\n\n\tprivate _lastAriaAlertLabel: string | null;\n\tprivate _ariaAlert(newAriaAlertLabel: string | null): void {\n\t\tif (this._lastAriaAlertLabel === newAriaAlertLabel) {\n\t\t\treturn;\n\t\t}\n\t\tthis._lastAriaAlertLabel = newAriaAlertLabel;\n\t\tif (this._lastAriaAlertLabel) {\n\t\t\talert(this._lastAriaAlertLabel, true);\n\t\t}\n\t}\n\n\tprivate onThemeChange(theme: ITheme) {\n\t\tconst backgroundColor = theme.getColor(editorSuggestWidgetBackground);\n\t\tif (backgroundColor) {\n\t\t\tthis.listElement.style.backgroundColor = backgroundColor.toString();\n\t\t\tthis.details.element.style.backgroundColor = backgroundColor.toString();\n\t\t\tthis.messageElement.style.backgroundColor = backgroundColor.toString();\n\t\t}\n\t\tconst borderColor = theme.getColor(editorSuggestWidgetBorder);\n\t\tif (borderColor) {\n\t\t\tthis.listElement.style.borderColor = borderColor.toString();\n\t\t\tthis.details.element.style.borderColor = borderColor.toString();\n\t\t\tthis.messageElement.style.borderColor = borderColor.toString();\n\t\t\tthis.detailsBorderColor = borderColor.toString();\n\t\t}\n\t\tconst focusBorderColor = theme.getColor(focusBorder);\n\t\tif (focusBorderColor) {\n\t\t\tthis.detailsFocusBorderColor = focusBorderColor.toString();\n\t\t}\n\t\tthis.details.setBorderWidth(theme.type === 'hc' ? 2 : 1);\n\t}\n\n\tprivate onListFocus(e: IListEvent<CompletionItem>): void {\n\t\tif (this.ignoreFocusEvents) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!e.elements.length) {\n\t\t\tif (this.currentSuggestionDetails) {\n\t\t\t\tthis.currentSuggestionDetails.cancel();\n\t\t\t\tthis.currentSuggestionDetails = null;\n\t\t\t\tthis.focusedItem = null;\n\t\t\t}\n\n\t\t\tthis._ariaAlert(null);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.completionModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst item = e.elements[0];\n\t\tconst index = e.indexes[0];\n\n\t\tthis.firstFocusInCurrentList = !this.focusedItem;\n\t\tif (item !== this.focusedItem) {\n\n\n\t\t\tif (this.currentSuggestionDetails) {\n\t\t\t\tthis.currentSuggestionDetails.cancel();\n\t\t\t\tthis.currentSuggestionDetails = null;\n\t\t\t}\n\n\t\t\tthis.focusedItem = item;\n\n\t\t\tthis.list.reveal(index);\n\n\t\t\tthis.currentSuggestionDetails = createCancelablePromise(token => item.resolve(token));\n\n\t\t\tthis.currentSuggestionDetails.then(() => {\n\t\t\t\tif (this.list.length < index) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// item can have extra information, so re-render\n\t\t\t\tthis.ignoreFocusEvents = true;\n\t\t\t\tthis.list.splice(index, 1, [item]);\n\t\t\t\tthis.list.setFocus([index]);\n\t\t\t\tthis.ignoreFocusEvents = false;\n\n\t\t\t\tif (this.expandDocsSettingFromStorage()) {\n\t\t\t\t\tthis.showDetails();\n\t\t\t\t} else {\n\t\t\t\t\tremoveClass(this.element, 'docs-side');\n\t\t\t\t}\n\n\t\t\t\tthis._ariaAlert(this._getSuggestionAriaAlertLabel(item));\n\t\t\t}).catch(onUnexpectedError).then(() => {\n\t\t\t\tif (this.focusedItem === item) {\n\t\t\t\t\tthis.currentSuggestionDetails = null;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// emit an event\n\t\tthis.onDidFocusEmitter.fire({ item, index, model: this.completionModel });\n\t}\n\n\tprivate setState(state: State): void {\n\t\tif (!this.element) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst stateChanged = this.state !== state;\n\t\tthis.state = state;\n\n\t\ttoggleClass(this.element, 'frozen', state === State.Frozen);\n\n\t\tswitch (state) {\n\t\t\tcase State.Hidden:\n\t\t\t\thide(this.messageElement, this.details.element, this.listElement);\n\t\t\t\tthis.hide();\n\t\t\t\tthis.listHeight = 0;\n\t\t\t\tif (stateChanged) {\n\t\t\t\t\tthis.list.splice(0, this.list.length);\n\t\t\t\t}\n\t\t\t\tthis.focusedItem = null;\n\t\t\t\tbreak;\n\t\t\tcase State.Loading:\n\t\t\t\tthis.messageElement.textContent = SuggestWidget.LOADING_MESSAGE;\n\t\t\t\thide(this.listElement, this.details.element);\n\t\t\t\tshow(this.messageElement);\n\t\t\t\tremoveClass(this.element, 'docs-side');\n\t\t\t\tthis.show();\n\t\t\t\tthis.focusedItem = null;\n\t\t\t\tbreak;\n\t\t\tcase State.Empty:\n\t\t\t\tthis.messageElement.textContent = SuggestWidget.NO_SUGGESTIONS_MESSAGE;\n\t\t\t\thide(this.listElement, this.details.element);\n\t\t\t\tshow(this.messageElement);\n\t\t\t\tremoveClass(this.element, 'docs-side');\n\t\t\t\tthis.show();\n\t\t\t\tthis.focusedItem = null;\n\t\t\t\tbreak;\n\t\t\tcase State.Open:\n\t\t\t\thide(this.messageElement);\n\t\t\t\tshow(this.listElement);\n\t\t\t\tthis.show();\n\t\t\t\tbreak;\n\t\t\tcase State.Frozen:\n\t\t\t\thide(this.messageElement);\n\t\t\t\tshow(this.listElement);\n\t\t\t\tthis.show();\n\t\t\t\tbreak;\n\t\t\tcase State.Details:\n\t\t\t\thide(this.messageElement);\n\t\t\t\tshow(this.details.element, this.listElement);\n\t\t\t\tthis.show();\n\t\t\t\tthis._ariaAlert(this.details.getAriaLabel());\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tshowTriggered(auto: boolean, delay: number) {\n\t\tif (this.state !== State.Hidden) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isAuto = !!auto;\n\n\t\tif (!this.isAuto) {\n\t\t\tthis.loadingTimeout = setTimeout(() => {\n\t\t\t\tthis.loadingTimeout = null;\n\t\t\t\tthis.setState(State.Loading);\n\t\t\t}, delay);\n\t\t}\n\t}\n\n\tshowSuggestions(completionModel: CompletionModel, selectionIndex: number, isFrozen: boolean, isAuto: boolean): void {\n\t\tthis.preferDocPositionTop = false;\n\t\tthis.docsPositionPreviousWidgetY = null;\n\n\t\tif (this.loadingTimeout) {\n\t\t\tclearTimeout(this.loadingTimeout);\n\t\t\tthis.loadingTimeout = null;\n\t\t}\n\n\t\tif (this.currentSuggestionDetails) {\n\t\t\tthis.currentSuggestionDetails.cancel();\n\t\t\tthis.currentSuggestionDetails = null;\n\t\t}\n\n\t\tif (this.completionModel !== completionModel) {\n\t\t\tthis.completionModel = completionModel;\n\t\t}\n\n\t\tif (isFrozen && this.state !== State.Empty && this.state !== State.Hidden) {\n\t\t\tthis.setState(State.Frozen);\n\t\t\treturn;\n\t\t}\n\n\t\tlet visibleCount = this.completionModel.items.length;\n\n\t\tconst isEmpty = visibleCount === 0;\n\t\tthis.suggestWidgetMultipleSuggestions.set(visibleCount > 1);\n\n\t\tif (isEmpty) {\n\t\t\tif (isAuto) {\n\t\t\t\tthis.setState(State.Hidden);\n\t\t\t} else {\n\t\t\t\tthis.setState(State.Empty);\n\t\t\t}\n\n\t\t\tthis.completionModel = null;\n\n\t\t} else {\n\n\t\t\tif (this.state !== State.Open) {\n\t\t\t\tconst { stats } = this.completionModel;\n\t\t\t\tstats['wasAutomaticallyTriggered'] = !!isAuto;\n\t\t\t\t/* __GDPR__\n\t\t\t\t\t\"suggestWidget\" : {\n\t\t\t\t\t\t\"wasAutomaticallyTriggered\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\t\"${ICompletionStats}\",\n\t\t\t\t\t\t\t\"${EditorTelemetryData}\"\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tthis.telemetryService.publicLog('suggestWidget', { ...stats, ...this.editor.getTelemetryData() });\n\t\t\t}\n\n\t\t\tthis.focusedItem = null;\n\t\t\tthis.list.splice(0, this.list.length, this.completionModel.items);\n\n\t\t\tif (isFrozen) {\n\t\t\t\tthis.setState(State.Frozen);\n\t\t\t} else {\n\t\t\t\tthis.setState(State.Open);\n\t\t\t}\n\n\t\t\tthis.list.reveal(selectionIndex, 0);\n\t\t\tthis.list.setFocus([selectionIndex]);\n\n\t\t\t// Reset focus border\n\t\t\tif (this.detailsBorderColor) {\n\t\t\t\tthis.details.element.style.borderColor = this.detailsBorderColor;\n\t\t\t}\n\t\t}\n\t}\n\n\tselectNextPage(): boolean {\n\t\tswitch (this.state) {\n\t\t\tcase State.Hidden:\n\t\t\t\treturn false;\n\t\t\tcase State.Details:\n\t\t\t\tthis.details.pageDown();\n\t\t\t\treturn true;\n\t\t\tcase State.Loading:\n\t\t\t\treturn !this.isAuto;\n\t\t\tdefault:\n\t\t\t\tthis.list.focusNextPage();\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tselectNext(): boolean {\n\t\tswitch (this.state) {\n\t\t\tcase State.Hidden:\n\t\t\t\treturn false;\n\t\t\tcase State.Loading:\n\t\t\t\treturn !this.isAuto;\n\t\t\tdefault:\n\t\t\t\tthis.list.focusNext(1, true);\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tselectLast(): boolean {\n\t\tswitch (this.state) {\n\t\t\tcase State.Hidden:\n\t\t\t\treturn false;\n\t\t\tcase State.Details:\n\t\t\t\tthis.details.scrollBottom();\n\t\t\t\treturn true;\n\t\t\tcase State.Loading:\n\t\t\t\treturn !this.isAuto;\n\t\t\tdefault:\n\t\t\t\tthis.list.focusLast();\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tselectPreviousPage(): boolean {\n\t\tswitch (this.state) {\n\t\t\tcase State.Hidden:\n\t\t\t\treturn false;\n\t\t\tcase State.Details:\n\t\t\t\tthis.details.pageUp();\n\t\t\t\treturn true;\n\t\t\tcase State.Loading:\n\t\t\t\treturn !this.isAuto;\n\t\t\tdefault:\n\t\t\t\tthis.list.focusPreviousPage();\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tselectPrevious(): boolean {\n\t\tswitch (this.state) {\n\t\t\tcase State.Hidden:\n\t\t\t\treturn false;\n\t\t\tcase State.Loading:\n\t\t\t\treturn !this.isAuto;\n\t\t\tdefault:\n\t\t\t\tthis.list.focusPrevious(1, true);\n\t\t\t\treturn false;\n\t\t}\n\t}\n\n\tselectFirst(): boolean {\n\t\tswitch (this.state) {\n\t\t\tcase State.Hidden:\n\t\t\t\treturn false;\n\t\t\tcase State.Details:\n\t\t\t\tthis.details.scrollTop();\n\t\t\t\treturn true;\n\t\t\tcase State.Loading:\n\t\t\t\treturn !this.isAuto;\n\t\t\tdefault:\n\t\t\t\tthis.list.focusFirst();\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tgetFocusedItem(): ISelectedSuggestion | undefined {\n\t\tif (this.state !== State.Hidden\n\t\t\t&& this.state !== State.Empty\n\t\t\t&& this.state !== State.Loading\n\t\t\t&& this.completionModel\n\t\t) {\n\n\t\t\treturn {\n\t\t\t\titem: this.list.getFocusedElements()[0],\n\t\t\t\tindex: this.list.getFocus()[0],\n\t\t\t\tmodel: this.completionModel\n\t\t\t};\n\t\t}\n\t\treturn undefined;\n\t}\n\n\ttoggleDetailsFocus(): void {\n\t\tif (this.state === State.Details) {\n\t\t\tthis.setState(State.Open);\n\t\t\tif (this.detailsBorderColor) {\n\t\t\t\tthis.details.element.style.borderColor = this.detailsBorderColor;\n\t\t\t}\n\t\t} else if (this.state === State.Open && this.expandDocsSettingFromStorage()) {\n\t\t\tthis.setState(State.Details);\n\t\t\tif (this.detailsFocusBorderColor) {\n\t\t\t\tthis.details.element.style.borderColor = this.detailsFocusBorderColor;\n\t\t\t}\n\t\t}\n\t\t/* __GDPR__\n\t\t\t\"suggestWidget:toggleDetailsFocus\" : {\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${EditorTelemetryData}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryService.publicLog('suggestWidget:toggleDetailsFocus', this.editor.getTelemetryData());\n\t}\n\n\ttoggleDetails(): void {\n\t\tif (!canExpandCompletionItem(this.list.getFocusedElements()[0])) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.expandDocsSettingFromStorage()) {\n\t\t\tthis.updateExpandDocsSetting(false);\n\t\t\thide(this.details.element);\n\t\t\tremoveClass(this.element, 'docs-side');\n\t\t\tremoveClass(this.element, 'docs-below');\n\t\t\tthis.editor.layoutContentWidget(this);\n\t\t\t/* __GDPR__\n\t\t\t\t\"suggestWidget:collapseDetails\" : {\n\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\"${EditorTelemetryData}\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.telemetryService.publicLog('suggestWidget:collapseDetails', this.editor.getTelemetryData());\n\t\t} else {\n\t\t\tif (this.state !== State.Open && this.state !== State.Details && this.state !== State.Frozen) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.updateExpandDocsSetting(true);\n\t\t\tthis.showDetails();\n\t\t\tthis._ariaAlert(this.details.getAriaLabel());\n\t\t\t/* __GDPR__\n\t\t\t\t\"suggestWidget:expandDetails\" : {\n\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\"${EditorTelemetryData}\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.telemetryService.publicLog('suggestWidget:expandDetails', this.editor.getTelemetryData());\n\t\t}\n\t}\n\n\tshowDetails(): void {\n\t\tthis.expandSideOrBelow();\n\n\t\tshow(this.details.element);\n\t\tthis.details.render(this.list.getFocusedElements()[0]);\n\t\tthis.details.element.style.maxHeight = this.maxWidgetHeight + 'px';\n\n\t\t// Reset margin-top that was set as Fix for #26416\n\t\tthis.listElement.style.marginTop = '0px';\n\n\t\t// with docs showing up widget width/height may change, so reposition the widget\n\t\tthis.editor.layoutContentWidget(this);\n\n\t\tthis.adjustDocsPosition();\n\n\t\tthis.editor.focus();\n\t}\n\n\tprivate show(): void {\n\t\tconst newHeight = this.updateListHeight();\n\t\tif (newHeight !== this.listHeight) {\n\t\t\tthis.editor.layoutContentWidget(this);\n\t\t\tthis.listHeight = newHeight;\n\t\t}\n\n\t\tthis.suggestWidgetVisible.set(true);\n\n\t\tthis.showTimeout.cancelAndSet(() => {\n\t\t\taddClass(this.element, 'visible');\n\t\t\tthis.onDidShowEmitter.fire(this);\n\t\t}, 100);\n\t}\n\n\tprivate hide(): void {\n\t\tthis.suggestWidgetVisible.reset();\n\t\tthis.suggestWidgetMultipleSuggestions.reset();\n\t\tremoveClass(this.element, 'visible');\n\t}\n\n\thideWidget(): void {\n\t\tclearTimeout(this.loadingTimeout);\n\t\tthis.setState(State.Hidden);\n\t\tthis.onDidHideEmitter.fire(this);\n\t}\n\n\tgetPosition(): IContentWidgetPosition | null {\n\t\tif (this.state === State.Hidden) {\n\t\t\treturn null;\n\t\t}\n\n\t\tlet preference = [ContentWidgetPositionPreference.BELOW, ContentWidgetPositionPreference.ABOVE];\n\t\tif (this.preferDocPositionTop) {\n\t\t\tpreference = [ContentWidgetPositionPreference.ABOVE];\n\t\t}\n\n\t\treturn {\n\t\t\tposition: this.editor.getPosition(),\n\t\t\tpreference: preference\n\t\t};\n\t}\n\n\tgetDomNode(): HTMLElement {\n\t\treturn this.element;\n\t}\n\n\tgetId(): string {\n\t\treturn SuggestWidget.ID;\n\t}\n\n\tprivate updateListHeight(): number {\n\t\tlet height = 0;\n\n\t\tif (this.state === State.Empty || this.state === State.Loading) {\n\t\t\theight = this.unfocusedHeight;\n\t\t} else {\n\t\t\tconst suggestionCount = this.list.contentHeight / this.unfocusedHeight;\n\t\t\tconst { maxVisibleSuggestions } = this.editor.getConfiguration().contribInfo.suggest;\n\t\t\theight = Math.min(suggestionCount, maxVisibleSuggestions) * this.unfocusedHeight;\n\t\t}\n\n\t\tthis.element.style.lineHeight = `${this.unfocusedHeight}px`;\n\t\tthis.listElement.style.height = `${height}px`;\n\t\tthis.list.layout(height);\n\t\treturn height;\n\t}\n\n\t/**\n\t * Adds the propert classes, margins when positioning the docs to the side\n\t */\n\tprivate adjustDocsPosition() {\n\t\tif (!this.editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst lineHeight = this.editor.getConfiguration().fontInfo.lineHeight;\n\t\tconst cursorCoords = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\n\t\tconst editorCoords = getDomNodePagePosition(this.editor.getDomNode());\n\t\tconst cursorX = editorCoords.left + cursorCoords.left;\n\t\tconst cursorY = editorCoords.top + cursorCoords.top + cursorCoords.height;\n\t\tconst widgetCoords = getDomNodePagePosition(this.element);\n\t\tconst widgetX = widgetCoords.left;\n\t\tconst widgetY = widgetCoords.top;\n\n\t\t// Fixes #27649\n\t\t// Check if the Y changed to the top of the cursor and keep the widget flagged to prefer top\n\t\tif (this.docsPositionPreviousWidgetY &&\n\t\t\tthis.docsPositionPreviousWidgetY < widgetY &&\n\t\t\t!this.preferDocPositionTop) {\n\t\t\tthis.preferDocPositionTop = true;\n\t\t\tthis.adjustDocsPosition();\n\t\t\treturn;\n\t\t}\n\t\tthis.docsPositionPreviousWidgetY = widgetY;\n\n\t\tif (widgetX < cursorX - this.listWidth) {\n\t\t\t// Widget is too far to the left of cursor, swap list and docs\n\t\t\taddClass(this.element, 'list-right');\n\t\t} else {\n\t\t\tremoveClass(this.element, 'list-right');\n\t\t}\n\n\t\t// Compare top of the cursor (cursorY - lineheight) with widgetTop to determine if\n\t\t// margin-top needs to be applied on list to make it appear right above the cursor\n\t\t// Cannot compare cursorY directly as it may be a few decimals off due to zoooming\n\t\tif (hasClass(this.element, 'docs-side')\n\t\t\t&& cursorY - lineHeight > widgetY\n\t\t\t&& this.details.element.offsetHeight > this.listElement.offsetHeight) {\n\n\t\t\t// Fix for #26416\n\t\t\t// Docs is bigger than list and widget is above cursor, apply margin-top so that list appears right above cursor\n\t\t\tthis.listElement.style.marginTop = `${this.details.element.offsetHeight - this.listElement.offsetHeight}px`;\n\t\t}\n\t}\n\n\t/**\n\t * Adds the proper classes for positioning the docs to the side or below\n\t */\n\tprivate expandSideOrBelow() {\n\t\tif (!canExpandCompletionItem(this.focusedItem) && this.firstFocusInCurrentList) {\n\t\t\tremoveClass(this.element, 'docs-side');\n\t\t\tremoveClass(this.element, 'docs-below');\n\t\t\treturn;\n\t\t}\n\n\t\tlet matches = this.element.style.maxWidth!.match(/(\\d+)px/);\n\t\tif (!matches || Number(matches[1]) < this.maxWidgetWidth) {\n\t\t\taddClass(this.element, 'docs-below');\n\t\t\tremoveClass(this.element, 'docs-side');\n\t\t} else if (canExpandCompletionItem(this.focusedItem)) {\n\t\t\taddClass(this.element, 'docs-side');\n\t\t\tremoveClass(this.element, 'docs-below');\n\t\t}\n\t}\n\n\t// Heights\n\n\tprivate get maxWidgetHeight(): number {\n\t\treturn this.unfocusedHeight * this.editor.getConfiguration().contribInfo.suggest.maxVisibleSuggestions;\n\t}\n\n\tprivate get unfocusedHeight(): number {\n\t\tconst configuration = this.editor.getConfiguration();\n\t\treturn configuration.contribInfo.suggestLineHeight || configuration.fontInfo.lineHeight;\n\t}\n\n\t// IDelegate\n\n\tgetHeight(element: CompletionItem): number {\n\t\treturn this.unfocusedHeight;\n\t}\n\n\tgetTemplateId(element: CompletionItem): string {\n\t\treturn 'suggestion';\n\t}\n\n\tprivate expandDocsSettingFromStorage(): boolean {\n\t\treturn this.storageService.getBoolean('expandSuggestionDocs', StorageScope.GLOBAL, expandSuggestionDocsByDefault);\n\t}\n\n\tprivate updateExpandDocsSetting(value: boolean) {\n\t\tthis.storageService.store('expandSuggestionDocs', value, StorageScope.GLOBAL);\n\t}\n\n\tdispose(): void {\n\t\tthis.state = null;\n\t\tthis.currentSuggestionDetails = null;\n\t\tthis.focusedItem = null;\n\t\tthis.element = null!; // StrictNullOverride: nulling out ok in dispose\n\t\tthis.messageElement = null!; // StrictNullOverride: nulling out ok in dispose\n\t\tthis.listElement = null!; // StrictNullOverride: nulling out ok in dispose\n\t\tthis.details.dispose();\n\t\tthis.details = null!; // StrictNullOverride: nulling out ok in dispose\n\t\tthis.list.dispose();\n\t\tthis.list = null!; // StrictNullOverride: nulling out ok in dispose\n\t\tthis.toDispose = dispose(this.toDispose);\n\t\tif (this.loadingTimeout) {\n\t\t\tclearTimeout(this.loadingTimeout);\n\t\t\tthis.loadingTimeout = null;\n\t\t}\n\n\t\tthis.editorBlurTimeout.dispose();\n\t\tthis.showTimeout.dispose();\n\t}\n}\n\nregisterThemingParticipant((theme, collector) => {\n\tconst matchHighlight = theme.getColor(editorSuggestWidgetHighlightForeground);\n\tif (matchHighlight) {\n\t\tcollector.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row .monaco-highlighted-label .highlight { color: ${matchHighlight}; }`);\n\t}\n\tconst foreground = theme.getColor(editorSuggestWidgetForeground);\n\tif (foreground) {\n\t\tcollector.addRule(`.monaco-editor .suggest-widget { color: ${foreground}; }`);\n\t}\n\n\tconst link = theme.getColor(textLinkForeground);\n\tif (link) {\n\t\tcollector.addRule(`.monaco-editor .suggest-widget a { color: ${link}; }`);\n\t}\n\n\tconst codeBackground = theme.getColor(textCodeBlockBackground);\n\tif (codeBackground) {\n\t\tcollector.addRule(`.monaco-editor .suggest-widget code { background-color: ${codeBackground}; }`);\n\t}\n});\n"]}]}