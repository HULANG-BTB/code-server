{"remainingRequest":"/home/coding/workspace/node_modules/ts-loader/index.js?{\"happyPackMode\":true,\"compilerOptions\":{\"target\":\"es5\",\"lib\":[\"dom\",\"esnext\"]}}!/home/coding/workspace/lib/vscode/src/vs/editor/browser/widget/codeEditorWidget.ts","dependencies":[{"path":"/home/coding/workspace/lib/vscode/src/vs/editor/browser/widget/codeEditorWidget.ts","mtime":1555102316000},{"path":"/home/coding/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1555844183884},{"path":"/home/coding/workspace/node_modules/ts-loader/index.js","mtime":1555844217316}],"contextDependencies":[],"result":["\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nrequire(\"vs/css!./media/editor\");\nrequire(\"vs/css!./media/tokens\");\nvar nls = require(\"vs/nls\");\nvar dom = require(\"vs/base/browser/dom\");\nvar errors_1 = require(\"vs/base/common/errors\");\nvar event_1 = require(\"vs/base/common/event\");\nvar hash_1 = require(\"vs/base/common/hash\");\nvar lifecycle_1 = require(\"vs/base/common/lifecycle\");\nvar network_1 = require(\"vs/base/common/network\");\nvar configuration_1 = require(\"vs/editor/browser/config/configuration\");\nvar editorExtensions_1 = require(\"vs/editor/browser/editorExtensions\");\nvar codeEditorService_1 = require(\"vs/editor/browser/services/codeEditorService\");\nvar viewImpl_1 = require(\"vs/editor/browser/view/viewImpl\");\nvar viewOutgoingEvents_1 = require(\"vs/editor/browser/view/viewOutgoingEvents\");\nvar cursor_1 = require(\"vs/editor/common/controller/cursor\");\nvar cursorCommon_1 = require(\"vs/editor/common/controller/cursorCommon\");\nvar position_1 = require(\"vs/editor/common/core/position\");\nvar range_1 = require(\"vs/editor/common/core/range\");\nvar selection_1 = require(\"vs/editor/common/core/selection\");\nvar editorAction_1 = require(\"vs/editor/common/editorAction\");\nvar editorCommon = require(\"vs/editor/common/editorCommon\");\nvar editorContextKeys_1 = require(\"vs/editor/common/editorContextKeys\");\nvar model_1 = require(\"vs/editor/common/model\");\nvar intervalTree_1 = require(\"vs/editor/common/model/intervalTree\");\nvar textModel_1 = require(\"vs/editor/common/model/textModel\");\nvar modes = require(\"vs/editor/common/modes\");\nvar editorColorRegistry_1 = require(\"vs/editor/common/view/editorColorRegistry\");\nvar viewEvents_1 = require(\"vs/editor/common/view/viewEvents\");\nvar viewModelImpl_1 = require(\"vs/editor/common/viewModel/viewModelImpl\");\nvar commands_1 = require(\"vs/platform/commands/common/commands\");\nvar contextkey_1 = require(\"vs/platform/contextkey/common/contextkey\");\nvar instantiation_1 = require(\"vs/platform/instantiation/common/instantiation\");\nvar serviceCollection_1 = require(\"vs/platform/instantiation/common/serviceCollection\");\nvar notification_1 = require(\"vs/platform/notification/common/notification\");\nvar themeService_1 = require(\"vs/platform/theme/common/themeService\");\nvar accessibility_1 = require(\"vs/platform/accessibility/common/accessibility\");\nvar types_1 = require(\"vs/base/common/types\");\nvar EDITOR_ID = 0;\nvar SHOW_UNUSED_ENABLED_CLASS = 'showUnused';\nvar ModelData = /** @class */ (function () {\n    function ModelData(model, viewModel, cursor, view, hasRealView, listenersToRemove) {\n        this.model = model;\n        this.viewModel = viewModel;\n        this.cursor = cursor;\n        this.view = view;\n        this.hasRealView = hasRealView;\n        this.listenersToRemove = listenersToRemove;\n    }\n    ModelData.prototype.dispose = function () {\n        lifecycle_1.dispose(this.listenersToRemove);\n        this.model.onBeforeDetached();\n        if (this.hasRealView) {\n            this.view.dispose();\n        }\n        this.cursor.dispose();\n        this.viewModel.dispose();\n    };\n    return ModelData;\n}());\nvar CodeEditorWidget = /** @class */ (function (_super) {\n    tslib_1.__extends(CodeEditorWidget, _super);\n    function CodeEditorWidget(domElement, options, codeEditorWidgetOptions, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService) {\n        var _this = _super.call(this) || this;\n        //#region Eventing\n        _this._onDidDispose = _this._register(new event_1.Emitter());\n        _this.onDidDispose = _this._onDidDispose.event;\n        _this._onDidChangeModelContent = _this._register(new event_1.Emitter());\n        _this.onDidChangeModelContent = _this._onDidChangeModelContent.event;\n        _this._onDidChangeModelLanguage = _this._register(new event_1.Emitter());\n        _this.onDidChangeModelLanguage = _this._onDidChangeModelLanguage.event;\n        _this._onDidChangeModelLanguageConfiguration = _this._register(new event_1.Emitter());\n        _this.onDidChangeModelLanguageConfiguration = _this._onDidChangeModelLanguageConfiguration.event;\n        _this._onDidChangeModelOptions = _this._register(new event_1.Emitter());\n        _this.onDidChangeModelOptions = _this._onDidChangeModelOptions.event;\n        _this._onDidChangeModelDecorations = _this._register(new event_1.Emitter());\n        _this.onDidChangeModelDecorations = _this._onDidChangeModelDecorations.event;\n        _this._onDidChangeConfiguration = _this._register(new event_1.Emitter());\n        _this.onDidChangeConfiguration = _this._onDidChangeConfiguration.event;\n        _this._onDidChangeModel = _this._register(new event_1.Emitter());\n        _this.onDidChangeModel = _this._onDidChangeModel.event;\n        _this._onDidChangeCursorPosition = _this._register(new event_1.Emitter());\n        _this.onDidChangeCursorPosition = _this._onDidChangeCursorPosition.event;\n        _this._onDidChangeCursorSelection = _this._register(new event_1.Emitter());\n        _this.onDidChangeCursorSelection = _this._onDidChangeCursorSelection.event;\n        _this._onDidAttemptReadOnlyEdit = _this._register(new event_1.Emitter());\n        _this.onDidAttemptReadOnlyEdit = _this._onDidAttemptReadOnlyEdit.event;\n        _this._onDidLayoutChange = _this._register(new event_1.Emitter());\n        _this.onDidLayoutChange = _this._onDidLayoutChange.event;\n        _this._editorTextFocus = _this._register(new BooleanEventEmitter());\n        _this.onDidFocusEditorText = _this._editorTextFocus.onDidChangeToTrue;\n        _this.onDidBlurEditorText = _this._editorTextFocus.onDidChangeToFalse;\n        _this._editorWidgetFocus = _this._register(new BooleanEventEmitter());\n        _this.onDidFocusEditorWidget = _this._editorWidgetFocus.onDidChangeToTrue;\n        _this.onDidBlurEditorWidget = _this._editorWidgetFocus.onDidChangeToFalse;\n        _this._onWillType = _this._register(new event_1.Emitter());\n        _this.onWillType = _this._onWillType.event;\n        _this._onDidType = _this._register(new event_1.Emitter());\n        _this.onDidType = _this._onDidType.event;\n        _this._onCompositionStart = _this._register(new event_1.Emitter());\n        _this.onCompositionStart = _this._onCompositionStart.event;\n        _this._onCompositionEnd = _this._register(new event_1.Emitter());\n        _this.onCompositionEnd = _this._onCompositionEnd.event;\n        _this._onDidPaste = _this._register(new event_1.Emitter());\n        _this.onDidPaste = _this._onDidPaste.event;\n        _this._onMouseUp = _this._register(new event_1.Emitter());\n        _this.onMouseUp = _this._onMouseUp.event;\n        _this._onMouseDown = _this._register(new event_1.Emitter());\n        _this.onMouseDown = _this._onMouseDown.event;\n        _this._onMouseDrag = _this._register(new event_1.Emitter());\n        _this.onMouseDrag = _this._onMouseDrag.event;\n        _this._onMouseDrop = _this._register(new event_1.Emitter());\n        _this.onMouseDrop = _this._onMouseDrop.event;\n        _this._onContextMenu = _this._register(new event_1.Emitter());\n        _this.onContextMenu = _this._onContextMenu.event;\n        _this._onMouseMove = _this._register(new event_1.Emitter());\n        _this.onMouseMove = _this._onMouseMove.event;\n        _this._onMouseLeave = _this._register(new event_1.Emitter());\n        _this.onMouseLeave = _this._onMouseLeave.event;\n        _this._onKeyUp = _this._register(new event_1.Emitter());\n        _this.onKeyUp = _this._onKeyUp.event;\n        _this._onKeyDown = _this._register(new event_1.Emitter());\n        _this.onKeyDown = _this._onKeyDown.event;\n        _this._onDidScrollChange = _this._register(new event_1.Emitter());\n        _this.onDidScrollChange = _this._onDidScrollChange.event;\n        _this._onDidChangeViewZones = _this._register(new event_1.Emitter());\n        _this.onDidChangeViewZones = _this._onDidChangeViewZones.event;\n        _this._domElement = domElement;\n        _this._id = (++EDITOR_ID);\n        _this._decorationTypeKeysToIds = {};\n        _this._decorationTypeSubtypes = {};\n        _this.isSimpleWidget = codeEditorWidgetOptions.isSimpleWidget || false;\n        _this._telemetryData = codeEditorWidgetOptions.telemetryData;\n        options = options || {};\n        _this._configuration = _this._register(_this._createConfiguration(options, accessibilityService));\n        _this._register(_this._configuration.onDidChange(function (e) {\n            _this._onDidChangeConfiguration.fire(e);\n            if (e.layoutInfo) {\n                _this._onDidLayoutChange.fire(_this._configuration.editor.layoutInfo);\n            }\n            if (_this._configuration.editor.showUnused) {\n                _this._domElement.classList.add(SHOW_UNUSED_ENABLED_CLASS);\n            }\n            else {\n                _this._domElement.classList.remove(SHOW_UNUSED_ENABLED_CLASS);\n            }\n        }));\n        _this._contextKeyService = _this._register(contextKeyService.createScoped(_this._domElement));\n        _this._notificationService = notificationService;\n        _this._codeEditorService = codeEditorService;\n        _this._commandService = commandService;\n        _this._themeService = themeService;\n        _this._register(new EditorContextKeysManager(_this, _this._contextKeyService));\n        _this._register(new EditorModeContext(_this, _this._contextKeyService));\n        _this._instantiationService = instantiationService.createChild(new serviceCollection_1.ServiceCollection([contextkey_1.IContextKeyService, _this._contextKeyService]));\n        _this._attachModel(null);\n        _this._contributions = {};\n        _this._actions = {};\n        _this._focusTracker = new CodeEditorWidgetFocusTracker(domElement);\n        _this._focusTracker.onChange(function () {\n            _this._editorWidgetFocus.setValue(_this._focusTracker.hasFocus());\n        });\n        _this._contentWidgets = {};\n        _this._overlayWidgets = {};\n        var contributions;\n        if (Array.isArray(codeEditorWidgetOptions.contributions)) {\n            contributions = codeEditorWidgetOptions.contributions;\n        }\n        else {\n            contributions = editorExtensions_1.EditorExtensionsRegistry.getEditorContributions();\n        }\n        for (var i = 0, len = contributions.length; i < len; i++) {\n            var ctor = contributions[i];\n            try {\n                var contribution = _this._instantiationService.createInstance(ctor, _this);\n                _this._contributions[contribution.getId()] = contribution;\n            }\n            catch (err) {\n                errors_1.onUnexpectedError(err);\n            }\n        }\n        editorExtensions_1.EditorExtensionsRegistry.getEditorActions().forEach(function (action) {\n            var internalAction = new editorAction_1.InternalEditorAction(action.id, action.label, action.alias, types_1.withNullAsUndefined(action.precondition), function () {\n                return _this._instantiationService.invokeFunction(function (accessor) {\n                    return Promise.resolve(action.runEditorCommand(accessor, _this, null));\n                });\n            }, _this._contextKeyService);\n            _this._actions[internalAction.id] = internalAction;\n        });\n        _this._codeEditorService.addCodeEditor(_this);\n        return _this;\n    }\n    CodeEditorWidget.prototype._createConfiguration = function (options, accessibilityService) {\n        return new configuration_1.Configuration(this.isSimpleWidget, options, this._domElement, accessibilityService);\n    };\n    CodeEditorWidget.prototype.getId = function () {\n        return this.getEditorType() + ':' + this._id;\n    };\n    CodeEditorWidget.prototype.getEditorType = function () {\n        return editorCommon.EditorType.ICodeEditor;\n    };\n    CodeEditorWidget.prototype.dispose = function () {\n        this._codeEditorService.removeCodeEditor(this);\n        this._focusTracker.dispose();\n        var keys = Object.keys(this._contributions);\n        for (var i = 0, len = keys.length; i < len; i++) {\n            var contributionId = keys[i];\n            this._contributions[contributionId].dispose();\n        }\n        this._removeDecorationTypes();\n        this._postDetachModelCleanup(this._detachModel());\n        this._onDidDispose.fire();\n        _super.prototype.dispose.call(this);\n    };\n    CodeEditorWidget.prototype.invokeWithinContext = function (fn) {\n        return this._instantiationService.invokeFunction(fn);\n    };\n    CodeEditorWidget.prototype.updateOptions = function (newOptions) {\n        this._configuration.updateOptions(newOptions);\n    };\n    CodeEditorWidget.prototype.getConfiguration = function () {\n        return this._configuration.editor;\n    };\n    CodeEditorWidget.prototype.getRawConfiguration = function () {\n        return this._configuration.getRawOptions();\n    };\n    CodeEditorWidget.prototype.getValue = function (options) {\n        if (options === void 0) { options = null; }\n        if (!this._modelData) {\n            return '';\n        }\n        var preserveBOM = (options && options.preserveBOM) ? true : false;\n        var eolPreference = model_1.EndOfLinePreference.TextDefined;\n        if (options && options.lineEnding && options.lineEnding === '\\n') {\n            eolPreference = model_1.EndOfLinePreference.LF;\n        }\n        else if (options && options.lineEnding && options.lineEnding === '\\r\\n') {\n            eolPreference = model_1.EndOfLinePreference.CRLF;\n        }\n        return this._modelData.model.getValue(eolPreference, preserveBOM);\n    };\n    CodeEditorWidget.prototype.setValue = function (newValue) {\n        if (!this._modelData) {\n            return;\n        }\n        this._modelData.model.setValue(newValue);\n    };\n    CodeEditorWidget.prototype.getModel = function () {\n        if (!this._modelData) {\n            return null;\n        }\n        return this._modelData.model;\n    };\n    CodeEditorWidget.prototype.setModel = function (_model) {\n        if (_model === void 0) { _model = null; }\n        var model = _model;\n        if (this._modelData === null && model === null) {\n            // Current model is the new model\n            return;\n        }\n        if (this._modelData && this._modelData.model === model) {\n            // Current model is the new model\n            return;\n        }\n        var detachedModel = this._detachModel();\n        this._attachModel(model);\n        var e = {\n            oldModelUrl: detachedModel ? detachedModel.uri : null,\n            newModelUrl: model ? model.uri : null\n        };\n        this._removeDecorationTypes();\n        this._onDidChangeModel.fire(e);\n        this._postDetachModelCleanup(detachedModel);\n    };\n    CodeEditorWidget.prototype._removeDecorationTypes = function () {\n        this._decorationTypeKeysToIds = {};\n        if (this._decorationTypeSubtypes) {\n            for (var decorationType in this._decorationTypeSubtypes) {\n                var subTypes = this._decorationTypeSubtypes[decorationType];\n                for (var subType in subTypes) {\n                    this._removeDecorationType(decorationType + '-' + subType);\n                }\n            }\n            this._decorationTypeSubtypes = {};\n        }\n    };\n    CodeEditorWidget.prototype.getVisibleRanges = function () {\n        if (!this._modelData) {\n            return [];\n        }\n        return this._modelData.viewModel.getVisibleRanges();\n    };\n    CodeEditorWidget.prototype.getWhitespaces = function () {\n        if (!this._modelData) {\n            return [];\n        }\n        return this._modelData.viewModel.viewLayout.getWhitespaces();\n    };\n    CodeEditorWidget._getVerticalOffsetForPosition = function (modelData, modelLineNumber, modelColumn) {\n        var modelPosition = modelData.model.validatePosition({\n            lineNumber: modelLineNumber,\n            column: modelColumn\n        });\n        var viewPosition = modelData.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\n        return modelData.viewModel.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);\n    };\n    CodeEditorWidget.prototype.getTopForLineNumber = function (lineNumber) {\n        if (!this._modelData) {\n            return -1;\n        }\n        return CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, 1);\n    };\n    CodeEditorWidget.prototype.getTopForPosition = function (lineNumber, column) {\n        if (!this._modelData) {\n            return -1;\n        }\n        return CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, column);\n    };\n    CodeEditorWidget.prototype.setHiddenAreas = function (ranges) {\n        if (this._modelData) {\n            this._modelData.viewModel.setHiddenAreas(ranges.map(function (r) { return range_1.Range.lift(r); }));\n        }\n    };\n    CodeEditorWidget.prototype.getVisibleColumnFromPosition = function (rawPosition) {\n        if (!this._modelData) {\n            return rawPosition.column;\n        }\n        var position = this._modelData.model.validatePosition(rawPosition);\n        var tabSize = this._modelData.model.getOptions().tabSize;\n        return cursorCommon_1.CursorColumns.visibleColumnFromColumn(this._modelData.model.getLineContent(position.lineNumber), position.column, tabSize) + 1;\n    };\n    CodeEditorWidget.prototype.getPosition = function () {\n        if (!this._modelData) {\n            return null;\n        }\n        return this._modelData.cursor.getPosition();\n    };\n    CodeEditorWidget.prototype.setPosition = function (position) {\n        if (!this._modelData) {\n            return;\n        }\n        if (!position_1.Position.isIPosition(position)) {\n            throw new Error('Invalid arguments');\n        }\n        this._modelData.cursor.setSelections('api', [{\n                selectionStartLineNumber: position.lineNumber,\n                selectionStartColumn: position.column,\n                positionLineNumber: position.lineNumber,\n                positionColumn: position.column\n            }]);\n    };\n    CodeEditorWidget.prototype._sendRevealRange = function (modelRange, verticalType, revealHorizontal, scrollType) {\n        if (!this._modelData) {\n            return;\n        }\n        if (!range_1.Range.isIRange(modelRange)) {\n            throw new Error('Invalid arguments');\n        }\n        var validatedModelRange = this._modelData.model.validateRange(modelRange);\n        var viewRange = this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(validatedModelRange);\n        this._modelData.cursor.emitCursorRevealRange(viewRange, verticalType, revealHorizontal, scrollType);\n    };\n    CodeEditorWidget.prototype.revealLine = function (lineNumber, scrollType) {\n        if (scrollType === void 0) { scrollType = editorCommon.ScrollType.Smooth; }\n        this._revealLine(lineNumber, viewEvents_1.VerticalRevealType.Simple, scrollType);\n    };\n    CodeEditorWidget.prototype.revealLineInCenter = function (lineNumber, scrollType) {\n        if (scrollType === void 0) { scrollType = editorCommon.ScrollType.Smooth; }\n        this._revealLine(lineNumber, viewEvents_1.VerticalRevealType.Center, scrollType);\n    };\n    CodeEditorWidget.prototype.revealLineInCenterIfOutsideViewport = function (lineNumber, scrollType) {\n        if (scrollType === void 0) { scrollType = editorCommon.ScrollType.Smooth; }\n        this._revealLine(lineNumber, viewEvents_1.VerticalRevealType.CenterIfOutsideViewport, scrollType);\n    };\n    CodeEditorWidget.prototype._revealLine = function (lineNumber, revealType, scrollType) {\n        if (typeof lineNumber !== 'number') {\n            throw new Error('Invalid arguments');\n        }\n        this._sendRevealRange(new range_1.Range(lineNumber, 1, lineNumber, 1), revealType, false, scrollType);\n    };\n    CodeEditorWidget.prototype.revealPosition = function (position, scrollType) {\n        if (scrollType === void 0) { scrollType = editorCommon.ScrollType.Smooth; }\n        this._revealPosition(position, viewEvents_1.VerticalRevealType.Simple, true, scrollType);\n    };\n    CodeEditorWidget.prototype.revealPositionInCenter = function (position, scrollType) {\n        if (scrollType === void 0) { scrollType = editorCommon.ScrollType.Smooth; }\n        this._revealPosition(position, viewEvents_1.VerticalRevealType.Center, true, scrollType);\n    };\n    CodeEditorWidget.prototype.revealPositionInCenterIfOutsideViewport = function (position, scrollType) {\n        if (scrollType === void 0) { scrollType = editorCommon.ScrollType.Smooth; }\n        this._revealPosition(position, viewEvents_1.VerticalRevealType.CenterIfOutsideViewport, true, scrollType);\n    };\n    CodeEditorWidget.prototype._revealPosition = function (position, verticalType, revealHorizontal, scrollType) {\n        if (!position_1.Position.isIPosition(position)) {\n            throw new Error('Invalid arguments');\n        }\n        this._sendRevealRange(new range_1.Range(position.lineNumber, position.column, position.lineNumber, position.column), verticalType, revealHorizontal, scrollType);\n    };\n    CodeEditorWidget.prototype.getSelection = function () {\n        if (!this._modelData) {\n            return null;\n        }\n        return this._modelData.cursor.getSelection();\n    };\n    CodeEditorWidget.prototype.getSelections = function () {\n        if (!this._modelData) {\n            return null;\n        }\n        return this._modelData.cursor.getSelections();\n    };\n    CodeEditorWidget.prototype.setSelection = function (something) {\n        var isSelection = selection_1.Selection.isISelection(something);\n        var isRange = range_1.Range.isIRange(something);\n        if (!isSelection && !isRange) {\n            throw new Error('Invalid arguments');\n        }\n        if (isSelection) {\n            this._setSelectionImpl(something);\n        }\n        else if (isRange) {\n            // act as if it was an IRange\n            var selection = {\n                selectionStartLineNumber: something.startLineNumber,\n                selectionStartColumn: something.startColumn,\n                positionLineNumber: something.endLineNumber,\n                positionColumn: something.endColumn\n            };\n            this._setSelectionImpl(selection);\n        }\n    };\n    CodeEditorWidget.prototype._setSelectionImpl = function (sel) {\n        if (!this._modelData) {\n            return;\n        }\n        var selection = new selection_1.Selection(sel.selectionStartLineNumber, sel.selectionStartColumn, sel.positionLineNumber, sel.positionColumn);\n        this._modelData.cursor.setSelections('api', [selection]);\n    };\n    CodeEditorWidget.prototype.revealLines = function (startLineNumber, endLineNumber, scrollType) {\n        if (scrollType === void 0) { scrollType = editorCommon.ScrollType.Smooth; }\n        this._revealLines(startLineNumber, endLineNumber, viewEvents_1.VerticalRevealType.Simple, scrollType);\n    };\n    CodeEditorWidget.prototype.revealLinesInCenter = function (startLineNumber, endLineNumber, scrollType) {\n        if (scrollType === void 0) { scrollType = editorCommon.ScrollType.Smooth; }\n        this._revealLines(startLineNumber, endLineNumber, viewEvents_1.VerticalRevealType.Center, scrollType);\n    };\n    CodeEditorWidget.prototype.revealLinesInCenterIfOutsideViewport = function (startLineNumber, endLineNumber, scrollType) {\n        if (scrollType === void 0) { scrollType = editorCommon.ScrollType.Smooth; }\n        this._revealLines(startLineNumber, endLineNumber, viewEvents_1.VerticalRevealType.CenterIfOutsideViewport, scrollType);\n    };\n    CodeEditorWidget.prototype._revealLines = function (startLineNumber, endLineNumber, verticalType, scrollType) {\n        if (typeof startLineNumber !== 'number' || typeof endLineNumber !== 'number') {\n            throw new Error('Invalid arguments');\n        }\n        this._sendRevealRange(new range_1.Range(startLineNumber, 1, endLineNumber, 1), verticalType, false, scrollType);\n    };\n    CodeEditorWidget.prototype.revealRange = function (range, scrollType, revealVerticalInCenter, revealHorizontal) {\n        if (scrollType === void 0) { scrollType = editorCommon.ScrollType.Smooth; }\n        if (revealVerticalInCenter === void 0) { revealVerticalInCenter = false; }\n        if (revealHorizontal === void 0) { revealHorizontal = true; }\n        this._revealRange(range, revealVerticalInCenter ? viewEvents_1.VerticalRevealType.Center : viewEvents_1.VerticalRevealType.Simple, revealHorizontal, scrollType);\n    };\n    CodeEditorWidget.prototype.revealRangeInCenter = function (range, scrollType) {\n        if (scrollType === void 0) { scrollType = editorCommon.ScrollType.Smooth; }\n        this._revealRange(range, viewEvents_1.VerticalRevealType.Center, true, scrollType);\n    };\n    CodeEditorWidget.prototype.revealRangeInCenterIfOutsideViewport = function (range, scrollType) {\n        if (scrollType === void 0) { scrollType = editorCommon.ScrollType.Smooth; }\n        this._revealRange(range, viewEvents_1.VerticalRevealType.CenterIfOutsideViewport, true, scrollType);\n    };\n    CodeEditorWidget.prototype.revealRangeAtTop = function (range, scrollType) {\n        if (scrollType === void 0) { scrollType = editorCommon.ScrollType.Smooth; }\n        this._revealRange(range, viewEvents_1.VerticalRevealType.Top, true, scrollType);\n    };\n    CodeEditorWidget.prototype._revealRange = function (range, verticalType, revealHorizontal, scrollType) {\n        if (!range_1.Range.isIRange(range)) {\n            throw new Error('Invalid arguments');\n        }\n        this._sendRevealRange(range_1.Range.lift(range), verticalType, revealHorizontal, scrollType);\n    };\n    CodeEditorWidget.prototype.setSelections = function (ranges, source) {\n        if (source === void 0) { source = 'api'; }\n        if (!this._modelData) {\n            return;\n        }\n        if (!ranges || ranges.length === 0) {\n            throw new Error('Invalid arguments');\n        }\n        for (var i = 0, len = ranges.length; i < len; i++) {\n            if (!selection_1.Selection.isISelection(ranges[i])) {\n                throw new Error('Invalid arguments');\n            }\n        }\n        this._modelData.cursor.setSelections(source, ranges);\n    };\n    CodeEditorWidget.prototype.getScrollWidth = function () {\n        if (!this._modelData) {\n            return -1;\n        }\n        return this._modelData.viewModel.viewLayout.getScrollWidth();\n    };\n    CodeEditorWidget.prototype.getScrollLeft = function () {\n        if (!this._modelData) {\n            return -1;\n        }\n        return this._modelData.viewModel.viewLayout.getCurrentScrollLeft();\n    };\n    CodeEditorWidget.prototype.getScrollHeight = function () {\n        if (!this._modelData) {\n            return -1;\n        }\n        return this._modelData.viewModel.viewLayout.getScrollHeight();\n    };\n    CodeEditorWidget.prototype.getScrollTop = function () {\n        if (!this._modelData) {\n            return -1;\n        }\n        return this._modelData.viewModel.viewLayout.getCurrentScrollTop();\n    };\n    CodeEditorWidget.prototype.setScrollLeft = function (newScrollLeft) {\n        if (!this._modelData) {\n            return;\n        }\n        if (typeof newScrollLeft !== 'number') {\n            throw new Error('Invalid arguments');\n        }\n        this._modelData.viewModel.viewLayout.setScrollPositionNow({\n            scrollLeft: newScrollLeft\n        });\n    };\n    CodeEditorWidget.prototype.setScrollTop = function (newScrollTop) {\n        if (!this._modelData) {\n            return;\n        }\n        if (typeof newScrollTop !== 'number') {\n            throw new Error('Invalid arguments');\n        }\n        this._modelData.viewModel.viewLayout.setScrollPositionNow({\n            scrollTop: newScrollTop\n        });\n    };\n    CodeEditorWidget.prototype.setScrollPosition = function (position) {\n        if (!this._modelData) {\n            return;\n        }\n        this._modelData.viewModel.viewLayout.setScrollPositionNow(position);\n    };\n    CodeEditorWidget.prototype.saveViewState = function () {\n        if (!this._modelData) {\n            return null;\n        }\n        var contributionsState = {};\n        var keys = Object.keys(this._contributions);\n        for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n            var id = keys_1[_i];\n            var contribution = this._contributions[id];\n            if (typeof contribution.saveViewState === 'function') {\n                contributionsState[id] = contribution.saveViewState();\n            }\n        }\n        var cursorState = this._modelData.cursor.saveState();\n        var viewState = this._modelData.viewModel.saveState();\n        return {\n            cursorState: cursorState,\n            viewState: viewState,\n            contributionsState: contributionsState\n        };\n    };\n    CodeEditorWidget.prototype.restoreViewState = function (s) {\n        if (!this._modelData || !this._modelData.hasRealView) {\n            return;\n        }\n        var codeEditorState = s;\n        if (codeEditorState && codeEditorState.cursorState && codeEditorState.viewState) {\n            var cursorState = codeEditorState.cursorState;\n            if (Array.isArray(cursorState)) {\n                this._modelData.cursor.restoreState(cursorState);\n            }\n            else {\n                // Backwards compatibility\n                this._modelData.cursor.restoreState([cursorState]);\n            }\n            var contributionsState = codeEditorState.contributionsState || {};\n            var keys = Object.keys(this._contributions);\n            for (var i = 0, len = keys.length; i < len; i++) {\n                var id = keys[i];\n                var contribution = this._contributions[id];\n                if (typeof contribution.restoreViewState === 'function') {\n                    contribution.restoreViewState(contributionsState[id]);\n                }\n            }\n            var reducedState = this._modelData.viewModel.reduceRestoreState(codeEditorState.viewState);\n            this._modelData.view.restoreState(reducedState);\n        }\n    };\n    CodeEditorWidget.prototype.onVisible = function () {\n    };\n    CodeEditorWidget.prototype.onHide = function () {\n    };\n    CodeEditorWidget.prototype.getContribution = function (id) {\n        return (this._contributions[id] || null);\n    };\n    CodeEditorWidget.prototype.getActions = function () {\n        var result = [];\n        var keys = Object.keys(this._actions);\n        for (var i = 0, len = keys.length; i < len; i++) {\n            var id = keys[i];\n            result.push(this._actions[id]);\n        }\n        return result;\n    };\n    CodeEditorWidget.prototype.getSupportedActions = function () {\n        var result = this.getActions();\n        result = result.filter(function (action) { return action.isSupported(); });\n        return result;\n    };\n    CodeEditorWidget.prototype.getAction = function (id) {\n        return this._actions[id] || null;\n    };\n    CodeEditorWidget.prototype.trigger = function (source, handlerId, payload) {\n        payload = payload || {};\n        // Special case for typing\n        if (handlerId === editorCommon.Handler.Type) {\n            if (!this._modelData || typeof payload.text !== 'string' || payload.text.length === 0) {\n                // nothing to do\n                return;\n            }\n            if (source === 'keyboard') {\n                this._onWillType.fire(payload.text);\n            }\n            this._modelData.cursor.trigger(source, handlerId, payload);\n            if (source === 'keyboard') {\n                this._onDidType.fire(payload.text);\n            }\n            return;\n        }\n        // Special case for pasting\n        if (handlerId === editorCommon.Handler.Paste) {\n            if (!this._modelData || typeof payload.text !== 'string' || payload.text.length === 0) {\n                // nothing to do\n                return;\n            }\n            var startPosition = this._modelData.cursor.getSelection().getStartPosition();\n            this._modelData.cursor.trigger(source, handlerId, payload);\n            var endPosition = this._modelData.cursor.getSelection().getStartPosition();\n            if (source === 'keyboard') {\n                this._onDidPaste.fire(new range_1.Range(startPosition.lineNumber, startPosition.column, endPosition.lineNumber, endPosition.column));\n            }\n            return;\n        }\n        if (handlerId === editorCommon.Handler.CompositionStart) {\n            this._onCompositionStart.fire();\n        }\n        if (handlerId === editorCommon.Handler.CompositionEnd) {\n            this._onCompositionEnd.fire();\n        }\n        var action = this.getAction(handlerId);\n        if (action) {\n            Promise.resolve(action.run()).then(undefined, errors_1.onUnexpectedError);\n            return;\n        }\n        if (!this._modelData) {\n            return;\n        }\n        if (this._triggerEditorCommand(source, handlerId, payload)) {\n            return;\n        }\n        this._modelData.cursor.trigger(source, handlerId, payload);\n    };\n    CodeEditorWidget.prototype._triggerEditorCommand = function (source, handlerId, payload) {\n        var _this = this;\n        var command = editorExtensions_1.EditorExtensionsRegistry.getEditorCommand(handlerId);\n        if (command) {\n            payload = payload || {};\n            payload.source = source;\n            this._instantiationService.invokeFunction(function (accessor) {\n                Promise.resolve(command.runEditorCommand(accessor, _this, payload)).then(undefined, errors_1.onUnexpectedError);\n            });\n            return true;\n        }\n        return false;\n    };\n    CodeEditorWidget.prototype._getCursors = function () {\n        if (!this._modelData) {\n            return null;\n        }\n        return this._modelData.cursor;\n    };\n    CodeEditorWidget.prototype.pushUndoStop = function () {\n        if (!this._modelData) {\n            return false;\n        }\n        if (this._configuration.editor.readOnly) {\n            // read only editor => sorry!\n            return false;\n        }\n        this._modelData.model.pushStackElement();\n        return true;\n    };\n    CodeEditorWidget.prototype.executeEdits = function (source, edits, endCursorState) {\n        if (!this._modelData) {\n            return false;\n        }\n        if (this._configuration.editor.readOnly) {\n            // read only editor => sorry!\n            return false;\n        }\n        this._modelData.model.pushEditOperations(this._modelData.cursor.getSelections(), edits, function () {\n            return endCursorState ? endCursorState : null;\n        });\n        if (endCursorState) {\n            this._modelData.cursor.setSelections(source, endCursorState);\n        }\n        return true;\n    };\n    CodeEditorWidget.prototype.executeCommand = function (source, command) {\n        if (!this._modelData) {\n            return;\n        }\n        this._modelData.cursor.trigger(source, editorCommon.Handler.ExecuteCommand, command);\n    };\n    CodeEditorWidget.prototype.executeCommands = function (source, commands) {\n        if (!this._modelData) {\n            return;\n        }\n        this._modelData.cursor.trigger(source, editorCommon.Handler.ExecuteCommands, commands);\n    };\n    CodeEditorWidget.prototype.changeDecorations = function (callback) {\n        if (!this._modelData) {\n            // callback will not be called\n            return null;\n        }\n        return this._modelData.model.changeDecorations(callback, this._id);\n    };\n    CodeEditorWidget.prototype.getLineDecorations = function (lineNumber) {\n        if (!this._modelData) {\n            return null;\n        }\n        return this._modelData.model.getLineDecorations(lineNumber, this._id, this._configuration.editor.readOnly);\n    };\n    CodeEditorWidget.prototype.deltaDecorations = function (oldDecorations, newDecorations) {\n        if (!this._modelData) {\n            return [];\n        }\n        if (oldDecorations.length === 0 && newDecorations.length === 0) {\n            return oldDecorations;\n        }\n        return this._modelData.model.deltaDecorations(oldDecorations, newDecorations, this._id);\n    };\n    CodeEditorWidget.prototype.setDecorations = function (decorationTypeKey, decorationOptions) {\n        var newDecorationsSubTypes = {};\n        var oldDecorationsSubTypes = this._decorationTypeSubtypes[decorationTypeKey] || {};\n        this._decorationTypeSubtypes[decorationTypeKey] = newDecorationsSubTypes;\n        var newModelDecorations = [];\n        for (var _i = 0, decorationOptions_1 = decorationOptions; _i < decorationOptions_1.length; _i++) {\n            var decorationOption = decorationOptions_1[_i];\n            var typeKey = decorationTypeKey;\n            if (decorationOption.renderOptions) {\n                // identify custom reder options by a hash code over all keys and values\n                // For custom render options register a decoration type if necessary\n                var subType = hash_1.hash(decorationOption.renderOptions).toString(16);\n                // The fact that `decorationTypeKey` appears in the typeKey has no influence\n                // it is just a mechanism to get predictable and unique keys (repeatable for the same options and unique across clients)\n                typeKey = decorationTypeKey + '-' + subType;\n                if (!oldDecorationsSubTypes[subType] && !newDecorationsSubTypes[subType]) {\n                    // decoration type did not exist before, register new one\n                    this._registerDecorationType(typeKey, decorationOption.renderOptions, decorationTypeKey);\n                }\n                newDecorationsSubTypes[subType] = true;\n            }\n            var opts = this._resolveDecorationOptions(typeKey, !!decorationOption.hoverMessage);\n            if (decorationOption.hoverMessage) {\n                opts.hoverMessage = decorationOption.hoverMessage;\n            }\n            newModelDecorations.push({ range: decorationOption.range, options: opts });\n        }\n        // remove decoration sub types that are no longer used, deregister decoration type if necessary\n        for (var subType in oldDecorationsSubTypes) {\n            if (!newDecorationsSubTypes[subType]) {\n                this._removeDecorationType(decorationTypeKey + '-' + subType);\n            }\n        }\n        // update all decorations\n        var oldDecorationsIds = this._decorationTypeKeysToIds[decorationTypeKey] || [];\n        this._decorationTypeKeysToIds[decorationTypeKey] = this.deltaDecorations(oldDecorationsIds, newModelDecorations);\n    };\n    CodeEditorWidget.prototype.setDecorationsFast = function (decorationTypeKey, ranges) {\n        // remove decoration sub types that are no longer used, deregister decoration type if necessary\n        var oldDecorationsSubTypes = this._decorationTypeSubtypes[decorationTypeKey] || {};\n        for (var subType in oldDecorationsSubTypes) {\n            this._removeDecorationType(decorationTypeKey + '-' + subType);\n        }\n        this._decorationTypeSubtypes[decorationTypeKey] = {};\n        var opts = textModel_1.ModelDecorationOptions.createDynamic(this._resolveDecorationOptions(decorationTypeKey, false));\n        var newModelDecorations = new Array(ranges.length);\n        for (var i = 0, len = ranges.length; i < len; i++) {\n            newModelDecorations[i] = { range: ranges[i], options: opts };\n        }\n        // update all decorations\n        var oldDecorationsIds = this._decorationTypeKeysToIds[decorationTypeKey] || [];\n        this._decorationTypeKeysToIds[decorationTypeKey] = this.deltaDecorations(oldDecorationsIds, newModelDecorations);\n    };\n    CodeEditorWidget.prototype.removeDecorations = function (decorationTypeKey) {\n        // remove decorations for type and sub type\n        var oldDecorationsIds = this._decorationTypeKeysToIds[decorationTypeKey];\n        if (oldDecorationsIds) {\n            this.deltaDecorations(oldDecorationsIds, []);\n        }\n        if (this._decorationTypeKeysToIds.hasOwnProperty(decorationTypeKey)) {\n            delete this._decorationTypeKeysToIds[decorationTypeKey];\n        }\n        if (this._decorationTypeSubtypes.hasOwnProperty(decorationTypeKey)) {\n            delete this._decorationTypeSubtypes[decorationTypeKey];\n        }\n    };\n    CodeEditorWidget.prototype.getLayoutInfo = function () {\n        return this._configuration.editor.layoutInfo;\n    };\n    CodeEditorWidget.prototype.createOverviewRuler = function (cssClassName) {\n        if (!this._modelData || !this._modelData.hasRealView) {\n            return null;\n        }\n        return this._modelData.view.createOverviewRuler(cssClassName);\n    };\n    CodeEditorWidget.prototype.getDomNode = function () {\n        if (!this._modelData || !this._modelData.hasRealView) {\n            return null;\n        }\n        return this._modelData.view.domNode.domNode;\n    };\n    CodeEditorWidget.prototype.delegateVerticalScrollbarMouseDown = function (browserEvent) {\n        if (!this._modelData || !this._modelData.hasRealView) {\n            return;\n        }\n        this._modelData.view.delegateVerticalScrollbarMouseDown(browserEvent);\n    };\n    CodeEditorWidget.prototype.layout = function (dimension) {\n        this._configuration.observeReferenceElement(dimension);\n        this.render();\n    };\n    CodeEditorWidget.prototype.focus = function () {\n        if (!this._modelData || !this._modelData.hasRealView) {\n            return;\n        }\n        this._modelData.view.focus();\n    };\n    CodeEditorWidget.prototype.hasTextFocus = function () {\n        if (!this._modelData || !this._modelData.hasRealView) {\n            return false;\n        }\n        return this._modelData.view.isFocused();\n    };\n    CodeEditorWidget.prototype.hasWidgetFocus = function () {\n        return this._focusTracker && this._focusTracker.hasFocus();\n    };\n    CodeEditorWidget.prototype.addContentWidget = function (widget) {\n        var widgetData = {\n            widget: widget,\n            position: widget.getPosition()\n        };\n        if (this._contentWidgets.hasOwnProperty(widget.getId())) {\n            console.warn('Overwriting a content widget with the same id.');\n        }\n        this._contentWidgets[widget.getId()] = widgetData;\n        if (this._modelData && this._modelData.hasRealView) {\n            this._modelData.view.addContentWidget(widgetData);\n        }\n    };\n    CodeEditorWidget.prototype.layoutContentWidget = function (widget) {\n        var widgetId = widget.getId();\n        if (this._contentWidgets.hasOwnProperty(widgetId)) {\n            var widgetData = this._contentWidgets[widgetId];\n            widgetData.position = widget.getPosition();\n            if (this._modelData && this._modelData.hasRealView) {\n                this._modelData.view.layoutContentWidget(widgetData);\n            }\n        }\n    };\n    CodeEditorWidget.prototype.removeContentWidget = function (widget) {\n        var widgetId = widget.getId();\n        if (this._contentWidgets.hasOwnProperty(widgetId)) {\n            var widgetData = this._contentWidgets[widgetId];\n            delete this._contentWidgets[widgetId];\n            if (this._modelData && this._modelData.hasRealView) {\n                this._modelData.view.removeContentWidget(widgetData);\n            }\n        }\n    };\n    CodeEditorWidget.prototype.addOverlayWidget = function (widget) {\n        var widgetData = {\n            widget: widget,\n            position: widget.getPosition()\n        };\n        if (this._overlayWidgets.hasOwnProperty(widget.getId())) {\n            console.warn('Overwriting an overlay widget with the same id.');\n        }\n        this._overlayWidgets[widget.getId()] = widgetData;\n        if (this._modelData && this._modelData.hasRealView) {\n            this._modelData.view.addOverlayWidget(widgetData);\n        }\n    };\n    CodeEditorWidget.prototype.layoutOverlayWidget = function (widget) {\n        var widgetId = widget.getId();\n        if (this._overlayWidgets.hasOwnProperty(widgetId)) {\n            var widgetData = this._overlayWidgets[widgetId];\n            widgetData.position = widget.getPosition();\n            if (this._modelData && this._modelData.hasRealView) {\n                this._modelData.view.layoutOverlayWidget(widgetData);\n            }\n        }\n    };\n    CodeEditorWidget.prototype.removeOverlayWidget = function (widget) {\n        var widgetId = widget.getId();\n        if (this._overlayWidgets.hasOwnProperty(widgetId)) {\n            var widgetData = this._overlayWidgets[widgetId];\n            delete this._overlayWidgets[widgetId];\n            if (this._modelData && this._modelData.hasRealView) {\n                this._modelData.view.removeOverlayWidget(widgetData);\n            }\n        }\n    };\n    CodeEditorWidget.prototype.changeViewZones = function (callback) {\n        if (!this._modelData || !this._modelData.hasRealView) {\n            return;\n        }\n        var hasChanges = this._modelData.view.change(callback);\n        if (hasChanges) {\n            this._onDidChangeViewZones.fire();\n        }\n    };\n    CodeEditorWidget.prototype.getTargetAtClientPoint = function (clientX, clientY) {\n        if (!this._modelData || !this._modelData.hasRealView) {\n            return null;\n        }\n        return this._modelData.view.getTargetAtClientPoint(clientX, clientY);\n    };\n    CodeEditorWidget.prototype.getScrolledVisiblePosition = function (rawPosition) {\n        if (!this._modelData || !this._modelData.hasRealView) {\n            return null;\n        }\n        var position = this._modelData.model.validatePosition(rawPosition);\n        var layoutInfo = this._configuration.editor.layoutInfo;\n        var top = CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, position.lineNumber, position.column) - this.getScrollTop();\n        var left = this._modelData.view.getOffsetForColumn(position.lineNumber, position.column) + layoutInfo.glyphMarginWidth + layoutInfo.lineNumbersWidth + layoutInfo.decorationsWidth - this.getScrollLeft();\n        return {\n            top: top,\n            left: left,\n            height: this._configuration.editor.lineHeight\n        };\n    };\n    CodeEditorWidget.prototype.getOffsetForColumn = function (lineNumber, column) {\n        if (!this._modelData || !this._modelData.hasRealView) {\n            return -1;\n        }\n        return this._modelData.view.getOffsetForColumn(lineNumber, column);\n    };\n    CodeEditorWidget.prototype.render = function (forceRedraw) {\n        if (forceRedraw === void 0) { forceRedraw = false; }\n        if (!this._modelData || !this._modelData.hasRealView) {\n            return;\n        }\n        this._modelData.view.render(true, forceRedraw);\n    };\n    CodeEditorWidget.prototype.applyFontInfo = function (target) {\n        configuration_1.Configuration.applyFontInfoSlow(target, this._configuration.editor.fontInfo);\n    };\n    CodeEditorWidget.prototype._attachModel = function (model) {\n        var _this = this;\n        if (!model) {\n            this._modelData = null;\n            return;\n        }\n        var listenersToRemove = [];\n        this._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\n        this._configuration.setIsDominatedByLongLines(model.isDominatedByLongLines());\n        this._configuration.setMaxLineNumber(model.getLineCount());\n        model.onBeforeAttached();\n        var viewModel = new viewModelImpl_1.ViewModel(this._id, this._configuration, model, function (callback) { return dom.scheduleAtNextAnimationFrame(callback); });\n        listenersToRemove.push(model.onDidChangeDecorations(function (e) { return _this._onDidChangeModelDecorations.fire(e); }));\n        listenersToRemove.push(model.onDidChangeLanguage(function (e) {\n            _this._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\n            _this._onDidChangeModelLanguage.fire(e);\n        }));\n        listenersToRemove.push(model.onDidChangeLanguageConfiguration(function (e) { return _this._onDidChangeModelLanguageConfiguration.fire(e); }));\n        listenersToRemove.push(model.onDidChangeContent(function (e) { return _this._onDidChangeModelContent.fire(e); }));\n        listenersToRemove.push(model.onDidChangeOptions(function (e) { return _this._onDidChangeModelOptions.fire(e); }));\n        // Someone might destroy the model from under the editor, so prevent any exceptions by setting a null model\n        listenersToRemove.push(model.onWillDispose(function () { return _this.setModel(null); }));\n        var cursor = new cursor_1.Cursor(this._configuration, model, viewModel);\n        listenersToRemove.push(cursor.onDidReachMaxCursorCount(function () {\n            _this._notificationService.warn(nls.localize('cursors.maximum', \"The number of cursors has been limited to {0}.\", cursor_1.Cursor.MAX_CURSOR_COUNT));\n        }));\n        listenersToRemove.push(cursor.onDidAttemptReadOnlyEdit(function () {\n            _this._onDidAttemptReadOnlyEdit.fire(undefined);\n        }));\n        listenersToRemove.push(cursor.onDidChange(function (e) {\n            var positions = [];\n            for (var i = 0, len = e.selections.length; i < len; i++) {\n                positions[i] = e.selections[i].getPosition();\n            }\n            var e1 = {\n                position: positions[0],\n                secondaryPositions: positions.slice(1),\n                reason: e.reason,\n                source: e.source\n            };\n            _this._onDidChangeCursorPosition.fire(e1);\n            var e2 = {\n                selection: e.selections[0],\n                secondarySelections: e.selections.slice(1),\n                source: e.source,\n                reason: e.reason\n            };\n            _this._onDidChangeCursorSelection.fire(e2);\n        }));\n        var _a = this._createView(viewModel, cursor), view = _a[0], hasRealView = _a[1];\n        if (hasRealView) {\n            this._domElement.appendChild(view.domNode.domNode);\n            var keys = Object.keys(this._contentWidgets);\n            for (var i = 0, len = keys.length; i < len; i++) {\n                var widgetId = keys[i];\n                view.addContentWidget(this._contentWidgets[widgetId]);\n            }\n            keys = Object.keys(this._overlayWidgets);\n            for (var i = 0, len = keys.length; i < len; i++) {\n                var widgetId = keys[i];\n                view.addOverlayWidget(this._overlayWidgets[widgetId]);\n            }\n            view.render(false, true);\n            view.domNode.domNode.setAttribute('data-uri', model.uri.toString());\n        }\n        this._modelData = new ModelData(model, viewModel, cursor, view, hasRealView, listenersToRemove);\n    };\n    CodeEditorWidget.prototype._createView = function (viewModel, cursor) {\n        var _this = this;\n        var commandDelegate;\n        if (this.isSimpleWidget) {\n            commandDelegate = {\n                executeEditorCommand: function (editorCommand, args) {\n                    editorCommand.runCoreEditorCommand(cursor, args);\n                },\n                paste: function (source, text, pasteOnNewLine, multicursorText) {\n                    _this.trigger(source, editorCommon.Handler.Paste, { text: text, pasteOnNewLine: pasteOnNewLine, multicursorText: multicursorText });\n                },\n                type: function (source, text) {\n                    _this.trigger(source, editorCommon.Handler.Type, { text: text });\n                },\n                replacePreviousChar: function (source, text, replaceCharCnt) {\n                    _this.trigger(source, editorCommon.Handler.ReplacePreviousChar, { text: text, replaceCharCnt: replaceCharCnt });\n                },\n                compositionStart: function (source) {\n                    _this.trigger(source, editorCommon.Handler.CompositionStart, undefined);\n                },\n                compositionEnd: function (source) {\n                    _this.trigger(source, editorCommon.Handler.CompositionEnd, undefined);\n                },\n                cut: function (source) {\n                    _this.trigger(source, editorCommon.Handler.Cut, undefined);\n                }\n            };\n        }\n        else {\n            commandDelegate = {\n                executeEditorCommand: function (editorCommand, args) {\n                    editorCommand.runCoreEditorCommand(cursor, args);\n                },\n                paste: function (source, text, pasteOnNewLine, multicursorText) {\n                    _this._commandService.executeCommand(editorCommon.Handler.Paste, {\n                        text: text,\n                        pasteOnNewLine: pasteOnNewLine,\n                        multicursorText: multicursorText\n                    });\n                },\n                type: function (source, text) {\n                    _this._commandService.executeCommand(editorCommon.Handler.Type, {\n                        text: text\n                    });\n                },\n                replacePreviousChar: function (source, text, replaceCharCnt) {\n                    _this._commandService.executeCommand(editorCommon.Handler.ReplacePreviousChar, {\n                        text: text,\n                        replaceCharCnt: replaceCharCnt\n                    });\n                },\n                compositionStart: function (source) {\n                    _this._commandService.executeCommand(editorCommon.Handler.CompositionStart, {});\n                },\n                compositionEnd: function (source) {\n                    _this._commandService.executeCommand(editorCommon.Handler.CompositionEnd, {});\n                },\n                cut: function (source) {\n                    _this._commandService.executeCommand(editorCommon.Handler.Cut, {});\n                }\n            };\n        }\n        var viewOutgoingEvents = new viewOutgoingEvents_1.ViewOutgoingEvents(viewModel);\n        viewOutgoingEvents.onDidGainFocus = function () {\n            _this._editorTextFocus.setValue(true);\n            // In IE, the focus is not synchronous, so we give it a little help\n            _this._editorWidgetFocus.setValue(true);\n        };\n        viewOutgoingEvents.onDidScroll = function (e) { return _this._onDidScrollChange.fire(e); };\n        viewOutgoingEvents.onDidLoseFocus = function () { return _this._editorTextFocus.setValue(false); };\n        viewOutgoingEvents.onContextMenu = function (e) { return _this._onContextMenu.fire(e); };\n        viewOutgoingEvents.onMouseDown = function (e) { return _this._onMouseDown.fire(e); };\n        viewOutgoingEvents.onMouseUp = function (e) { return _this._onMouseUp.fire(e); };\n        viewOutgoingEvents.onMouseDrag = function (e) { return _this._onMouseDrag.fire(e); };\n        viewOutgoingEvents.onMouseDrop = function (e) { return _this._onMouseDrop.fire(e); };\n        viewOutgoingEvents.onKeyUp = function (e) { return _this._onKeyUp.fire(e); };\n        viewOutgoingEvents.onMouseMove = function (e) { return _this._onMouseMove.fire(e); };\n        viewOutgoingEvents.onMouseLeave = function (e) { return _this._onMouseLeave.fire(e); };\n        viewOutgoingEvents.onKeyDown = function (e) { return _this._onKeyDown.fire(e); };\n        var view = new viewImpl_1.View(commandDelegate, this._configuration, this._themeService, viewModel, cursor, viewOutgoingEvents);\n        return [view, true];\n    };\n    CodeEditorWidget.prototype._postDetachModelCleanup = function (detachedModel) {\n        if (detachedModel) {\n            detachedModel.removeAllDecorationsWithOwnerId(this._id);\n        }\n    };\n    CodeEditorWidget.prototype._detachModel = function () {\n        if (!this._modelData) {\n            return null;\n        }\n        var model = this._modelData.model;\n        var removeDomNode = this._modelData.hasRealView ? this._modelData.view.domNode.domNode : null;\n        this._modelData.dispose();\n        this._modelData = null;\n        this._domElement.removeAttribute('data-mode-id');\n        if (removeDomNode) {\n            this._domElement.removeChild(removeDomNode);\n        }\n        return model;\n    };\n    CodeEditorWidget.prototype._registerDecorationType = function (key, options, parentTypeKey) {\n        this._codeEditorService.registerDecorationType(key, options, parentTypeKey);\n    };\n    CodeEditorWidget.prototype._removeDecorationType = function (key) {\n        this._codeEditorService.removeDecorationType(key);\n    };\n    CodeEditorWidget.prototype._resolveDecorationOptions = function (typeKey, writable) {\n        return this._codeEditorService.resolveDecorationOptions(typeKey, writable);\n    };\n    /* __GDPR__FRAGMENT__\n        \"EditorTelemetryData\" : {}\n    */\n    CodeEditorWidget.prototype.getTelemetryData = function () {\n        return this._telemetryData;\n    };\n    CodeEditorWidget.prototype.hasModel = function () {\n        return (this._modelData !== null);\n    };\n    CodeEditorWidget = tslib_1.__decorate([\n        tslib_1.__param(3, instantiation_1.IInstantiationService),\n        tslib_1.__param(4, codeEditorService_1.ICodeEditorService),\n        tslib_1.__param(5, commands_1.ICommandService),\n        tslib_1.__param(6, contextkey_1.IContextKeyService),\n        tslib_1.__param(7, themeService_1.IThemeService),\n        tslib_1.__param(8, notification_1.INotificationService),\n        tslib_1.__param(9, accessibility_1.IAccessibilityService)\n    ], CodeEditorWidget);\n    return CodeEditorWidget;\n}(lifecycle_1.Disposable));\nexports.CodeEditorWidget = CodeEditorWidget;\nvar BooleanEventValue;\n(function (BooleanEventValue) {\n    BooleanEventValue[BooleanEventValue[\"NotSet\"] = 0] = \"NotSet\";\n    BooleanEventValue[BooleanEventValue[\"False\"] = 1] = \"False\";\n    BooleanEventValue[BooleanEventValue[\"True\"] = 2] = \"True\";\n})(BooleanEventValue || (BooleanEventValue = {}));\nvar BooleanEventEmitter = /** @class */ (function (_super) {\n    tslib_1.__extends(BooleanEventEmitter, _super);\n    function BooleanEventEmitter() {\n        var _this = _super.call(this) || this;\n        _this._onDidChangeToTrue = _this._register(new event_1.Emitter());\n        _this.onDidChangeToTrue = _this._onDidChangeToTrue.event;\n        _this._onDidChangeToFalse = _this._register(new event_1.Emitter());\n        _this.onDidChangeToFalse = _this._onDidChangeToFalse.event;\n        _this._value = BooleanEventValue.NotSet;\n        return _this;\n    }\n    BooleanEventEmitter.prototype.setValue = function (_value) {\n        var value = (_value ? BooleanEventValue.True : BooleanEventValue.False);\n        if (this._value === value) {\n            return;\n        }\n        this._value = value;\n        if (this._value === BooleanEventValue.True) {\n            this._onDidChangeToTrue.fire();\n        }\n        else if (this._value === BooleanEventValue.False) {\n            this._onDidChangeToFalse.fire();\n        }\n    };\n    return BooleanEventEmitter;\n}(lifecycle_1.Disposable));\nexports.BooleanEventEmitter = BooleanEventEmitter;\nvar EditorContextKeysManager = /** @class */ (function (_super) {\n    tslib_1.__extends(EditorContextKeysManager, _super);\n    function EditorContextKeysManager(editor, contextKeyService) {\n        var _this = _super.call(this) || this;\n        _this._editor = editor;\n        contextKeyService.createKey('editorId', editor.getId());\n        _this._editorFocus = editorContextKeys_1.EditorContextKeys.focus.bindTo(contextKeyService);\n        _this._textInputFocus = editorContextKeys_1.EditorContextKeys.textInputFocus.bindTo(contextKeyService);\n        _this._editorTextFocus = editorContextKeys_1.EditorContextKeys.editorTextFocus.bindTo(contextKeyService);\n        _this._editorTabMovesFocus = editorContextKeys_1.EditorContextKeys.tabMovesFocus.bindTo(contextKeyService);\n        _this._editorReadonly = editorContextKeys_1.EditorContextKeys.readOnly.bindTo(contextKeyService);\n        _this._hasMultipleSelections = editorContextKeys_1.EditorContextKeys.hasMultipleSelections.bindTo(contextKeyService);\n        _this._hasNonEmptySelection = editorContextKeys_1.EditorContextKeys.hasNonEmptySelection.bindTo(contextKeyService);\n        _this._canUndo = editorContextKeys_1.EditorContextKeys.canUndo.bindTo(contextKeyService);\n        _this._canRedo = editorContextKeys_1.EditorContextKeys.canRedo.bindTo(contextKeyService);\n        _this._register(_this._editor.onDidChangeConfiguration(function () { return _this._updateFromConfig(); }));\n        _this._register(_this._editor.onDidChangeCursorSelection(function () { return _this._updateFromSelection(); }));\n        _this._register(_this._editor.onDidFocusEditorWidget(function () { return _this._updateFromFocus(); }));\n        _this._register(_this._editor.onDidBlurEditorWidget(function () { return _this._updateFromFocus(); }));\n        _this._register(_this._editor.onDidFocusEditorText(function () { return _this._updateFromFocus(); }));\n        _this._register(_this._editor.onDidBlurEditorText(function () { return _this._updateFromFocus(); }));\n        _this._register(_this._editor.onDidChangeModel(function () { return _this._updateFromModel(); }));\n        _this._register(_this._editor.onDidChangeConfiguration(function () { return _this._updateFromModel(); }));\n        _this._updateFromConfig();\n        _this._updateFromSelection();\n        _this._updateFromFocus();\n        _this._updateFromModel();\n        return _this;\n    }\n    EditorContextKeysManager.prototype._updateFromConfig = function () {\n        var config = this._editor.getConfiguration();\n        this._editorTabMovesFocus.set(config.tabFocusMode);\n        this._editorReadonly.set(config.readOnly);\n    };\n    EditorContextKeysManager.prototype._updateFromSelection = function () {\n        var selections = this._editor.getSelections();\n        if (!selections) {\n            this._hasMultipleSelections.reset();\n            this._hasNonEmptySelection.reset();\n        }\n        else {\n            this._hasMultipleSelections.set(selections.length > 1);\n            this._hasNonEmptySelection.set(selections.some(function (s) { return !s.isEmpty(); }));\n        }\n    };\n    EditorContextKeysManager.prototype._updateFromFocus = function () {\n        this._editorFocus.set(this._editor.hasWidgetFocus() && !this._editor.isSimpleWidget);\n        this._editorTextFocus.set(this._editor.hasTextFocus() && !this._editor.isSimpleWidget);\n        this._textInputFocus.set(this._editor.hasTextFocus());\n    };\n    EditorContextKeysManager.prototype._updateFromModel = function () {\n        var model = this._editor.getModel();\n        this._canUndo.set(Boolean(model && model.canUndo()));\n        this._canRedo.set(Boolean(model && model.canRedo()));\n    };\n    return EditorContextKeysManager;\n}(lifecycle_1.Disposable));\nvar EditorModeContext = /** @class */ (function (_super) {\n    tslib_1.__extends(EditorModeContext, _super);\n    function EditorModeContext(editor, contextKeyService) {\n        var _this = _super.call(this) || this;\n        _this._editor = editor;\n        _this._langId = editorContextKeys_1.EditorContextKeys.languageId.bindTo(contextKeyService);\n        _this._hasCompletionItemProvider = editorContextKeys_1.EditorContextKeys.hasCompletionItemProvider.bindTo(contextKeyService);\n        _this._hasCodeActionsProvider = editorContextKeys_1.EditorContextKeys.hasCodeActionsProvider.bindTo(contextKeyService);\n        _this._hasCodeLensProvider = editorContextKeys_1.EditorContextKeys.hasCodeLensProvider.bindTo(contextKeyService);\n        _this._hasDefinitionProvider = editorContextKeys_1.EditorContextKeys.hasDefinitionProvider.bindTo(contextKeyService);\n        _this._hasDeclarationProvider = editorContextKeys_1.EditorContextKeys.hasDeclarationProvider.bindTo(contextKeyService);\n        _this._hasImplementationProvider = editorContextKeys_1.EditorContextKeys.hasImplementationProvider.bindTo(contextKeyService);\n        _this._hasTypeDefinitionProvider = editorContextKeys_1.EditorContextKeys.hasTypeDefinitionProvider.bindTo(contextKeyService);\n        _this._hasHoverProvider = editorContextKeys_1.EditorContextKeys.hasHoverProvider.bindTo(contextKeyService);\n        _this._hasDocumentHighlightProvider = editorContextKeys_1.EditorContextKeys.hasDocumentHighlightProvider.bindTo(contextKeyService);\n        _this._hasDocumentSymbolProvider = editorContextKeys_1.EditorContextKeys.hasDocumentSymbolProvider.bindTo(contextKeyService);\n        _this._hasReferenceProvider = editorContextKeys_1.EditorContextKeys.hasReferenceProvider.bindTo(contextKeyService);\n        _this._hasRenameProvider = editorContextKeys_1.EditorContextKeys.hasRenameProvider.bindTo(contextKeyService);\n        _this._hasSignatureHelpProvider = editorContextKeys_1.EditorContextKeys.hasSignatureHelpProvider.bindTo(contextKeyService);\n        _this._hasDocumentFormattingProvider = editorContextKeys_1.EditorContextKeys.hasDocumentFormattingProvider.bindTo(contextKeyService);\n        _this._hasDocumentSelectionFormattingProvider = editorContextKeys_1.EditorContextKeys.hasDocumentSelectionFormattingProvider.bindTo(contextKeyService);\n        _this._hasMultipleDocumentFormattingProvider = editorContextKeys_1.EditorContextKeys.hasMultipleDocumentFormattingProvider.bindTo(contextKeyService);\n        _this._hasMultipleDocumentSelectionFormattingProvider = editorContextKeys_1.EditorContextKeys.hasMultipleDocumentSelectionFormattingProvider.bindTo(contextKeyService);\n        _this._isInWalkThrough = editorContextKeys_1.EditorContextKeys.isInEmbeddedEditor.bindTo(contextKeyService);\n        var update = function () { return _this._update(); };\n        // update when model/mode changes\n        _this._register(editor.onDidChangeModel(update));\n        _this._register(editor.onDidChangeModelLanguage(update));\n        // update when registries change\n        _this._register(modes.CompletionProviderRegistry.onDidChange(update));\n        _this._register(modes.CodeActionProviderRegistry.onDidChange(update));\n        _this._register(modes.CodeLensProviderRegistry.onDidChange(update));\n        _this._register(modes.DefinitionProviderRegistry.onDidChange(update));\n        _this._register(modes.DeclarationProviderRegistry.onDidChange(update));\n        _this._register(modes.ImplementationProviderRegistry.onDidChange(update));\n        _this._register(modes.TypeDefinitionProviderRegistry.onDidChange(update));\n        _this._register(modes.HoverProviderRegistry.onDidChange(update));\n        _this._register(modes.DocumentHighlightProviderRegistry.onDidChange(update));\n        _this._register(modes.DocumentSymbolProviderRegistry.onDidChange(update));\n        _this._register(modes.ReferenceProviderRegistry.onDidChange(update));\n        _this._register(modes.RenameProviderRegistry.onDidChange(update));\n        _this._register(modes.DocumentFormattingEditProviderRegistry.onDidChange(update));\n        _this._register(modes.DocumentRangeFormattingEditProviderRegistry.onDidChange(update));\n        _this._register(modes.SignatureHelpProviderRegistry.onDidChange(update));\n        update();\n        return _this;\n    }\n    EditorModeContext.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n    };\n    EditorModeContext.prototype.reset = function () {\n        this._langId.reset();\n        this._hasCompletionItemProvider.reset();\n        this._hasCodeActionsProvider.reset();\n        this._hasCodeLensProvider.reset();\n        this._hasDefinitionProvider.reset();\n        this._hasDeclarationProvider.reset();\n        this._hasImplementationProvider.reset();\n        this._hasTypeDefinitionProvider.reset();\n        this._hasHoverProvider.reset();\n        this._hasDocumentHighlightProvider.reset();\n        this._hasDocumentSymbolProvider.reset();\n        this._hasReferenceProvider.reset();\n        this._hasRenameProvider.reset();\n        this._hasDocumentFormattingProvider.reset();\n        this._hasDocumentSelectionFormattingProvider.reset();\n        this._hasSignatureHelpProvider.reset();\n        this._isInWalkThrough.reset();\n    };\n    EditorModeContext.prototype._update = function () {\n        var model = this._editor.getModel();\n        if (!model) {\n            this.reset();\n            return;\n        }\n        this._langId.set(model.getLanguageIdentifier().language);\n        this._hasCompletionItemProvider.set(modes.CompletionProviderRegistry.has(model));\n        this._hasCodeActionsProvider.set(modes.CodeActionProviderRegistry.has(model));\n        this._hasCodeLensProvider.set(modes.CodeLensProviderRegistry.has(model));\n        this._hasDefinitionProvider.set(modes.DefinitionProviderRegistry.has(model));\n        this._hasDeclarationProvider.set(modes.DeclarationProviderRegistry.has(model));\n        this._hasImplementationProvider.set(modes.ImplementationProviderRegistry.has(model));\n        this._hasTypeDefinitionProvider.set(modes.TypeDefinitionProviderRegistry.has(model));\n        this._hasHoverProvider.set(modes.HoverProviderRegistry.has(model));\n        this._hasDocumentHighlightProvider.set(modes.DocumentHighlightProviderRegistry.has(model));\n        this._hasDocumentSymbolProvider.set(modes.DocumentSymbolProviderRegistry.has(model));\n        this._hasReferenceProvider.set(modes.ReferenceProviderRegistry.has(model));\n        this._hasRenameProvider.set(modes.RenameProviderRegistry.has(model));\n        this._hasSignatureHelpProvider.set(modes.SignatureHelpProviderRegistry.has(model));\n        this._hasDocumentFormattingProvider.set(modes.DocumentFormattingEditProviderRegistry.has(model) || modes.DocumentRangeFormattingEditProviderRegistry.has(model));\n        this._hasDocumentSelectionFormattingProvider.set(modes.DocumentRangeFormattingEditProviderRegistry.has(model));\n        this._hasMultipleDocumentFormattingProvider.set(modes.DocumentFormattingEditProviderRegistry.all(model).length > 1 || modes.DocumentRangeFormattingEditProviderRegistry.all(model).length > 1);\n        this._hasMultipleDocumentSelectionFormattingProvider.set(modes.DocumentRangeFormattingEditProviderRegistry.all(model).length > 1);\n        this._isInWalkThrough.set(model.uri.scheme === network_1.Schemas.walkThroughSnippet);\n    };\n    return EditorModeContext;\n}(lifecycle_1.Disposable));\nexports.EditorModeContext = EditorModeContext;\nvar CodeEditorWidgetFocusTracker = /** @class */ (function (_super) {\n    tslib_1.__extends(CodeEditorWidgetFocusTracker, _super);\n    function CodeEditorWidgetFocusTracker(domElement) {\n        var _this = _super.call(this) || this;\n        _this._onChange = _this._register(new event_1.Emitter());\n        _this.onChange = _this._onChange.event;\n        _this._hasFocus = false;\n        _this._domFocusTracker = _this._register(dom.trackFocus(domElement));\n        _this._register(_this._domFocusTracker.onDidFocus(function () {\n            _this._hasFocus = true;\n            _this._onChange.fire(undefined);\n        }));\n        _this._register(_this._domFocusTracker.onDidBlur(function () {\n            _this._hasFocus = false;\n            _this._onChange.fire(undefined);\n        }));\n        return _this;\n    }\n    CodeEditorWidgetFocusTracker.prototype.hasFocus = function () {\n        return this._hasFocus;\n    };\n    return CodeEditorWidgetFocusTracker;\n}(lifecycle_1.Disposable));\nvar squigglyStart = encodeURIComponent(\"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='\");\nvar squigglyEnd = encodeURIComponent(\"'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>\");\nfunction getSquigglySVGData(color) {\n    return squigglyStart + encodeURIComponent(color.toString()) + squigglyEnd;\n}\nvar dotdotdotStart = encodeURIComponent(\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" height=\\\"3\\\" width=\\\"12\\\"><g fill=\\\"\");\nvar dotdotdotEnd = encodeURIComponent(\"\\\"><circle cx=\\\"1\\\" cy=\\\"1\\\" r=\\\"1\\\"/><circle cx=\\\"5\\\" cy=\\\"1\\\" r=\\\"1\\\"/><circle cx=\\\"9\\\" cy=\\\"1\\\" r=\\\"1\\\"/></g></svg>\");\nfunction getDotDotDotSVGData(color) {\n    return dotdotdotStart + encodeURIComponent(color.toString()) + dotdotdotEnd;\n}\nthemeService_1.registerThemingParticipant(function (theme, collector) {\n    var errorBorderColor = theme.getColor(editorColorRegistry_1.editorErrorBorder);\n    if (errorBorderColor) {\n        collector.addRule(\".monaco-editor .\" + intervalTree_1.ClassName.EditorErrorDecoration + \" { border-bottom: 4px double \" + errorBorderColor + \"; }\");\n    }\n    var errorForeground = theme.getColor(editorColorRegistry_1.editorErrorForeground);\n    if (errorForeground) {\n        collector.addRule(\".monaco-editor .\" + intervalTree_1.ClassName.EditorErrorDecoration + \" { background: url(\\\"data:image/svg+xml,\" + getSquigglySVGData(errorForeground) + \"\\\") repeat-x bottom left; }\");\n    }\n    var warningBorderColor = theme.getColor(editorColorRegistry_1.editorWarningBorder);\n    if (warningBorderColor) {\n        collector.addRule(\".monaco-editor .\" + intervalTree_1.ClassName.EditorWarningDecoration + \" { border-bottom: 4px double \" + warningBorderColor + \"; }\");\n    }\n    var warningForeground = theme.getColor(editorColorRegistry_1.editorWarningForeground);\n    if (warningForeground) {\n        collector.addRule(\".monaco-editor .\" + intervalTree_1.ClassName.EditorWarningDecoration + \" { background: url(\\\"data:image/svg+xml,\" + getSquigglySVGData(warningForeground) + \"\\\") repeat-x bottom left; }\");\n    }\n    var infoBorderColor = theme.getColor(editorColorRegistry_1.editorInfoBorder);\n    if (infoBorderColor) {\n        collector.addRule(\".monaco-editor .\" + intervalTree_1.ClassName.EditorInfoDecoration + \" { border-bottom: 4px double \" + infoBorderColor + \"; }\");\n    }\n    var infoForeground = theme.getColor(editorColorRegistry_1.editorInfoForeground);\n    if (infoForeground) {\n        collector.addRule(\".monaco-editor .\" + intervalTree_1.ClassName.EditorInfoDecoration + \" { background: url(\\\"data:image/svg+xml,\" + getSquigglySVGData(infoForeground) + \"\\\") repeat-x bottom left; }\");\n    }\n    var hintBorderColor = theme.getColor(editorColorRegistry_1.editorHintBorder);\n    if (hintBorderColor) {\n        collector.addRule(\".monaco-editor .\" + intervalTree_1.ClassName.EditorHintDecoration + \" { border-bottom: 2px dotted \" + hintBorderColor + \"; }\");\n    }\n    var hintForeground = theme.getColor(editorColorRegistry_1.editorHintForeground);\n    if (hintForeground) {\n        collector.addRule(\".monaco-editor .\" + intervalTree_1.ClassName.EditorHintDecoration + \" { background: url(\\\"data:image/svg+xml,\" + getDotDotDotSVGData(hintForeground) + \"\\\") no-repeat bottom left; }\");\n    }\n    var unnecessaryForeground = theme.getColor(editorColorRegistry_1.editorUnnecessaryCodeOpacity);\n    if (unnecessaryForeground) {\n        collector.addRule(\".\" + SHOW_UNUSED_ENABLED_CLASS + \" .monaco-editor .\" + intervalTree_1.ClassName.EditorUnnecessaryInlineDecoration + \" { opacity: \" + unnecessaryForeground.rgba.a + \"; }\");\n    }\n    var unnecessaryBorder = theme.getColor(editorColorRegistry_1.editorUnnecessaryCodeBorder);\n    if (unnecessaryBorder) {\n        collector.addRule(\".\" + SHOW_UNUSED_ENABLED_CLASS + \" .monaco-editor .\" + intervalTree_1.ClassName.EditorUnnecessaryDecoration + \" { border-bottom: 2px dashed \" + unnecessaryBorder + \"; }\");\n    }\n});\n",{"version":3,"file":"/home/coding/workspace/lib/vscode/src/vs/editor/browser/widget/codeEditorWidget.ts","sourceRoot":"","sources":["/home/coding/workspace/lib/vscode/src/vs/editor/browser/widget/codeEditorWidget.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./media/editor';\nimport 'vs/css!./media/tokens';\nimport * as nls from 'vs/nls';\nimport * as dom from 'vs/base/browser/dom';\nimport { IKeyboardEvent } from 'vs/base/browser/keyboardEvent';\nimport { IMouseEvent } from 'vs/base/browser/mouseEvent';\nimport { Color } from 'vs/base/common/color';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { hash } from 'vs/base/common/hash';\nimport { Disposable, IDisposable, dispose } from 'vs/base/common/lifecycle';\nimport { Schemas } from 'vs/base/common/network';\nimport { Configuration } from 'vs/editor/browser/config/configuration';\nimport { CoreEditorCommand } from 'vs/editor/browser/controller/coreCommands';\nimport * as editorBrowser from 'vs/editor/browser/editorBrowser';\nimport { EditorExtensionsRegistry, IEditorContributionCtor } from 'vs/editor/browser/editorExtensions';\nimport { ICodeEditorService } from 'vs/editor/browser/services/codeEditorService';\nimport { ICommandDelegate } from 'vs/editor/browser/view/viewController';\nimport { IContentWidgetData, IOverlayWidgetData, View } from 'vs/editor/browser/view/viewImpl';\nimport { ViewOutgoingEvents } from 'vs/editor/browser/view/viewOutgoingEvents';\nimport * as editorOptions from 'vs/editor/common/config/editorOptions';\nimport { Cursor, CursorStateChangedEvent } from 'vs/editor/common/controller/cursor';\nimport { CursorColumns, ICursors } from 'vs/editor/common/controller/cursorCommon';\nimport { ICursorPositionChangedEvent, ICursorSelectionChangedEvent } from 'vs/editor/common/controller/cursorEvents';\nimport { IPosition, Position } from 'vs/editor/common/core/position';\nimport { IRange, Range } from 'vs/editor/common/core/range';\nimport { ISelection, Selection } from 'vs/editor/common/core/selection';\nimport { InternalEditorAction } from 'vs/editor/common/editorAction';\nimport * as editorCommon from 'vs/editor/common/editorCommon';\nimport { EditorContextKeys } from 'vs/editor/common/editorContextKeys';\nimport { EndOfLinePreference, IIdentifiedSingleEditOperation, IModelDecoration, IModelDecorationOptions, IModelDecorationsChangeAccessor, IModelDeltaDecoration, ITextModel } from 'vs/editor/common/model';\nimport { ClassName } from 'vs/editor/common/model/intervalTree';\nimport { ModelDecorationOptions } from 'vs/editor/common/model/textModel';\nimport { IModelContentChangedEvent, IModelDecorationsChangedEvent, IModelLanguageChangedEvent, IModelLanguageConfigurationChangedEvent, IModelOptionsChangedEvent } from 'vs/editor/common/model/textModelEvents';\nimport * as modes from 'vs/editor/common/modes';\nimport { editorErrorBorder, editorErrorForeground, editorHintBorder, editorHintForeground, editorInfoBorder, editorInfoForeground, editorUnnecessaryCodeBorder, editorUnnecessaryCodeOpacity, editorWarningBorder, editorWarningForeground } from 'vs/editor/common/view/editorColorRegistry';\nimport { VerticalRevealType } from 'vs/editor/common/view/viewEvents';\nimport { IEditorWhitespace } from 'vs/editor/common/viewLayout/whitespaceComputer';\nimport { ViewModel } from 'vs/editor/common/viewModel/viewModelImpl';\nimport { ICommandService } from 'vs/platform/commands/common/commands';\nimport { IContextKey, IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IInstantiationService, ServicesAccessor } from 'vs/platform/instantiation/common/instantiation';\nimport { ServiceCollection } from 'vs/platform/instantiation/common/serviceCollection';\nimport { INotificationService } from 'vs/platform/notification/common/notification';\nimport { IThemeService, registerThemingParticipant } from 'vs/platform/theme/common/themeService';\nimport { IAccessibilityService } from 'vs/platform/accessibility/common/accessibility';\nimport { withNullAsUndefined } from 'vs/base/common/types';\n\nlet EDITOR_ID = 0;\n\nconst SHOW_UNUSED_ENABLED_CLASS = 'showUnused';\n\nexport interface ICodeEditorWidgetOptions {\n\t/**\n\t * Is this a simple widget (not a real code editor) ?\n\t * Defaults to false.\n\t */\n\tisSimpleWidget?: boolean;\n\n\t/**\n\t * Contributions to instantiate.\n\t * Defaults to EditorExtensionsRegistry.getEditorContributions().\n\t */\n\tcontributions?: IEditorContributionCtor[];\n\n\t/**\n\t * Telemetry data associated with this CodeEditorWidget.\n\t * Defaults to null.\n\t */\n\ttelemetryData?: object;\n}\n\nclass ModelData {\n\tpublic readonly model: ITextModel;\n\tpublic readonly viewModel: ViewModel;\n\tpublic readonly cursor: Cursor;\n\tpublic readonly view: View;\n\tpublic readonly hasRealView: boolean;\n\tpublic readonly listenersToRemove: IDisposable[];\n\n\tconstructor(model: ITextModel, viewModel: ViewModel, cursor: Cursor, view: View, hasRealView: boolean, listenersToRemove: IDisposable[]) {\n\t\tthis.model = model;\n\t\tthis.viewModel = viewModel;\n\t\tthis.cursor = cursor;\n\t\tthis.view = view;\n\t\tthis.hasRealView = hasRealView;\n\t\tthis.listenersToRemove = listenersToRemove;\n\t}\n\n\tpublic dispose(): void {\n\t\tdispose(this.listenersToRemove);\n\t\tthis.model.onBeforeDetached();\n\t\tif (this.hasRealView) {\n\t\t\tthis.view.dispose();\n\t\t}\n\t\tthis.cursor.dispose();\n\t\tthis.viewModel.dispose();\n\t}\n}\n\nexport class CodeEditorWidget extends Disposable implements editorBrowser.ICodeEditor {\n\n\t//#region Eventing\n\tprivate readonly _onDidDispose: Emitter<void> = this._register(new Emitter<void>());\n\tpublic readonly onDidDispose: Event<void> = this._onDidDispose.event;\n\n\tprivate readonly _onDidChangeModelContent: Emitter<IModelContentChangedEvent> = this._register(new Emitter<IModelContentChangedEvent>());\n\tpublic readonly onDidChangeModelContent: Event<IModelContentChangedEvent> = this._onDidChangeModelContent.event;\n\n\tprivate readonly _onDidChangeModelLanguage: Emitter<IModelLanguageChangedEvent> = this._register(new Emitter<IModelLanguageChangedEvent>());\n\tpublic readonly onDidChangeModelLanguage: Event<IModelLanguageChangedEvent> = this._onDidChangeModelLanguage.event;\n\n\tprivate readonly _onDidChangeModelLanguageConfiguration: Emitter<IModelLanguageConfigurationChangedEvent> = this._register(new Emitter<IModelLanguageConfigurationChangedEvent>());\n\tpublic readonly onDidChangeModelLanguageConfiguration: Event<IModelLanguageConfigurationChangedEvent> = this._onDidChangeModelLanguageConfiguration.event;\n\n\tprivate readonly _onDidChangeModelOptions: Emitter<IModelOptionsChangedEvent> = this._register(new Emitter<IModelOptionsChangedEvent>());\n\tpublic readonly onDidChangeModelOptions: Event<IModelOptionsChangedEvent> = this._onDidChangeModelOptions.event;\n\n\tprivate readonly _onDidChangeModelDecorations: Emitter<IModelDecorationsChangedEvent> = this._register(new Emitter<IModelDecorationsChangedEvent>());\n\tpublic readonly onDidChangeModelDecorations: Event<IModelDecorationsChangedEvent> = this._onDidChangeModelDecorations.event;\n\n\tprivate readonly _onDidChangeConfiguration: Emitter<editorOptions.IConfigurationChangedEvent> = this._register(new Emitter<editorOptions.IConfigurationChangedEvent>());\n\tpublic readonly onDidChangeConfiguration: Event<editorOptions.IConfigurationChangedEvent> = this._onDidChangeConfiguration.event;\n\n\tprotected readonly _onDidChangeModel: Emitter<editorCommon.IModelChangedEvent> = this._register(new Emitter<editorCommon.IModelChangedEvent>());\n\tpublic readonly onDidChangeModel: Event<editorCommon.IModelChangedEvent> = this._onDidChangeModel.event;\n\n\tprivate readonly _onDidChangeCursorPosition: Emitter<ICursorPositionChangedEvent> = this._register(new Emitter<ICursorPositionChangedEvent>());\n\tpublic readonly onDidChangeCursorPosition: Event<ICursorPositionChangedEvent> = this._onDidChangeCursorPosition.event;\n\n\tprivate readonly _onDidChangeCursorSelection: Emitter<ICursorSelectionChangedEvent> = this._register(new Emitter<ICursorSelectionChangedEvent>());\n\tpublic readonly onDidChangeCursorSelection: Event<ICursorSelectionChangedEvent> = this._onDidChangeCursorSelection.event;\n\n\tprivate readonly _onDidAttemptReadOnlyEdit: Emitter<void> = this._register(new Emitter<void>());\n\tpublic readonly onDidAttemptReadOnlyEdit: Event<void> = this._onDidAttemptReadOnlyEdit.event;\n\n\tprivate readonly _onDidLayoutChange: Emitter<editorOptions.EditorLayoutInfo> = this._register(new Emitter<editorOptions.EditorLayoutInfo>());\n\tpublic readonly onDidLayoutChange: Event<editorOptions.EditorLayoutInfo> = this._onDidLayoutChange.event;\n\n\tprivate readonly _editorTextFocus: BooleanEventEmitter = this._register(new BooleanEventEmitter());\n\tpublic readonly onDidFocusEditorText: Event<void> = this._editorTextFocus.onDidChangeToTrue;\n\tpublic readonly onDidBlurEditorText: Event<void> = this._editorTextFocus.onDidChangeToFalse;\n\n\tprivate readonly _editorWidgetFocus: BooleanEventEmitter = this._register(new BooleanEventEmitter());\n\tpublic readonly onDidFocusEditorWidget: Event<void> = this._editorWidgetFocus.onDidChangeToTrue;\n\tpublic readonly onDidBlurEditorWidget: Event<void> = this._editorWidgetFocus.onDidChangeToFalse;\n\n\tprivate readonly _onWillType: Emitter<string> = this._register(new Emitter<string>());\n\tpublic readonly onWillType = this._onWillType.event;\n\n\tprivate readonly _onDidType: Emitter<string> = this._register(new Emitter<string>());\n\tpublic readonly onDidType = this._onDidType.event;\n\n\tprivate readonly _onCompositionStart: Emitter<void> = this._register(new Emitter<void>());\n\tpublic readonly onCompositionStart = this._onCompositionStart.event;\n\n\tprivate readonly _onCompositionEnd: Emitter<void> = this._register(new Emitter<void>());\n\tpublic readonly onCompositionEnd = this._onCompositionEnd.event;\n\n\tprivate readonly _onDidPaste: Emitter<Range> = this._register(new Emitter<Range>());\n\tpublic readonly onDidPaste = this._onDidPaste.event;\n\n\tprivate readonly _onMouseUp: Emitter<editorBrowser.IEditorMouseEvent> = this._register(new Emitter<editorBrowser.IEditorMouseEvent>());\n\tpublic readonly onMouseUp: Event<editorBrowser.IEditorMouseEvent> = this._onMouseUp.event;\n\n\tprivate readonly _onMouseDown: Emitter<editorBrowser.IEditorMouseEvent> = this._register(new Emitter<editorBrowser.IEditorMouseEvent>());\n\tpublic readonly onMouseDown: Event<editorBrowser.IEditorMouseEvent> = this._onMouseDown.event;\n\n\tprivate readonly _onMouseDrag: Emitter<editorBrowser.IEditorMouseEvent> = this._register(new Emitter<editorBrowser.IEditorMouseEvent>());\n\tpublic readonly onMouseDrag: Event<editorBrowser.IEditorMouseEvent> = this._onMouseDrag.event;\n\n\tprivate readonly _onMouseDrop: Emitter<editorBrowser.IPartialEditorMouseEvent> = this._register(new Emitter<editorBrowser.IPartialEditorMouseEvent>());\n\tpublic readonly onMouseDrop: Event<editorBrowser.IPartialEditorMouseEvent> = this._onMouseDrop.event;\n\n\tprivate readonly _onContextMenu: Emitter<editorBrowser.IEditorMouseEvent> = this._register(new Emitter<editorBrowser.IEditorMouseEvent>());\n\tpublic readonly onContextMenu: Event<editorBrowser.IEditorMouseEvent> = this._onContextMenu.event;\n\n\tprivate readonly _onMouseMove: Emitter<editorBrowser.IEditorMouseEvent> = this._register(new Emitter<editorBrowser.IEditorMouseEvent>());\n\tpublic readonly onMouseMove: Event<editorBrowser.IEditorMouseEvent> = this._onMouseMove.event;\n\n\tprivate readonly _onMouseLeave: Emitter<editorBrowser.IPartialEditorMouseEvent> = this._register(new Emitter<editorBrowser.IPartialEditorMouseEvent>());\n\tpublic readonly onMouseLeave: Event<editorBrowser.IPartialEditorMouseEvent> = this._onMouseLeave.event;\n\n\tprivate readonly _onKeyUp: Emitter<IKeyboardEvent> = this._register(new Emitter<IKeyboardEvent>());\n\tpublic readonly onKeyUp: Event<IKeyboardEvent> = this._onKeyUp.event;\n\n\tprivate readonly _onKeyDown: Emitter<IKeyboardEvent> = this._register(new Emitter<IKeyboardEvent>());\n\tpublic readonly onKeyDown: Event<IKeyboardEvent> = this._onKeyDown.event;\n\n\tprivate readonly _onDidScrollChange: Emitter<editorCommon.IScrollEvent> = this._register(new Emitter<editorCommon.IScrollEvent>());\n\tpublic readonly onDidScrollChange: Event<editorCommon.IScrollEvent> = this._onDidScrollChange.event;\n\n\tprivate readonly _onDidChangeViewZones: Emitter<void> = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeViewZones: Event<void> = this._onDidChangeViewZones.event;\n\t//#endregion\n\n\tpublic readonly isSimpleWidget: boolean;\n\tprivate readonly _telemetryData?: object;\n\n\tprivate readonly _domElement: HTMLElement;\n\tprivate readonly _id: number;\n\tprivate readonly _configuration: editorCommon.IConfiguration;\n\n\tprotected readonly _contributions: { [key: string]: editorCommon.IEditorContribution; };\n\tprotected readonly _actions: { [key: string]: editorCommon.IEditorAction; };\n\n\t// --- Members logically associated to a model\n\tprotected _modelData: ModelData | null;\n\n\tprotected readonly _instantiationService: IInstantiationService;\n\tprotected readonly _contextKeyService: IContextKeyService;\n\tprivate readonly _notificationService: INotificationService;\n\tprivate readonly _codeEditorService: ICodeEditorService;\n\tprivate readonly _commandService: ICommandService;\n\tprivate readonly _themeService: IThemeService;\n\n\tprivate readonly _focusTracker: CodeEditorWidgetFocusTracker;\n\n\tprivate readonly _contentWidgets: { [key: string]: IContentWidgetData; };\n\tprivate readonly _overlayWidgets: { [key: string]: IOverlayWidgetData; };\n\n\t/**\n\t * map from \"parent\" decoration type to live decoration ids.\n\t */\n\tprivate _decorationTypeKeysToIds: { [decorationTypeKey: string]: string[] };\n\tprivate _decorationTypeSubtypes: { [decorationTypeKey: string]: { [subtype: string]: boolean } };\n\n\tconstructor(\n\t\tdomElement: HTMLElement,\n\t\toptions: editorOptions.IEditorOptions,\n\t\tcodeEditorWidgetOptions: ICodeEditorWidgetOptions,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@ICodeEditorService codeEditorService: ICodeEditorService,\n\t\t@ICommandService commandService: ICommandService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IAccessibilityService accessibilityService: IAccessibilityService\n\t) {\n\t\tsuper();\n\t\tthis._domElement = domElement;\n\t\tthis._id = (++EDITOR_ID);\n\t\tthis._decorationTypeKeysToIds = {};\n\t\tthis._decorationTypeSubtypes = {};\n\t\tthis.isSimpleWidget = codeEditorWidgetOptions.isSimpleWidget || false;\n\t\tthis._telemetryData = codeEditorWidgetOptions.telemetryData;\n\n\t\toptions = options || {};\n\t\tthis._configuration = this._register(this._createConfiguration(options, accessibilityService));\n\t\tthis._register(this._configuration.onDidChange((e) => {\n\t\t\tthis._onDidChangeConfiguration.fire(e);\n\n\t\t\tif (e.layoutInfo) {\n\t\t\t\tthis._onDidLayoutChange.fire(this._configuration.editor.layoutInfo);\n\t\t\t}\n\t\t\tif (this._configuration.editor.showUnused) {\n\t\t\t\tthis._domElement.classList.add(SHOW_UNUSED_ENABLED_CLASS);\n\t\t\t} else {\n\t\t\t\tthis._domElement.classList.remove(SHOW_UNUSED_ENABLED_CLASS);\n\t\t\t}\n\t\t}));\n\n\t\tthis._contextKeyService = this._register(contextKeyService.createScoped(this._domElement));\n\t\tthis._notificationService = notificationService;\n\t\tthis._codeEditorService = codeEditorService;\n\t\tthis._commandService = commandService;\n\t\tthis._themeService = themeService;\n\t\tthis._register(new EditorContextKeysManager(this, this._contextKeyService));\n\t\tthis._register(new EditorModeContext(this, this._contextKeyService));\n\n\t\tthis._instantiationService = instantiationService.createChild(new ServiceCollection([IContextKeyService, this._contextKeyService]));\n\n\t\tthis._attachModel(null);\n\n\t\tthis._contributions = {};\n\t\tthis._actions = {};\n\n\t\tthis._focusTracker = new CodeEditorWidgetFocusTracker(domElement);\n\t\tthis._focusTracker.onChange(() => {\n\t\t\tthis._editorWidgetFocus.setValue(this._focusTracker.hasFocus());\n\t\t});\n\n\t\tthis._contentWidgets = {};\n\t\tthis._overlayWidgets = {};\n\n\t\tlet contributions: IEditorContributionCtor[];\n\t\tif (Array.isArray(codeEditorWidgetOptions.contributions)) {\n\t\t\tcontributions = codeEditorWidgetOptions.contributions;\n\t\t} else {\n\t\t\tcontributions = EditorExtensionsRegistry.getEditorContributions();\n\t\t}\n\t\tfor (let i = 0, len = contributions.length; i < len; i++) {\n\t\t\tconst ctor = contributions[i];\n\t\t\ttry {\n\t\t\t\tconst contribution = this._instantiationService.createInstance(ctor, this);\n\t\t\t\tthis._contributions[contribution.getId()] = contribution;\n\t\t\t} catch (err) {\n\t\t\t\tonUnexpectedError(err);\n\t\t\t}\n\t\t}\n\n\t\tEditorExtensionsRegistry.getEditorActions().forEach((action) => {\n\t\t\tconst internalAction = new InternalEditorAction(\n\t\t\t\taction.id,\n\t\t\t\taction.label,\n\t\t\t\taction.alias,\n\t\t\t\twithNullAsUndefined(action.precondition),\n\t\t\t\t(): Promise<void> => {\n\t\t\t\t\treturn this._instantiationService.invokeFunction((accessor) => {\n\t\t\t\t\t\treturn Promise.resolve(action.runEditorCommand(accessor, this, null));\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tthis._contextKeyService\n\t\t\t);\n\t\t\tthis._actions[internalAction.id] = internalAction;\n\t\t});\n\n\t\tthis._codeEditorService.addCodeEditor(this);\n\t}\n\n\tprotected _createConfiguration(options: editorOptions.IEditorOptions, accessibilityService: IAccessibilityService): editorCommon.IConfiguration {\n\t\treturn new Configuration(this.isSimpleWidget, options, this._domElement, accessibilityService);\n\t}\n\n\tpublic getId(): string {\n\t\treturn this.getEditorType() + ':' + this._id;\n\t}\n\n\tpublic getEditorType(): string {\n\t\treturn editorCommon.EditorType.ICodeEditor;\n\t}\n\n\tpublic dispose(): void {\n\t\tthis._codeEditorService.removeCodeEditor(this);\n\n\t\tthis._focusTracker.dispose();\n\n\t\tconst keys = Object.keys(this._contributions);\n\t\tfor (let i = 0, len = keys.length; i < len; i++) {\n\t\t\tconst contributionId = keys[i];\n\t\t\tthis._contributions[contributionId].dispose();\n\t\t}\n\n\t\tthis._removeDecorationTypes();\n\t\tthis._postDetachModelCleanup(this._detachModel());\n\n\t\tthis._onDidDispose.fire();\n\n\t\tsuper.dispose();\n\t}\n\n\tpublic invokeWithinContext<T>(fn: (accessor: ServicesAccessor) => T): T {\n\t\treturn this._instantiationService.invokeFunction(fn);\n\t}\n\n\tpublic updateOptions(newOptions: editorOptions.IEditorOptions): void {\n\t\tthis._configuration.updateOptions(newOptions);\n\t}\n\n\tpublic getConfiguration(): editorOptions.InternalEditorOptions {\n\t\treturn this._configuration.editor;\n\t}\n\n\tpublic getRawConfiguration(): editorOptions.IEditorOptions {\n\t\treturn this._configuration.getRawOptions();\n\t}\n\n\tpublic getValue(options: { preserveBOM: boolean; lineEnding: string; } | null = null): string {\n\t\tif (!this._modelData) {\n\t\t\treturn '';\n\t\t}\n\n\t\tconst preserveBOM: boolean = (options && options.preserveBOM) ? true : false;\n\t\tlet eolPreference = EndOfLinePreference.TextDefined;\n\t\tif (options && options.lineEnding && options.lineEnding === '\\n') {\n\t\t\teolPreference = EndOfLinePreference.LF;\n\t\t} else if (options && options.lineEnding && options.lineEnding === '\\r\\n') {\n\t\t\teolPreference = EndOfLinePreference.CRLF;\n\t\t}\n\t\treturn this._modelData.model.getValue(eolPreference, preserveBOM);\n\t}\n\n\tpublic setValue(newValue: string): void {\n\t\tif (!this._modelData) {\n\t\t\treturn;\n\t\t}\n\t\tthis._modelData.model.setValue(newValue);\n\t}\n\n\tpublic getModel(): ITextModel | null {\n\t\tif (!this._modelData) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._modelData.model;\n\t}\n\n\tpublic setModel(_model: ITextModel | editorCommon.IDiffEditorModel | null = null): void {\n\t\tconst model = <ITextModel | null>_model;\n\t\tif (this._modelData === null && model === null) {\n\t\t\t// Current model is the new model\n\t\t\treturn;\n\t\t}\n\t\tif (this._modelData && this._modelData.model === model) {\n\t\t\t// Current model is the new model\n\t\t\treturn;\n\t\t}\n\n\t\tconst detachedModel = this._detachModel();\n\t\tthis._attachModel(model);\n\n\t\tconst e: editorCommon.IModelChangedEvent = {\n\t\t\toldModelUrl: detachedModel ? detachedModel.uri : null,\n\t\t\tnewModelUrl: model ? model.uri : null\n\t\t};\n\n\t\tthis._removeDecorationTypes();\n\t\tthis._onDidChangeModel.fire(e);\n\t\tthis._postDetachModelCleanup(detachedModel);\n\t}\n\n\tprivate _removeDecorationTypes(): void {\n\t\tthis._decorationTypeKeysToIds = {};\n\t\tif (this._decorationTypeSubtypes) {\n\t\t\tfor (let decorationType in this._decorationTypeSubtypes) {\n\t\t\t\tconst subTypes = this._decorationTypeSubtypes[decorationType];\n\t\t\t\tfor (let subType in subTypes) {\n\t\t\t\t\tthis._removeDecorationType(decorationType + '-' + subType);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._decorationTypeSubtypes = {};\n\t\t}\n\t}\n\n\tpublic getVisibleRanges(): Range[] {\n\t\tif (!this._modelData) {\n\t\t\treturn [];\n\t\t}\n\t\treturn this._modelData.viewModel.getVisibleRanges();\n\t}\n\n\tpublic getWhitespaces(): IEditorWhitespace[] {\n\t\tif (!this._modelData) {\n\t\t\treturn [];\n\t\t}\n\t\treturn this._modelData.viewModel.viewLayout.getWhitespaces();\n\t}\n\n\tprivate static _getVerticalOffsetForPosition(modelData: ModelData, modelLineNumber: number, modelColumn: number): number {\n\t\tconst modelPosition = modelData.model.validatePosition({\n\t\t\tlineNumber: modelLineNumber,\n\t\t\tcolumn: modelColumn\n\t\t});\n\t\tconst viewPosition = modelData.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\n\t\treturn modelData.viewModel.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);\n\t}\n\n\tpublic getTopForLineNumber(lineNumber: number): number {\n\t\tif (!this._modelData) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, 1);\n\t}\n\n\tpublic getTopForPosition(lineNumber: number, column: number): number {\n\t\tif (!this._modelData) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, lineNumber, column);\n\t}\n\n\tpublic setHiddenAreas(ranges: IRange[]): void {\n\t\tif (this._modelData) {\n\t\t\tthis._modelData.viewModel.setHiddenAreas(ranges.map(r => Range.lift(r)));\n\t\t}\n\t}\n\n\tpublic getVisibleColumnFromPosition(rawPosition: IPosition): number {\n\t\tif (!this._modelData) {\n\t\t\treturn rawPosition.column;\n\t\t}\n\n\t\tconst position = this._modelData.model.validatePosition(rawPosition);\n\t\tconst tabSize = this._modelData.model.getOptions().tabSize;\n\n\t\treturn CursorColumns.visibleColumnFromColumn(this._modelData.model.getLineContent(position.lineNumber), position.column, tabSize) + 1;\n\t}\n\n\tpublic getPosition(): Position | null {\n\t\tif (!this._modelData) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._modelData.cursor.getPosition();\n\t}\n\n\tpublic setPosition(position: IPosition): void {\n\t\tif (!this._modelData) {\n\t\t\treturn;\n\t\t}\n\t\tif (!Position.isIPosition(position)) {\n\t\t\tthrow new Error('Invalid arguments');\n\t\t}\n\t\tthis._modelData.cursor.setSelections('api', [{\n\t\t\tselectionStartLineNumber: position.lineNumber,\n\t\t\tselectionStartColumn: position.column,\n\t\t\tpositionLineNumber: position.lineNumber,\n\t\t\tpositionColumn: position.column\n\t\t}]);\n\t}\n\n\tprivate _sendRevealRange(modelRange: Range, verticalType: VerticalRevealType, revealHorizontal: boolean, scrollType: editorCommon.ScrollType): void {\n\t\tif (!this._modelData) {\n\t\t\treturn;\n\t\t}\n\t\tif (!Range.isIRange(modelRange)) {\n\t\t\tthrow new Error('Invalid arguments');\n\t\t}\n\t\tconst validatedModelRange = this._modelData.model.validateRange(modelRange);\n\t\tconst viewRange = this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(validatedModelRange);\n\n\t\tthis._modelData.cursor.emitCursorRevealRange(viewRange, verticalType, revealHorizontal, scrollType);\n\t}\n\n\tpublic revealLine(lineNumber: number, scrollType: editorCommon.ScrollType = editorCommon.ScrollType.Smooth): void {\n\t\tthis._revealLine(lineNumber, VerticalRevealType.Simple, scrollType);\n\t}\n\n\tpublic revealLineInCenter(lineNumber: number, scrollType: editorCommon.ScrollType = editorCommon.ScrollType.Smooth): void {\n\t\tthis._revealLine(lineNumber, VerticalRevealType.Center, scrollType);\n\t}\n\n\tpublic revealLineInCenterIfOutsideViewport(lineNumber: number, scrollType: editorCommon.ScrollType = editorCommon.ScrollType.Smooth): void {\n\t\tthis._revealLine(lineNumber, VerticalRevealType.CenterIfOutsideViewport, scrollType);\n\t}\n\n\tprivate _revealLine(lineNumber: number, revealType: VerticalRevealType, scrollType: editorCommon.ScrollType): void {\n\t\tif (typeof lineNumber !== 'number') {\n\t\t\tthrow new Error('Invalid arguments');\n\t\t}\n\n\t\tthis._sendRevealRange(\n\t\t\tnew Range(lineNumber, 1, lineNumber, 1),\n\t\t\trevealType,\n\t\t\tfalse,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tpublic revealPosition(position: IPosition, scrollType: editorCommon.ScrollType = editorCommon.ScrollType.Smooth): void {\n\t\tthis._revealPosition(\n\t\t\tposition,\n\t\t\tVerticalRevealType.Simple,\n\t\t\ttrue,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tpublic revealPositionInCenter(position: IPosition, scrollType: editorCommon.ScrollType = editorCommon.ScrollType.Smooth): void {\n\t\tthis._revealPosition(\n\t\t\tposition,\n\t\t\tVerticalRevealType.Center,\n\t\t\ttrue,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tpublic revealPositionInCenterIfOutsideViewport(position: IPosition, scrollType: editorCommon.ScrollType = editorCommon.ScrollType.Smooth): void {\n\t\tthis._revealPosition(\n\t\t\tposition,\n\t\t\tVerticalRevealType.CenterIfOutsideViewport,\n\t\t\ttrue,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tprivate _revealPosition(position: IPosition, verticalType: VerticalRevealType, revealHorizontal: boolean, scrollType: editorCommon.ScrollType): void {\n\t\tif (!Position.isIPosition(position)) {\n\t\t\tthrow new Error('Invalid arguments');\n\t\t}\n\n\t\tthis._sendRevealRange(\n\t\t\tnew Range(position.lineNumber, position.column, position.lineNumber, position.column),\n\t\t\tverticalType,\n\t\t\trevealHorizontal,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tpublic getSelection(): Selection | null {\n\t\tif (!this._modelData) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._modelData.cursor.getSelection();\n\t}\n\n\tpublic getSelections(): Selection[] | null {\n\t\tif (!this._modelData) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._modelData.cursor.getSelections();\n\t}\n\n\tpublic setSelection(range: IRange): void;\n\tpublic setSelection(editorRange: Range): void;\n\tpublic setSelection(selection: ISelection): void;\n\tpublic setSelection(editorSelection: Selection): void;\n\tpublic setSelection(something: any): void {\n\t\tconst isSelection = Selection.isISelection(something);\n\t\tconst isRange = Range.isIRange(something);\n\n\t\tif (!isSelection && !isRange) {\n\t\t\tthrow new Error('Invalid arguments');\n\t\t}\n\n\t\tif (isSelection) {\n\t\t\tthis._setSelectionImpl(<ISelection>something);\n\t\t} else if (isRange) {\n\t\t\t// act as if it was an IRange\n\t\t\tconst selection: ISelection = {\n\t\t\t\tselectionStartLineNumber: something.startLineNumber,\n\t\t\t\tselectionStartColumn: something.startColumn,\n\t\t\t\tpositionLineNumber: something.endLineNumber,\n\t\t\t\tpositionColumn: something.endColumn\n\t\t\t};\n\t\t\tthis._setSelectionImpl(selection);\n\t\t}\n\t}\n\n\tprivate _setSelectionImpl(sel: ISelection): void {\n\t\tif (!this._modelData) {\n\t\t\treturn;\n\t\t}\n\t\tconst selection = new Selection(sel.selectionStartLineNumber, sel.selectionStartColumn, sel.positionLineNumber, sel.positionColumn);\n\t\tthis._modelData.cursor.setSelections('api', [selection]);\n\t}\n\n\tpublic revealLines(startLineNumber: number, endLineNumber: number, scrollType: editorCommon.ScrollType = editorCommon.ScrollType.Smooth): void {\n\t\tthis._revealLines(\n\t\t\tstartLineNumber,\n\t\t\tendLineNumber,\n\t\t\tVerticalRevealType.Simple,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tpublic revealLinesInCenter(startLineNumber: number, endLineNumber: number, scrollType: editorCommon.ScrollType = editorCommon.ScrollType.Smooth): void {\n\t\tthis._revealLines(\n\t\t\tstartLineNumber,\n\t\t\tendLineNumber,\n\t\t\tVerticalRevealType.Center,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tpublic revealLinesInCenterIfOutsideViewport(startLineNumber: number, endLineNumber: number, scrollType: editorCommon.ScrollType = editorCommon.ScrollType.Smooth): void {\n\t\tthis._revealLines(\n\t\t\tstartLineNumber,\n\t\t\tendLineNumber,\n\t\t\tVerticalRevealType.CenterIfOutsideViewport,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tprivate _revealLines(startLineNumber: number, endLineNumber: number, verticalType: VerticalRevealType, scrollType: editorCommon.ScrollType): void {\n\t\tif (typeof startLineNumber !== 'number' || typeof endLineNumber !== 'number') {\n\t\t\tthrow new Error('Invalid arguments');\n\t\t}\n\n\t\tthis._sendRevealRange(\n\t\t\tnew Range(startLineNumber, 1, endLineNumber, 1),\n\t\t\tverticalType,\n\t\t\tfalse,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tpublic revealRange(range: IRange, scrollType: editorCommon.ScrollType = editorCommon.ScrollType.Smooth, revealVerticalInCenter: boolean = false, revealHorizontal: boolean = true): void {\n\t\tthis._revealRange(\n\t\t\trange,\n\t\t\trevealVerticalInCenter ? VerticalRevealType.Center : VerticalRevealType.Simple,\n\t\t\trevealHorizontal,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tpublic revealRangeInCenter(range: IRange, scrollType: editorCommon.ScrollType = editorCommon.ScrollType.Smooth): void {\n\t\tthis._revealRange(\n\t\t\trange,\n\t\t\tVerticalRevealType.Center,\n\t\t\ttrue,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tpublic revealRangeInCenterIfOutsideViewport(range: IRange, scrollType: editorCommon.ScrollType = editorCommon.ScrollType.Smooth): void {\n\t\tthis._revealRange(\n\t\t\trange,\n\t\t\tVerticalRevealType.CenterIfOutsideViewport,\n\t\t\ttrue,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tpublic revealRangeAtTop(range: IRange, scrollType: editorCommon.ScrollType = editorCommon.ScrollType.Smooth): void {\n\t\tthis._revealRange(\n\t\t\trange,\n\t\t\tVerticalRevealType.Top,\n\t\t\ttrue,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tprivate _revealRange(range: IRange, verticalType: VerticalRevealType, revealHorizontal: boolean, scrollType: editorCommon.ScrollType): void {\n\t\tif (!Range.isIRange(range)) {\n\t\t\tthrow new Error('Invalid arguments');\n\t\t}\n\n\t\tthis._sendRevealRange(\n\t\t\tRange.lift(range),\n\t\t\tverticalType,\n\t\t\trevealHorizontal,\n\t\t\tscrollType\n\t\t);\n\t}\n\n\tpublic setSelections(ranges: ISelection[], source: string = 'api'): void {\n\t\tif (!this._modelData) {\n\t\t\treturn;\n\t\t}\n\t\tif (!ranges || ranges.length === 0) {\n\t\t\tthrow new Error('Invalid arguments');\n\t\t}\n\t\tfor (let i = 0, len = ranges.length; i < len; i++) {\n\t\t\tif (!Selection.isISelection(ranges[i])) {\n\t\t\t\tthrow new Error('Invalid arguments');\n\t\t\t}\n\t\t}\n\t\tthis._modelData.cursor.setSelections(source, ranges);\n\t}\n\n\tpublic getScrollWidth(): number {\n\t\tif (!this._modelData) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn this._modelData.viewModel.viewLayout.getScrollWidth();\n\t}\n\tpublic getScrollLeft(): number {\n\t\tif (!this._modelData) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn this._modelData.viewModel.viewLayout.getCurrentScrollLeft();\n\t}\n\n\tpublic getScrollHeight(): number {\n\t\tif (!this._modelData) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn this._modelData.viewModel.viewLayout.getScrollHeight();\n\t}\n\tpublic getScrollTop(): number {\n\t\tif (!this._modelData) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn this._modelData.viewModel.viewLayout.getCurrentScrollTop();\n\t}\n\n\tpublic setScrollLeft(newScrollLeft: number): void {\n\t\tif (!this._modelData) {\n\t\t\treturn;\n\t\t}\n\t\tif (typeof newScrollLeft !== 'number') {\n\t\t\tthrow new Error('Invalid arguments');\n\t\t}\n\t\tthis._modelData.viewModel.viewLayout.setScrollPositionNow({\n\t\t\tscrollLeft: newScrollLeft\n\t\t});\n\t}\n\tpublic setScrollTop(newScrollTop: number): void {\n\t\tif (!this._modelData) {\n\t\t\treturn;\n\t\t}\n\t\tif (typeof newScrollTop !== 'number') {\n\t\t\tthrow new Error('Invalid arguments');\n\t\t}\n\t\tthis._modelData.viewModel.viewLayout.setScrollPositionNow({\n\t\t\tscrollTop: newScrollTop\n\t\t});\n\t}\n\tpublic setScrollPosition(position: editorCommon.INewScrollPosition): void {\n\t\tif (!this._modelData) {\n\t\t\treturn;\n\t\t}\n\t\tthis._modelData.viewModel.viewLayout.setScrollPositionNow(position);\n\t}\n\n\tpublic saveViewState(): editorCommon.ICodeEditorViewState | null {\n\t\tif (!this._modelData) {\n\t\t\treturn null;\n\t\t}\n\t\tconst contributionsState: { [key: string]: any } = {};\n\n\t\tconst keys = Object.keys(this._contributions);\n\t\tfor (const id of keys) {\n\t\t\tconst contribution = this._contributions[id];\n\t\t\tif (typeof contribution.saveViewState === 'function') {\n\t\t\t\tcontributionsState[id] = contribution.saveViewState();\n\t\t\t}\n\t\t}\n\n\t\tconst cursorState = this._modelData.cursor.saveState();\n\t\tconst viewState = this._modelData.viewModel.saveState();\n\t\treturn {\n\t\t\tcursorState: cursorState,\n\t\t\tviewState: viewState,\n\t\t\tcontributionsState: contributionsState\n\t\t};\n\t}\n\n\tpublic restoreViewState(s: editorCommon.IEditorViewState | null): void {\n\t\tif (!this._modelData || !this._modelData.hasRealView) {\n\t\t\treturn;\n\t\t}\n\t\tconst codeEditorState = s as editorCommon.ICodeEditorViewState | null;\n\t\tif (codeEditorState && codeEditorState.cursorState && codeEditorState.viewState) {\n\t\t\tconst cursorState = <any>codeEditorState.cursorState;\n\t\t\tif (Array.isArray(cursorState)) {\n\t\t\t\tthis._modelData.cursor.restoreState(<editorCommon.ICursorState[]>cursorState);\n\t\t\t} else {\n\t\t\t\t// Backwards compatibility\n\t\t\t\tthis._modelData.cursor.restoreState([<editorCommon.ICursorState>cursorState]);\n\t\t\t}\n\n\t\t\tconst contributionsState = codeEditorState.contributionsState || {};\n\t\t\tconst keys = Object.keys(this._contributions);\n\t\t\tfor (let i = 0, len = keys.length; i < len; i++) {\n\t\t\t\tconst id = keys[i];\n\t\t\t\tconst contribution = this._contributions[id];\n\t\t\t\tif (typeof contribution.restoreViewState === 'function') {\n\t\t\t\t\tcontribution.restoreViewState(contributionsState[id]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst reducedState = this._modelData.viewModel.reduceRestoreState(codeEditorState.viewState);\n\t\t\tthis._modelData.view.restoreState(reducedState);\n\t\t}\n\t}\n\n\tpublic onVisible(): void {\n\t}\n\n\tpublic onHide(): void {\n\t}\n\n\tpublic getContribution<T extends editorCommon.IEditorContribution>(id: string): T {\n\t\treturn <T>(this._contributions[id] || null);\n\t}\n\n\tpublic getActions(): editorCommon.IEditorAction[] {\n\t\tconst result: editorCommon.IEditorAction[] = [];\n\n\t\tconst keys = Object.keys(this._actions);\n\t\tfor (let i = 0, len = keys.length; i < len; i++) {\n\t\t\tconst id = keys[i];\n\t\t\tresult.push(this._actions[id]);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tpublic getSupportedActions(): editorCommon.IEditorAction[] {\n\t\tlet result = this.getActions();\n\n\t\tresult = result.filter(action => action.isSupported());\n\n\t\treturn result;\n\t}\n\n\tpublic getAction(id: string): editorCommon.IEditorAction {\n\t\treturn this._actions[id] || null;\n\t}\n\n\tpublic trigger(source: string, handlerId: string, payload: any): void {\n\t\tpayload = payload || {};\n\n\t\t// Special case for typing\n\t\tif (handlerId === editorCommon.Handler.Type) {\n\t\t\tif (!this._modelData || typeof payload.text !== 'string' || payload.text.length === 0) {\n\t\t\t\t// nothing to do\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (source === 'keyboard') {\n\t\t\t\tthis._onWillType.fire(payload.text);\n\t\t\t}\n\t\t\tthis._modelData.cursor.trigger(source, handlerId, payload);\n\t\t\tif (source === 'keyboard') {\n\t\t\t\tthis._onDidType.fire(payload.text);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t// Special case for pasting\n\t\tif (handlerId === editorCommon.Handler.Paste) {\n\t\t\tif (!this._modelData || typeof payload.text !== 'string' || payload.text.length === 0) {\n\t\t\t\t// nothing to do\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst startPosition = this._modelData.cursor.getSelection().getStartPosition();\n\t\t\tthis._modelData.cursor.trigger(source, handlerId, payload);\n\t\t\tconst endPosition = this._modelData.cursor.getSelection().getStartPosition();\n\t\t\tif (source === 'keyboard') {\n\t\t\t\tthis._onDidPaste.fire(\n\t\t\t\t\tnew Range(startPosition.lineNumber, startPosition.column, endPosition.lineNumber, endPosition.column)\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (handlerId === editorCommon.Handler.CompositionStart) {\n\t\t\tthis._onCompositionStart.fire();\n\t\t}\n\t\tif (handlerId === editorCommon.Handler.CompositionEnd) {\n\t\t\tthis._onCompositionEnd.fire();\n\t\t}\n\n\t\tconst action = this.getAction(handlerId);\n\t\tif (action) {\n\t\t\tPromise.resolve(action.run()).then(undefined, onUnexpectedError);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._modelData) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._triggerEditorCommand(source, handlerId, payload)) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._modelData.cursor.trigger(source, handlerId, payload);\n\t}\n\n\tprivate _triggerEditorCommand(source: string, handlerId: string, payload: any): boolean {\n\t\tconst command = EditorExtensionsRegistry.getEditorCommand(handlerId);\n\t\tif (command) {\n\t\t\tpayload = payload || {};\n\t\t\tpayload.source = source;\n\t\t\tthis._instantiationService.invokeFunction((accessor) => {\n\t\t\t\tPromise.resolve(command.runEditorCommand(accessor, this, payload)).then(undefined, onUnexpectedError);\n\t\t\t});\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tpublic _getCursors(): ICursors | null {\n\t\tif (!this._modelData) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._modelData.cursor;\n\t}\n\n\tpublic pushUndoStop(): boolean {\n\t\tif (!this._modelData) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this._configuration.editor.readOnly) {\n\t\t\t// read only editor => sorry!\n\t\t\treturn false;\n\t\t}\n\t\tthis._modelData.model.pushStackElement();\n\t\treturn true;\n\t}\n\n\tpublic executeEdits(source: string, edits: IIdentifiedSingleEditOperation[], endCursorState?: Selection[]): boolean {\n\t\tif (!this._modelData) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this._configuration.editor.readOnly) {\n\t\t\t// read only editor => sorry!\n\t\t\treturn false;\n\t\t}\n\n\t\tthis._modelData.model.pushEditOperations(this._modelData.cursor.getSelections(), edits, () => {\n\t\t\treturn endCursorState ? endCursorState : null;\n\t\t});\n\n\t\tif (endCursorState) {\n\t\t\tthis._modelData.cursor.setSelections(source, endCursorState);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tpublic executeCommand(source: string, command: editorCommon.ICommand): void {\n\t\tif (!this._modelData) {\n\t\t\treturn;\n\t\t}\n\t\tthis._modelData.cursor.trigger(source, editorCommon.Handler.ExecuteCommand, command);\n\t}\n\n\tpublic executeCommands(source: string, commands: editorCommon.ICommand[]): void {\n\t\tif (!this._modelData) {\n\t\t\treturn;\n\t\t}\n\t\tthis._modelData.cursor.trigger(source, editorCommon.Handler.ExecuteCommands, commands);\n\t}\n\n\tpublic changeDecorations(callback: (changeAccessor: IModelDecorationsChangeAccessor) => any): any {\n\t\tif (!this._modelData) {\n\t\t\t// callback will not be called\n\t\t\treturn null;\n\t\t}\n\t\treturn this._modelData.model.changeDecorations(callback, this._id);\n\t}\n\n\tpublic getLineDecorations(lineNumber: number): IModelDecoration[] | null {\n\t\tif (!this._modelData) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._modelData.model.getLineDecorations(lineNumber, this._id, this._configuration.editor.readOnly);\n\t}\n\n\tpublic deltaDecorations(oldDecorations: string[], newDecorations: IModelDeltaDecoration[]): string[] {\n\t\tif (!this._modelData) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif (oldDecorations.length === 0 && newDecorations.length === 0) {\n\t\t\treturn oldDecorations;\n\t\t}\n\n\t\treturn this._modelData.model.deltaDecorations(oldDecorations, newDecorations, this._id);\n\t}\n\n\tpublic setDecorations(decorationTypeKey: string, decorationOptions: editorCommon.IDecorationOptions[]): void {\n\n\t\tconst newDecorationsSubTypes: { [key: string]: boolean } = {};\n\t\tconst oldDecorationsSubTypes = this._decorationTypeSubtypes[decorationTypeKey] || {};\n\t\tthis._decorationTypeSubtypes[decorationTypeKey] = newDecorationsSubTypes;\n\n\t\tconst newModelDecorations: IModelDeltaDecoration[] = [];\n\n\t\tfor (let decorationOption of decorationOptions) {\n\t\t\tlet typeKey = decorationTypeKey;\n\t\t\tif (decorationOption.renderOptions) {\n\t\t\t\t// identify custom reder options by a hash code over all keys and values\n\t\t\t\t// For custom render options register a decoration type if necessary\n\t\t\t\tconst subType = hash(decorationOption.renderOptions).toString(16);\n\t\t\t\t// The fact that `decorationTypeKey` appears in the typeKey has no influence\n\t\t\t\t// it is just a mechanism to get predictable and unique keys (repeatable for the same options and unique across clients)\n\t\t\t\ttypeKey = decorationTypeKey + '-' + subType;\n\t\t\t\tif (!oldDecorationsSubTypes[subType] && !newDecorationsSubTypes[subType]) {\n\t\t\t\t\t// decoration type did not exist before, register new one\n\t\t\t\t\tthis._registerDecorationType(typeKey, decorationOption.renderOptions, decorationTypeKey);\n\t\t\t\t}\n\t\t\t\tnewDecorationsSubTypes[subType] = true;\n\t\t\t}\n\t\t\tconst opts = this._resolveDecorationOptions(typeKey, !!decorationOption.hoverMessage);\n\t\t\tif (decorationOption.hoverMessage) {\n\t\t\t\topts.hoverMessage = decorationOption.hoverMessage;\n\t\t\t}\n\t\t\tnewModelDecorations.push({ range: decorationOption.range, options: opts });\n\t\t}\n\n\t\t// remove decoration sub types that are no longer used, deregister decoration type if necessary\n\t\tfor (let subType in oldDecorationsSubTypes) {\n\t\t\tif (!newDecorationsSubTypes[subType]) {\n\t\t\t\tthis._removeDecorationType(decorationTypeKey + '-' + subType);\n\t\t\t}\n\t\t}\n\n\t\t// update all decorations\n\t\tconst oldDecorationsIds = this._decorationTypeKeysToIds[decorationTypeKey] || [];\n\t\tthis._decorationTypeKeysToIds[decorationTypeKey] = this.deltaDecorations(oldDecorationsIds, newModelDecorations);\n\t}\n\n\tpublic setDecorationsFast(decorationTypeKey: string, ranges: IRange[]): void {\n\n\t\t// remove decoration sub types that are no longer used, deregister decoration type if necessary\n\t\tconst oldDecorationsSubTypes = this._decorationTypeSubtypes[decorationTypeKey] || {};\n\t\tfor (let subType in oldDecorationsSubTypes) {\n\t\t\tthis._removeDecorationType(decorationTypeKey + '-' + subType);\n\t\t}\n\t\tthis._decorationTypeSubtypes[decorationTypeKey] = {};\n\n\t\tconst opts = ModelDecorationOptions.createDynamic(this._resolveDecorationOptions(decorationTypeKey, false));\n\t\tconst newModelDecorations: IModelDeltaDecoration[] = new Array<IModelDeltaDecoration>(ranges.length);\n\t\tfor (let i = 0, len = ranges.length; i < len; i++) {\n\t\t\tnewModelDecorations[i] = { range: ranges[i], options: opts };\n\t\t}\n\n\t\t// update all decorations\n\t\tconst oldDecorationsIds = this._decorationTypeKeysToIds[decorationTypeKey] || [];\n\t\tthis._decorationTypeKeysToIds[decorationTypeKey] = this.deltaDecorations(oldDecorationsIds, newModelDecorations);\n\t}\n\n\tpublic removeDecorations(decorationTypeKey: string): void {\n\t\t// remove decorations for type and sub type\n\t\tconst oldDecorationsIds = this._decorationTypeKeysToIds[decorationTypeKey];\n\t\tif (oldDecorationsIds) {\n\t\t\tthis.deltaDecorations(oldDecorationsIds, []);\n\t\t}\n\t\tif (this._decorationTypeKeysToIds.hasOwnProperty(decorationTypeKey)) {\n\t\t\tdelete this._decorationTypeKeysToIds[decorationTypeKey];\n\t\t}\n\t\tif (this._decorationTypeSubtypes.hasOwnProperty(decorationTypeKey)) {\n\t\t\tdelete this._decorationTypeSubtypes[decorationTypeKey];\n\t\t}\n\t}\n\n\tpublic getLayoutInfo(): editorOptions.EditorLayoutInfo {\n\t\treturn this._configuration.editor.layoutInfo;\n\t}\n\n\tpublic createOverviewRuler(cssClassName: string): editorBrowser.IOverviewRuler | null {\n\t\tif (!this._modelData || !this._modelData.hasRealView) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._modelData.view.createOverviewRuler(cssClassName);\n\t}\n\n\tpublic getDomNode(): HTMLElement | null {\n\t\tif (!this._modelData || !this._modelData.hasRealView) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._modelData.view.domNode.domNode;\n\t}\n\n\tpublic delegateVerticalScrollbarMouseDown(browserEvent: IMouseEvent): void {\n\t\tif (!this._modelData || !this._modelData.hasRealView) {\n\t\t\treturn;\n\t\t}\n\t\tthis._modelData.view.delegateVerticalScrollbarMouseDown(browserEvent);\n\t}\n\n\tpublic layout(dimension?: editorCommon.IDimension): void {\n\t\tthis._configuration.observeReferenceElement(dimension);\n\t\tthis.render();\n\t}\n\n\tpublic focus(): void {\n\t\tif (!this._modelData || !this._modelData.hasRealView) {\n\t\t\treturn;\n\t\t}\n\t\tthis._modelData.view.focus();\n\t}\n\n\tpublic hasTextFocus(): boolean {\n\t\tif (!this._modelData || !this._modelData.hasRealView) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this._modelData.view.isFocused();\n\t}\n\n\tpublic hasWidgetFocus(): boolean {\n\t\treturn this._focusTracker && this._focusTracker.hasFocus();\n\t}\n\n\tpublic addContentWidget(widget: editorBrowser.IContentWidget): void {\n\t\tconst widgetData: IContentWidgetData = {\n\t\t\twidget: widget,\n\t\t\tposition: widget.getPosition()\n\t\t};\n\n\t\tif (this._contentWidgets.hasOwnProperty(widget.getId())) {\n\t\t\tconsole.warn('Overwriting a content widget with the same id.');\n\t\t}\n\n\t\tthis._contentWidgets[widget.getId()] = widgetData;\n\n\t\tif (this._modelData && this._modelData.hasRealView) {\n\t\t\tthis._modelData.view.addContentWidget(widgetData);\n\t\t}\n\t}\n\n\tpublic layoutContentWidget(widget: editorBrowser.IContentWidget): void {\n\t\tconst widgetId = widget.getId();\n\t\tif (this._contentWidgets.hasOwnProperty(widgetId)) {\n\t\t\tconst widgetData = this._contentWidgets[widgetId];\n\t\t\twidgetData.position = widget.getPosition();\n\t\t\tif (this._modelData && this._modelData.hasRealView) {\n\t\t\t\tthis._modelData.view.layoutContentWidget(widgetData);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic removeContentWidget(widget: editorBrowser.IContentWidget): void {\n\t\tconst widgetId = widget.getId();\n\t\tif (this._contentWidgets.hasOwnProperty(widgetId)) {\n\t\t\tconst widgetData = this._contentWidgets[widgetId];\n\t\t\tdelete this._contentWidgets[widgetId];\n\t\t\tif (this._modelData && this._modelData.hasRealView) {\n\t\t\t\tthis._modelData.view.removeContentWidget(widgetData);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic addOverlayWidget(widget: editorBrowser.IOverlayWidget): void {\n\t\tconst widgetData: IOverlayWidgetData = {\n\t\t\twidget: widget,\n\t\t\tposition: widget.getPosition()\n\t\t};\n\n\t\tif (this._overlayWidgets.hasOwnProperty(widget.getId())) {\n\t\t\tconsole.warn('Overwriting an overlay widget with the same id.');\n\t\t}\n\n\t\tthis._overlayWidgets[widget.getId()] = widgetData;\n\n\t\tif (this._modelData && this._modelData.hasRealView) {\n\t\t\tthis._modelData.view.addOverlayWidget(widgetData);\n\t\t}\n\t}\n\n\tpublic layoutOverlayWidget(widget: editorBrowser.IOverlayWidget): void {\n\t\tconst widgetId = widget.getId();\n\t\tif (this._overlayWidgets.hasOwnProperty(widgetId)) {\n\t\t\tconst widgetData = this._overlayWidgets[widgetId];\n\t\t\twidgetData.position = widget.getPosition();\n\t\t\tif (this._modelData && this._modelData.hasRealView) {\n\t\t\t\tthis._modelData.view.layoutOverlayWidget(widgetData);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic removeOverlayWidget(widget: editorBrowser.IOverlayWidget): void {\n\t\tconst widgetId = widget.getId();\n\t\tif (this._overlayWidgets.hasOwnProperty(widgetId)) {\n\t\t\tconst widgetData = this._overlayWidgets[widgetId];\n\t\t\tdelete this._overlayWidgets[widgetId];\n\t\t\tif (this._modelData && this._modelData.hasRealView) {\n\t\t\t\tthis._modelData.view.removeOverlayWidget(widgetData);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic changeViewZones(callback: (accessor: editorBrowser.IViewZoneChangeAccessor) => void): void {\n\t\tif (!this._modelData || !this._modelData.hasRealView) {\n\t\t\treturn;\n\t\t}\n\t\tconst hasChanges = this._modelData.view.change(callback);\n\t\tif (hasChanges) {\n\t\t\tthis._onDidChangeViewZones.fire();\n\t\t}\n\t}\n\n\tpublic getTargetAtClientPoint(clientX: number, clientY: number): editorBrowser.IMouseTarget | null {\n\t\tif (!this._modelData || !this._modelData.hasRealView) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._modelData.view.getTargetAtClientPoint(clientX, clientY);\n\t}\n\n\tpublic getScrolledVisiblePosition(rawPosition: IPosition): { top: number; left: number; height: number; } | null {\n\t\tif (!this._modelData || !this._modelData.hasRealView) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst position = this._modelData.model.validatePosition(rawPosition);\n\t\tconst layoutInfo = this._configuration.editor.layoutInfo;\n\n\t\tconst top = CodeEditorWidget._getVerticalOffsetForPosition(this._modelData, position.lineNumber, position.column) - this.getScrollTop();\n\t\tconst left = this._modelData.view.getOffsetForColumn(position.lineNumber, position.column) + layoutInfo.glyphMarginWidth + layoutInfo.lineNumbersWidth + layoutInfo.decorationsWidth - this.getScrollLeft();\n\n\t\treturn {\n\t\t\ttop: top,\n\t\t\tleft: left,\n\t\t\theight: this._configuration.editor.lineHeight\n\t\t};\n\t}\n\n\tpublic getOffsetForColumn(lineNumber: number, column: number): number {\n\t\tif (!this._modelData || !this._modelData.hasRealView) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn this._modelData.view.getOffsetForColumn(lineNumber, column);\n\t}\n\n\tpublic render(forceRedraw: boolean = false): void {\n\t\tif (!this._modelData || !this._modelData.hasRealView) {\n\t\t\treturn;\n\t\t}\n\t\tthis._modelData.view.render(true, forceRedraw);\n\t}\n\n\tpublic applyFontInfo(target: HTMLElement): void {\n\t\tConfiguration.applyFontInfoSlow(target, this._configuration.editor.fontInfo);\n\t}\n\n\tprotected _attachModel(model: ITextModel | null): void {\n\t\tif (!model) {\n\t\t\tthis._modelData = null;\n\t\t\treturn;\n\t\t}\n\n\t\tconst listenersToRemove: IDisposable[] = [];\n\n\t\tthis._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\n\t\tthis._configuration.setIsDominatedByLongLines(model.isDominatedByLongLines());\n\t\tthis._configuration.setMaxLineNumber(model.getLineCount());\n\n\t\tmodel.onBeforeAttached();\n\n\t\tconst viewModel = new ViewModel(this._id, this._configuration, model, (callback) => dom.scheduleAtNextAnimationFrame(callback));\n\n\t\tlistenersToRemove.push(model.onDidChangeDecorations((e) => this._onDidChangeModelDecorations.fire(e)));\n\t\tlistenersToRemove.push(model.onDidChangeLanguage((e) => {\n\t\t\tthis._domElement.setAttribute('data-mode-id', model.getLanguageIdentifier().language);\n\t\t\tthis._onDidChangeModelLanguage.fire(e);\n\t\t}));\n\t\tlistenersToRemove.push(model.onDidChangeLanguageConfiguration((e) => this._onDidChangeModelLanguageConfiguration.fire(e)));\n\t\tlistenersToRemove.push(model.onDidChangeContent((e) => this._onDidChangeModelContent.fire(e)));\n\t\tlistenersToRemove.push(model.onDidChangeOptions((e) => this._onDidChangeModelOptions.fire(e)));\n\t\t// Someone might destroy the model from under the editor, so prevent any exceptions by setting a null model\n\t\tlistenersToRemove.push(model.onWillDispose(() => this.setModel(null)));\n\n\t\tconst cursor = new Cursor(this._configuration, model, viewModel);\n\n\t\tlistenersToRemove.push(cursor.onDidReachMaxCursorCount(() => {\n\t\t\tthis._notificationService.warn(nls.localize('cursors.maximum', \"The number of cursors has been limited to {0}.\", Cursor.MAX_CURSOR_COUNT));\n\t\t}));\n\n\t\tlistenersToRemove.push(cursor.onDidAttemptReadOnlyEdit(() => {\n\t\t\tthis._onDidAttemptReadOnlyEdit.fire(undefined);\n\t\t}));\n\n\t\tlistenersToRemove.push(cursor.onDidChange((e: CursorStateChangedEvent) => {\n\t\t\tconst positions: Position[] = [];\n\t\t\tfor (let i = 0, len = e.selections.length; i < len; i++) {\n\t\t\t\tpositions[i] = e.selections[i].getPosition();\n\t\t\t}\n\n\t\t\tconst e1: ICursorPositionChangedEvent = {\n\t\t\t\tposition: positions[0],\n\t\t\t\tsecondaryPositions: positions.slice(1),\n\t\t\t\treason: e.reason,\n\t\t\t\tsource: e.source\n\t\t\t};\n\t\t\tthis._onDidChangeCursorPosition.fire(e1);\n\n\t\t\tconst e2: ICursorSelectionChangedEvent = {\n\t\t\t\tselection: e.selections[0],\n\t\t\t\tsecondarySelections: e.selections.slice(1),\n\t\t\t\tsource: e.source,\n\t\t\t\treason: e.reason\n\t\t\t};\n\t\t\tthis._onDidChangeCursorSelection.fire(e2);\n\t\t}));\n\n\t\tconst [view, hasRealView] = this._createView(viewModel, cursor);\n\t\tif (hasRealView) {\n\t\t\tthis._domElement.appendChild(view.domNode.domNode);\n\n\t\t\tlet keys = Object.keys(this._contentWidgets);\n\t\t\tfor (let i = 0, len = keys.length; i < len; i++) {\n\t\t\t\tconst widgetId = keys[i];\n\t\t\t\tview.addContentWidget(this._contentWidgets[widgetId]);\n\t\t\t}\n\n\t\t\tkeys = Object.keys(this._overlayWidgets);\n\t\t\tfor (let i = 0, len = keys.length; i < len; i++) {\n\t\t\t\tconst widgetId = keys[i];\n\t\t\t\tview.addOverlayWidget(this._overlayWidgets[widgetId]);\n\t\t\t}\n\n\t\t\tview.render(false, true);\n\t\t\tview.domNode.domNode.setAttribute('data-uri', model.uri.toString());\n\t\t}\n\n\t\tthis._modelData = new ModelData(model, viewModel, cursor, view, hasRealView, listenersToRemove);\n\t}\n\n\tprotected _createView(viewModel: ViewModel, cursor: Cursor): [View, boolean] {\n\t\tlet commandDelegate: ICommandDelegate;\n\t\tif (this.isSimpleWidget) {\n\t\t\tcommandDelegate = {\n\t\t\t\texecuteEditorCommand: (editorCommand: CoreEditorCommand, args: any): void => {\n\t\t\t\t\teditorCommand.runCoreEditorCommand(cursor, args);\n\t\t\t\t},\n\t\t\t\tpaste: (source: string, text: string, pasteOnNewLine: boolean, multicursorText: string[] | null) => {\n\t\t\t\t\tthis.trigger(source, editorCommon.Handler.Paste, { text, pasteOnNewLine, multicursorText });\n\t\t\t\t},\n\t\t\t\ttype: (source: string, text: string) => {\n\t\t\t\t\tthis.trigger(source, editorCommon.Handler.Type, { text });\n\t\t\t\t},\n\t\t\t\treplacePreviousChar: (source: string, text: string, replaceCharCnt: number) => {\n\t\t\t\t\tthis.trigger(source, editorCommon.Handler.ReplacePreviousChar, { text, replaceCharCnt });\n\t\t\t\t},\n\t\t\t\tcompositionStart: (source: string) => {\n\t\t\t\t\tthis.trigger(source, editorCommon.Handler.CompositionStart, undefined);\n\t\t\t\t},\n\t\t\t\tcompositionEnd: (source: string) => {\n\t\t\t\t\tthis.trigger(source, editorCommon.Handler.CompositionEnd, undefined);\n\t\t\t\t},\n\t\t\t\tcut: (source: string) => {\n\t\t\t\t\tthis.trigger(source, editorCommon.Handler.Cut, undefined);\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\tcommandDelegate = {\n\t\t\t\texecuteEditorCommand: (editorCommand: CoreEditorCommand, args: any): void => {\n\t\t\t\t\teditorCommand.runCoreEditorCommand(cursor, args);\n\t\t\t\t},\n\t\t\t\tpaste: (source: string, text: string, pasteOnNewLine: boolean, multicursorText: string[] | null) => {\n\t\t\t\t\tthis._commandService.executeCommand(editorCommon.Handler.Paste, {\n\t\t\t\t\t\ttext: text,\n\t\t\t\t\t\tpasteOnNewLine: pasteOnNewLine,\n\t\t\t\t\t\tmulticursorText: multicursorText\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\ttype: (source: string, text: string) => {\n\t\t\t\t\tthis._commandService.executeCommand(editorCommon.Handler.Type, {\n\t\t\t\t\t\ttext: text\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\treplacePreviousChar: (source: string, text: string, replaceCharCnt: number) => {\n\t\t\t\t\tthis._commandService.executeCommand(editorCommon.Handler.ReplacePreviousChar, {\n\t\t\t\t\t\ttext: text,\n\t\t\t\t\t\treplaceCharCnt: replaceCharCnt\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tcompositionStart: (source: string) => {\n\t\t\t\t\tthis._commandService.executeCommand(editorCommon.Handler.CompositionStart, {});\n\t\t\t\t},\n\t\t\t\tcompositionEnd: (source: string) => {\n\t\t\t\t\tthis._commandService.executeCommand(editorCommon.Handler.CompositionEnd, {});\n\t\t\t\t},\n\t\t\t\tcut: (source: string) => {\n\t\t\t\t\tthis._commandService.executeCommand(editorCommon.Handler.Cut, {});\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tconst viewOutgoingEvents = new ViewOutgoingEvents(viewModel);\n\t\tviewOutgoingEvents.onDidGainFocus = () => {\n\t\t\tthis._editorTextFocus.setValue(true);\n\t\t\t// In IE, the focus is not synchronous, so we give it a little help\n\t\t\tthis._editorWidgetFocus.setValue(true);\n\t\t};\n\t\tviewOutgoingEvents.onDidScroll = (e) => this._onDidScrollChange.fire(e);\n\t\tviewOutgoingEvents.onDidLoseFocus = () => this._editorTextFocus.setValue(false);\n\t\tviewOutgoingEvents.onContextMenu = (e) => this._onContextMenu.fire(e);\n\t\tviewOutgoingEvents.onMouseDown = (e) => this._onMouseDown.fire(e);\n\t\tviewOutgoingEvents.onMouseUp = (e) => this._onMouseUp.fire(e);\n\t\tviewOutgoingEvents.onMouseDrag = (e) => this._onMouseDrag.fire(e);\n\t\tviewOutgoingEvents.onMouseDrop = (e) => this._onMouseDrop.fire(e);\n\t\tviewOutgoingEvents.onKeyUp = (e) => this._onKeyUp.fire(e);\n\t\tviewOutgoingEvents.onMouseMove = (e) => this._onMouseMove.fire(e);\n\t\tviewOutgoingEvents.onMouseLeave = (e) => this._onMouseLeave.fire(e);\n\t\tviewOutgoingEvents.onKeyDown = (e) => this._onKeyDown.fire(e);\n\n\t\tconst view = new View(\n\t\t\tcommandDelegate,\n\t\t\tthis._configuration,\n\t\t\tthis._themeService,\n\t\t\tviewModel,\n\t\t\tcursor,\n\t\t\tviewOutgoingEvents\n\t\t);\n\n\t\treturn [view, true];\n\t}\n\n\tprotected _postDetachModelCleanup(detachedModel: ITextModel | null): void {\n\t\tif (detachedModel) {\n\t\t\tdetachedModel.removeAllDecorationsWithOwnerId(this._id);\n\t\t}\n\t}\n\n\tprivate _detachModel(): ITextModel | null {\n\t\tif (!this._modelData) {\n\t\t\treturn null;\n\t\t}\n\t\tconst model = this._modelData.model;\n\t\tconst removeDomNode = this._modelData.hasRealView ? this._modelData.view.domNode.domNode : null;\n\n\t\tthis._modelData.dispose();\n\t\tthis._modelData = null;\n\n\t\tthis._domElement.removeAttribute('data-mode-id');\n\t\tif (removeDomNode) {\n\t\t\tthis._domElement.removeChild(removeDomNode);\n\t\t}\n\n\t\treturn model;\n\t}\n\n\tprivate _registerDecorationType(key: string, options: editorCommon.IDecorationRenderOptions, parentTypeKey?: string): void {\n\t\tthis._codeEditorService.registerDecorationType(key, options, parentTypeKey);\n\t}\n\n\tprivate _removeDecorationType(key: string): void {\n\t\tthis._codeEditorService.removeDecorationType(key);\n\t}\n\n\tprivate _resolveDecorationOptions(typeKey: string, writable: boolean): IModelDecorationOptions {\n\t\treturn this._codeEditorService.resolveDecorationOptions(typeKey, writable);\n\t}\n\n\t/* __GDPR__FRAGMENT__\n\t\t\"EditorTelemetryData\" : {}\n\t*/\n\tpublic getTelemetryData(): { [key: string]: any; } | undefined {\n\t\treturn this._telemetryData;\n\t}\n\n\tpublic hasModel(): this is editorBrowser.IActiveCodeEditor {\n\t\treturn (this._modelData !== null);\n\t}\n}\n\nconst enum BooleanEventValue {\n\tNotSet,\n\tFalse,\n\tTrue\n}\n\nexport class BooleanEventEmitter extends Disposable {\n\tprivate readonly _onDidChangeToTrue: Emitter<void> = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeToTrue: Event<void> = this._onDidChangeToTrue.event;\n\n\tprivate readonly _onDidChangeToFalse: Emitter<void> = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeToFalse: Event<void> = this._onDidChangeToFalse.event;\n\n\tprivate _value: BooleanEventValue;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis._value = BooleanEventValue.NotSet;\n\t}\n\n\tpublic setValue(_value: boolean) {\n\t\tconst value = (_value ? BooleanEventValue.True : BooleanEventValue.False);\n\t\tif (this._value === value) {\n\t\t\treturn;\n\t\t}\n\t\tthis._value = value;\n\t\tif (this._value === BooleanEventValue.True) {\n\t\t\tthis._onDidChangeToTrue.fire();\n\t\t} else if (this._value === BooleanEventValue.False) {\n\t\t\tthis._onDidChangeToFalse.fire();\n\t\t}\n\t}\n}\n\nclass EditorContextKeysManager extends Disposable {\n\n\tprivate readonly _editor: CodeEditorWidget;\n\tprivate readonly _editorFocus: IContextKey<boolean>;\n\tprivate readonly _textInputFocus: IContextKey<boolean>;\n\tprivate readonly _editorTextFocus: IContextKey<boolean>;\n\tprivate readonly _editorTabMovesFocus: IContextKey<boolean>;\n\tprivate readonly _editorReadonly: IContextKey<boolean>;\n\tprivate readonly _hasMultipleSelections: IContextKey<boolean>;\n\tprivate readonly _hasNonEmptySelection: IContextKey<boolean>;\n\tprivate readonly _canUndo: IContextKey<boolean>;\n\tprivate readonly _canRedo: IContextKey<boolean>;\n\n\tconstructor(\n\t\teditor: CodeEditorWidget,\n\t\tcontextKeyService: IContextKeyService\n\t) {\n\t\tsuper();\n\n\t\tthis._editor = editor;\n\n\t\tcontextKeyService.createKey('editorId', editor.getId());\n\t\tthis._editorFocus = EditorContextKeys.focus.bindTo(contextKeyService);\n\t\tthis._textInputFocus = EditorContextKeys.textInputFocus.bindTo(contextKeyService);\n\t\tthis._editorTextFocus = EditorContextKeys.editorTextFocus.bindTo(contextKeyService);\n\t\tthis._editorTabMovesFocus = EditorContextKeys.tabMovesFocus.bindTo(contextKeyService);\n\t\tthis._editorReadonly = EditorContextKeys.readOnly.bindTo(contextKeyService);\n\t\tthis._hasMultipleSelections = EditorContextKeys.hasMultipleSelections.bindTo(contextKeyService);\n\t\tthis._hasNonEmptySelection = EditorContextKeys.hasNonEmptySelection.bindTo(contextKeyService);\n\t\tthis._canUndo = EditorContextKeys.canUndo.bindTo(contextKeyService);\n\t\tthis._canRedo = EditorContextKeys.canRedo.bindTo(contextKeyService);\n\n\t\tthis._register(this._editor.onDidChangeConfiguration(() => this._updateFromConfig()));\n\t\tthis._register(this._editor.onDidChangeCursorSelection(() => this._updateFromSelection()));\n\t\tthis._register(this._editor.onDidFocusEditorWidget(() => this._updateFromFocus()));\n\t\tthis._register(this._editor.onDidBlurEditorWidget(() => this._updateFromFocus()));\n\t\tthis._register(this._editor.onDidFocusEditorText(() => this._updateFromFocus()));\n\t\tthis._register(this._editor.onDidBlurEditorText(() => this._updateFromFocus()));\n\t\tthis._register(this._editor.onDidChangeModel(() => this._updateFromModel()));\n\t\tthis._register(this._editor.onDidChangeConfiguration(() => this._updateFromModel()));\n\n\t\tthis._updateFromConfig();\n\t\tthis._updateFromSelection();\n\t\tthis._updateFromFocus();\n\t\tthis._updateFromModel();\n\t}\n\n\tprivate _updateFromConfig(): void {\n\t\tconst config = this._editor.getConfiguration();\n\n\t\tthis._editorTabMovesFocus.set(config.tabFocusMode);\n\t\tthis._editorReadonly.set(config.readOnly);\n\t}\n\n\tprivate _updateFromSelection(): void {\n\t\tconst selections = this._editor.getSelections();\n\t\tif (!selections) {\n\t\t\tthis._hasMultipleSelections.reset();\n\t\t\tthis._hasNonEmptySelection.reset();\n\t\t} else {\n\t\t\tthis._hasMultipleSelections.set(selections.length > 1);\n\t\t\tthis._hasNonEmptySelection.set(selections.some(s => !s.isEmpty()));\n\t\t}\n\t}\n\n\tprivate _updateFromFocus(): void {\n\t\tthis._editorFocus.set(this._editor.hasWidgetFocus() && !this._editor.isSimpleWidget);\n\t\tthis._editorTextFocus.set(this._editor.hasTextFocus() && !this._editor.isSimpleWidget);\n\t\tthis._textInputFocus.set(this._editor.hasTextFocus());\n\t}\n\n\tprivate _updateFromModel(): void {\n\t\tconst model = this._editor.getModel();\n\t\tthis._canUndo.set(Boolean(model && model.canUndo()));\n\t\tthis._canRedo.set(Boolean(model && model.canRedo()));\n\t}\n}\n\nexport class EditorModeContext extends Disposable {\n\n\tprivate readonly _editor: CodeEditorWidget;\n\n\tprivate readonly _langId: IContextKey<string>;\n\tprivate readonly _hasCompletionItemProvider: IContextKey<boolean>;\n\tprivate readonly _hasCodeActionsProvider: IContextKey<boolean>;\n\tprivate readonly _hasCodeLensProvider: IContextKey<boolean>;\n\tprivate readonly _hasDefinitionProvider: IContextKey<boolean>;\n\tprivate readonly _hasDeclarationProvider: IContextKey<boolean>;\n\tprivate readonly _hasImplementationProvider: IContextKey<boolean>;\n\tprivate readonly _hasTypeDefinitionProvider: IContextKey<boolean>;\n\tprivate readonly _hasHoverProvider: IContextKey<boolean>;\n\tprivate readonly _hasDocumentHighlightProvider: IContextKey<boolean>;\n\tprivate readonly _hasDocumentSymbolProvider: IContextKey<boolean>;\n\tprivate readonly _hasReferenceProvider: IContextKey<boolean>;\n\tprivate readonly _hasRenameProvider: IContextKey<boolean>;\n\tprivate readonly _hasDocumentFormattingProvider: IContextKey<boolean>;\n\tprivate readonly _hasDocumentSelectionFormattingProvider: IContextKey<boolean>;\n\tprivate readonly _hasMultipleDocumentFormattingProvider: IContextKey<boolean>;\n\tprivate readonly _hasMultipleDocumentSelectionFormattingProvider: IContextKey<boolean>;\n\tprivate readonly _hasSignatureHelpProvider: IContextKey<boolean>;\n\tprivate readonly _isInWalkThrough: IContextKey<boolean>;\n\n\tconstructor(\n\t\teditor: CodeEditorWidget,\n\t\tcontextKeyService: IContextKeyService\n\t) {\n\t\tsuper();\n\t\tthis._editor = editor;\n\n\t\tthis._langId = EditorContextKeys.languageId.bindTo(contextKeyService);\n\t\tthis._hasCompletionItemProvider = EditorContextKeys.hasCompletionItemProvider.bindTo(contextKeyService);\n\t\tthis._hasCodeActionsProvider = EditorContextKeys.hasCodeActionsProvider.bindTo(contextKeyService);\n\t\tthis._hasCodeLensProvider = EditorContextKeys.hasCodeLensProvider.bindTo(contextKeyService);\n\t\tthis._hasDefinitionProvider = EditorContextKeys.hasDefinitionProvider.bindTo(contextKeyService);\n\t\tthis._hasDeclarationProvider = EditorContextKeys.hasDeclarationProvider.bindTo(contextKeyService);\n\t\tthis._hasImplementationProvider = EditorContextKeys.hasImplementationProvider.bindTo(contextKeyService);\n\t\tthis._hasTypeDefinitionProvider = EditorContextKeys.hasTypeDefinitionProvider.bindTo(contextKeyService);\n\t\tthis._hasHoverProvider = EditorContextKeys.hasHoverProvider.bindTo(contextKeyService);\n\t\tthis._hasDocumentHighlightProvider = EditorContextKeys.hasDocumentHighlightProvider.bindTo(contextKeyService);\n\t\tthis._hasDocumentSymbolProvider = EditorContextKeys.hasDocumentSymbolProvider.bindTo(contextKeyService);\n\t\tthis._hasReferenceProvider = EditorContextKeys.hasReferenceProvider.bindTo(contextKeyService);\n\t\tthis._hasRenameProvider = EditorContextKeys.hasRenameProvider.bindTo(contextKeyService);\n\t\tthis._hasSignatureHelpProvider = EditorContextKeys.hasSignatureHelpProvider.bindTo(contextKeyService);\n\t\tthis._hasDocumentFormattingProvider = EditorContextKeys.hasDocumentFormattingProvider.bindTo(contextKeyService);\n\t\tthis._hasDocumentSelectionFormattingProvider = EditorContextKeys.hasDocumentSelectionFormattingProvider.bindTo(contextKeyService);\n\t\tthis._hasMultipleDocumentFormattingProvider = EditorContextKeys.hasMultipleDocumentFormattingProvider.bindTo(contextKeyService);\n\t\tthis._hasMultipleDocumentSelectionFormattingProvider = EditorContextKeys.hasMultipleDocumentSelectionFormattingProvider.bindTo(contextKeyService);\n\t\tthis._isInWalkThrough = EditorContextKeys.isInEmbeddedEditor.bindTo(contextKeyService);\n\n\t\tconst update = () => this._update();\n\n\t\t// update when model/mode changes\n\t\tthis._register(editor.onDidChangeModel(update));\n\t\tthis._register(editor.onDidChangeModelLanguage(update));\n\n\t\t// update when registries change\n\t\tthis._register(modes.CompletionProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.CodeActionProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.CodeLensProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.DefinitionProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.DeclarationProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.ImplementationProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.TypeDefinitionProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.HoverProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.DocumentHighlightProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.DocumentSymbolProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.ReferenceProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.RenameProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.DocumentFormattingEditProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.DocumentRangeFormattingEditProviderRegistry.onDidChange(update));\n\t\tthis._register(modes.SignatureHelpProviderRegistry.onDidChange(update));\n\n\t\tupdate();\n\t}\n\n\tdispose() {\n\t\tsuper.dispose();\n\t}\n\n\treset() {\n\t\tthis._langId.reset();\n\t\tthis._hasCompletionItemProvider.reset();\n\t\tthis._hasCodeActionsProvider.reset();\n\t\tthis._hasCodeLensProvider.reset();\n\t\tthis._hasDefinitionProvider.reset();\n\t\tthis._hasDeclarationProvider.reset();\n\t\tthis._hasImplementationProvider.reset();\n\t\tthis._hasTypeDefinitionProvider.reset();\n\t\tthis._hasHoverProvider.reset();\n\t\tthis._hasDocumentHighlightProvider.reset();\n\t\tthis._hasDocumentSymbolProvider.reset();\n\t\tthis._hasReferenceProvider.reset();\n\t\tthis._hasRenameProvider.reset();\n\t\tthis._hasDocumentFormattingProvider.reset();\n\t\tthis._hasDocumentSelectionFormattingProvider.reset();\n\t\tthis._hasSignatureHelpProvider.reset();\n\t\tthis._isInWalkThrough.reset();\n\t}\n\n\tprivate _update() {\n\t\tconst model = this._editor.getModel();\n\t\tif (!model) {\n\t\t\tthis.reset();\n\t\t\treturn;\n\t\t}\n\t\tthis._langId.set(model.getLanguageIdentifier().language);\n\t\tthis._hasCompletionItemProvider.set(modes.CompletionProviderRegistry.has(model));\n\t\tthis._hasCodeActionsProvider.set(modes.CodeActionProviderRegistry.has(model));\n\t\tthis._hasCodeLensProvider.set(modes.CodeLensProviderRegistry.has(model));\n\t\tthis._hasDefinitionProvider.set(modes.DefinitionProviderRegistry.has(model));\n\t\tthis._hasDeclarationProvider.set(modes.DeclarationProviderRegistry.has(model));\n\t\tthis._hasImplementationProvider.set(modes.ImplementationProviderRegistry.has(model));\n\t\tthis._hasTypeDefinitionProvider.set(modes.TypeDefinitionProviderRegistry.has(model));\n\t\tthis._hasHoverProvider.set(modes.HoverProviderRegistry.has(model));\n\t\tthis._hasDocumentHighlightProvider.set(modes.DocumentHighlightProviderRegistry.has(model));\n\t\tthis._hasDocumentSymbolProvider.set(modes.DocumentSymbolProviderRegistry.has(model));\n\t\tthis._hasReferenceProvider.set(modes.ReferenceProviderRegistry.has(model));\n\t\tthis._hasRenameProvider.set(modes.RenameProviderRegistry.has(model));\n\t\tthis._hasSignatureHelpProvider.set(modes.SignatureHelpProviderRegistry.has(model));\n\t\tthis._hasDocumentFormattingProvider.set(modes.DocumentFormattingEditProviderRegistry.has(model) || modes.DocumentRangeFormattingEditProviderRegistry.has(model));\n\t\tthis._hasDocumentSelectionFormattingProvider.set(modes.DocumentRangeFormattingEditProviderRegistry.has(model));\n\t\tthis._hasMultipleDocumentFormattingProvider.set(modes.DocumentFormattingEditProviderRegistry.all(model).length > 1 || modes.DocumentRangeFormattingEditProviderRegistry.all(model).length > 1);\n\t\tthis._hasMultipleDocumentSelectionFormattingProvider.set(modes.DocumentRangeFormattingEditProviderRegistry.all(model).length > 1);\n\t\tthis._isInWalkThrough.set(model.uri.scheme === Schemas.walkThroughSnippet);\n\t}\n}\n\nclass CodeEditorWidgetFocusTracker extends Disposable {\n\n\tprivate _hasFocus: boolean;\n\tprivate readonly _domFocusTracker: dom.IFocusTracker;\n\n\tprivate readonly _onChange: Emitter<void> = this._register(new Emitter<void>());\n\tpublic readonly onChange: Event<void> = this._onChange.event;\n\n\tconstructor(domElement: HTMLElement) {\n\t\tsuper();\n\n\t\tthis._hasFocus = false;\n\t\tthis._domFocusTracker = this._register(dom.trackFocus(domElement));\n\n\t\tthis._register(this._domFocusTracker.onDidFocus(() => {\n\t\t\tthis._hasFocus = true;\n\t\t\tthis._onChange.fire(undefined);\n\t\t}));\n\t\tthis._register(this._domFocusTracker.onDidBlur(() => {\n\t\t\tthis._hasFocus = false;\n\t\t\tthis._onChange.fire(undefined);\n\t\t}));\n\t}\n\n\tpublic hasFocus(): boolean {\n\t\treturn this._hasFocus;\n\t}\n}\n\nconst squigglyStart = encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='`);\nconst squigglyEnd = encodeURIComponent(`'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>`);\n\nfunction getSquigglySVGData(color: Color) {\n\treturn squigglyStart + encodeURIComponent(color.toString()) + squigglyEnd;\n}\n\nconst dotdotdotStart = encodeURIComponent(`<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"3\" width=\"12\"><g fill=\"`);\nconst dotdotdotEnd = encodeURIComponent(`\"><circle cx=\"1\" cy=\"1\" r=\"1\"/><circle cx=\"5\" cy=\"1\" r=\"1\"/><circle cx=\"9\" cy=\"1\" r=\"1\"/></g></svg>`);\n\nfunction getDotDotDotSVGData(color: Color) {\n\treturn dotdotdotStart + encodeURIComponent(color.toString()) + dotdotdotEnd;\n}\n\nregisterThemingParticipant((theme, collector) => {\n\tconst errorBorderColor = theme.getColor(editorErrorBorder);\n\tif (errorBorderColor) {\n\t\tcollector.addRule(`.monaco-editor .${ClassName.EditorErrorDecoration} { border-bottom: 4px double ${errorBorderColor}; }`);\n\t}\n\tconst errorForeground = theme.getColor(editorErrorForeground);\n\tif (errorForeground) {\n\t\tcollector.addRule(`.monaco-editor .${ClassName.EditorErrorDecoration} { background: url(\"data:image/svg+xml,${getSquigglySVGData(errorForeground)}\") repeat-x bottom left; }`);\n\t}\n\n\tconst warningBorderColor = theme.getColor(editorWarningBorder);\n\tif (warningBorderColor) {\n\t\tcollector.addRule(`.monaco-editor .${ClassName.EditorWarningDecoration} { border-bottom: 4px double ${warningBorderColor}; }`);\n\t}\n\tconst warningForeground = theme.getColor(editorWarningForeground);\n\tif (warningForeground) {\n\t\tcollector.addRule(`.monaco-editor .${ClassName.EditorWarningDecoration} { background: url(\"data:image/svg+xml,${getSquigglySVGData(warningForeground)}\") repeat-x bottom left; }`);\n\t}\n\n\tconst infoBorderColor = theme.getColor(editorInfoBorder);\n\tif (infoBorderColor) {\n\t\tcollector.addRule(`.monaco-editor .${ClassName.EditorInfoDecoration} { border-bottom: 4px double ${infoBorderColor}; }`);\n\t}\n\tconst infoForeground = theme.getColor(editorInfoForeground);\n\tif (infoForeground) {\n\t\tcollector.addRule(`.monaco-editor .${ClassName.EditorInfoDecoration} { background: url(\"data:image/svg+xml,${getSquigglySVGData(infoForeground)}\") repeat-x bottom left; }`);\n\t}\n\n\tconst hintBorderColor = theme.getColor(editorHintBorder);\n\tif (hintBorderColor) {\n\t\tcollector.addRule(`.monaco-editor .${ClassName.EditorHintDecoration} { border-bottom: 2px dotted ${hintBorderColor}; }`);\n\t}\n\tconst hintForeground = theme.getColor(editorHintForeground);\n\tif (hintForeground) {\n\t\tcollector.addRule(`.monaco-editor .${ClassName.EditorHintDecoration} { background: url(\"data:image/svg+xml,${getDotDotDotSVGData(hintForeground)}\") no-repeat bottom left; }`);\n\t}\n\n\tconst unnecessaryForeground = theme.getColor(editorUnnecessaryCodeOpacity);\n\tif (unnecessaryForeground) {\n\t\tcollector.addRule(`.${SHOW_UNUSED_ENABLED_CLASS} .monaco-editor .${ClassName.EditorUnnecessaryInlineDecoration} { opacity: ${unnecessaryForeground.rgba.a}; }`);\n\t}\n\n\tconst unnecessaryBorder = theme.getColor(editorUnnecessaryCodeBorder);\n\tif (unnecessaryBorder) {\n\t\tcollector.addRule(`.${SHOW_UNUSED_ENABLED_CLASS} .monaco-editor .${ClassName.EditorUnnecessaryDecoration} { border-bottom: 2px dashed ${unnecessaryBorder}; }`);\n\t}\n});\n"]}]}