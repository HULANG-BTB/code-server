{"remainingRequest":"/home/coding/workspace/node_modules/ts-loader/index.js?{\"happyPackMode\":true,\"compilerOptions\":{\"target\":\"es5\",\"lib\":[\"dom\",\"esnext\"]}}!/home/coding/workspace/lib/vscode/src/vs/workbench/browser/parts/editor/tabsTitleControl.ts","dependencies":[{"path":"/home/coding/workspace/lib/vscode/src/vs/workbench/browser/parts/editor/tabsTitleControl.ts","mtime":1555846338036},{"path":"/home/coding/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1555844183884},{"path":"/home/coding/workspace/node_modules/ts-loader/index.js","mtime":1555844217316}],"contextDependencies":[],"result":["\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nrequire(\"vs/css!./media/tabstitlecontrol\");\nvar browser_1 = require(\"vs/base/browser/browser\");\nvar labels_1 = require(\"vs/base/common/labels\");\nvar editor_1 = require(\"vs/workbench/common/editor\");\nvar keyboardEvent_1 = require(\"vs/base/browser/keyboardEvent\");\nvar touch_1 = require(\"vs/base/browser/touch\");\nvar keyCodes_1 = require(\"vs/base/common/keyCodes\");\nvar labels_2 = require(\"vs/workbench/browser/labels\");\nvar actionbar_1 = require(\"vs/base/browser/ui/actionbar/actionbar\");\nvar contextView_1 = require(\"vs/platform/contextview/browser/contextView\");\nvar telemetry_1 = require(\"vs/platform/telemetry/common/telemetry\");\nvar instantiation_1 = require(\"vs/platform/instantiation/common/instantiation\");\nvar keybinding_1 = require(\"vs/platform/keybinding/common/keybinding\");\nvar contextkey_1 = require(\"vs/platform/contextkey/common/contextkey\");\nvar actions_1 = require(\"vs/platform/actions/common/actions\");\nvar titleControl_1 = require(\"vs/workbench/browser/parts/editor/titleControl\");\nvar quickOpen_1 = require(\"vs/platform/quickOpen/common/quickOpen\");\nvar lifecycle_1 = require(\"vs/base/common/lifecycle\");\nvar scrollableElement_1 = require(\"vs/base/browser/ui/scrollbar/scrollableElement\");\nvar scrollable_1 = require(\"vs/base/common/scrollable\");\nvar map_1 = require(\"vs/base/common/map\");\nvar themeService_1 = require(\"vs/platform/theme/common/themeService\");\nvar theme_1 = require(\"vs/workbench/common/theme\");\nvar colorRegistry_1 = require(\"vs/platform/theme/common/colorRegistry\");\nvar dnd_1 = require(\"vs/workbench/browser/dnd\");\nvar notification_1 = require(\"vs/platform/notification/common/notification\");\nvar extensions_1 = require(\"vs/workbench/services/extensions/common/extensions\");\nvar editorGroupsService_1 = require(\"vs/workbench/services/editor/common/editorGroupsService\");\nvar untitledEditorService_1 = require(\"vs/workbench/services/untitled/common/untitledEditorService\");\nvar dom_1 = require(\"vs/base/browser/dom\");\nvar nls_1 = require(\"vs/nls\");\nvar editorActions_1 = require(\"vs/workbench/browser/parts/editor/editorActions\");\nvar configuration_1 = require(\"vs/platform/configuration/common/configuration\");\nvar breadcrumbsControl_1 = require(\"vs/workbench/browser/parts/editor/breadcrumbsControl\");\nvar files_1 = require(\"vs/platform/files/common/files\");\nvar types_1 = require(\"vs/base/common/types\");\nvar TabsTitleControl = /** @class */ (function (_super) {\n    tslib_1.__extends(TabsTitleControl, _super);\n    function TabsTitleControl(parent, accessor, group, contextMenuService, instantiationService, untitledEditorService, contextKeyService, keybindingService, telemetryService, notificationService, menuService, quickOpenService, themeService, extensionService, configurationService, fileService) {\n        var _this = _super.call(this, parent, accessor, group, contextMenuService, instantiationService, contextKeyService, keybindingService, telemetryService, notificationService, menuService, quickOpenService, themeService, extensionService, configurationService, fileService) || this;\n        _this.untitledEditorService = untitledEditorService;\n        _this.tabLabels = [];\n        _this.tabDisposeables = [];\n        return _this;\n    }\n    TabsTitleControl.prototype.create = function (parent) {\n        this.titleContainer = parent;\n        // Tabs and Actions Container (are on a single row with flex side-by-side)\n        var tabsAndActionsContainer = document.createElement('div');\n        dom_1.addClass(tabsAndActionsContainer, 'tabs-and-actions-container');\n        this.titleContainer.appendChild(tabsAndActionsContainer);\n        // Tabs Container\n        this.tabsContainer = document.createElement('div');\n        this.tabsContainer.setAttribute('role', 'tablist');\n        this.tabsContainer.draggable = true;\n        dom_1.addClass(this.tabsContainer, 'tabs-container');\n        // Tabs Container listeners\n        this.registerTabsContainerListeners();\n        // Tabs Scrollbar\n        this.tabsScrollbar = this.createTabsScrollbar(this.tabsContainer);\n        tabsAndActionsContainer.appendChild(this.tabsScrollbar.getDomNode());\n        // Editor Toolbar Container\n        this.editorToolbarContainer = document.createElement('div');\n        dom_1.addClass(this.editorToolbarContainer, 'editor-actions');\n        tabsAndActionsContainer.appendChild(this.editorToolbarContainer);\n        // Editor Actions Toolbar\n        this.createEditorActionsToolBar(this.editorToolbarContainer);\n        // Close Action\n        this.closeOneEditorAction = this._register(this.instantiationService.createInstance(editorActions_1.CloseOneEditorAction, editorActions_1.CloseOneEditorAction.ID, editorActions_1.CloseOneEditorAction.LABEL));\n        // Breadcrumbs (are on a separate row below tabs and actions)\n        var breadcrumbsContainer = document.createElement('div');\n        dom_1.addClass(breadcrumbsContainer, 'tabs-breadcrumbs');\n        this.titleContainer.appendChild(breadcrumbsContainer);\n        this.createBreadcrumbsControl(breadcrumbsContainer, { showFileIcons: true, showSymbolIcons: true, showDecorationColors: false, breadcrumbsBackground: colorRegistry_1.breadcrumbsBackground });\n        // Tab Labels\n        this.tabResourceLabels = this._register(this.instantiationService.createInstance(labels_2.ResourceLabels, labels_2.DEFAULT_LABELS_CONTAINER));\n    };\n    TabsTitleControl.prototype.createTabsScrollbar = function (scrollable) {\n        var tabsScrollbar = new scrollableElement_1.ScrollableElement(scrollable, {\n            horizontal: scrollable_1.ScrollbarVisibility.Auto,\n            vertical: scrollable_1.ScrollbarVisibility.Hidden,\n            scrollYToX: true,\n            useShadows: false,\n            horizontalScrollbarSize: 3\n        });\n        tabsScrollbar.onScroll(function (e) {\n            scrollable.scrollLeft = e.scrollLeft;\n        });\n        return tabsScrollbar;\n    };\n    TabsTitleControl.prototype.updateBreadcrumbsControl = function () {\n        if (this.breadcrumbsControl && this.breadcrumbsControl.update()) {\n            // relayout when we have a breadcrumbs and when update changed\n            // its hidden-status\n            this.group.relayout();\n        }\n    };\n    TabsTitleControl.prototype.handleBreadcrumbsEnablementChange = function () {\n        // relayout when breadcrumbs are enable/disabled\n        this.group.relayout();\n    };\n    TabsTitleControl.prototype.registerTabsContainerListeners = function () {\n        var _this = this;\n        // Group dragging\n        this.enableGroupDragging(this.tabsContainer);\n        // Forward scrolling inside the container to our custom scrollbar\n        this._register(dom_1.addDisposableListener(this.tabsContainer, dom_1.EventType.SCROLL, function () {\n            if (dom_1.hasClass(_this.tabsContainer, 'scroll')) {\n                _this.tabsScrollbar.setScrollPosition({\n                    scrollLeft: _this.tabsContainer.scrollLeft // during DND the  container gets scrolled so we need to update the custom scrollbar\n                });\n            }\n        }));\n        // New file when double clicking on tabs container (but not tabs)\n        this._register(dom_1.addDisposableListener(this.tabsContainer, dom_1.EventType.DBLCLICK, function (e) {\n            if (e.target === _this.tabsContainer) {\n                dom_1.EventHelper.stop(e);\n                _this.group.openEditor(_this.untitledEditorService.createOrGet(), { pinned: true /* untitled is always pinned */, index: _this.group.count /* always at the end */ });\n            }\n        }));\n        // Prevent auto-scrolling (https://github.com/Microsoft/vscode/issues/16690)\n        this._register(dom_1.addDisposableListener(this.tabsContainer, dom_1.EventType.MOUSE_DOWN, function (e) {\n            if (e.button === 1) {\n                e.preventDefault();\n            }\n        }));\n        // Drop support\n        this._register(new dnd_1.DragAndDropObserver(this.tabsContainer, {\n            onDragEnter: function (e) {\n                // Always enable support to scroll while dragging\n                dom_1.addClass(_this.tabsContainer, 'scroll');\n                // Return if the target is not on the tabs container\n                if (e.target !== _this.tabsContainer) {\n                    _this.updateDropFeedback(_this.tabsContainer, false); // fixes https://github.com/Microsoft/vscode/issues/52093\n                    return;\n                }\n                // Return if transfer is unsupported\n                if (!_this.isSupportedDropTransfer(e)) {\n                    e.dataTransfer.dropEffect = 'none';\n                    return;\n                }\n                // Return if dragged editor is last tab because then this is a no-op\n                var isLocalDragAndDrop = false;\n                if (_this.editorTransfer.hasData(dnd_1.DraggedEditorIdentifier.prototype)) {\n                    isLocalDragAndDrop = true;\n                    var localDraggedEditor = _this.editorTransfer.getData(dnd_1.DraggedEditorIdentifier.prototype)[0].identifier;\n                    if (_this.group.id === localDraggedEditor.groupId && _this.group.getIndexOfEditor(localDraggedEditor.editor) === _this.group.count - 1) {\n                        e.dataTransfer.dropEffect = 'none';\n                        return;\n                    }\n                }\n                // Update the dropEffect to \"copy\" if there is no local data to be dragged because\n                // in that case we can only copy the data into and not move it from its source\n                if (!isLocalDragAndDrop) {\n                    e.dataTransfer.dropEffect = 'copy';\n                }\n                _this.updateDropFeedback(_this.tabsContainer, true);\n            },\n            onDragLeave: function (e) {\n                _this.updateDropFeedback(_this.tabsContainer, false);\n                dom_1.removeClass(_this.tabsContainer, 'scroll');\n            },\n            onDragEnd: function (e) {\n                _this.updateDropFeedback(_this.tabsContainer, false);\n                dom_1.removeClass(_this.tabsContainer, 'scroll');\n            },\n            onDrop: function (e) {\n                _this.updateDropFeedback(_this.tabsContainer, false);\n                dom_1.removeClass(_this.tabsContainer, 'scroll');\n                if (e.target === _this.tabsContainer) {\n                    _this.onDrop(e, _this.group.count);\n                }\n            }\n        }));\n    };\n    TabsTitleControl.prototype.updateEditorActionsToolbar = function () {\n        _super.prototype.updateEditorActionsToolbar.call(this);\n        // Changing the actions in the toolbar can have an impact on the size of the\n        // tab container, so we need to layout the tabs to make sure the active is visible\n        this.layout(this.dimension);\n    };\n    TabsTitleControl.prototype.openEditor = function (editor) {\n        // Create tabs as needed\n        for (var i = this.tabsContainer.children.length; i < this.group.count; i++) {\n            this.tabsContainer.appendChild(this.createTab(i));\n        }\n        // An add of a tab requires to recompute all labels\n        this.computeTabLabels();\n        // Redraw all tabs\n        this.redraw();\n        // Update Breadcrumbs\n        this.updateBreadcrumbsControl();\n    };\n    TabsTitleControl.prototype.closeEditor = function (editor) {\n        this.handleClosedEditors();\n    };\n    TabsTitleControl.prototype.closeEditors = function (editors) {\n        this.handleClosedEditors();\n    };\n    TabsTitleControl.prototype.closeAllEditors = function () {\n        this.handleClosedEditors();\n    };\n    TabsTitleControl.prototype.handleClosedEditors = function () {\n        // There are tabs to show\n        if (this.group.activeEditor) {\n            // Remove tabs that got closed\n            while (this.tabsContainer.children.length > this.group.count) {\n                // Remove one tab from container (must be the last to keep indexes in order!)\n                this.tabsContainer.lastChild.remove();\n                // Remove associated tab label and widget\n                this.tabDisposeables.pop().dispose();\n            }\n            // A removal of a label requires to recompute all labels\n            this.computeTabLabels();\n            // Redraw all tabs\n            this.redraw();\n        }\n        // No tabs to show\n        else {\n            dom_1.clearNode(this.tabsContainer);\n            this.tabDisposeables = lifecycle_1.dispose(this.tabDisposeables);\n            this.tabResourceLabels.clear();\n            this.tabLabels = [];\n            this.clearEditorActionsToolbar();\n        }\n        // Update Breadcrumbs\n        this.updateBreadcrumbsControl();\n    };\n    TabsTitleControl.prototype.moveEditor = function (editor, fromIndex, targetIndex) {\n        var _this = this;\n        // Swap the editor label\n        var editorLabel = this.tabLabels[fromIndex];\n        this.tabLabels.splice(fromIndex, 1);\n        this.tabLabels.splice(targetIndex, 0, editorLabel);\n        // As such we need to redraw each tab\n        this.forEachTab(function (editor, index, tabContainer, tabLabelWidget, tabLabel) {\n            _this.redrawTab(editor, index, tabContainer, tabLabelWidget, tabLabel);\n        });\n        // Moving an editor requires a layout to keep the active editor visible\n        this.layout(this.dimension);\n    };\n    TabsTitleControl.prototype.pinEditor = function (editor) {\n        var _this = this;\n        this.withTab(editor, function (tabContainer, tabLabelWidget, tabLabel) { return _this.redrawLabel(editor, tabContainer, tabLabelWidget, tabLabel); });\n    };\n    TabsTitleControl.prototype.setActive = function (isGroupActive) {\n        var _this = this;\n        // Activity has an impact on each tab\n        this.forEachTab(function (editor, index, tabContainer, tabLabelWidget, tabLabel) {\n            _this.redrawEditorActiveAndDirty(isGroupActive, editor, tabContainer, tabLabelWidget);\n        });\n        // Activity has an impact on the toolbar, so we need to update and layout\n        this.updateEditorActionsToolbar();\n        this.layout(this.dimension);\n    };\n    TabsTitleControl.prototype.updateEditorLabel = function (editor) {\n        var _this = this;\n        // A change to a label requires to recompute all labels\n        this.computeTabLabels();\n        // As such we need to redraw each label\n        this.forEachTab(function (editor, index, tabContainer, tabLabelWidget, tabLabel) {\n            _this.redrawLabel(editor, tabContainer, tabLabelWidget, tabLabel);\n        });\n        // A change to a label requires a layout to keep the active editor visible\n        this.layout(this.dimension);\n    };\n    TabsTitleControl.prototype.updateEditorDirty = function (editor) {\n        var _this = this;\n        this.withTab(editor, function (tabContainer, tabLabelWidget) { return _this.redrawEditorActiveAndDirty(_this.accessor.activeGroup === _this.group, editor, tabContainer, tabLabelWidget); });\n    };\n    TabsTitleControl.prototype.updateOptions = function (oldOptions, newOptions) {\n        // A change to a label format options requires to recompute all labels\n        if (oldOptions.labelFormat !== newOptions.labelFormat) {\n            this.computeTabLabels();\n        }\n        // Apply new options if something of interest changed\n        if (oldOptions.labelFormat !== newOptions.labelFormat ||\n            oldOptions.tabCloseButton !== newOptions.tabCloseButton ||\n            oldOptions.tabSizing !== newOptions.tabSizing ||\n            oldOptions.showIcons !== newOptions.showIcons ||\n            oldOptions.iconTheme !== newOptions.iconTheme ||\n            oldOptions.highlightModifiedTabs !== newOptions.highlightModifiedTabs) {\n            this.redraw();\n        }\n    };\n    TabsTitleControl.prototype.updateStyles = function () {\n        this.redraw();\n    };\n    TabsTitleControl.prototype.withTab = function (editor, fn) {\n        var editorIndex = this.group.getIndexOfEditor(editor);\n        var tabContainer = this.tabsContainer.children[editorIndex];\n        if (tabContainer) {\n            fn(tabContainer, this.tabResourceLabels.get(editorIndex), this.tabLabels[editorIndex]);\n        }\n    };\n    TabsTitleControl.prototype.createTab = function (index) {\n        var _this = this;\n        // Tab Container\n        var tabContainer = document.createElement('div');\n        tabContainer.draggable = true;\n        tabContainer.tabIndex = 0;\n        tabContainer.setAttribute('role', 'presentation'); // cannot use role \"tab\" here due to https://github.com/Microsoft/vscode/issues/8659\n        dom_1.addClass(tabContainer, 'tab');\n        // Gesture Support\n        touch_1.Gesture.addTarget(tabContainer);\n        // Tab Border Top\n        var tabBorderTopContainer = document.createElement('div');\n        dom_1.addClass(tabBorderTopContainer, 'tab-border-top-container');\n        tabContainer.appendChild(tabBorderTopContainer);\n        // Tab Editor Label\n        var editorLabel = this.tabResourceLabels.create(tabContainer);\n        // Tab Close Button\n        var tabCloseContainer = document.createElement('div');\n        dom_1.addClass(tabCloseContainer, 'tab-close');\n        tabContainer.appendChild(tabCloseContainer);\n        // Tab Border Bottom\n        var tabBorderBottomContainer = document.createElement('div');\n        dom_1.addClass(tabBorderBottomContainer, 'tab-border-bottom-container');\n        tabContainer.appendChild(tabBorderBottomContainer);\n        var tabActionRunner = new editor_1.EditorCommandsContextActionRunner({ groupId: this.group.id, editorIndex: index });\n        var tabActionBar = new actionbar_1.ActionBar(tabCloseContainer, { ariaLabel: nls_1.localize('araLabelTabActions', \"Tab actions\"), actionRunner: tabActionRunner });\n        tabActionBar.push(this.closeOneEditorAction, { icon: true, label: false, keybinding: this.getKeybindingLabel(this.closeOneEditorAction) });\n        tabActionBar.onDidBeforeRun(function () { return _this.blockRevealActiveTabOnce(); });\n        // Eventing\n        var eventsDisposable = this.registerTabListeners(tabContainer, index);\n        this.tabDisposeables.push(lifecycle_1.combinedDisposable([eventsDisposable, tabActionBar, tabActionRunner, editorLabel]));\n        return tabContainer;\n    };\n    TabsTitleControl.prototype.registerTabListeners = function (tab, index) {\n        var _this = this;\n        var disposables = [];\n        var handleClickOrTouch = function (e) {\n            tab.blur();\n            if (e instanceof MouseEvent && e.button !== 0) {\n                if (e.button === 1) {\n                    e.preventDefault(); // required to prevent auto-scrolling (https://github.com/Microsoft/vscode/issues/16690)\n                }\n                return undefined; // only for left mouse click\n            }\n            if (_this.originatesFromTabActionBar(e)) {\n                return; // not when clicking on actions\n            }\n            // Open tabs editor\n            var input = _this.group.getEditor(index);\n            if (input) {\n                _this.group.openEditor(input);\n            }\n            return undefined;\n        };\n        var showContextMenu = function (e) {\n            dom_1.EventHelper.stop(e);\n            var input = _this.group.getEditor(index);\n            if (input) {\n                _this.onContextMenu(input, e, tab);\n            }\n        };\n        // Open on Click / Touch\n        disposables.push(dom_1.addDisposableListener(tab, dom_1.EventType.MOUSE_DOWN, function (e) { return handleClickOrTouch(e); }));\n        disposables.push(dom_1.addDisposableListener(tab, touch_1.EventType.Tap, function (e) { return handleClickOrTouch(e); }));\n        // Touch Scroll Support\n        disposables.push(dom_1.addDisposableListener(tab, touch_1.EventType.Change, function (e) {\n            _this.tabsScrollbar.setScrollPosition({ scrollLeft: _this.tabsScrollbar.getScrollPosition().scrollLeft - e.translationX });\n        }));\n        // Close on mouse middle click\n        disposables.push(dom_1.addDisposableListener(tab, dom_1.EventType.MOUSE_UP, function (e) {\n            dom_1.EventHelper.stop(e);\n            tab.blur();\n            if (e.button === 1 /* Middle Button*/) {\n                e.stopPropagation(); // for https://github.com/Microsoft/vscode/issues/56715\n                _this.blockRevealActiveTabOnce();\n                _this.closeOneEditorAction.run({ groupId: _this.group.id, editorIndex: index });\n            }\n        }));\n        // Context menu on Shift+F10\n        disposables.push(dom_1.addDisposableListener(tab, dom_1.EventType.KEY_DOWN, function (e) {\n            var event = new keyboardEvent_1.StandardKeyboardEvent(e);\n            if (event.shiftKey && event.keyCode === keyCodes_1.KeyCode.F10) {\n                showContextMenu(e);\n            }\n        }));\n        // Context menu on touch context menu gesture\n        disposables.push(dom_1.addDisposableListener(tab, touch_1.EventType.Contextmenu, function (e) {\n            showContextMenu(e);\n        }));\n        // Keyboard accessibility\n        disposables.push(dom_1.addDisposableListener(tab, dom_1.EventType.KEY_UP, function (e) {\n            var event = new keyboardEvent_1.StandardKeyboardEvent(e);\n            var handled = false;\n            // Run action on Enter/Space\n            if (event.equals(keyCodes_1.KeyCode.Enter) || event.equals(keyCodes_1.KeyCode.Space)) {\n                handled = true;\n                var input = _this.group.getEditor(index);\n                if (input) {\n                    _this.group.openEditor(input);\n                }\n            }\n            // Navigate in editors\n            else if ([keyCodes_1.KeyCode.LeftArrow, keyCodes_1.KeyCode.RightArrow, keyCodes_1.KeyCode.UpArrow, keyCodes_1.KeyCode.DownArrow, keyCodes_1.KeyCode.Home, keyCodes_1.KeyCode.End].some(function (kb) { return event.equals(kb); })) {\n                var targetIndex = void 0;\n                if (event.equals(keyCodes_1.KeyCode.LeftArrow) || event.equals(keyCodes_1.KeyCode.UpArrow)) {\n                    targetIndex = index - 1;\n                }\n                else if (event.equals(keyCodes_1.KeyCode.RightArrow) || event.equals(keyCodes_1.KeyCode.DownArrow)) {\n                    targetIndex = index + 1;\n                }\n                else if (event.equals(keyCodes_1.KeyCode.Home)) {\n                    targetIndex = 0;\n                }\n                else {\n                    targetIndex = _this.group.count - 1;\n                }\n                var target = _this.group.getEditor(targetIndex);\n                if (target) {\n                    handled = true;\n                    _this.group.openEditor(target, { preserveFocus: true });\n                    _this.tabsContainer.childNodes[targetIndex].focus();\n                }\n            }\n            if (handled) {\n                dom_1.EventHelper.stop(e, true);\n            }\n            // moving in the tabs container can have an impact on scrolling position, so we need to update the custom scrollbar\n            _this.tabsScrollbar.setScrollPosition({\n                scrollLeft: _this.tabsContainer.scrollLeft\n            });\n        }));\n        // Pin on double click\n        disposables.push(dom_1.addDisposableListener(tab, dom_1.EventType.DBLCLICK, function (e) {\n            dom_1.EventHelper.stop(e);\n            _this.group.pinEditor(_this.group.getEditor(index) || undefined);\n        }));\n        // Context menu\n        disposables.push(dom_1.addDisposableListener(tab, dom_1.EventType.CONTEXT_MENU, function (e) {\n            dom_1.EventHelper.stop(e, true);\n            var input = _this.group.getEditor(index);\n            if (input) {\n                _this.onContextMenu(input, e, tab);\n            }\n        }, true /* use capture to fix https://github.com/Microsoft/vscode/issues/19145 */));\n        // Drag support\n        disposables.push(dom_1.addDisposableListener(tab, dom_1.EventType.DRAG_START, function (e) {\n            var editor = _this.group.getEditor(index);\n            if (!editor) {\n                return;\n            }\n            _this.editorTransfer.setData([new dnd_1.DraggedEditorIdentifier({ editor: editor, groupId: _this.group.id })], dnd_1.DraggedEditorIdentifier.prototype);\n            e.dataTransfer.effectAllowed = 'copyMove';\n            // Apply some datatransfer types to allow for dragging the element outside of the application\n            var resource = editor_1.toResource(editor, { supportSideBySide: true });\n            if (resource) {\n                _this.instantiationService.invokeFunction(dnd_1.fillResourceDataTransfers, [resource], e);\n            }\n            // Fixes https://github.com/Microsoft/vscode/issues/18733\n            dom_1.addClass(tab, 'dragged');\n            dom_1.scheduleAtNextAnimationFrame(function () { return dom_1.removeClass(tab, 'dragged'); });\n        }));\n        // Drop support\n        disposables.push(new dnd_1.DragAndDropObserver(tab, {\n            onDragEnter: function (e) {\n                // Update class to signal drag operation\n                dom_1.addClass(tab, 'dragged-over');\n                // Return if transfer is unsupported\n                if (!_this.isSupportedDropTransfer(e)) {\n                    e.dataTransfer.dropEffect = 'none';\n                    return;\n                }\n                // Return if dragged editor is the current tab dragged over\n                var isLocalDragAndDrop = false;\n                if (_this.editorTransfer.hasData(dnd_1.DraggedEditorIdentifier.prototype)) {\n                    isLocalDragAndDrop = true;\n                    var localDraggedEditor = _this.editorTransfer.getData(dnd_1.DraggedEditorIdentifier.prototype)[0].identifier;\n                    if (localDraggedEditor.editor === _this.group.getEditor(index) && localDraggedEditor.groupId === _this.group.id) {\n                        e.dataTransfer.dropEffect = 'none';\n                        return;\n                    }\n                }\n                // Update the dropEffect to \"copy\" if there is no local data to be dragged because\n                // in that case we can only copy the data into and not move it from its source\n                if (!isLocalDragAndDrop) {\n                    e.dataTransfer.dropEffect = 'copy';\n                }\n                _this.updateDropFeedback(tab, true, index);\n            },\n            onDragLeave: function (e) {\n                dom_1.removeClass(tab, 'dragged-over');\n                _this.updateDropFeedback(tab, false, index);\n            },\n            onDragEnd: function (e) {\n                dom_1.removeClass(tab, 'dragged-over');\n                _this.updateDropFeedback(tab, false, index);\n                _this.editorTransfer.clearData(dnd_1.DraggedEditorIdentifier.prototype);\n            },\n            onDrop: function (e) {\n                dom_1.removeClass(tab, 'dragged-over');\n                _this.updateDropFeedback(tab, false, index);\n                _this.onDrop(e, index);\n            }\n        }));\n        return lifecycle_1.combinedDisposable(disposables);\n    };\n    TabsTitleControl.prototype.isSupportedDropTransfer = function (e) {\n        if (this.groupTransfer.hasData(dnd_1.DraggedEditorGroupIdentifier.prototype)) {\n            var group = this.groupTransfer.getData(dnd_1.DraggedEditorGroupIdentifier.prototype)[0];\n            if (group.identifier === this.group.id) {\n                return false; // groups cannot be dropped on title area it originates from\n            }\n            return true;\n        }\n        if (this.editorTransfer.hasData(dnd_1.DraggedEditorIdentifier.prototype)) {\n            return true; // (local) editors can always be dropped\n        }\n        if (e.dataTransfer && e.dataTransfer.types.length > 0) {\n            return true; // optimistically allow external data (// see https://github.com/Microsoft/vscode/issues/25789)\n        }\n        return false;\n    };\n    TabsTitleControl.prototype.updateDropFeedback = function (element, isDND, index) {\n        var isTab = (typeof index === 'number');\n        var editor = typeof index === 'number' ? this.group.getEditor(index) : null;\n        var isActiveTab = isTab && !!editor && this.group.isActive(editor);\n        // Background\n        var noDNDBackgroundColor = isTab ? this.getColor(isActiveTab ? theme_1.TAB_ACTIVE_BACKGROUND : theme_1.TAB_INACTIVE_BACKGROUND) : null;\n        element.style.backgroundColor = isDND ? this.getColor(theme_1.EDITOR_DRAG_AND_DROP_BACKGROUND) : noDNDBackgroundColor;\n        // Outline\n        var activeContrastBorderColor = this.getColor(colorRegistry_1.activeContrastBorder);\n        if (activeContrastBorderColor && isDND) {\n            element.style.outlineWidth = '2px';\n            element.style.outlineStyle = 'dashed';\n            element.style.outlineColor = activeContrastBorderColor;\n            element.style.outlineOffset = isTab ? '-5px' : '-3px';\n        }\n        else {\n            element.style.outlineWidth = null;\n            element.style.outlineStyle = null;\n            element.style.outlineColor = activeContrastBorderColor;\n            element.style.outlineOffset = null;\n        }\n    };\n    TabsTitleControl.prototype.computeTabLabels = function () {\n        var labelFormat = this.accessor.partOptions.labelFormat;\n        var _a = this.getLabelConfigFlags(labelFormat), verbosity = _a.verbosity, shortenDuplicates = _a.shortenDuplicates;\n        // Build labels and descriptions for each editor\n        var labels = this.group.editors.map(function (editor) { return ({\n            editor: editor,\n            name: editor.getName(),\n            description: types_1.withNullAsUndefined(editor.getDescription(verbosity)),\n            title: types_1.withNullAsUndefined(editor.getTitle(editor_1.Verbosity.LONG))\n        }); });\n        // Shorten labels as needed\n        if (shortenDuplicates) {\n            this.shortenTabLabels(labels);\n        }\n        this.tabLabels = labels;\n    };\n    TabsTitleControl.prototype.shortenTabLabels = function (labels) {\n        // Gather duplicate titles, while filtering out invalid descriptions\n        var mapTitleToDuplicates = new Map();\n        for (var _i = 0, labels_3 = labels; _i < labels_3.length; _i++) {\n            var label = labels_3[_i];\n            if (typeof label.description === 'string') {\n                map_1.getOrSet(mapTitleToDuplicates, label.name, []).push(label);\n            }\n            else {\n                label.description = '';\n            }\n        }\n        // Identify duplicate titles and shorten descriptions\n        mapTitleToDuplicates.forEach(function (duplicateTitles) {\n            // Remove description if the title isn't duplicated\n            if (duplicateTitles.length === 1) {\n                duplicateTitles[0].description = '';\n                return;\n            }\n            // Identify duplicate descriptions\n            var mapDescriptionToDuplicates = new Map();\n            for (var _i = 0, duplicateTitles_1 = duplicateTitles; _i < duplicateTitles_1.length; _i++) {\n                var label = duplicateTitles_1[_i];\n                map_1.getOrSet(mapDescriptionToDuplicates, label.description, []).push(label);\n            }\n            // For editors with duplicate descriptions, check whether any long descriptions differ\n            var useLongDescriptions = false;\n            mapDescriptionToDuplicates.forEach(function (duplicateDescriptions, name) {\n                if (!useLongDescriptions && duplicateDescriptions.length > 1) {\n                    var _a = duplicateDescriptions.map(function (_a) {\n                        var editor = _a.editor;\n                        return editor.getDescription(editor_1.Verbosity.LONG);\n                    }), first_1 = _a[0], rest = _a.slice(1);\n                    useLongDescriptions = rest.some(function (description) { return description !== first_1; });\n                }\n            });\n            // If so, replace all descriptions with long descriptions\n            if (useLongDescriptions) {\n                mapDescriptionToDuplicates.clear();\n                duplicateTitles.forEach(function (label) {\n                    label.description = types_1.withNullAsUndefined(label.editor.getDescription(editor_1.Verbosity.LONG));\n                    map_1.getOrSet(mapDescriptionToDuplicates, label.description, []).push(label);\n                });\n            }\n            // Obtain final set of descriptions\n            var descriptions = [];\n            mapDescriptionToDuplicates.forEach(function (_, description) { return descriptions.push(description); });\n            // Remove description if all descriptions are identical\n            if (descriptions.length === 1) {\n                for (var _a = 0, _b = mapDescriptionToDuplicates.get(descriptions[0]) || []; _a < _b.length; _a++) {\n                    var label = _b[_a];\n                    label.description = '';\n                }\n                return;\n            }\n            // Shorten descriptions\n            var shortenedDescriptions = labels_1.shorten(descriptions);\n            descriptions.forEach(function (description, i) {\n                for (var _i = 0, _a = mapDescriptionToDuplicates.get(description) || []; _i < _a.length; _i++) {\n                    var label = _a[_i];\n                    label.description = shortenedDescriptions[i];\n                }\n            });\n        });\n    };\n    TabsTitleControl.prototype.getLabelConfigFlags = function (value) {\n        switch (value) {\n            case 'short':\n                return { verbosity: editor_1.Verbosity.SHORT, shortenDuplicates: false };\n            case 'medium':\n                return { verbosity: editor_1.Verbosity.MEDIUM, shortenDuplicates: false };\n            case 'long':\n                return { verbosity: editor_1.Verbosity.LONG, shortenDuplicates: false };\n            default:\n                return { verbosity: editor_1.Verbosity.MEDIUM, shortenDuplicates: true };\n        }\n    };\n    TabsTitleControl.prototype.redraw = function () {\n        var _this = this;\n        // For each tab\n        this.forEachTab(function (editor, index, tabContainer, tabLabelWidget, tabLabel) {\n            _this.redrawTab(editor, index, tabContainer, tabLabelWidget, tabLabel);\n        });\n        // Update Editor Actions Toolbar\n        this.updateEditorActionsToolbar();\n        // Ensure the active tab is always revealed\n        this.layout(this.dimension);\n    };\n    TabsTitleControl.prototype.forEachTab = function (fn) {\n        var _this = this;\n        this.group.editors.forEach(function (editor, index) {\n            var tabContainer = _this.tabsContainer.children[index];\n            if (tabContainer) {\n                fn(editor, index, tabContainer, _this.tabResourceLabels.get(index), _this.tabLabels[index]);\n            }\n        });\n    };\n    TabsTitleControl.prototype.redrawTab = function (editor, index, tabContainer, tabLabelWidget, tabLabel) {\n        // Label\n        this.redrawLabel(editor, tabContainer, tabLabelWidget, tabLabel);\n        // Borders / Outline\n        var borderRightColor = (this.getColor(theme_1.TAB_BORDER) || this.getColor(colorRegistry_1.contrastBorder));\n        tabContainer.style.borderRight = borderRightColor ? \"1px solid \" + borderRightColor : null;\n        tabContainer.style.outlineColor = this.getColor(colorRegistry_1.activeContrastBorder);\n        // Settings\n        var options = this.accessor.partOptions;\n        ['off', 'left', 'right'].forEach(function (option) {\n            var domAction = options.tabCloseButton === option ? dom_1.addClass : dom_1.removeClass;\n            domAction(tabContainer, \"close-button-\" + option);\n        });\n        ['fit', 'shrink'].forEach(function (option) {\n            var domAction = options.tabSizing === option ? dom_1.addClass : dom_1.removeClass;\n            domAction(tabContainer, \"sizing-\" + option);\n        });\n        if (options.showIcons && !!options.iconTheme) {\n            dom_1.addClass(tabContainer, 'has-icon-theme');\n        }\n        else {\n            dom_1.removeClass(tabContainer, 'has-icon-theme');\n        }\n        // Active / dirty state\n        this.redrawEditorActiveAndDirty(this.accessor.activeGroup === this.group, editor, tabContainer, tabLabelWidget);\n    };\n    TabsTitleControl.prototype.redrawLabel = function (editor, tabContainer, tabLabelWidget, tabLabel) {\n        var name = tabLabel.name;\n        var description = tabLabel.description || '';\n        var title = tabLabel.title || '';\n        // Container\n        tabContainer.setAttribute('aria-label', name + \", tab\");\n        tabContainer.title = title;\n        // Label\n        tabLabelWidget.setResource({ name: name, description: description, resource: editor_1.toResource(editor, { supportSideBySide: true }) || undefined }, { title: title, extraClasses: ['tab-label'], italic: !this.group.isPinned(editor) });\n    };\n    TabsTitleControl.prototype.redrawEditorActiveAndDirty = function (isGroupActive, editor, tabContainer, tabLabelWidget) {\n        var isTabActive = this.group.isActive(editor);\n        var hasModifiedBorderTop = this.doRedrawEditorDirty(isGroupActive, isTabActive, editor, tabContainer);\n        this.doRedrawEditorActive(isGroupActive, !hasModifiedBorderTop, editor, tabContainer, tabLabelWidget);\n    };\n    TabsTitleControl.prototype.doRedrawEditorActive = function (isGroupActive, allowBorderTop, editor, tabContainer, tabLabelWidget) {\n        // Tab is active\n        if (this.group.isActive(editor)) {\n            // Container\n            dom_1.addClass(tabContainer, 'active');\n            tabContainer.setAttribute('aria-selected', 'true');\n            tabContainer.style.backgroundColor = this.getColor(theme_1.TAB_ACTIVE_BACKGROUND);\n            var activeTabBorderColorBottom = this.getColor(isGroupActive ? theme_1.TAB_ACTIVE_BORDER : theme_1.TAB_UNFOCUSED_ACTIVE_BORDER);\n            if (activeTabBorderColorBottom) {\n                dom_1.addClass(tabContainer, 'tab-border-bottom');\n                tabContainer.style.setProperty('--tab-border-bottom-color', activeTabBorderColorBottom.toString());\n            }\n            else {\n                dom_1.removeClass(tabContainer, 'tab-border-bottom');\n                tabContainer.style.removeProperty('--tab-border-bottom-color');\n            }\n            var activeTabBorderColorTop = allowBorderTop ? this.getColor(isGroupActive ? theme_1.TAB_ACTIVE_BORDER_TOP : theme_1.TAB_UNFOCUSED_ACTIVE_BORDER_TOP) : undefined;\n            if (activeTabBorderColorTop) {\n                dom_1.addClass(tabContainer, 'tab-border-top');\n                tabContainer.style.setProperty('--tab-border-top-color', activeTabBorderColorTop.toString());\n            }\n            else {\n                dom_1.removeClass(tabContainer, 'tab-border-top');\n                tabContainer.style.removeProperty('--tab-border-top-color');\n            }\n            // Label\n            tabLabelWidget.element.style.color = this.getColor(isGroupActive ? theme_1.TAB_ACTIVE_FOREGROUND : theme_1.TAB_UNFOCUSED_ACTIVE_FOREGROUND);\n        }\n        // Tab is inactive\n        else {\n            // Container\n            dom_1.removeClass(tabContainer, 'active');\n            tabContainer.setAttribute('aria-selected', 'false');\n            tabContainer.style.backgroundColor = this.getColor(theme_1.TAB_INACTIVE_BACKGROUND);\n            tabContainer.style.boxShadow = null;\n            // Label\n            tabLabelWidget.element.style.color = this.getColor(isGroupActive ? theme_1.TAB_INACTIVE_FOREGROUND : theme_1.TAB_UNFOCUSED_INACTIVE_FOREGROUND);\n        }\n    };\n    TabsTitleControl.prototype.doRedrawEditorDirty = function (isGroupActive, isTabActive, editor, tabContainer) {\n        var hasModifiedBorderColor = false;\n        // Tab: dirty\n        if (editor.isDirty()) {\n            dom_1.addClass(tabContainer, 'dirty');\n            // Highlight modified tabs with a border if configured\n            if (this.accessor.partOptions.highlightModifiedTabs) {\n                var modifiedBorderColor = void 0;\n                if (isGroupActive && isTabActive) {\n                    modifiedBorderColor = this.getColor(theme_1.TAB_ACTIVE_MODIFIED_BORDER);\n                }\n                else if (isGroupActive && !isTabActive) {\n                    modifiedBorderColor = this.getColor(theme_1.TAB_INACTIVE_MODIFIED_BORDER);\n                }\n                else if (!isGroupActive && isTabActive) {\n                    modifiedBorderColor = this.getColor(theme_1.TAB_UNFOCUSED_ACTIVE_MODIFIED_BORDER);\n                }\n                else {\n                    modifiedBorderColor = this.getColor(theme_1.TAB_UNFOCUSED_INACTIVE_MODIFIED_BORDER);\n                }\n                if (modifiedBorderColor) {\n                    hasModifiedBorderColor = true;\n                    dom_1.addClass(tabContainer, 'dirty-border-top');\n                    tabContainer.style.setProperty('--tab-dirty-border-top-color', modifiedBorderColor);\n                }\n            }\n            else {\n                dom_1.removeClass(tabContainer, 'dirty-border-top');\n                tabContainer.style.removeProperty('--tab-dirty-border-top-color');\n            }\n        }\n        // Tab: not dirty\n        else {\n            dom_1.removeClass(tabContainer, 'dirty');\n            dom_1.removeClass(tabContainer, 'dirty-border-top');\n            tabContainer.style.removeProperty('--tab-dirty-border-top-color');\n        }\n        return hasModifiedBorderColor;\n    };\n    TabsTitleControl.prototype.layout = function (dimension) {\n        var _this = this;\n        this.dimension = dimension;\n        var activeTab = this.group.activeEditor ? this.getTab(this.group.activeEditor) : undefined;\n        if (!activeTab || !this.dimension) {\n            return;\n        }\n        // The layout of tabs can be an expensive operation because we access DOM properties\n        // that can result in the browser doing a full page layout to validate them. To buffer\n        // this a little bit we try at least to schedule this work on the next animation frame.\n        if (!this.layoutScheduled) {\n            this.layoutScheduled = dom_1.scheduleAtNextAnimationFrame(function () {\n                _this.doLayout(_this.dimension);\n                _this.layoutScheduled = undefined;\n            });\n        }\n    };\n    TabsTitleControl.prototype.doLayout = function (dimension) {\n        var activeTab = this.group.activeEditor ? this.getTab(this.group.activeEditor) : undefined;\n        if (!activeTab) {\n            return;\n        }\n        if (this.breadcrumbsControl && !this.breadcrumbsControl.isHidden()) {\n            this.breadcrumbsControl.layout({ width: dimension.width, height: breadcrumbsControl_1.BreadcrumbsControl.HEIGHT });\n            this.tabsScrollbar.getDomNode().style.height = dimension.height - breadcrumbsControl_1.BreadcrumbsControl.HEIGHT + \"px\";\n        }\n        var visibleContainerWidth = this.tabsContainer.offsetWidth;\n        var totalContainerWidth = this.tabsContainer.scrollWidth;\n        var activeTabPosX;\n        var activeTabWidth;\n        if (!this.blockRevealActiveTab) {\n            activeTabPosX = activeTab.offsetLeft;\n            activeTabWidth = activeTab.offsetWidth;\n        }\n        // Update scrollbar\n        this.tabsScrollbar.setScrollDimensions({\n            width: visibleContainerWidth,\n            scrollWidth: totalContainerWidth\n        });\n        // Return now if we are blocked to reveal the active tab and clear flag\n        if (this.blockRevealActiveTab) {\n            this.blockRevealActiveTab = false;\n            return;\n        }\n        // Reveal the active one\n        var containerScrollPosX = this.tabsScrollbar.getScrollPosition().scrollLeft;\n        var activeTabFits = activeTabWidth <= visibleContainerWidth;\n        // Tab is overflowing to the right: Scroll minimally until the element is fully visible to the right\n        // Note: only try to do this if we actually have enough width to give to show the tab fully!\n        if (activeTabFits && containerScrollPosX + visibleContainerWidth < activeTabPosX + activeTabWidth) {\n            this.tabsScrollbar.setScrollPosition({\n                scrollLeft: containerScrollPosX + ((activeTabPosX + activeTabWidth) /* right corner of tab */ - (containerScrollPosX + visibleContainerWidth) /* right corner of view port */)\n            });\n        }\n        // Tab is overlflowng to the left or does not fit: Scroll it into view to the left\n        else if (containerScrollPosX > activeTabPosX || !activeTabFits) {\n            this.tabsScrollbar.setScrollPosition({\n                scrollLeft: activeTabPosX\n            });\n        }\n    };\n    TabsTitleControl.prototype.getTab = function (editor) {\n        var editorIndex = this.group.getIndexOfEditor(editor);\n        if (editorIndex >= 0) {\n            return this.tabsContainer.children[editorIndex];\n        }\n        return undefined;\n    };\n    TabsTitleControl.prototype.blockRevealActiveTabOnce = function () {\n        // When closing tabs through the tab close button or gesture, the user\n        // might want to rapidly close tabs in sequence and as such revealing\n        // the active tab after each close would be annoying. As such we block\n        // the automated revealing of the active tab once after the close is\n        // triggered.\n        this.blockRevealActiveTab = true;\n    };\n    TabsTitleControl.prototype.originatesFromTabActionBar = function (e) {\n        var element;\n        if (e instanceof MouseEvent) {\n            element = (e.target || e.srcElement);\n        }\n        else {\n            element = e.initialTarget;\n        }\n        return !!dom_1.findParentWithClass(element, 'action-item', 'tab');\n    };\n    TabsTitleControl.prototype.onDrop = function (e, targetIndex) {\n        var _this = this;\n        dom_1.EventHelper.stop(e, true);\n        this.updateDropFeedback(this.tabsContainer, false);\n        dom_1.removeClass(this.tabsContainer, 'scroll');\n        // Local Editor DND\n        if (this.editorTransfer.hasData(dnd_1.DraggedEditorIdentifier.prototype)) {\n            var draggedEditor = this.editorTransfer.getData(dnd_1.DraggedEditorIdentifier.prototype)[0].identifier;\n            var sourceGroup = this.accessor.getGroup(draggedEditor.groupId);\n            if (sourceGroup) {\n                // Move editor to target position and index\n                if (this.isMoveOperation(e, draggedEditor.groupId)) {\n                    sourceGroup.moveEditor(draggedEditor.editor, this.group, { index: targetIndex });\n                }\n                // Copy editor to target position and index\n                else {\n                    sourceGroup.copyEditor(draggedEditor.editor, this.group, { index: targetIndex });\n                }\n            }\n            this.group.focus();\n            this.editorTransfer.clearData(dnd_1.DraggedEditorIdentifier.prototype);\n        }\n        // Local Editor Group DND\n        else if (this.groupTransfer.hasData(dnd_1.DraggedEditorGroupIdentifier.prototype)) {\n            var sourceGroup = this.accessor.getGroup(this.groupTransfer.getData(dnd_1.DraggedEditorGroupIdentifier.prototype)[0].identifier);\n            if (sourceGroup) {\n                var mergeGroupOptions = { index: targetIndex };\n                if (!this.isMoveOperation(e, sourceGroup.id)) {\n                    mergeGroupOptions.mode = editorGroupsService_1.MergeGroupMode.COPY_EDITORS;\n                }\n                this.accessor.mergeGroup(sourceGroup, this.group, mergeGroupOptions);\n            }\n            this.group.focus();\n            this.groupTransfer.clearData(dnd_1.DraggedEditorGroupIdentifier.prototype);\n        }\n        // External DND\n        else {\n            var dropHandler = this.instantiationService.createInstance(dnd_1.ResourcesDropHandler, { allowWorkspaceOpen: false /* open workspace file as file if dropped */ });\n            dropHandler.handleDrop(e, function () { return _this.group; }, function () { return _this.group.focus(); }, targetIndex);\n        }\n    };\n    TabsTitleControl.prototype.isMoveOperation = function (e, source) {\n        var isCopy = (e.ctrlKey && !browser_1.isMacintosh) || (e.altKey && browser_1.isMacintosh);\n        return !isCopy || source === this.group.id;\n    };\n    TabsTitleControl.prototype.dispose = function () {\n        _super.prototype.dispose.call(this);\n        lifecycle_1.dispose(this.layoutScheduled);\n        this.layoutScheduled = undefined;\n    };\n    TabsTitleControl = tslib_1.__decorate([\n        tslib_1.__param(3, contextView_1.IContextMenuService),\n        tslib_1.__param(4, instantiation_1.IInstantiationService),\n        tslib_1.__param(5, untitledEditorService_1.IUntitledEditorService),\n        tslib_1.__param(6, contextkey_1.IContextKeyService),\n        tslib_1.__param(7, keybinding_1.IKeybindingService),\n        tslib_1.__param(8, telemetry_1.ITelemetryService),\n        tslib_1.__param(9, notification_1.INotificationService),\n        tslib_1.__param(10, actions_1.IMenuService),\n        tslib_1.__param(11, quickOpen_1.IQuickOpenService),\n        tslib_1.__param(12, themeService_1.IThemeService),\n        tslib_1.__param(13, extensions_1.IExtensionService),\n        tslib_1.__param(14, configuration_1.IConfigurationService),\n        tslib_1.__param(15, files_1.IFileService)\n    ], TabsTitleControl);\n    return TabsTitleControl;\n}(titleControl_1.TitleControl));\nexports.TabsTitleControl = TabsTitleControl;\nthemeService_1.registerThemingParticipant(function (theme, collector) {\n    // Styling with Outline color (e.g. high contrast theme)\n    var activeContrastBorderColor = theme.getColor(colorRegistry_1.activeContrastBorder);\n    if (activeContrastBorderColor) {\n        collector.addRule(\"\\n\\t\\t\\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active,\\n\\t\\t\\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active:hover  {\\n\\t\\t\\t\\toutline: 1px solid;\\n\\t\\t\\t\\toutline-offset: -5px;\\n\\t\\t\\t}\\n\\n\\t\\t\\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {\\n\\t\\t\\t\\toutline: 1px dashed;\\n\\t\\t\\t\\toutline-offset: -5px;\\n\\t\\t\\t}\\n\\n\\t\\t\\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active > .tab-close .action-label,\\n\\t\\t\\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active:hover > .tab-close .action-label,\\n\\t\\t\\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.dirty > .tab-close .action-label,\\n\\t\\t\\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-close .action-label {\\n\\t\\t\\t\\topacity: 1 !important;\\n\\t\\t\\t}\\n\\t\\t\");\n    }\n    // High Contrast Border Color for Editor Actions\n    var contrastBorderColor = theme.getColor(colorRegistry_1.contrastBorder);\n    if (colorRegistry_1.contrastBorder) {\n        collector.addRule(\"\\n\\t\\t\\t.monaco-workbench .part.editor > .content .editor-group-container > .title .editor-actions {\\n\\t\\t\\t\\toutline: 1px solid \" + contrastBorderColor + \"\\n\\t\\t\\t}\\n\\t\\t\");\n    }\n    // Hover Background\n    var tabHoverBackground = theme.getColor(theme_1.TAB_HOVER_BACKGROUND);\n    if (tabHoverBackground) {\n        collector.addRule(\"\\n\\t\\t\\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover  {\\n\\t\\t\\t\\tbackground-color: \" + tabHoverBackground + \" !important;\\n\\t\\t\\t}\\n\\t\\t\");\n    }\n    var tabUnfocusedHoverBackground = theme.getColor(theme_1.TAB_UNFOCUSED_HOVER_BACKGROUND);\n    if (tabUnfocusedHoverBackground) {\n        collector.addRule(\"\\n\\t\\t\\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {\\n\\t\\t\\t\\tbackground-color: \" + tabUnfocusedHoverBackground + \" !important;\\n\\t\\t\\t}\\n\\t\\t\");\n    }\n    // Hover Border\n    var tabHoverBorder = theme.getColor(theme_1.TAB_HOVER_BORDER);\n    if (tabHoverBorder) {\n        collector.addRule(\"\\n\\t\\t\\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover  {\\n\\t\\t\\t\\tbox-shadow: \" + tabHoverBorder + \" 0 -1px inset !important;\\n\\t\\t\\t}\\n\\t\\t\");\n    }\n    var tabUnfocusedHoverBorder = theme.getColor(theme_1.TAB_UNFOCUSED_HOVER_BORDER);\n    if (tabUnfocusedHoverBorder) {\n        collector.addRule(\"\\n\\t\\t\\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {\\n\\t\\t\\t\\tbox-shadow: \" + tabUnfocusedHoverBorder + \" 0 -1px inset !important;\\n\\t\\t\\t}\\n\\t\\t\");\n    }\n    // Fade out styles via linear gradient (when tabs are set to shrink)\n    if (theme.type !== 'hc') {\n        var workbenchBackground = theme_1.WORKBENCH_BACKGROUND(theme);\n        var editorBackgroundColor = theme.getColor(colorRegistry_1.editorBackground);\n        var editorGroupHeaderTabsBackground = theme.getColor(theme_1.EDITOR_GROUP_HEADER_TABS_BACKGROUND);\n        var editorDragAndDropBackground = theme.getColor(theme_1.EDITOR_DRAG_AND_DROP_BACKGROUND);\n        var adjustedTabBackground = void 0;\n        if (editorGroupHeaderTabsBackground && editorBackgroundColor) {\n            adjustedTabBackground = editorGroupHeaderTabsBackground.flatten(editorBackgroundColor, editorBackgroundColor, workbenchBackground);\n        }\n        var adjustedTabDragBackground = void 0;\n        if (editorGroupHeaderTabsBackground && editorBackgroundColor && editorDragAndDropBackground && editorBackgroundColor) {\n            adjustedTabDragBackground = editorGroupHeaderTabsBackground.flatten(editorBackgroundColor, editorDragAndDropBackground, editorBackgroundColor, workbenchBackground);\n        }\n        // Adjust gradient for (focused) hover background\n        if (tabHoverBackground && adjustedTabBackground && adjustedTabDragBackground) {\n            var adjustedColor = tabHoverBackground.flatten(adjustedTabBackground);\n            var adjustedColorDrag = tabHoverBackground.flatten(adjustedTabDragBackground);\n            collector.addRule(\"\\n\\t\\t\\t\\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink:not(.dragged):hover > .tab-label::after {\\n\\t\\t\\t\\t\\tbackground: linear-gradient(to left, \" + adjustedColor + \", transparent) !important;\\n\\t\\t\\t\\t}\\n\\n\\n\\t\\t\\t\\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink:not(.dragged):hover > .tab-label::after {\\n\\t\\t\\t\\t\\tbackground: linear-gradient(to left, \" + adjustedColorDrag + \", transparent) !important;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\");\n        }\n        // Adjust gradient for unfocused hover background\n        if (tabUnfocusedHoverBackground && adjustedTabBackground && adjustedTabDragBackground) {\n            var adjustedColor = tabUnfocusedHoverBackground.flatten(adjustedTabBackground);\n            var adjustedColorDrag = tabUnfocusedHoverBackground.flatten(adjustedTabDragBackground);\n            collector.addRule(\"\\n\\t\\t\\t\\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container > .title .tabs-container > .tab.sizing-shrink:not(.dragged):hover > .tab-label::after {\\n\\t\\t\\t\\t\\tbackground: linear-gradient(to left, \" + adjustedColor + \", transparent) !important;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container > .title .tabs-container > .tab.sizing-shrink:not(.dragged):hover > .tab-label::after {\\n\\t\\t\\t\\t\\tbackground: linear-gradient(to left, \" + adjustedColorDrag + \", transparent) !important;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\");\n        }\n        // Adjust gradient for drag and drop background\n        if (editorDragAndDropBackground && adjustedTabDragBackground) {\n            var adjustedColorDrag = editorDragAndDropBackground.flatten(adjustedTabDragBackground);\n            collector.addRule(\"\\n\\t\\t\\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.active):not(.dragged) > .tab-label::after,\\n\\t\\t\\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.dragged) > .tab-label::after {\\n\\t\\t\\t\\tbackground: linear-gradient(to left, \" + adjustedColorDrag + \", transparent) !important;\\n\\t\\t\\t}\\n\\t\\t\");\n        }\n        // Adjust gradient for active tab background\n        var tabActiveBackground = theme.getColor(theme_1.TAB_ACTIVE_BACKGROUND);\n        if (tabActiveBackground && adjustedTabBackground && adjustedTabDragBackground) {\n            var adjustedColor = tabActiveBackground.flatten(adjustedTabBackground);\n            var adjustedColorDrag = tabActiveBackground.flatten(adjustedTabDragBackground);\n            collector.addRule(\"\\n\\t\\t\\t\\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container > .title .tabs-container > .tab.sizing-shrink.active:not(.dragged) > .tab-label::after {\\n\\t\\t\\t\\t\\tbackground: linear-gradient(to left, \" + adjustedColor + \", transparent);\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container > .title .tabs-container > .tab.sizing-shrink.active:not(.dragged) > .tab-label::after {\\n\\t\\t\\t\\t\\tbackground: linear-gradient(to left, \" + adjustedColorDrag + \", transparent);\\n\\t\\t\\t\\t}\\n\\t\\t\\t\");\n        }\n        // Adjust gradient for inactive tab background\n        var tabInactiveBackground = theme.getColor(theme_1.TAB_INACTIVE_BACKGROUND);\n        if (tabInactiveBackground && adjustedTabBackground && adjustedTabDragBackground) {\n            var adjustedColor = tabInactiveBackground.flatten(adjustedTabBackground);\n            var adjustedColorDrag = tabInactiveBackground.flatten(adjustedTabDragBackground);\n            collector.addRule(\"\\n\\t\\t\\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container > .title .tabs-container > .tab.sizing-shrink:not(.dragged) > .tab-label::after {\\n\\t\\t\\t\\tbackground: linear-gradient(to left, \" + adjustedColor + \", transparent);\\n\\t\\t\\t}\\n\\n\\t\\t\\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container > .title .tabs-container > .tab.sizing-shrink:not(.dragged) > .tab-label::after {\\n\\t\\t\\t\\tbackground: linear-gradient(to left, \" + adjustedColorDrag + \", transparent);\\n\\t\\t\\t}\\n\\t\\t\");\n        }\n    }\n});\n",{"version":3,"file":"/home/coding/workspace/lib/vscode/src/vs/workbench/browser/parts/editor/tabsTitleControl.ts","sourceRoot":"","sources":["/home/coding/workspace/lib/vscode/src/vs/workbench/browser/parts/editor/tabsTitleControl.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./media/tabstitlecontrol';\nimport { isMacintosh } from 'vs/base/browser/browser';\nimport { shorten } from 'vs/base/common/labels';\nimport { toResource, GroupIdentifier, IEditorInput, Verbosity, EditorCommandsContextActionRunner, IEditorPartOptions } from 'vs/workbench/common/editor';\nimport { StandardKeyboardEvent } from 'vs/base/browser/keyboardEvent';\nimport { EventType as TouchEventType, GestureEvent, Gesture } from 'vs/base/browser/touch';\nimport { KeyCode } from 'vs/base/common/keyCodes';\nimport { ResourceLabels, IResourceLabel, DEFAULT_LABELS_CONTAINER } from 'vs/workbench/browser/labels';\nimport { ActionBar } from 'vs/base/browser/ui/actionbar/actionbar';\nimport { IContextMenuService } from 'vs/platform/contextview/browser/contextView';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IMenuService } from 'vs/platform/actions/common/actions';\nimport { TitleControl } from 'vs/workbench/browser/parts/editor/titleControl';\nimport { IQuickOpenService } from 'vs/platform/quickOpen/common/quickOpen';\nimport { IDisposable, dispose, combinedDisposable } from 'vs/base/common/lifecycle';\nimport { ScrollableElement } from 'vs/base/browser/ui/scrollbar/scrollableElement';\nimport { ScrollbarVisibility } from 'vs/base/common/scrollable';\nimport { getOrSet } from 'vs/base/common/map';\nimport { IThemeService, registerThemingParticipant, ITheme, ICssStyleCollector } from 'vs/platform/theme/common/themeService';\nimport { TAB_INACTIVE_BACKGROUND, TAB_ACTIVE_BACKGROUND, TAB_ACTIVE_FOREGROUND, TAB_INACTIVE_FOREGROUND, TAB_BORDER, EDITOR_DRAG_AND_DROP_BACKGROUND, TAB_UNFOCUSED_ACTIVE_FOREGROUND, TAB_UNFOCUSED_INACTIVE_FOREGROUND, TAB_UNFOCUSED_ACTIVE_BORDER, TAB_ACTIVE_BORDER, TAB_HOVER_BACKGROUND, TAB_HOVER_BORDER, TAB_UNFOCUSED_HOVER_BACKGROUND, TAB_UNFOCUSED_HOVER_BORDER, EDITOR_GROUP_HEADER_TABS_BACKGROUND, WORKBENCH_BACKGROUND, TAB_ACTIVE_BORDER_TOP, TAB_UNFOCUSED_ACTIVE_BORDER_TOP, TAB_ACTIVE_MODIFIED_BORDER, TAB_INACTIVE_MODIFIED_BORDER, TAB_UNFOCUSED_ACTIVE_MODIFIED_BORDER, TAB_UNFOCUSED_INACTIVE_MODIFIED_BORDER } from 'vs/workbench/common/theme';\nimport { activeContrastBorder, contrastBorder, editorBackground, breadcrumbsBackground } from 'vs/platform/theme/common/colorRegistry';\nimport { ResourcesDropHandler, fillResourceDataTransfers, DraggedEditorIdentifier, DraggedEditorGroupIdentifier, DragAndDropObserver } from 'vs/workbench/browser/dnd';\nimport { Color } from 'vs/base/common/color';\nimport { INotificationService } from 'vs/platform/notification/common/notification';\nimport { IExtensionService } from 'vs/workbench/services/extensions/common/extensions';\nimport { MergeGroupMode, IMergeGroupOptions } from 'vs/workbench/services/editor/common/editorGroupsService';\nimport { IUntitledEditorService } from 'vs/workbench/services/untitled/common/untitledEditorService';\nimport { addClass, addDisposableListener, hasClass, EventType, EventHelper, removeClass, Dimension, scheduleAtNextAnimationFrame, findParentWithClass, clearNode } from 'vs/base/browser/dom';\nimport { localize } from 'vs/nls';\nimport { IEditorGroupsAccessor, IEditorGroupView } from 'vs/workbench/browser/parts/editor/editor';\nimport { CloseOneEditorAction } from 'vs/workbench/browser/parts/editor/editorActions';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { BreadcrumbsControl } from 'vs/workbench/browser/parts/editor/breadcrumbsControl';\nimport { IFileService } from 'vs/platform/files/common/files';\nimport { withNullAsUndefined } from 'vs/base/common/types';\n\ninterface IEditorInputLabel {\n\tname: string;\n\tdescription?: string;\n\ttitle?: string;\n}\n\ntype AugmentedLabel = IEditorInputLabel & { editor: IEditorInput };\n\nexport class TabsTitleControl extends TitleControl {\n\n\tprivate titleContainer: HTMLElement;\n\tprivate tabsContainer: HTMLElement;\n\tprivate editorToolbarContainer: HTMLElement;\n\tprivate tabsScrollbar: ScrollableElement;\n\tprivate closeOneEditorAction: CloseOneEditorAction;\n\n\tprivate tabResourceLabels: ResourceLabels;\n\tprivate tabLabels: IEditorInputLabel[] = [];\n\tprivate tabDisposeables: IDisposable[] = [];\n\n\tprivate dimension: Dimension;\n\tprivate layoutScheduled?: IDisposable;\n\tprivate blockRevealActiveTab: boolean;\n\n\tconstructor(\n\t\tparent: HTMLElement,\n\t\taccessor: IEditorGroupsAccessor,\n\t\tgroup: IEditorGroupView,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IUntitledEditorService private readonly untitledEditorService: IUntitledEditorService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IQuickOpenService quickOpenService: IQuickOpenService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IExtensionService extensionService: IExtensionService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IFileService fileService: IFileService,\n\t) {\n\t\tsuper(parent, accessor, group, contextMenuService, instantiationService, contextKeyService, keybindingService, telemetryService, notificationService, menuService, quickOpenService, themeService, extensionService, configurationService, fileService);\n\t}\n\n\tprotected create(parent: HTMLElement): void {\n\t\tthis.titleContainer = parent;\n\n\t\t// Tabs and Actions Container (are on a single row with flex side-by-side)\n\t\tconst tabsAndActionsContainer = document.createElement('div');\n\t\taddClass(tabsAndActionsContainer, 'tabs-and-actions-container');\n\t\tthis.titleContainer.appendChild(tabsAndActionsContainer);\n\n\t\t// Tabs Container\n\t\tthis.tabsContainer = document.createElement('div');\n\t\tthis.tabsContainer.setAttribute('role', 'tablist');\n\t\tthis.tabsContainer.draggable = true;\n\t\taddClass(this.tabsContainer, 'tabs-container');\n\n\t\t// Tabs Container listeners\n\t\tthis.registerTabsContainerListeners();\n\n\t\t// Tabs Scrollbar\n\t\tthis.tabsScrollbar = this.createTabsScrollbar(this.tabsContainer);\n\t\ttabsAndActionsContainer.appendChild(this.tabsScrollbar.getDomNode());\n\n\t\t// Editor Toolbar Container\n\t\tthis.editorToolbarContainer = document.createElement('div');\n\t\taddClass(this.editorToolbarContainer, 'editor-actions');\n\t\ttabsAndActionsContainer.appendChild(this.editorToolbarContainer);\n\n\t\t// Editor Actions Toolbar\n\t\tthis.createEditorActionsToolBar(this.editorToolbarContainer);\n\n\t\t// Close Action\n\t\tthis.closeOneEditorAction = this._register(this.instantiationService.createInstance(CloseOneEditorAction, CloseOneEditorAction.ID, CloseOneEditorAction.LABEL));\n\n\t\t// Breadcrumbs (are on a separate row below tabs and actions)\n\t\tconst breadcrumbsContainer = document.createElement('div');\n\t\taddClass(breadcrumbsContainer, 'tabs-breadcrumbs');\n\t\tthis.titleContainer.appendChild(breadcrumbsContainer);\n\t\tthis.createBreadcrumbsControl(breadcrumbsContainer, { showFileIcons: true, showSymbolIcons: true, showDecorationColors: false, breadcrumbsBackground: breadcrumbsBackground });\n\n\t\t// Tab Labels\n\t\tthis.tabResourceLabels = this._register(this.instantiationService.createInstance(ResourceLabels, DEFAULT_LABELS_CONTAINER));\n\t}\n\n\tprivate createTabsScrollbar(scrollable: HTMLElement): ScrollableElement {\n\t\tconst tabsScrollbar = new ScrollableElement(scrollable, {\n\t\t\thorizontal: ScrollbarVisibility.Auto,\n\t\t\tvertical: ScrollbarVisibility.Hidden,\n\t\t\tscrollYToX: true,\n\t\t\tuseShadows: false,\n\t\t\thorizontalScrollbarSize: 3\n\t\t});\n\n\t\ttabsScrollbar.onScroll(e => {\n\t\t\tscrollable.scrollLeft = e.scrollLeft;\n\t\t});\n\n\t\treturn tabsScrollbar;\n\t}\n\n\tprivate updateBreadcrumbsControl(): void {\n\t\tif (this.breadcrumbsControl && this.breadcrumbsControl.update()) {\n\t\t\t// relayout when we have a breadcrumbs and when update changed\n\t\t\t// its hidden-status\n\t\t\tthis.group.relayout();\n\t\t}\n\t}\n\n\tprotected handleBreadcrumbsEnablementChange(): void {\n\t\t// relayout when breadcrumbs are enable/disabled\n\t\tthis.group.relayout();\n\t}\n\n\tprivate registerTabsContainerListeners(): void {\n\n\t\t// Group dragging\n\t\tthis.enableGroupDragging(this.tabsContainer);\n\n\t\t// Forward scrolling inside the container to our custom scrollbar\n\t\tthis._register(addDisposableListener(this.tabsContainer, EventType.SCROLL, () => {\n\t\t\tif (hasClass(this.tabsContainer, 'scroll')) {\n\t\t\t\tthis.tabsScrollbar.setScrollPosition({\n\t\t\t\t\tscrollLeft: this.tabsContainer.scrollLeft // during DND the  container gets scrolled so we need to update the custom scrollbar\n\t\t\t\t});\n\t\t\t}\n\t\t}));\n\n\t\t// New file when double clicking on tabs container (but not tabs)\n\t\tthis._register(addDisposableListener(this.tabsContainer, EventType.DBLCLICK, e => {\n\t\t\tif (e.target === this.tabsContainer) {\n\t\t\t\tEventHelper.stop(e);\n\n\t\t\t\tthis.group.openEditor(this.untitledEditorService.createOrGet(), { pinned: true /* untitled is always pinned */, index: this.group.count /* always at the end */ });\n\t\t\t}\n\t\t}));\n\n\t\t// Prevent auto-scrolling (https://github.com/Microsoft/vscode/issues/16690)\n\t\tthis._register(addDisposableListener(this.tabsContainer, EventType.MOUSE_DOWN, (e: MouseEvent) => {\n\t\t\tif (e.button === 1) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t}));\n\n\n\t\t// Drop support\n\t\tthis._register(new DragAndDropObserver(this.tabsContainer, {\n\t\t\tonDragEnter: e => {\n\n\t\t\t\t// Always enable support to scroll while dragging\n\t\t\t\taddClass(this.tabsContainer, 'scroll');\n\n\t\t\t\t// Return if the target is not on the tabs container\n\t\t\t\tif (e.target !== this.tabsContainer) {\n\t\t\t\t\tthis.updateDropFeedback(this.tabsContainer, false); // fixes https://github.com/Microsoft/vscode/issues/52093\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Return if transfer is unsupported\n\t\t\t\tif (!this.isSupportedDropTransfer(e)) {\n\t\t\t\t\te.dataTransfer!.dropEffect = 'none';\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Return if dragged editor is last tab because then this is a no-op\n\t\t\t\tlet isLocalDragAndDrop = false;\n\t\t\t\tif (this.editorTransfer.hasData(DraggedEditorIdentifier.prototype)) {\n\t\t\t\t\tisLocalDragAndDrop = true;\n\n\t\t\t\t\tconst localDraggedEditor = this.editorTransfer.getData(DraggedEditorIdentifier.prototype)![0].identifier;\n\t\t\t\t\tif (this.group.id === localDraggedEditor.groupId && this.group.getIndexOfEditor(localDraggedEditor.editor) === this.group.count - 1) {\n\t\t\t\t\t\te.dataTransfer!.dropEffect = 'none';\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Update the dropEffect to \"copy\" if there is no local data to be dragged because\n\t\t\t\t// in that case we can only copy the data into and not move it from its source\n\t\t\t\tif (!isLocalDragAndDrop) {\n\t\t\t\t\te.dataTransfer!.dropEffect = 'copy';\n\t\t\t\t}\n\n\t\t\t\tthis.updateDropFeedback(this.tabsContainer, true);\n\t\t\t},\n\n\t\t\tonDragLeave: e => {\n\t\t\t\tthis.updateDropFeedback(this.tabsContainer, false);\n\t\t\t\tremoveClass(this.tabsContainer, 'scroll');\n\t\t\t},\n\n\t\t\tonDragEnd: e => {\n\t\t\t\tthis.updateDropFeedback(this.tabsContainer, false);\n\t\t\t\tremoveClass(this.tabsContainer, 'scroll');\n\t\t\t},\n\n\t\t\tonDrop: e => {\n\t\t\t\tthis.updateDropFeedback(this.tabsContainer, false);\n\t\t\t\tremoveClass(this.tabsContainer, 'scroll');\n\n\t\t\t\tif (e.target === this.tabsContainer) {\n\t\t\t\t\tthis.onDrop(e, this.group.count);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tprotected updateEditorActionsToolbar(): void {\n\t\tsuper.updateEditorActionsToolbar();\n\n\t\t// Changing the actions in the toolbar can have an impact on the size of the\n\t\t// tab container, so we need to layout the tabs to make sure the active is visible\n\t\tthis.layout(this.dimension);\n\t}\n\n\topenEditor(editor: IEditorInput): void {\n\n\t\t// Create tabs as needed\n\t\tfor (let i = this.tabsContainer.children.length; i < this.group.count; i++) {\n\t\t\tthis.tabsContainer.appendChild(this.createTab(i));\n\t\t}\n\n\t\t// An add of a tab requires to recompute all labels\n\t\tthis.computeTabLabels();\n\n\t\t// Redraw all tabs\n\t\tthis.redraw();\n\n\t\t// Update Breadcrumbs\n\t\tthis.updateBreadcrumbsControl();\n\t}\n\n\tcloseEditor(editor: IEditorInput): void {\n\t\tthis.handleClosedEditors();\n\t}\n\n\tcloseEditors(editors: IEditorInput[]): void {\n\t\tthis.handleClosedEditors();\n\t}\n\n\tcloseAllEditors(): void {\n\t\tthis.handleClosedEditors();\n\t}\n\n\tprivate handleClosedEditors(): void {\n\n\t\t// There are tabs to show\n\t\tif (this.group.activeEditor) {\n\n\t\t\t// Remove tabs that got closed\n\t\t\twhile (this.tabsContainer.children.length > this.group.count) {\n\n\t\t\t\t// Remove one tab from container (must be the last to keep indexes in order!)\n\t\t\t\t(this.tabsContainer.lastChild as HTMLElement).remove();\n\n\t\t\t\t// Remove associated tab label and widget\n\t\t\t\tthis.tabDisposeables.pop()!.dispose();\n\t\t\t}\n\n\t\t\t// A removal of a label requires to recompute all labels\n\t\t\tthis.computeTabLabels();\n\n\t\t\t// Redraw all tabs\n\t\t\tthis.redraw();\n\t\t}\n\n\t\t// No tabs to show\n\t\telse {\n\t\t\tclearNode(this.tabsContainer);\n\n\t\t\tthis.tabDisposeables = dispose(this.tabDisposeables);\n\t\t\tthis.tabResourceLabels.clear();\n\t\t\tthis.tabLabels = [];\n\n\t\t\tthis.clearEditorActionsToolbar();\n\t\t}\n\n\t\t// Update Breadcrumbs\n\t\tthis.updateBreadcrumbsControl();\n\t}\n\n\tmoveEditor(editor: IEditorInput, fromIndex: number, targetIndex: number): void {\n\n\t\t// Swap the editor label\n\t\tconst editorLabel = this.tabLabels[fromIndex];\n\t\tthis.tabLabels.splice(fromIndex, 1);\n\t\tthis.tabLabels.splice(targetIndex, 0, editorLabel);\n\n\t\t// As such we need to redraw each tab\n\t\tthis.forEachTab((editor, index, tabContainer, tabLabelWidget, tabLabel) => {\n\t\t\tthis.redrawTab(editor, index, tabContainer, tabLabelWidget, tabLabel);\n\t\t});\n\n\t\t// Moving an editor requires a layout to keep the active editor visible\n\t\tthis.layout(this.dimension);\n\t}\n\n\tpinEditor(editor: IEditorInput): void {\n\t\tthis.withTab(editor, (tabContainer, tabLabelWidget, tabLabel) => this.redrawLabel(editor, tabContainer, tabLabelWidget, tabLabel));\n\t}\n\n\tsetActive(isGroupActive: boolean): void {\n\n\t\t// Activity has an impact on each tab\n\t\tthis.forEachTab((editor, index, tabContainer, tabLabelWidget, tabLabel) => {\n\t\t\tthis.redrawEditorActiveAndDirty(isGroupActive, editor, tabContainer, tabLabelWidget);\n\t\t});\n\n\t\t// Activity has an impact on the toolbar, so we need to update and layout\n\t\tthis.updateEditorActionsToolbar();\n\t\tthis.layout(this.dimension);\n\t}\n\n\tupdateEditorLabel(editor: IEditorInput): void {\n\n\t\t// A change to a label requires to recompute all labels\n\t\tthis.computeTabLabels();\n\n\t\t// As such we need to redraw each label\n\t\tthis.forEachTab((editor, index, tabContainer, tabLabelWidget, tabLabel) => {\n\t\t\tthis.redrawLabel(editor, tabContainer, tabLabelWidget, tabLabel);\n\t\t});\n\n\t\t// A change to a label requires a layout to keep the active editor visible\n\t\tthis.layout(this.dimension);\n\t}\n\n\tupdateEditorDirty(editor: IEditorInput): void {\n\t\tthis.withTab(editor, (tabContainer, tabLabelWidget) => this.redrawEditorActiveAndDirty(this.accessor.activeGroup === this.group, editor, tabContainer, tabLabelWidget));\n\t}\n\n\tupdateOptions(oldOptions: IEditorPartOptions, newOptions: IEditorPartOptions): void {\n\n\t\t// A change to a label format options requires to recompute all labels\n\t\tif (oldOptions.labelFormat !== newOptions.labelFormat) {\n\t\t\tthis.computeTabLabels();\n\t\t}\n\n\t\t// Apply new options if something of interest changed\n\t\tif (\n\t\t\toldOptions.labelFormat !== newOptions.labelFormat ||\n\t\t\toldOptions.tabCloseButton !== newOptions.tabCloseButton ||\n\t\t\toldOptions.tabSizing !== newOptions.tabSizing ||\n\t\t\toldOptions.showIcons !== newOptions.showIcons ||\n\t\t\toldOptions.iconTheme !== newOptions.iconTheme ||\n\t\t\toldOptions.highlightModifiedTabs !== newOptions.highlightModifiedTabs\n\t\t) {\n\t\t\tthis.redraw();\n\t\t}\n\t}\n\n\tupdateStyles(): void {\n\t\tthis.redraw();\n\t}\n\n\tprivate withTab(editor: IEditorInput, fn: (tabContainer: HTMLElement, tabLabelWidget: IResourceLabel, tabLabel: IEditorInputLabel) => void): void {\n\t\tconst editorIndex = this.group.getIndexOfEditor(editor);\n\n\t\tconst tabContainer = this.tabsContainer.children[editorIndex] as HTMLElement;\n\t\tif (tabContainer) {\n\t\t\tfn(tabContainer, this.tabResourceLabels.get(editorIndex), this.tabLabels[editorIndex]);\n\t\t}\n\t}\n\n\tprivate createTab(index: number): HTMLElement {\n\n\t\t// Tab Container\n\t\tconst tabContainer = document.createElement('div');\n\t\ttabContainer.draggable = true;\n\t\ttabContainer.tabIndex = 0;\n\t\ttabContainer.setAttribute('role', 'presentation'); // cannot use role \"tab\" here due to https://github.com/Microsoft/vscode/issues/8659\n\t\taddClass(tabContainer, 'tab');\n\n\t\t// Gesture Support\n\t\tGesture.addTarget(tabContainer);\n\n\t\t// Tab Border Top\n\t\tconst tabBorderTopContainer = document.createElement('div');\n\t\taddClass(tabBorderTopContainer, 'tab-border-top-container');\n\t\ttabContainer.appendChild(tabBorderTopContainer);\n\n\t\t// Tab Editor Label\n\t\tconst editorLabel = this.tabResourceLabels.create(tabContainer);\n\n\t\t// Tab Close Button\n\t\tconst tabCloseContainer = document.createElement('div');\n\t\taddClass(tabCloseContainer, 'tab-close');\n\t\ttabContainer.appendChild(tabCloseContainer);\n\n\t\t// Tab Border Bottom\n\t\tconst tabBorderBottomContainer = document.createElement('div');\n\t\taddClass(tabBorderBottomContainer, 'tab-border-bottom-container');\n\t\ttabContainer.appendChild(tabBorderBottomContainer);\n\n\t\tconst tabActionRunner = new EditorCommandsContextActionRunner({ groupId: this.group.id, editorIndex: index });\n\n\t\tconst tabActionBar = new ActionBar(tabCloseContainer, { ariaLabel: localize('araLabelTabActions', \"Tab actions\"), actionRunner: tabActionRunner });\n\t\ttabActionBar.push(this.closeOneEditorAction, { icon: true, label: false, keybinding: this.getKeybindingLabel(this.closeOneEditorAction) });\n\t\ttabActionBar.onDidBeforeRun(() => this.blockRevealActiveTabOnce());\n\n\t\t// Eventing\n\t\tconst eventsDisposable = this.registerTabListeners(tabContainer, index);\n\n\t\tthis.tabDisposeables.push(combinedDisposable([eventsDisposable, tabActionBar, tabActionRunner, editorLabel]));\n\n\t\treturn tabContainer;\n\t}\n\n\tprivate registerTabListeners(tab: HTMLElement, index: number): IDisposable {\n\t\tconst disposables: IDisposable[] = [];\n\n\t\tconst handleClickOrTouch = (e: MouseEvent | GestureEvent): void => {\n\t\t\ttab.blur();\n\n\t\t\tif (e instanceof MouseEvent && e.button !== 0) {\n\t\t\t\tif (e.button === 1) {\n\t\t\t\t\te.preventDefault(); // required to prevent auto-scrolling (https://github.com/Microsoft/vscode/issues/16690)\n\t\t\t\t}\n\n\t\t\t\treturn undefined; // only for left mouse click\n\t\t\t}\n\n\t\t\tif (this.originatesFromTabActionBar(e)) {\n\t\t\t\treturn; // not when clicking on actions\n\t\t\t}\n\n\t\t\t// Open tabs editor\n\t\t\tconst input = this.group.getEditor(index);\n\t\t\tif (input) {\n\t\t\t\tthis.group.openEditor(input);\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t};\n\n\t\tconst showContextMenu = (e: Event) => {\n\t\t\tEventHelper.stop(e);\n\n\t\t\tconst input = this.group.getEditor(index);\n\t\t\tif (input) {\n\t\t\t\tthis.onContextMenu(input, e, tab);\n\t\t\t}\n\t\t};\n\n\t\t// Open on Click / Touch\n\t\tdisposables.push(addDisposableListener(tab, EventType.MOUSE_DOWN, (e: MouseEvent) => handleClickOrTouch(e)));\n\t\tdisposables.push(addDisposableListener(tab, TouchEventType.Tap, (e: GestureEvent) => handleClickOrTouch(e)));\n\n\t\t// Touch Scroll Support\n\t\tdisposables.push(addDisposableListener(tab, TouchEventType.Change, (e: GestureEvent) => {\n\t\t\tthis.tabsScrollbar.setScrollPosition({ scrollLeft: this.tabsScrollbar.getScrollPosition().scrollLeft - e.translationX });\n\t\t}));\n\n\t\t// Close on mouse middle click\n\t\tdisposables.push(addDisposableListener(tab, EventType.MOUSE_UP, (e: MouseEvent) => {\n\t\t\tEventHelper.stop(e);\n\n\t\t\ttab.blur();\n\n\t\t\tif (e.button === 1 /* Middle Button*/) {\n\t\t\t\te.stopPropagation(); // for https://github.com/Microsoft/vscode/issues/56715\n\n\t\t\t\tthis.blockRevealActiveTabOnce();\n\t\t\t\tthis.closeOneEditorAction.run({ groupId: this.group.id, editorIndex: index });\n\t\t\t}\n\t\t}));\n\n\t\t// Context menu on Shift+F10\n\t\tdisposables.push(addDisposableListener(tab, EventType.KEY_DOWN, (e: KeyboardEvent) => {\n\t\t\tconst event = new StandardKeyboardEvent(e);\n\t\t\tif (event.shiftKey && event.keyCode === KeyCode.F10) {\n\t\t\t\tshowContextMenu(e);\n\t\t\t}\n\t\t}));\n\n\t\t// Context menu on touch context menu gesture\n\t\tdisposables.push(addDisposableListener(tab, TouchEventType.Contextmenu, (e: GestureEvent) => {\n\t\t\tshowContextMenu(e);\n\t\t}));\n\n\t\t// Keyboard accessibility\n\t\tdisposables.push(addDisposableListener(tab, EventType.KEY_UP, (e: KeyboardEvent) => {\n\t\t\tconst event = new StandardKeyboardEvent(e);\n\t\t\tlet handled = false;\n\n\t\t\t// Run action on Enter/Space\n\t\t\tif (event.equals(KeyCode.Enter) || event.equals(KeyCode.Space)) {\n\t\t\t\thandled = true;\n\t\t\t\tconst input = this.group.getEditor(index);\n\t\t\t\tif (input) {\n\t\t\t\t\tthis.group.openEditor(input);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Navigate in editors\n\t\t\telse if ([KeyCode.LeftArrow, KeyCode.RightArrow, KeyCode.UpArrow, KeyCode.DownArrow, KeyCode.Home, KeyCode.End].some(kb => event.equals(kb))) {\n\t\t\t\tlet targetIndex: number;\n\t\t\t\tif (event.equals(KeyCode.LeftArrow) || event.equals(KeyCode.UpArrow)) {\n\t\t\t\t\ttargetIndex = index - 1;\n\t\t\t\t} else if (event.equals(KeyCode.RightArrow) || event.equals(KeyCode.DownArrow)) {\n\t\t\t\t\ttargetIndex = index + 1;\n\t\t\t\t} else if (event.equals(KeyCode.Home)) {\n\t\t\t\t\ttargetIndex = 0;\n\t\t\t\t} else {\n\t\t\t\t\ttargetIndex = this.group.count - 1;\n\t\t\t\t}\n\n\t\t\t\tconst target = this.group.getEditor(targetIndex);\n\t\t\t\tif (target) {\n\t\t\t\t\thandled = true;\n\t\t\t\t\tthis.group.openEditor(target, { preserveFocus: true });\n\t\t\t\t\t(<HTMLElement>this.tabsContainer.childNodes[targetIndex]).focus();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (handled) {\n\t\t\t\tEventHelper.stop(e, true);\n\t\t\t}\n\n\t\t\t// moving in the tabs container can have an impact on scrolling position, so we need to update the custom scrollbar\n\t\t\tthis.tabsScrollbar.setScrollPosition({\n\t\t\t\tscrollLeft: this.tabsContainer.scrollLeft\n\t\t\t});\n\t\t}));\n\n\t\t// Pin on double click\n\t\tdisposables.push(addDisposableListener(tab, EventType.DBLCLICK, (e: MouseEvent) => {\n\t\t\tEventHelper.stop(e);\n\n\t\t\tthis.group.pinEditor(this.group.getEditor(index) || undefined);\n\t\t}));\n\n\t\t// Context menu\n\t\tdisposables.push(addDisposableListener(tab, EventType.CONTEXT_MENU, (e: Event) => {\n\t\t\tEventHelper.stop(e, true);\n\n\t\t\tconst input = this.group.getEditor(index);\n\t\t\tif (input) {\n\t\t\t\tthis.onContextMenu(input, e, tab);\n\t\t\t}\n\t\t}, true /* use capture to fix https://github.com/Microsoft/vscode/issues/19145 */));\n\n\t\t// Drag support\n\t\tdisposables.push(addDisposableListener(tab, EventType.DRAG_START, (e: DragEvent) => {\n\t\t\tconst editor = this.group.getEditor(index);\n\t\t\tif (!editor) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.editorTransfer.setData([new DraggedEditorIdentifier({ editor, groupId: this.group.id })], DraggedEditorIdentifier.prototype);\n\n\t\t\te.dataTransfer!.effectAllowed = 'copyMove';\n\n\t\t\t// Apply some datatransfer types to allow for dragging the element outside of the application\n\t\t\tconst resource = toResource(editor, { supportSideBySide: true });\n\t\t\tif (resource) {\n\t\t\t\tthis.instantiationService.invokeFunction(fillResourceDataTransfers, [resource], e);\n\t\t\t}\n\n\t\t\t// Fixes https://github.com/Microsoft/vscode/issues/18733\n\t\t\taddClass(tab, 'dragged');\n\t\t\tscheduleAtNextAnimationFrame(() => removeClass(tab, 'dragged'));\n\t\t}));\n\n\t\t// Drop support\n\t\tdisposables.push(new DragAndDropObserver(tab, {\n\t\t\tonDragEnter: e => {\n\n\t\t\t\t// Update class to signal drag operation\n\t\t\t\taddClass(tab, 'dragged-over');\n\n\t\t\t\t// Return if transfer is unsupported\n\t\t\t\tif (!this.isSupportedDropTransfer(e)) {\n\t\t\t\t\te.dataTransfer!.dropEffect = 'none';\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Return if dragged editor is the current tab dragged over\n\t\t\t\tlet isLocalDragAndDrop = false;\n\t\t\t\tif (this.editorTransfer.hasData(DraggedEditorIdentifier.prototype)) {\n\t\t\t\t\tisLocalDragAndDrop = true;\n\n\t\t\t\t\tconst localDraggedEditor = this.editorTransfer.getData(DraggedEditorIdentifier.prototype)![0].identifier;\n\t\t\t\t\tif (localDraggedEditor.editor === this.group.getEditor(index) && localDraggedEditor.groupId === this.group.id) {\n\t\t\t\t\t\te.dataTransfer!.dropEffect = 'none';\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Update the dropEffect to \"copy\" if there is no local data to be dragged because\n\t\t\t\t// in that case we can only copy the data into and not move it from its source\n\t\t\t\tif (!isLocalDragAndDrop) {\n\t\t\t\t\te.dataTransfer!.dropEffect = 'copy';\n\t\t\t\t}\n\n\t\t\t\tthis.updateDropFeedback(tab, true, index);\n\t\t\t},\n\n\t\t\tonDragLeave: e => {\n\t\t\t\tremoveClass(tab, 'dragged-over');\n\t\t\t\tthis.updateDropFeedback(tab, false, index);\n\t\t\t},\n\n\t\t\tonDragEnd: e => {\n\t\t\t\tremoveClass(tab, 'dragged-over');\n\t\t\t\tthis.updateDropFeedback(tab, false, index);\n\n\t\t\t\tthis.editorTransfer.clearData(DraggedEditorIdentifier.prototype);\n\t\t\t},\n\n\t\t\tonDrop: e => {\n\t\t\t\tremoveClass(tab, 'dragged-over');\n\t\t\t\tthis.updateDropFeedback(tab, false, index);\n\n\t\t\t\tthis.onDrop(e, index);\n\t\t\t}\n\t\t}));\n\n\t\treturn combinedDisposable(disposables);\n\t}\n\n\tprivate isSupportedDropTransfer(e: DragEvent): boolean {\n\t\tif (this.groupTransfer.hasData(DraggedEditorGroupIdentifier.prototype)) {\n\t\t\tconst group = this.groupTransfer.getData(DraggedEditorGroupIdentifier.prototype)![0];\n\t\t\tif (group.identifier === this.group.id) {\n\t\t\t\treturn false; // groups cannot be dropped on title area it originates from\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.editorTransfer.hasData(DraggedEditorIdentifier.prototype)) {\n\t\t\treturn true; // (local) editors can always be dropped\n\t\t}\n\n\t\tif (e.dataTransfer && e.dataTransfer.types.length > 0) {\n\t\t\treturn true; // optimistically allow external data (// see https://github.com/Microsoft/vscode/issues/25789)\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate updateDropFeedback(element: HTMLElement, isDND: boolean, index?: number): void {\n\t\tconst isTab = (typeof index === 'number');\n\t\tconst editor = typeof index === 'number' ? this.group.getEditor(index) : null;\n\t\tconst isActiveTab = isTab && !!editor && this.group.isActive(editor);\n\n\t\t// Background\n\t\tconst noDNDBackgroundColor = isTab ? this.getColor(isActiveTab ? TAB_ACTIVE_BACKGROUND : TAB_INACTIVE_BACKGROUND) : null;\n\t\telement.style.backgroundColor = isDND ? this.getColor(EDITOR_DRAG_AND_DROP_BACKGROUND) : noDNDBackgroundColor;\n\n\t\t// Outline\n\t\tconst activeContrastBorderColor = this.getColor(activeContrastBorder);\n\t\tif (activeContrastBorderColor && isDND) {\n\t\t\telement.style.outlineWidth = '2px';\n\t\t\telement.style.outlineStyle = 'dashed';\n\t\t\telement.style.outlineColor = activeContrastBorderColor;\n\t\t\telement.style.outlineOffset = isTab ? '-5px' : '-3px';\n\t\t} else {\n\t\t\telement.style.outlineWidth = null;\n\t\t\telement.style.outlineStyle = null;\n\t\t\telement.style.outlineColor = activeContrastBorderColor;\n\t\t\telement.style.outlineOffset = null;\n\t\t}\n\t}\n\n\tprivate computeTabLabels(): void {\n\t\tconst { labelFormat } = this.accessor.partOptions;\n\t\tconst { verbosity, shortenDuplicates } = this.getLabelConfigFlags(labelFormat);\n\n\t\t// Build labels and descriptions for each editor\n\t\tconst labels = this.group.editors.map(editor => ({\n\t\t\teditor,\n\t\t\tname: editor.getName()!,\n\t\t\tdescription: withNullAsUndefined(editor.getDescription(verbosity)),\n\t\t\ttitle: withNullAsUndefined(editor.getTitle(Verbosity.LONG))\n\t\t}));\n\n\t\t// Shorten labels as needed\n\t\tif (shortenDuplicates) {\n\t\t\tthis.shortenTabLabels(labels);\n\t\t}\n\n\t\tthis.tabLabels = labels;\n\t}\n\n\tprivate shortenTabLabels(labels: AugmentedLabel[]): void {\n\n\t\t// Gather duplicate titles, while filtering out invalid descriptions\n\t\tconst mapTitleToDuplicates = new Map<string, AugmentedLabel[]>();\n\t\tfor (const label of labels) {\n\t\t\tif (typeof label.description === 'string') {\n\t\t\t\tgetOrSet(mapTitleToDuplicates, label.name, []).push(label);\n\t\t\t} else {\n\t\t\t\tlabel.description = '';\n\t\t\t}\n\t\t}\n\n\t\t// Identify duplicate titles and shorten descriptions\n\t\tmapTitleToDuplicates.forEach(duplicateTitles => {\n\n\t\t\t// Remove description if the title isn't duplicated\n\t\t\tif (duplicateTitles.length === 1) {\n\t\t\t\tduplicateTitles[0].description = '';\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Identify duplicate descriptions\n\t\t\tconst mapDescriptionToDuplicates = new Map<string, AugmentedLabel[]>();\n\t\t\tfor (const label of duplicateTitles) {\n\t\t\t\tgetOrSet(mapDescriptionToDuplicates, label.description, []).push(label);\n\t\t\t}\n\n\t\t\t// For editors with duplicate descriptions, check whether any long descriptions differ\n\t\t\tlet useLongDescriptions = false;\n\t\t\tmapDescriptionToDuplicates.forEach((duplicateDescriptions, name) => {\n\t\t\t\tif (!useLongDescriptions && duplicateDescriptions.length > 1) {\n\t\t\t\t\tconst [first, ...rest] = duplicateDescriptions.map(({ editor }) => editor.getDescription(Verbosity.LONG));\n\t\t\t\t\tuseLongDescriptions = rest.some(description => description !== first);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// If so, replace all descriptions with long descriptions\n\t\t\tif (useLongDescriptions) {\n\t\t\t\tmapDescriptionToDuplicates.clear();\n\t\t\t\tduplicateTitles.forEach(label => {\n\t\t\t\t\tlabel.description = withNullAsUndefined(label.editor.getDescription(Verbosity.LONG));\n\t\t\t\t\tgetOrSet(mapDescriptionToDuplicates, label.description, []).push(label);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Obtain final set of descriptions\n\t\t\tconst descriptions: string[] = [];\n\t\t\tmapDescriptionToDuplicates.forEach((_, description) => descriptions.push(description));\n\n\t\t\t// Remove description if all descriptions are identical\n\t\t\tif (descriptions.length === 1) {\n\t\t\t\tfor (const label of mapDescriptionToDuplicates.get(descriptions[0]) || []) {\n\t\t\t\t\tlabel.description = '';\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Shorten descriptions\n\t\t\tconst shortenedDescriptions = shorten(descriptions);\n\t\t\tdescriptions.forEach((description, i) => {\n\t\t\t\tfor (const label of mapDescriptionToDuplicates.get(description) || []) {\n\t\t\t\t\tlabel.description = shortenedDescriptions[i];\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate getLabelConfigFlags(value: string | undefined) {\n\t\tswitch (value) {\n\t\t\tcase 'short':\n\t\t\t\treturn { verbosity: Verbosity.SHORT, shortenDuplicates: false };\n\t\t\tcase 'medium':\n\t\t\t\treturn { verbosity: Verbosity.MEDIUM, shortenDuplicates: false };\n\t\t\tcase 'long':\n\t\t\t\treturn { verbosity: Verbosity.LONG, shortenDuplicates: false };\n\t\t\tdefault:\n\t\t\t\treturn { verbosity: Verbosity.MEDIUM, shortenDuplicates: true };\n\t\t}\n\t}\n\n\tprivate redraw(): void {\n\n\t\t// For each tab\n\t\tthis.forEachTab((editor, index, tabContainer, tabLabelWidget, tabLabel) => {\n\t\t\tthis.redrawTab(editor, index, tabContainer, tabLabelWidget, tabLabel);\n\t\t});\n\n\t\t// Update Editor Actions Toolbar\n\t\tthis.updateEditorActionsToolbar();\n\n\t\t// Ensure the active tab is always revealed\n\t\tthis.layout(this.dimension);\n\t}\n\n\tprivate forEachTab(fn: (editor: IEditorInput, index: number, tabContainer: HTMLElement, tabLabelWidget: IResourceLabel, tabLabel: IEditorInputLabel) => void): void {\n\t\tthis.group.editors.forEach((editor, index) => {\n\t\t\tconst tabContainer = this.tabsContainer.children[index] as HTMLElement;\n\t\t\tif (tabContainer) {\n\t\t\t\tfn(editor, index, tabContainer, this.tabResourceLabels.get(index), this.tabLabels[index]);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate redrawTab(editor: IEditorInput, index: number, tabContainer: HTMLElement, tabLabelWidget: IResourceLabel, tabLabel: IEditorInputLabel): void {\n\n\t\t// Label\n\t\tthis.redrawLabel(editor, tabContainer, tabLabelWidget, tabLabel);\n\n\t\t// Borders / Outline\n\t\tconst borderRightColor = (this.getColor(TAB_BORDER) || this.getColor(contrastBorder));\n\t\ttabContainer.style.borderRight = borderRightColor ? `1px solid ${borderRightColor}` : null;\n\t\ttabContainer.style.outlineColor = this.getColor(activeContrastBorder);\n\n\t\t// Settings\n\t\tconst options = this.accessor.partOptions;\n\n\t\t['off', 'left', 'right'].forEach(option => {\n\t\t\tconst domAction = options.tabCloseButton === option ? addClass : removeClass;\n\t\t\tdomAction(tabContainer, `close-button-${option}`);\n\t\t});\n\n\t\t['fit', 'shrink'].forEach(option => {\n\t\t\tconst domAction = options.tabSizing === option ? addClass : removeClass;\n\t\t\tdomAction(tabContainer, `sizing-${option}`);\n\t\t});\n\n\t\tif (options.showIcons && !!options.iconTheme) {\n\t\t\taddClass(tabContainer, 'has-icon-theme');\n\t\t} else {\n\t\t\tremoveClass(tabContainer, 'has-icon-theme');\n\t\t}\n\n\t\t// Active / dirty state\n\t\tthis.redrawEditorActiveAndDirty(this.accessor.activeGroup === this.group, editor, tabContainer, tabLabelWidget);\n\t}\n\n\tprivate redrawLabel(editor: IEditorInput, tabContainer: HTMLElement, tabLabelWidget: IResourceLabel, tabLabel: IEditorInputLabel): void {\n\t\tconst name = tabLabel.name;\n\t\tconst description = tabLabel.description || '';\n\t\tconst title = tabLabel.title || '';\n\n\t\t// Container\n\t\ttabContainer.setAttribute('aria-label', `${name}, tab`);\n\t\ttabContainer.title = title;\n\n\t\t// Label\n\t\ttabLabelWidget.setResource({ name, description, resource: toResource(editor, { supportSideBySide: true }) || undefined }, { title, extraClasses: ['tab-label'], italic: !this.group.isPinned(editor) });\n\t}\n\n\tprivate redrawEditorActiveAndDirty(isGroupActive: boolean, editor: IEditorInput, tabContainer: HTMLElement, tabLabelWidget: IResourceLabel): void {\n\t\tconst isTabActive = this.group.isActive(editor);\n\n\t\tconst hasModifiedBorderTop = this.doRedrawEditorDirty(isGroupActive, isTabActive, editor, tabContainer);\n\n\t\tthis.doRedrawEditorActive(isGroupActive, !hasModifiedBorderTop, editor, tabContainer, tabLabelWidget);\n\t}\n\n\tprivate doRedrawEditorActive(isGroupActive: boolean, allowBorderTop: boolean, editor: IEditorInput, tabContainer: HTMLElement, tabLabelWidget: IResourceLabel): void {\n\n\t\t// Tab is active\n\t\tif (this.group.isActive(editor)) {\n\n\t\t\t// Container\n\t\t\taddClass(tabContainer, 'active');\n\t\t\ttabContainer.setAttribute('aria-selected', 'true');\n\t\t\ttabContainer.style.backgroundColor = this.getColor(TAB_ACTIVE_BACKGROUND);\n\n\t\t\tconst activeTabBorderColorBottom = this.getColor(isGroupActive ? TAB_ACTIVE_BORDER : TAB_UNFOCUSED_ACTIVE_BORDER);\n\t\t\tif (activeTabBorderColorBottom) {\n\t\t\t\taddClass(tabContainer, 'tab-border-bottom');\n\t\t\t\ttabContainer.style.setProperty('--tab-border-bottom-color', activeTabBorderColorBottom.toString());\n\t\t\t} else {\n\t\t\t\tremoveClass(tabContainer, 'tab-border-bottom');\n\t\t\t\ttabContainer.style.removeProperty('--tab-border-bottom-color');\n\t\t\t}\n\n\t\t\tconst activeTabBorderColorTop = allowBorderTop ? this.getColor(isGroupActive ? TAB_ACTIVE_BORDER_TOP : TAB_UNFOCUSED_ACTIVE_BORDER_TOP) : undefined;\n\t\t\tif (activeTabBorderColorTop) {\n\t\t\t\taddClass(tabContainer, 'tab-border-top');\n\t\t\t\ttabContainer.style.setProperty('--tab-border-top-color', activeTabBorderColorTop.toString());\n\t\t\t} else {\n\t\t\t\tremoveClass(tabContainer, 'tab-border-top');\n\t\t\t\ttabContainer.style.removeProperty('--tab-border-top-color');\n\t\t\t}\n\n\t\t\t// Label\n\t\t\ttabLabelWidget.element.style.color = this.getColor(isGroupActive ? TAB_ACTIVE_FOREGROUND : TAB_UNFOCUSED_ACTIVE_FOREGROUND);\n\t\t}\n\n\t\t// Tab is inactive\n\t\telse {\n\n\t\t\t// Container\n\t\t\tremoveClass(tabContainer, 'active');\n\t\t\ttabContainer.setAttribute('aria-selected', 'false');\n\t\t\ttabContainer.style.backgroundColor = this.getColor(TAB_INACTIVE_BACKGROUND);\n\t\t\ttabContainer.style.boxShadow = null;\n\n\t\t\t// Label\n\t\t\ttabLabelWidget.element.style.color = this.getColor(isGroupActive ? TAB_INACTIVE_FOREGROUND : TAB_UNFOCUSED_INACTIVE_FOREGROUND);\n\t\t}\n\t}\n\n\tprivate doRedrawEditorDirty(isGroupActive: boolean, isTabActive: boolean, editor: IEditorInput, tabContainer: HTMLElement): boolean {\n\t\tlet hasModifiedBorderColor = false;\n\n\t\t// Tab: dirty\n\t\tif (editor.isDirty()) {\n\t\t\taddClass(tabContainer, 'dirty');\n\n\t\t\t// Highlight modified tabs with a border if configured\n\t\t\tif (this.accessor.partOptions.highlightModifiedTabs) {\n\t\t\t\tlet modifiedBorderColor: string | null;\n\t\t\t\tif (isGroupActive && isTabActive) {\n\t\t\t\t\tmodifiedBorderColor = this.getColor(TAB_ACTIVE_MODIFIED_BORDER);\n\t\t\t\t} else if (isGroupActive && !isTabActive) {\n\t\t\t\t\tmodifiedBorderColor = this.getColor(TAB_INACTIVE_MODIFIED_BORDER);\n\t\t\t\t} else if (!isGroupActive && isTabActive) {\n\t\t\t\t\tmodifiedBorderColor = this.getColor(TAB_UNFOCUSED_ACTIVE_MODIFIED_BORDER);\n\t\t\t\t} else {\n\t\t\t\t\tmodifiedBorderColor = this.getColor(TAB_UNFOCUSED_INACTIVE_MODIFIED_BORDER);\n\t\t\t\t}\n\n\t\t\t\tif (modifiedBorderColor) {\n\t\t\t\t\thasModifiedBorderColor = true;\n\n\t\t\t\t\taddClass(tabContainer, 'dirty-border-top');\n\t\t\t\t\ttabContainer.style.setProperty('--tab-dirty-border-top-color', modifiedBorderColor);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tremoveClass(tabContainer, 'dirty-border-top');\n\t\t\t\ttabContainer.style.removeProperty('--tab-dirty-border-top-color');\n\t\t\t}\n\t\t}\n\n\t\t// Tab: not dirty\n\t\telse {\n\t\t\tremoveClass(tabContainer, 'dirty');\n\n\t\t\tremoveClass(tabContainer, 'dirty-border-top');\n\t\t\ttabContainer.style.removeProperty('--tab-dirty-border-top-color');\n\t\t}\n\n\t\treturn hasModifiedBorderColor;\n\t}\n\n\tlayout(dimension: Dimension): void {\n\t\tthis.dimension = dimension;\n\n\t\tconst activeTab = this.group.activeEditor ? this.getTab(this.group.activeEditor) : undefined;\n\t\tif (!activeTab || !this.dimension) {\n\t\t\treturn;\n\t\t}\n\n\t\t// The layout of tabs can be an expensive operation because we access DOM properties\n\t\t// that can result in the browser doing a full page layout to validate them. To buffer\n\t\t// this a little bit we try at least to schedule this work on the next animation frame.\n\t\tif (!this.layoutScheduled) {\n\t\t\tthis.layoutScheduled = scheduleAtNextAnimationFrame(() => {\n\t\t\t\tthis.doLayout(this.dimension);\n\t\t\t\tthis.layoutScheduled = undefined;\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate doLayout(dimension: Dimension): void {\n\t\tconst activeTab = this.group.activeEditor ? this.getTab(this.group.activeEditor) : undefined;\n\t\tif (!activeTab) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.breadcrumbsControl && !this.breadcrumbsControl.isHidden()) {\n\t\t\tthis.breadcrumbsControl.layout({ width: dimension.width, height: BreadcrumbsControl.HEIGHT });\n\t\t\tthis.tabsScrollbar.getDomNode().style.height = `${dimension.height - BreadcrumbsControl.HEIGHT}px`;\n\t\t}\n\n\t\tconst visibleContainerWidth = this.tabsContainer.offsetWidth;\n\t\tconst totalContainerWidth = this.tabsContainer.scrollWidth;\n\n\t\tlet activeTabPosX: number;\n\t\tlet activeTabWidth: number;\n\n\t\tif (!this.blockRevealActiveTab) {\n\t\t\tactiveTabPosX = activeTab.offsetLeft;\n\t\t\tactiveTabWidth = activeTab.offsetWidth;\n\t\t}\n\n\t\t// Update scrollbar\n\t\tthis.tabsScrollbar.setScrollDimensions({\n\t\t\twidth: visibleContainerWidth,\n\t\t\tscrollWidth: totalContainerWidth\n\t\t});\n\n\t\t// Return now if we are blocked to reveal the active tab and clear flag\n\t\tif (this.blockRevealActiveTab) {\n\t\t\tthis.blockRevealActiveTab = false;\n\t\t\treturn;\n\t\t}\n\n\t\t// Reveal the active one\n\t\tconst containerScrollPosX = this.tabsScrollbar.getScrollPosition().scrollLeft;\n\t\tconst activeTabFits = activeTabWidth! <= visibleContainerWidth;\n\n\t\t// Tab is overflowing to the right: Scroll minimally until the element is fully visible to the right\n\t\t// Note: only try to do this if we actually have enough width to give to show the tab fully!\n\t\tif (activeTabFits && containerScrollPosX + visibleContainerWidth < activeTabPosX! + activeTabWidth!) {\n\t\t\tthis.tabsScrollbar.setScrollPosition({\n\t\t\t\tscrollLeft: containerScrollPosX + ((activeTabPosX! + activeTabWidth!) /* right corner of tab */ - (containerScrollPosX + visibleContainerWidth) /* right corner of view port */)\n\t\t\t});\n\t\t}\n\n\t\t// Tab is overlflowng to the left or does not fit: Scroll it into view to the left\n\t\telse if (containerScrollPosX > activeTabPosX! || !activeTabFits) {\n\t\t\tthis.tabsScrollbar.setScrollPosition({\n\t\t\t\tscrollLeft: activeTabPosX!\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate getTab(editor: IEditorInput): HTMLElement | undefined {\n\t\tconst editorIndex = this.group.getIndexOfEditor(editor);\n\t\tif (editorIndex >= 0) {\n\t\t\treturn this.tabsContainer.children[editorIndex] as HTMLElement;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate blockRevealActiveTabOnce(): void {\n\n\t\t// When closing tabs through the tab close button or gesture, the user\n\t\t// might want to rapidly close tabs in sequence and as such revealing\n\t\t// the active tab after each close would be annoying. As such we block\n\t\t// the automated revealing of the active tab once after the close is\n\t\t// triggered.\n\t\tthis.blockRevealActiveTab = true;\n\t}\n\n\tprivate originatesFromTabActionBar(e: MouseEvent | GestureEvent): boolean {\n\t\tlet element: HTMLElement;\n\t\tif (e instanceof MouseEvent) {\n\t\t\telement = (e.target || e.srcElement) as HTMLElement;\n\t\t} else {\n\t\t\telement = (e as GestureEvent).initialTarget as HTMLElement;\n\t\t}\n\n\t\treturn !!findParentWithClass(element, 'action-item', 'tab');\n\t}\n\n\tprivate onDrop(e: DragEvent, targetIndex: number): void {\n\t\tEventHelper.stop(e, true);\n\n\t\tthis.updateDropFeedback(this.tabsContainer, false);\n\t\tremoveClass(this.tabsContainer, 'scroll');\n\n\t\t// Local Editor DND\n\t\tif (this.editorTransfer.hasData(DraggedEditorIdentifier.prototype)) {\n\t\t\tconst draggedEditor = this.editorTransfer.getData(DraggedEditorIdentifier.prototype)![0].identifier;\n\t\t\tconst sourceGroup = this.accessor.getGroup(draggedEditor.groupId);\n\n\t\t\tif (sourceGroup) {\n\n\t\t\t\t// Move editor to target position and index\n\t\t\t\tif (this.isMoveOperation(e, draggedEditor.groupId)) {\n\t\t\t\t\tsourceGroup.moveEditor(draggedEditor.editor, this.group, { index: targetIndex });\n\t\t\t\t}\n\n\t\t\t\t// Copy editor to target position and index\n\t\t\t\telse {\n\t\t\t\t\tsourceGroup.copyEditor(draggedEditor.editor, this.group, { index: targetIndex });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.group.focus();\n\t\t\tthis.editorTransfer.clearData(DraggedEditorIdentifier.prototype);\n\t\t}\n\n\t\t// Local Editor Group DND\n\t\telse if (this.groupTransfer.hasData(DraggedEditorGroupIdentifier.prototype)) {\n\t\t\tconst sourceGroup = this.accessor.getGroup(this.groupTransfer.getData(DraggedEditorGroupIdentifier.prototype)![0].identifier);\n\n\t\t\tif (sourceGroup) {\n\t\t\t\tconst mergeGroupOptions: IMergeGroupOptions = { index: targetIndex };\n\t\t\t\tif (!this.isMoveOperation(e, sourceGroup.id)) {\n\t\t\t\t\tmergeGroupOptions.mode = MergeGroupMode.COPY_EDITORS;\n\t\t\t\t}\n\n\t\t\t\tthis.accessor.mergeGroup(sourceGroup, this.group, mergeGroupOptions);\n\t\t\t}\n\n\t\t\tthis.group.focus();\n\t\t\tthis.groupTransfer.clearData(DraggedEditorGroupIdentifier.prototype);\n\t\t}\n\n\t\t// External DND\n\t\telse {\n\t\t\tconst dropHandler = this.instantiationService.createInstance(ResourcesDropHandler, { allowWorkspaceOpen: false /* open workspace file as file if dropped */ });\n\t\t\tdropHandler.handleDrop(e, () => this.group, () => this.group.focus(), targetIndex);\n\t\t}\n\t}\n\n\tprivate isMoveOperation(e: DragEvent, source: GroupIdentifier) {\n\t\tconst isCopy = (e.ctrlKey && !isMacintosh) || (e.altKey && isMacintosh);\n\n\t\treturn !isCopy || source === this.group.id;\n\t}\n\n\tdispose(): void {\n\t\tsuper.dispose();\n\n\t\tdispose(this.layoutScheduled);\n\t\tthis.layoutScheduled = undefined;\n\t}\n}\n\nregisterThemingParticipant((theme: ITheme, collector: ICssStyleCollector) => {\n\n\t// Styling with Outline color (e.g. high contrast theme)\n\tconst activeContrastBorderColor = theme.getColor(activeContrastBorder);\n\tif (activeContrastBorderColor) {\n\t\tcollector.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active:hover  {\n\t\t\t\toutline: 1px solid;\n\t\t\t\toutline-offset: -5px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {\n\t\t\t\toutline: 1px dashed;\n\t\t\t\toutline-offset: -5px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active > .tab-close .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active:hover > .tab-close .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.dirty > .tab-close .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-close .action-label {\n\t\t\t\topacity: 1 !important;\n\t\t\t}\n\t\t`);\n\t}\n\n\t// High Contrast Border Color for Editor Actions\n\tconst contrastBorderColor = theme.getColor(contrastBorder);\n\tif (contrastBorder) {\n\t\tcollector.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .editor-actions {\n\t\t\t\toutline: 1px solid ${contrastBorderColor}\n\t\t\t}\n\t\t`);\n\t}\n\n\t// Hover Background\n\tconst tabHoverBackground = theme.getColor(TAB_HOVER_BACKGROUND);\n\tif (tabHoverBackground) {\n\t\tcollector.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover  {\n\t\t\t\tbackground-color: ${tabHoverBackground} !important;\n\t\t\t}\n\t\t`);\n\t}\n\n\tconst tabUnfocusedHoverBackground = theme.getColor(TAB_UNFOCUSED_HOVER_BACKGROUND);\n\tif (tabUnfocusedHoverBackground) {\n\t\tcollector.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {\n\t\t\t\tbackground-color: ${tabUnfocusedHoverBackground} !important;\n\t\t\t}\n\t\t`);\n\t}\n\n\t// Hover Border\n\tconst tabHoverBorder = theme.getColor(TAB_HOVER_BORDER);\n\tif (tabHoverBorder) {\n\t\tcollector.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover  {\n\t\t\t\tbox-shadow: ${tabHoverBorder} 0 -1px inset !important;\n\t\t\t}\n\t\t`);\n\t}\n\n\tconst tabUnfocusedHoverBorder = theme.getColor(TAB_UNFOCUSED_HOVER_BORDER);\n\tif (tabUnfocusedHoverBorder) {\n\t\tcollector.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {\n\t\t\t\tbox-shadow: ${tabUnfocusedHoverBorder} 0 -1px inset !important;\n\t\t\t}\n\t\t`);\n\t}\n\n\t// Fade out styles via linear gradient (when tabs are set to shrink)\n\tif (theme.type !== 'hc') {\n\t\tconst workbenchBackground = WORKBENCH_BACKGROUND(theme);\n\t\tconst editorBackgroundColor = theme.getColor(editorBackground);\n\t\tconst editorGroupHeaderTabsBackground = theme.getColor(EDITOR_GROUP_HEADER_TABS_BACKGROUND);\n\t\tconst editorDragAndDropBackground = theme.getColor(EDITOR_DRAG_AND_DROP_BACKGROUND);\n\n\t\tlet adjustedTabBackground: Color | undefined;\n\t\tif (editorGroupHeaderTabsBackground && editorBackgroundColor) {\n\t\t\tadjustedTabBackground = editorGroupHeaderTabsBackground.flatten(editorBackgroundColor, editorBackgroundColor, workbenchBackground);\n\t\t}\n\n\t\tlet adjustedTabDragBackground: Color | undefined;\n\t\tif (editorGroupHeaderTabsBackground && editorBackgroundColor && editorDragAndDropBackground && editorBackgroundColor) {\n\t\t\tadjustedTabDragBackground = editorGroupHeaderTabsBackground.flatten(editorBackgroundColor, editorDragAndDropBackground, editorBackgroundColor, workbenchBackground);\n\t\t}\n\n\t\t// Adjust gradient for (focused) hover background\n\t\tif (tabHoverBackground && adjustedTabBackground && adjustedTabDragBackground) {\n\t\t\tconst adjustedColor = tabHoverBackground.flatten(adjustedTabBackground);\n\t\t\tconst adjustedColorDrag = tabHoverBackground.flatten(adjustedTabDragBackground);\n\t\t\tcollector.addRule(`\n\t\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink:not(.dragged):hover > .tab-label::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ${adjustedColor}, transparent) !important;\n\t\t\t\t}\n\n\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink:not(.dragged):hover > .tab-label::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ${adjustedColorDrag}, transparent) !important;\n\t\t\t\t}\n\t\t\t`);\n\t\t}\n\n\t\t// Adjust gradient for unfocused hover background\n\t\tif (tabUnfocusedHoverBackground && adjustedTabBackground && adjustedTabDragBackground) {\n\t\t\tconst adjustedColor = tabUnfocusedHoverBackground.flatten(adjustedTabBackground);\n\t\t\tconst adjustedColorDrag = tabUnfocusedHoverBackground.flatten(adjustedTabDragBackground);\n\t\t\tcollector.addRule(`\n\t\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container > .title .tabs-container > .tab.sizing-shrink:not(.dragged):hover > .tab-label::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ${adjustedColor}, transparent) !important;\n\t\t\t\t}\n\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container > .title .tabs-container > .tab.sizing-shrink:not(.dragged):hover > .tab-label::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ${adjustedColorDrag}, transparent) !important;\n\t\t\t\t}\n\t\t\t`);\n\t\t}\n\n\t\t// Adjust gradient for drag and drop background\n\t\tif (editorDragAndDropBackground && adjustedTabDragBackground) {\n\t\t\tconst adjustedColorDrag = editorDragAndDropBackground.flatten(adjustedTabDragBackground);\n\t\t\tcollector.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.active):not(.dragged) > .tab-label::after,\n\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.dragged) > .tab-label::after {\n\t\t\t\tbackground: linear-gradient(to left, ${adjustedColorDrag}, transparent) !important;\n\t\t\t}\n\t\t`);\n\t\t}\n\n\t\t// Adjust gradient for active tab background\n\t\tconst tabActiveBackground = theme.getColor(TAB_ACTIVE_BACKGROUND);\n\t\tif (tabActiveBackground && adjustedTabBackground && adjustedTabDragBackground) {\n\t\t\tconst adjustedColor = tabActiveBackground.flatten(adjustedTabBackground);\n\t\t\tconst adjustedColorDrag = tabActiveBackground.flatten(adjustedTabDragBackground);\n\t\t\tcollector.addRule(`\n\t\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container > .title .tabs-container > .tab.sizing-shrink.active:not(.dragged) > .tab-label::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ${adjustedColor}, transparent);\n\t\t\t\t}\n\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container > .title .tabs-container > .tab.sizing-shrink.active:not(.dragged) > .tab-label::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ${adjustedColorDrag}, transparent);\n\t\t\t\t}\n\t\t\t`);\n\t\t}\n\n\t\t// Adjust gradient for inactive tab background\n\t\tconst tabInactiveBackground = theme.getColor(TAB_INACTIVE_BACKGROUND);\n\t\tif (tabInactiveBackground && adjustedTabBackground && adjustedTabDragBackground) {\n\t\t\tconst adjustedColor = tabInactiveBackground.flatten(adjustedTabBackground);\n\t\t\tconst adjustedColorDrag = tabInactiveBackground.flatten(adjustedTabDragBackground);\n\t\t\tcollector.addRule(`\n\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container > .title .tabs-container > .tab.sizing-shrink:not(.dragged) > .tab-label::after {\n\t\t\t\tbackground: linear-gradient(to left, ${adjustedColor}, transparent);\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container > .title .tabs-container > .tab.sizing-shrink:not(.dragged) > .tab-label::after {\n\t\t\t\tbackground: linear-gradient(to left, ${adjustedColorDrag}, transparent);\n\t\t\t}\n\t\t`);\n\t\t}\n\t}\n});\n"]}]}