{"remainingRequest":"/home/coding/workspace/node_modules/ts-loader/index.js?{\"happyPackMode\":true,\"compilerOptions\":{\"target\":\"es5\",\"lib\":[\"dom\",\"esnext\"]}}!/home/coding/workspace/lib/vscode/src/vs/workbench/contrib/stats/node/workspaceStats.ts","dependencies":[{"path":"/home/coding/workspace/lib/vscode/src/vs/workbench/contrib/stats/node/workspaceStats.ts","mtime":1555102317000},{"path":"/home/coding/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1555844183884},{"path":"/home/coding/workspace/node_modules/ts-loader/index.js","mtime":1555844217316}],"contextDependencies":[],"result":["\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar nls_1 = require(\"vs/nls\");\nvar crypto = require(\"crypto\");\nvar errors_1 = require(\"vs/base/common/errors\");\nvar uri_1 = require(\"vs/base/common/uri\");\nvar files_1 = require(\"vs/platform/files/common/files\");\nvar telemetry_1 = require(\"vs/platform/telemetry/common/telemetry\");\nvar workspace_1 = require(\"vs/platform/workspace/common/workspace\");\nvar environment_1 = require(\"vs/platform/environment/common/environment\");\nvar windows_1 = require(\"vs/platform/windows/common/windows\");\nvar strings_1 = require(\"vs/base/common/strings\");\nvar network_1 = require(\"vs/base/common/network\");\nvar notification_1 = require(\"vs/platform/notification/common/notification\");\nvar workspaces_1 = require(\"vs/platform/workspaces/common/workspaces\");\nvar quickInput_1 = require(\"vs/platform/quickinput/common/quickInput\");\nvar storage_1 = require(\"vs/platform/storage/common/storage\");\nvar resources_1 = require(\"vs/base/common/resources\");\nvar SshProtocolMatcher = /^([^@:]+@)?([^:]+):/;\nvar SshUrlMatcher = /^([^@:]+@)?([^:]+):(.+)$/;\nvar AuthorityMatcher = /^([^@]+@)?([^:]+)(:\\d+)?$/;\nvar SecondLevelDomainMatcher = /([^@:.]+\\.[^@:.]+)(:\\d+)?$/;\nvar RemoteMatcher = /^\\s*url\\s*=\\s*(.+\\S)\\s*$/mg;\nvar AnyButDot = /[^.]/g;\nvar SecondLevelDomainWhitelist = [\n    'github.com',\n    'bitbucket.org',\n    'visualstudio.com',\n    'gitlab.com',\n    'heroku.com',\n    'azurewebsites.net',\n    'ibm.com',\n    'amazon.com',\n    'amazonaws.com',\n    'cloudapp.net',\n    'rhcloud.com',\n    'google.com'\n];\nvar ModulesToLookFor = [\n    // Packages that suggest a node server\n    'express',\n    'sails',\n    'koa',\n    'hapi',\n    'socket.io',\n    'restify',\n    // JS frameworks\n    'react',\n    'react-native',\n    '@angular/core',\n    '@ionic',\n    'vue',\n    'tns-core-modules',\n    // Other interesting packages\n    'aws-sdk',\n    'aws-amplify',\n    'azure',\n    'azure-storage',\n    'firebase',\n    '@google-cloud/common',\n    'heroku-cli'\n];\nvar PyModulesToLookFor = [\n    'azure',\n    'azure-storage-common',\n    'azure-storage-blob',\n    'azure-storage-file',\n    'azure-storage-queue',\n    'azure-shell',\n    'azure-cosmos',\n    'azure-devtools',\n    'azure-elasticluster',\n    'azure-eventgrid',\n    'azure-functions',\n    'azure-graphrbac',\n    'azure-keyvault',\n    'azure-loganalytics',\n    'azure-monitor',\n    'azure-servicebus',\n    'azure-servicefabric',\n    'azure-storage',\n    'azure-translator',\n    'azure-iothub-device-client',\n    'adal',\n    'pydocumentdb',\n    'botbuilder-core',\n    'botbuilder-schema',\n    'botframework-connector'\n];\nfunction stripLowLevelDomains(domain) {\n    var match = domain.match(SecondLevelDomainMatcher);\n    return match ? match[1] : null;\n}\nfunction extractDomain(url) {\n    if (url.indexOf('://') === -1) {\n        var match = url.match(SshProtocolMatcher);\n        if (match) {\n            return stripLowLevelDomains(match[2]);\n        }\n        else {\n            return null;\n        }\n    }\n    try {\n        var uri = uri_1.URI.parse(url);\n        if (uri.authority) {\n            return stripLowLevelDomains(uri.authority);\n        }\n    }\n    catch (e) {\n        // ignore invalid URIs\n    }\n    return null;\n}\nfunction getDomainsOfRemotes(text, whitelist) {\n    var domains = new Set();\n    var match;\n    while (match = RemoteMatcher.exec(text)) {\n        var domain = extractDomain(match[1]);\n        if (domain) {\n            domains.add(domain);\n        }\n    }\n    var whitemap = whitelist.reduce(function (map, key) {\n        map[key] = true;\n        return map;\n    }, Object.create(null));\n    var elements = [];\n    domains.forEach(function (e) { return elements.push(e); });\n    return elements\n        .map(function (key) { return whitemap[key] ? key : key.replace(AnyButDot, 'a'); });\n}\nexports.getDomainsOfRemotes = getDomainsOfRemotes;\nfunction stripPort(authority) {\n    var match = authority.match(AuthorityMatcher);\n    return match ? match[2] : null;\n}\nfunction normalizeRemote(host, path, stripEndingDotGit) {\n    if (host && path) {\n        if (stripEndingDotGit && strings_1.endsWith(path, '.git')) {\n            path = path.substr(0, path.length - 4);\n        }\n        return (path.indexOf('/') === 0) ? \"\" + host + path : host + \"/\" + path;\n    }\n    return null;\n}\nfunction extractRemote(url, stripEndingDotGit) {\n    if (url.indexOf('://') === -1) {\n        var match = url.match(SshUrlMatcher);\n        if (match) {\n            return normalizeRemote(match[2], match[3], stripEndingDotGit);\n        }\n    }\n    try {\n        var uri = uri_1.URI.parse(url);\n        if (uri.authority) {\n            return normalizeRemote(stripPort(uri.authority), uri.path, stripEndingDotGit);\n        }\n    }\n    catch (e) {\n        // ignore invalid URIs\n    }\n    return null;\n}\nfunction getRemotes(text, stripEndingDotGit) {\n    if (stripEndingDotGit === void 0) { stripEndingDotGit = false; }\n    var remotes = [];\n    var match;\n    while (match = RemoteMatcher.exec(text)) {\n        var remote = extractRemote(match[1], stripEndingDotGit);\n        if (remote) {\n            remotes.push(remote);\n        }\n    }\n    return remotes;\n}\nexports.getRemotes = getRemotes;\nfunction getHashedRemotesFromConfig(text, stripEndingDotGit) {\n    if (stripEndingDotGit === void 0) { stripEndingDotGit = false; }\n    return getRemotes(text, stripEndingDotGit).map(function (r) {\n        return crypto.createHash('sha1').update(r).digest('hex');\n    });\n}\nexports.getHashedRemotesFromConfig = getHashedRemotesFromConfig;\nfunction getHashedRemotesFromUri(workspaceUri, fileService, stripEndingDotGit) {\n    if (stripEndingDotGit === void 0) { stripEndingDotGit = false; }\n    var path = workspaceUri.path;\n    var uri = workspaceUri.with({ path: (path !== '/' ? path : '') + \"/.git/config\" });\n    return fileService.existsFile(uri).then(function (exists) {\n        if (!exists) {\n            return [];\n        }\n        return fileService.resolveContent(uri, { acceptTextOnly: true }).then(function (content) { return getHashedRemotesFromConfig(content.value, stripEndingDotGit); }, function (err) { return []; } // ignore missing or binary file\n        );\n    });\n}\nexports.getHashedRemotesFromUri = getHashedRemotesFromUri;\nvar WorkspaceStats = /** @class */ (function () {\n    function WorkspaceStats(fileService, contextService, telemetryService, environmentService, windowService, notificationService, quickInputService, storageService) {\n        this.fileService = fileService;\n        this.contextService = contextService;\n        this.telemetryService = telemetryService;\n        this.environmentService = environmentService;\n        this.windowService = windowService;\n        this.notificationService = notificationService;\n        this.quickInputService = quickInputService;\n        this.storageService = storageService;\n        this.report();\n    }\n    WorkspaceStats.prototype.report = function () {\n        var _this = this;\n        // Workspace Stats\n        this.resolveWorkspaceTags(this.windowService.getConfiguration(), function (rootFiles) { return _this.handleWorkspaceFiles(rootFiles); })\n            .then(function (tags) { return _this.reportWorkspaceTags(tags); }, function (error) { return errors_1.onUnexpectedError(error); });\n        // Cloud Stats\n        this.reportCloudStats();\n        this.reportProxyStats();\n    };\n    WorkspaceStats.searchArray = function (arr, regEx) {\n        return arr.some(function (v) { return v.search(regEx) > -1; }) || undefined;\n    };\n    /* __GDPR__FRAGMENT__\n        \"WorkspaceTags\" : {\n            \"workbench.filesToOpen\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workbench.filesToCreate\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workbench.filesToDiff\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.id\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n            \"workspace.roots\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.empty\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.grunt\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.gulp\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.jake\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.tsconfig\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.jsconfig\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.config.xml\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.vsc.extension\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.asp<NUMBER>\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.sln\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.unity\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.express\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.sails\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.koa\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.hapi\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.socket.io\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.restify\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.react\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.@angular/core\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.vue\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.aws-sdk\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.aws-amplify-sdk\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.azure\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.azure-storage\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.@google-cloud/common\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.firebase\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.npm.heroku-cli\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.bower\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.yeoman.code.ext\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.cordova.high\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.cordova.low\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.xamarin.android\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.xamarin.ios\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.android.cpp\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.reactNative\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.ionic\" : { \"classification\" : \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": \"true\" },\n            \"workspace.nativeScript\" : { \"classification\" : \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": \"true\" },\n            \"workspace.py.requirements\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.requirements.star\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.Pipfile\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.conda\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.any-azure\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-storage-common\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-storage-blob\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-storage-file\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-storage-queue\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-mgmt\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-shell\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.pulumi-azure\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-cosmos\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-devtools\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-elasticluster\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-eventgrid\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-functions\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-graphrbac\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-keyvault\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-loganalytics\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-monitor\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-servicebus\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-servicefabric\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-storage\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-translator\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-iothub-device-client\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-ml\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.azure-cognitiveservices\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.adal\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.pydocumentdb\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.botbuilder-core\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.botbuilder-schema\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n            \"workspace.py.botframework-connector\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n\n        }\n    */\n    WorkspaceStats.prototype.resolveWorkspaceTags = function (configuration, participant) {\n        var _this = this;\n        var tags = Object.create(null);\n        var state = this.contextService.getWorkbenchState();\n        var workspace = this.contextService.getWorkspace();\n        function createHash(uri) {\n            return crypto.createHash('sha1').update(uri.scheme === network_1.Schemas.file ? uri.fsPath : uri.toString()).digest('hex');\n        }\n        var workspaceId;\n        switch (state) {\n            case workspace_1.WorkbenchState.EMPTY:\n                workspaceId = undefined;\n                break;\n            case workspace_1.WorkbenchState.FOLDER:\n                workspaceId = createHash(workspace.folders[0].uri);\n                break;\n            case workspace_1.WorkbenchState.WORKSPACE:\n                if (workspace.configuration) {\n                    workspaceId = createHash(workspace.configuration);\n                }\n        }\n        tags['workspace.id'] = workspaceId;\n        var filesToOpen = configuration.filesToOpen, filesToCreate = configuration.filesToCreate, filesToDiff = configuration.filesToDiff;\n        tags['workbench.filesToOpen'] = filesToOpen && filesToOpen.length || 0;\n        tags['workbench.filesToCreate'] = filesToCreate && filesToCreate.length || 0;\n        tags['workbench.filesToDiff'] = filesToDiff && filesToDiff.length || 0;\n        var isEmpty = state === workspace_1.WorkbenchState.EMPTY;\n        tags['workspace.roots'] = isEmpty ? 0 : workspace.folders.length;\n        tags['workspace.empty'] = isEmpty;\n        var folders = !isEmpty ? workspace.folders.map(function (folder) { return folder.uri; }) : this.environmentService.appQuality !== 'stable' && this.findFolders(configuration);\n        if (!folders || !folders.length || !this.fileService) {\n            return Promise.resolve(tags);\n        }\n        return this.fileService.resolveFiles(folders.map(function (resource) { return ({ resource: resource }); })).then(function (files) {\n            var _a;\n            var names = (_a = []).concat.apply(_a, files.map(function (result) { return result.success ? (result.stat.children || []) : []; })).map(function (c) { return c.name; });\n            var nameSet = names.reduce(function (s, n) { return s.add(n.toLowerCase()); }, new Set());\n            if (participant) {\n                participant(names);\n            }\n            tags['workspace.grunt'] = nameSet.has('gruntfile.js');\n            tags['workspace.gulp'] = nameSet.has('gulpfile.js');\n            tags['workspace.jake'] = nameSet.has('jakefile.js');\n            tags['workspace.tsconfig'] = nameSet.has('tsconfig.json');\n            tags['workspace.jsconfig'] = nameSet.has('jsconfig.json');\n            tags['workspace.config.xml'] = nameSet.has('config.xml');\n            tags['workspace.vsc.extension'] = nameSet.has('vsc-extension-quickstart.md');\n            tags['workspace.ASP5'] = nameSet.has('project.json') && WorkspaceStats.searchArray(names, /^.+\\.cs$/i);\n            tags['workspace.sln'] = WorkspaceStats.searchArray(names, /^.+\\.sln$|^.+\\.csproj$/i);\n            tags['workspace.unity'] = nameSet.has('assets') && nameSet.has('library') && nameSet.has('projectsettings');\n            tags['workspace.npm'] = nameSet.has('package.json') || nameSet.has('node_modules');\n            tags['workspace.bower'] = nameSet.has('bower.json') || nameSet.has('bower_components');\n            tags['workspace.yeoman.code.ext'] = nameSet.has('vsc-extension-quickstart.md');\n            tags['workspace.py.requirements'] = nameSet.has('requirements.txt');\n            tags['workspace.py.requirements.star'] = WorkspaceStats.searchArray(names, /^(.*)requirements(.*)\\.txt$/i);\n            tags['workspace.py.Pipfile'] = nameSet.has('pipfile');\n            tags['workspace.py.conda'] = WorkspaceStats.searchArray(names, /^environment(\\.yml$|\\.yaml$)/i);\n            var mainActivity = nameSet.has('mainactivity.cs') || nameSet.has('mainactivity.fs');\n            var appDelegate = nameSet.has('appdelegate.cs') || nameSet.has('appdelegate.fs');\n            var androidManifest = nameSet.has('androidmanifest.xml');\n            var platforms = nameSet.has('platforms');\n            var plugins = nameSet.has('plugins');\n            var www = nameSet.has('www');\n            var properties = nameSet.has('properties');\n            var resources = nameSet.has('resources');\n            var jni = nameSet.has('jni');\n            if (tags['workspace.config.xml'] &&\n                !tags['workspace.language.cs'] && !tags['workspace.language.vb'] && !tags['workspace.language.aspx']) {\n                if (platforms && plugins && www) {\n                    tags['workspace.cordova.high'] = true;\n                }\n                else {\n                    tags['workspace.cordova.low'] = true;\n                }\n            }\n            if (tags['workspace.config.xml'] &&\n                !tags['workspace.language.cs'] && !tags['workspace.language.vb'] && !tags['workspace.language.aspx']) {\n                if (nameSet.has('ionic.config.json')) {\n                    tags['workspace.ionic'] = true;\n                }\n            }\n            if (mainActivity && properties && resources) {\n                tags['workspace.xamarin.android'] = true;\n            }\n            if (appDelegate && resources) {\n                tags['workspace.xamarin.ios'] = true;\n            }\n            if (androidManifest && jni) {\n                tags['workspace.android.cpp'] = true;\n            }\n            function getFilePromises(filename, fileService, contentHandler) {\n                return !nameSet.has(filename) ? [] : folders.map(function (workspaceUri) {\n                    var uri = workspaceUri.with({ path: (workspaceUri.path !== '/' ? workspaceUri.path : '') + \"/\" + filename });\n                    return fileService.existsFile(uri).then(function (exists) {\n                        if (!exists) {\n                            return undefined;\n                        }\n                        return fileService.resolveContent(uri, { acceptTextOnly: true }).then(contentHandler);\n                    }, function (err) {\n                        // Ignore missing file\n                    });\n                });\n            }\n            function addPythonTags(packageName) {\n                if (PyModulesToLookFor.indexOf(packageName) > -1) {\n                    tags['workspace.py.' + packageName] = true;\n                }\n                // cognitive services has a lot of tiny packages. eg. 'azure-cognitiveservices-search-autosuggest'\n                if (packageName.indexOf('azure-cognitiveservices') > -1) {\n                    tags['workspace.py.azure-cognitiveservices'] = true;\n                }\n                if (packageName.indexOf('azure-mgmt') > -1) {\n                    tags['workspace.py.azure-mgmt'] = true;\n                }\n                if (packageName.indexOf('azure-ml') > -1) {\n                    tags['workspace.py.azure-ml'] = true;\n                }\n                if (!tags['workspace.py.any-azure']) {\n                    tags['workspace.py.any-azure'] = /azure/i.test(packageName);\n                }\n            }\n            var requirementsTxtPromises = getFilePromises('requirements.txt', _this.fileService, function (content) {\n                var dependencies = content.value.split(/\\r\\n|\\r|\\n/);\n                for (var _i = 0, dependencies_1 = dependencies; _i < dependencies_1.length; _i++) {\n                    var dependency = dependencies_1[_i];\n                    // Dependencies in requirements.txt can have 3 formats: `foo==3.1, foo>=3.1, foo`\n                    var format1 = dependency.split('==');\n                    var format2 = dependency.split('>=');\n                    var packageName = (format1.length === 2 ? format1[0] : format2[0]).trim();\n                    addPythonTags(packageName);\n                }\n            });\n            var pipfilePromises = getFilePromises('pipfile', _this.fileService, function (content) {\n                var dependencies = content.value.split(/\\r\\n|\\r|\\n/);\n                // We're only interested in the '[packages]' section of the Pipfile\n                dependencies = dependencies.slice(dependencies.indexOf('[packages]') + 1);\n                for (var _i = 0, dependencies_2 = dependencies; _i < dependencies_2.length; _i++) {\n                    var dependency = dependencies_2[_i];\n                    if (dependency.trim().indexOf('[') > -1) {\n                        break;\n                    }\n                    // All dependencies in Pipfiles follow the format: `<package> = <version, or git repo, or something else>`\n                    if (dependency.indexOf('=') === -1) {\n                        continue;\n                    }\n                    var packageName = dependency.split('=')[0].trim();\n                    addPythonTags(packageName);\n                }\n            });\n            var packageJsonPromises = getFilePromises('package.json', _this.fileService, function (content) {\n                try {\n                    var packageJsonContents = JSON.parse(content.value);\n                    if (packageJsonContents['dependencies']) {\n                        for (var _i = 0, ModulesToLookFor_1 = ModulesToLookFor; _i < ModulesToLookFor_1.length; _i++) {\n                            var module = ModulesToLookFor_1[_i];\n                            if ('react-native' === module) {\n                                if (packageJsonContents['dependencies'][module]) {\n                                    tags['workspace.reactNative'] = true;\n                                }\n                            }\n                            else if ('tns-core-modules' === module) {\n                                if (packageJsonContents['dependencies'][module]) {\n                                    tags['workspace.nativescript'] = true;\n                                }\n                            }\n                            else {\n                                if (packageJsonContents['dependencies'][module]) {\n                                    tags['workspace.npm.' + module] = true;\n                                }\n                            }\n                        }\n                    }\n                }\n                catch (e) {\n                    // Ignore errors when resolving file or parsing file contents\n                }\n            });\n            return Promise.all(packageJsonPromises.concat(requirementsTxtPromises, pipfilePromises)).then(function () { return tags; });\n        });\n    };\n    WorkspaceStats.prototype.handleWorkspaceFiles = function (rootFiles) {\n        var state = this.contextService.getWorkbenchState();\n        var workspace = this.contextService.getWorkspace();\n        // Handle top-level workspace files for local single folder workspace\n        if (state === workspace_1.WorkbenchState.FOLDER && workspace.folders[0].uri.scheme === network_1.Schemas.file) {\n            var workspaceFiles = rootFiles.filter(workspaces_1.hasWorkspaceFileExtension);\n            if (workspaceFiles.length > 0) {\n                this.doHandleWorkspaceFiles(workspace.folders[0].uri, workspaceFiles);\n            }\n        }\n    };\n    WorkspaceStats.prototype.doHandleWorkspaceFiles = function (folder, workspaces) {\n        var _this = this;\n        if (this.storageService.getBoolean(WorkspaceStats.DISABLE_WORKSPACE_PROMPT_KEY, storage_1.StorageScope.WORKSPACE)) {\n            return; // prompt disabled by user\n        }\n        var doNotShowAgain = {\n            label: nls_1.localize('never again', \"Don't Show Again\"),\n            isSecondary: true,\n            run: function () { return _this.storageService.store(WorkspaceStats.DISABLE_WORKSPACE_PROMPT_KEY, true, storage_1.StorageScope.WORKSPACE); }\n        };\n        // Prompt to open one workspace\n        if (workspaces.length === 1) {\n            var workspaceFile_1 = workspaces[0];\n            this.notificationService.prompt(notification_1.Severity.Info, nls_1.localize('workspaceFound', \"This folder contains a workspace file '{0}'. Do you want to open it? [Learn more]({1}) about workspace files.\", workspaceFile_1, 'https://go.microsoft.com/fwlink/?linkid=2025315'), [{\n                    label: nls_1.localize('openWorkspace', \"Open Workspace\"),\n                    run: function () { return _this.windowService.openWindow([{ uri: resources_1.joinPath(folder, workspaceFile_1), typeHint: 'file' }]); }\n                }, doNotShowAgain]);\n        }\n        // Prompt to select a workspace from many\n        else if (workspaces.length > 1) {\n            this.notificationService.prompt(notification_1.Severity.Info, nls_1.localize('workspacesFound', \"This folder contains multiple workspace files. Do you want to open one? [Learn more]({0}) about workspace files.\", 'https://go.microsoft.com/fwlink/?linkid=2025315'), [{\n                    label: nls_1.localize('selectWorkspace', \"Select Workspace\"),\n                    run: function () {\n                        _this.quickInputService.pick(workspaces.map(function (workspace) { return ({ label: workspace }); }), { placeHolder: nls_1.localize('selectToOpen', \"Select a workspace to open\") }).then(function (pick) {\n                            if (pick) {\n                                _this.windowService.openWindow([{ uri: resources_1.joinPath(folder, pick.label), typeHint: 'file' }]);\n                            }\n                        });\n                    }\n                }, doNotShowAgain]);\n        }\n    };\n    WorkspaceStats.prototype.findFolders = function (configuration) {\n        var folder = this.findFolder(configuration);\n        return folder && [folder];\n    };\n    WorkspaceStats.prototype.findFolder = function (_a) {\n        var filesToOpen = _a.filesToOpen, filesToCreate = _a.filesToCreate, filesToDiff = _a.filesToDiff;\n        if (filesToOpen && filesToOpen.length) {\n            return this.parentURI(filesToOpen[0].fileUri);\n        }\n        else if (filesToCreate && filesToCreate.length) {\n            return this.parentURI(filesToCreate[0].fileUri);\n        }\n        else if (filesToDiff && filesToDiff.length) {\n            return this.parentURI(filesToDiff[0].fileUri);\n        }\n        return undefined;\n    };\n    WorkspaceStats.prototype.parentURI = function (uri) {\n        if (!uri) {\n            return undefined;\n        }\n        var path = uri.path;\n        var i = path.lastIndexOf('/');\n        return i !== -1 ? uri.with({ path: path.substr(0, i) }) : undefined;\n    };\n    WorkspaceStats.prototype.reportWorkspaceTags = function (tags) {\n        /* __GDPR__\n            \"workspce.tags\" : {\n                \"${include}\": [\n                    \"${WorkspaceTags}\"\n                ]\n            }\n        */\n        this.telemetryService.publicLog('workspce.tags', tags);\n        WorkspaceStats.TAGS = tags;\n    };\n    WorkspaceStats.prototype.reportRemoteDomains = function (workspaceUris) {\n        var _this = this;\n        Promise.all(workspaceUris.map(function (workspaceUri) {\n            var path = workspaceUri.path;\n            var uri = workspaceUri.with({ path: (path !== '/' ? path : '') + \"/.git/config\" });\n            return _this.fileService.existsFile(uri).then(function (exists) {\n                if (!exists) {\n                    return [];\n                }\n                return _this.fileService.resolveContent(uri, { acceptTextOnly: true }).then(function (content) { return getDomainsOfRemotes(content.value, SecondLevelDomainWhitelist); }, function (err) { return []; } // ignore missing or binary file\n                );\n            });\n        })).then(function (domains) {\n            var set = domains.reduce(function (set, list) { return list.reduce(function (set, item) { return set.add(item); }, set); }, new Set());\n            var list = [];\n            set.forEach(function (item) { return list.push(item); });\n            /* __GDPR__\n                \"workspace.remotes\" : {\n                    \"domains\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n                }\n            */\n            _this.telemetryService.publicLog('workspace.remotes', { domains: list.sort() });\n        }, errors_1.onUnexpectedError);\n    };\n    WorkspaceStats.prototype.reportRemotes = function (workspaceUris) {\n        var _this = this;\n        Promise.all(workspaceUris.map(function (workspaceUri) {\n            return getHashedRemotesFromUri(workspaceUri, _this.fileService, true);\n        })).then(function (hashedRemotes) {\n            /* __GDPR__\n                    \"workspace.hashedRemotes\" : {\n                        \"remotes\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n                    }\n                */\n            _this.telemetryService.publicLog('workspace.hashedRemotes', { remotes: hashedRemotes });\n        }, errors_1.onUnexpectedError);\n    };\n    /* __GDPR__FRAGMENT__\n        \"AzureTags\" : {\n            \"node\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n        }\n    */\n    WorkspaceStats.prototype.reportAzureNode = function (workspaceUris, tags) {\n        // TODO: should also work for `node_modules` folders several levels down\n        var uris = workspaceUris.map(function (workspaceUri) {\n            var path = workspaceUri.path;\n            return workspaceUri.with({ path: (path !== '/' ? path : '') + \"/node_modules\" });\n        });\n        return this.fileService.resolveFiles(uris.map(function (resource) { return ({ resource: resource }); })).then(function (results) {\n            var _a;\n            var names = (_a = []).concat.apply(_a, results.map(function (result) { return result.success ? (result.stat.children || []) : []; })).map(function (c) { return c.name; });\n            var referencesAzure = WorkspaceStats.searchArray(names, /azure/i);\n            if (referencesAzure) {\n                tags['node'] = true;\n            }\n            return tags;\n        }, function (err) {\n            return tags;\n        });\n    };\n    /* __GDPR__FRAGMENT__\n        \"AzureTags\" : {\n            \"java\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n        }\n    */\n    WorkspaceStats.prototype.reportAzureJava = function (workspaceUris, tags) {\n        var _this = this;\n        return Promise.all(workspaceUris.map(function (workspaceUri) {\n            var path = workspaceUri.path;\n            var uri = workspaceUri.with({ path: (path !== '/' ? path : '') + \"/pom.xml\" });\n            return _this.fileService.existsFile(uri).then(function (exists) {\n                if (!exists) {\n                    return false;\n                }\n                return _this.fileService.resolveContent(uri, { acceptTextOnly: true }).then(function (content) { return !!content.value.match(/azure/i); }, function (err) { return false; });\n            });\n        })).then(function (javas) {\n            if (javas.indexOf(true) !== -1) {\n                tags['java'] = true;\n            }\n            return tags;\n        });\n    };\n    WorkspaceStats.prototype.reportAzure = function (uris) {\n        var _this = this;\n        var tags = Object.create(null);\n        this.reportAzureNode(uris, tags).then(function (tags) {\n            return _this.reportAzureJava(uris, tags);\n        }).then(function (tags) {\n            if (Object.keys(tags).length) {\n                /* __GDPR__\n                    \"workspace.azure\" : {\n                        \"${include}\": [\n                            \"${AzureTags}\"\n                        ]\n                    }\n                */\n                _this.telemetryService.publicLog('workspace.azure', tags);\n            }\n        }).then(undefined, errors_1.onUnexpectedError);\n    };\n    WorkspaceStats.prototype.reportCloudStats = function () {\n        var uris = this.contextService.getWorkspace().folders.map(function (folder) { return folder.uri; });\n        if (uris.length && this.fileService) {\n            this.reportRemoteDomains(uris);\n            this.reportRemotes(uris);\n            this.reportAzure(uris);\n        }\n    };\n    WorkspaceStats.prototype.reportProxyStats = function () {\n        var _this = this;\n        this.windowService.resolveProxy('https://www.example.com/')\n            .then(function (proxy) {\n            var type = proxy ? String(proxy).trim().split(/\\s+/, 1)[0] : 'EMPTY';\n            if (['DIRECT', 'PROXY', 'HTTPS', 'SOCKS', 'EMPTY'].indexOf(type) === -1) {\n                type = 'UNKNOWN';\n            }\n            /* __GDPR__\n                \"resolveProxy.stats\" : {\n                    \"type\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" }\n                }\n            */\n            _this.telemetryService.publicLog('resolveProxy.stats', { type: type });\n        }).then(undefined, errors_1.onUnexpectedError);\n    };\n    WorkspaceStats.DISABLE_WORKSPACE_PROMPT_KEY = 'workspaces.dontPromptToOpen';\n    WorkspaceStats = tslib_1.__decorate([\n        tslib_1.__param(0, files_1.IFileService),\n        tslib_1.__param(1, workspace_1.IWorkspaceContextService),\n        tslib_1.__param(2, telemetry_1.ITelemetryService),\n        tslib_1.__param(3, environment_1.IEnvironmentService),\n        tslib_1.__param(4, windows_1.IWindowService),\n        tslib_1.__param(5, notification_1.INotificationService),\n        tslib_1.__param(6, quickInput_1.IQuickInputService),\n        tslib_1.__param(7, storage_1.IStorageService)\n    ], WorkspaceStats);\n    return WorkspaceStats;\n}());\nexports.WorkspaceStats = WorkspaceStats;\n",{"version":3,"file":"/home/coding/workspace/lib/vscode/src/vs/workbench/contrib/stats/node/workspaceStats.ts","sourceRoot":"","sources":["/home/coding/workspace/lib/vscode/src/vs/workbench/contrib/stats/node/workspaceStats.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport * as crypto from 'crypto';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { URI } from 'vs/base/common/uri';\nimport { IFileService, IFileStat, IResolveFileResult, IContent } from 'vs/platform/files/common/files';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { IWorkspaceContextService, WorkbenchState } from 'vs/platform/workspace/common/workspace';\nimport { IEnvironmentService } from 'vs/platform/environment/common/environment';\nimport { IWindowConfiguration, IWindowService } from 'vs/platform/windows/common/windows';\nimport { IWorkbenchContribution } from 'vs/workbench/common/contributions';\nimport { endsWith } from 'vs/base/common/strings';\nimport { Schemas } from 'vs/base/common/network';\nimport { INotificationService, Severity, IPromptChoice } from 'vs/platform/notification/common/notification';\nimport { hasWorkspaceFileExtension } from 'vs/platform/workspaces/common/workspaces';\nimport { IQuickInputService, IQuickPickItem } from 'vs/platform/quickinput/common/quickInput';\nimport { IStorageService, StorageScope } from 'vs/platform/storage/common/storage';\nimport { joinPath } from 'vs/base/common/resources';\n\nconst SshProtocolMatcher = /^([^@:]+@)?([^:]+):/;\nconst SshUrlMatcher = /^([^@:]+@)?([^:]+):(.+)$/;\nconst AuthorityMatcher = /^([^@]+@)?([^:]+)(:\\d+)?$/;\nconst SecondLevelDomainMatcher = /([^@:.]+\\.[^@:.]+)(:\\d+)?$/;\nconst RemoteMatcher = /^\\s*url\\s*=\\s*(.+\\S)\\s*$/mg;\nconst AnyButDot = /[^.]/g;\nconst SecondLevelDomainWhitelist = [\n\t'github.com',\n\t'bitbucket.org',\n\t'visualstudio.com',\n\t'gitlab.com',\n\t'heroku.com',\n\t'azurewebsites.net',\n\t'ibm.com',\n\t'amazon.com',\n\t'amazonaws.com',\n\t'cloudapp.net',\n\t'rhcloud.com',\n\t'google.com'\n];\nconst ModulesToLookFor = [\n\t// Packages that suggest a node server\n\t'express',\n\t'sails',\n\t'koa',\n\t'hapi',\n\t'socket.io',\n\t'restify',\n\t// JS frameworks\n\t'react',\n\t'react-native',\n\t'@angular/core',\n\t'@ionic',\n\t'vue',\n\t'tns-core-modules',\n\t// Other interesting packages\n\t'aws-sdk',\n\t'aws-amplify',\n\t'azure',\n\t'azure-storage',\n\t'firebase',\n\t'@google-cloud/common',\n\t'heroku-cli'\n];\nconst PyModulesToLookFor = [\n\t'azure',\n\t'azure-storage-common',\n\t'azure-storage-blob',\n\t'azure-storage-file',\n\t'azure-storage-queue',\n\t'azure-shell',\n\t'azure-cosmos',\n\t'azure-devtools',\n\t'azure-elasticluster',\n\t'azure-eventgrid',\n\t'azure-functions',\n\t'azure-graphrbac',\n\t'azure-keyvault',\n\t'azure-loganalytics',\n\t'azure-monitor',\n\t'azure-servicebus',\n\t'azure-servicefabric',\n\t'azure-storage',\n\t'azure-translator',\n\t'azure-iothub-device-client',\n\t'adal',\n\t'pydocumentdb',\n\t'botbuilder-core',\n\t'botbuilder-schema',\n\t'botframework-connector'\n];\n\ntype Tags = { [index: string]: boolean | number | string | undefined };\n\nfunction stripLowLevelDomains(domain: string): string | null {\n\tconst match = domain.match(SecondLevelDomainMatcher);\n\treturn match ? match[1] : null;\n}\n\nfunction extractDomain(url: string): string | null {\n\tif (url.indexOf('://') === -1) {\n\t\tconst match = url.match(SshProtocolMatcher);\n\t\tif (match) {\n\t\t\treturn stripLowLevelDomains(match[2]);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\ttry {\n\t\tconst uri = URI.parse(url);\n\t\tif (uri.authority) {\n\t\t\treturn stripLowLevelDomains(uri.authority);\n\t\t}\n\t} catch (e) {\n\t\t// ignore invalid URIs\n\t}\n\treturn null;\n}\n\nexport function getDomainsOfRemotes(text: string, whitelist: string[]): string[] {\n\tconst domains = new Set<string>();\n\tlet match: RegExpExecArray | null;\n\twhile (match = RemoteMatcher.exec(text)) {\n\t\tconst domain = extractDomain(match[1]);\n\t\tif (domain) {\n\t\t\tdomains.add(domain);\n\t\t}\n\t}\n\n\tconst whitemap = whitelist.reduce((map, key) => {\n\t\tmap[key] = true;\n\t\treturn map;\n\t}, Object.create(null));\n\n\tconst elements: string[] = [];\n\tdomains.forEach(e => elements.push(e));\n\n\treturn elements\n\t\t.map(key => whitemap[key] ? key : key.replace(AnyButDot, 'a'));\n}\n\nfunction stripPort(authority: string): string | null {\n\tconst match = authority.match(AuthorityMatcher);\n\treturn match ? match[2] : null;\n}\n\nfunction normalizeRemote(host: string | null, path: string, stripEndingDotGit: boolean): string | null {\n\tif (host && path) {\n\t\tif (stripEndingDotGit && endsWith(path, '.git')) {\n\t\t\tpath = path.substr(0, path.length - 4);\n\t\t}\n\t\treturn (path.indexOf('/') === 0) ? `${host}${path}` : `${host}/${path}`;\n\t}\n\treturn null;\n}\n\nfunction extractRemote(url: string, stripEndingDotGit: boolean): string | null {\n\tif (url.indexOf('://') === -1) {\n\t\tconst match = url.match(SshUrlMatcher);\n\t\tif (match) {\n\t\t\treturn normalizeRemote(match[2], match[3], stripEndingDotGit);\n\t\t}\n\t}\n\ttry {\n\t\tconst uri = URI.parse(url);\n\t\tif (uri.authority) {\n\t\t\treturn normalizeRemote(stripPort(uri.authority), uri.path, stripEndingDotGit);\n\t\t}\n\t} catch (e) {\n\t\t// ignore invalid URIs\n\t}\n\treturn null;\n}\n\nexport function getRemotes(text: string, stripEndingDotGit: boolean = false): string[] {\n\tconst remotes: string[] = [];\n\tlet match: RegExpExecArray | null;\n\twhile (match = RemoteMatcher.exec(text)) {\n\t\tconst remote = extractRemote(match[1], stripEndingDotGit);\n\t\tif (remote) {\n\t\t\tremotes.push(remote);\n\t\t}\n\t}\n\treturn remotes;\n}\n\nexport function getHashedRemotesFromConfig(text: string, stripEndingDotGit: boolean = false): string[] {\n\treturn getRemotes(text, stripEndingDotGit).map(r => {\n\t\treturn crypto.createHash('sha1').update(r).digest('hex');\n\t});\n}\n\nexport function getHashedRemotesFromUri(workspaceUri: URI, fileService: IFileService, stripEndingDotGit: boolean = false): Promise<string[]> {\n\tconst path = workspaceUri.path;\n\tconst uri = workspaceUri.with({ path: `${path !== '/' ? path : ''}/.git/config` });\n\treturn fileService.existsFile(uri).then(exists => {\n\t\tif (!exists) {\n\t\t\treturn [];\n\t\t}\n\t\treturn fileService.resolveContent(uri, { acceptTextOnly: true }).then(\n\t\t\tcontent => getHashedRemotesFromConfig(content.value, stripEndingDotGit),\n\t\t\terr => [] // ignore missing or binary file\n\t\t);\n\t});\n}\n\nexport class WorkspaceStats implements IWorkbenchContribution {\n\n\tstatic TAGS: Tags;\n\n\tprivate static DISABLE_WORKSPACE_PROMPT_KEY = 'workspaces.dontPromptToOpen';\n\n\tconstructor(\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IEnvironmentService private readonly environmentService: IEnvironmentService,\n\t\t@IWindowService private readonly windowService: IWindowService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@IQuickInputService private readonly quickInputService: IQuickInputService,\n\t\t@IStorageService private readonly storageService: IStorageService\n\t) {\n\t\tthis.report();\n\t}\n\n\tprivate report(): void {\n\n\t\t// Workspace Stats\n\t\tthis.resolveWorkspaceTags(this.windowService.getConfiguration(), rootFiles => this.handleWorkspaceFiles(rootFiles))\n\t\t\t.then(tags => this.reportWorkspaceTags(tags), error => onUnexpectedError(error));\n\n\t\t// Cloud Stats\n\t\tthis.reportCloudStats();\n\n\t\tthis.reportProxyStats();\n\t}\n\n\tprivate static searchArray(arr: string[], regEx: RegExp): boolean | undefined {\n\t\treturn arr.some(v => v.search(regEx) > -1) || undefined;\n\t}\n\n\t/* __GDPR__FRAGMENT__\n\t\t\"WorkspaceTags\" : {\n\t\t\t\"workbench.filesToOpen\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workbench.filesToCreate\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workbench.filesToDiff\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.id\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\"workspace.roots\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.empty\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.grunt\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.gulp\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.jake\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.tsconfig\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.jsconfig\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.config.xml\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.vsc.extension\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.asp<NUMBER>\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.sln\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.unity\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.express\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.sails\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.koa\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.hapi\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.socket.io\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.restify\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.react\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.@angular/core\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.vue\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.aws-sdk\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.aws-amplify-sdk\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.azure\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.azure-storage\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.@google-cloud/common\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.firebase\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.npm.heroku-cli\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.bower\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.yeoman.code.ext\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.cordova.high\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.cordova.low\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.xamarin.android\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.xamarin.ios\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.android.cpp\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.reactNative\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.ionic\" : { \"classification\" : \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": \"true\" },\n\t\t\t\"workspace.nativeScript\" : { \"classification\" : \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": \"true\" },\n\t\t\t\"workspace.py.requirements\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.requirements.star\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.Pipfile\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.conda\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.any-azure\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-storage-common\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-storage-blob\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-storage-file\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-storage-queue\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-mgmt\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-shell\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.pulumi-azure\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-cosmos\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-devtools\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-elasticluster\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-eventgrid\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-functions\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-graphrbac\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-keyvault\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-loganalytics\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-monitor\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-servicebus\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-servicefabric\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-storage\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-translator\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-iothub-device-client\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-ml\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.azure-cognitiveservices\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.adal\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.pydocumentdb\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.botbuilder-core\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.botbuilder-schema\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\"workspace.py.botframework-connector\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n\n\t\t}\n\t*/\n\tprivate resolveWorkspaceTags(configuration: IWindowConfiguration, participant?: (rootFiles: string[]) => void): Promise<Tags> {\n\t\tconst tags: Tags = Object.create(null);\n\n\t\tconst state = this.contextService.getWorkbenchState();\n\t\tconst workspace = this.contextService.getWorkspace();\n\n\t\tfunction createHash(uri: URI): string {\n\t\t\treturn crypto.createHash('sha1').update(uri.scheme === Schemas.file ? uri.fsPath : uri.toString()).digest('hex');\n\t\t}\n\n\t\tlet workspaceId: string | undefined;\n\t\tswitch (state) {\n\t\t\tcase WorkbenchState.EMPTY:\n\t\t\t\tworkspaceId = undefined;\n\t\t\t\tbreak;\n\t\t\tcase WorkbenchState.FOLDER:\n\t\t\t\tworkspaceId = createHash(workspace.folders[0].uri);\n\t\t\t\tbreak;\n\t\t\tcase WorkbenchState.WORKSPACE:\n\t\t\t\tif (workspace.configuration) {\n\t\t\t\t\tworkspaceId = createHash(workspace.configuration);\n\t\t\t\t}\n\t\t}\n\n\t\ttags['workspace.id'] = workspaceId;\n\n\t\tconst { filesToOpen, filesToCreate, filesToDiff } = configuration;\n\t\ttags['workbench.filesToOpen'] = filesToOpen && filesToOpen.length || 0;\n\t\ttags['workbench.filesToCreate'] = filesToCreate && filesToCreate.length || 0;\n\t\ttags['workbench.filesToDiff'] = filesToDiff && filesToDiff.length || 0;\n\n\t\tconst isEmpty = state === WorkbenchState.EMPTY;\n\t\ttags['workspace.roots'] = isEmpty ? 0 : workspace.folders.length;\n\t\ttags['workspace.empty'] = isEmpty;\n\n\t\tconst folders = !isEmpty ? workspace.folders.map(folder => folder.uri) : this.environmentService.appQuality !== 'stable' && this.findFolders(configuration);\n\t\tif (!folders || !folders.length || !this.fileService) {\n\t\t\treturn Promise.resolve(tags);\n\t\t}\n\n\t\treturn this.fileService.resolveFiles(folders.map(resource => ({ resource }))).then((files: IResolveFileResult[]) => {\n\t\t\tconst names = (<IFileStat[]>[]).concat(...files.map(result => result.success ? (result.stat!.children || []) : [])).map(c => c.name);\n\t\t\tconst nameSet = names.reduce((s, n) => s.add(n.toLowerCase()), new Set());\n\n\t\t\tif (participant) {\n\t\t\t\tparticipant(names);\n\t\t\t}\n\n\t\t\ttags['workspace.grunt'] = nameSet.has('gruntfile.js');\n\t\t\ttags['workspace.gulp'] = nameSet.has('gulpfile.js');\n\t\t\ttags['workspace.jake'] = nameSet.has('jakefile.js');\n\n\t\t\ttags['workspace.tsconfig'] = nameSet.has('tsconfig.json');\n\t\t\ttags['workspace.jsconfig'] = nameSet.has('jsconfig.json');\n\t\t\ttags['workspace.config.xml'] = nameSet.has('config.xml');\n\t\t\ttags['workspace.vsc.extension'] = nameSet.has('vsc-extension-quickstart.md');\n\n\t\t\ttags['workspace.ASP5'] = nameSet.has('project.json') && WorkspaceStats.searchArray(names, /^.+\\.cs$/i);\n\t\t\ttags['workspace.sln'] = WorkspaceStats.searchArray(names, /^.+\\.sln$|^.+\\.csproj$/i);\n\t\t\ttags['workspace.unity'] = nameSet.has('assets') && nameSet.has('library') && nameSet.has('projectsettings');\n\t\t\ttags['workspace.npm'] = nameSet.has('package.json') || nameSet.has('node_modules');\n\t\t\ttags['workspace.bower'] = nameSet.has('bower.json') || nameSet.has('bower_components');\n\n\t\t\ttags['workspace.yeoman.code.ext'] = nameSet.has('vsc-extension-quickstart.md');\n\n\t\t\ttags['workspace.py.requirements'] = nameSet.has('requirements.txt');\n\t\t\ttags['workspace.py.requirements.star'] = WorkspaceStats.searchArray(names, /^(.*)requirements(.*)\\.txt$/i);\n\t\t\ttags['workspace.py.Pipfile'] = nameSet.has('pipfile');\n\t\t\ttags['workspace.py.conda'] = WorkspaceStats.searchArray(names, /^environment(\\.yml$|\\.yaml$)/i);\n\n\t\t\tconst mainActivity = nameSet.has('mainactivity.cs') || nameSet.has('mainactivity.fs');\n\t\t\tconst appDelegate = nameSet.has('appdelegate.cs') || nameSet.has('appdelegate.fs');\n\t\t\tconst androidManifest = nameSet.has('androidmanifest.xml');\n\n\t\t\tconst platforms = nameSet.has('platforms');\n\t\t\tconst plugins = nameSet.has('plugins');\n\t\t\tconst www = nameSet.has('www');\n\t\t\tconst properties = nameSet.has('properties');\n\t\t\tconst resources = nameSet.has('resources');\n\t\t\tconst jni = nameSet.has('jni');\n\n\t\t\tif (tags['workspace.config.xml'] &&\n\t\t\t\t!tags['workspace.language.cs'] && !tags['workspace.language.vb'] && !tags['workspace.language.aspx']) {\n\t\t\t\tif (platforms && plugins && www) {\n\t\t\t\t\ttags['workspace.cordova.high'] = true;\n\t\t\t\t} else {\n\t\t\t\t\ttags['workspace.cordova.low'] = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (tags['workspace.config.xml'] &&\n\t\t\t\t!tags['workspace.language.cs'] && !tags['workspace.language.vb'] && !tags['workspace.language.aspx']) {\n\n\t\t\t\tif (nameSet.has('ionic.config.json')) {\n\t\t\t\t\ttags['workspace.ionic'] = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (mainActivity && properties && resources) {\n\t\t\t\ttags['workspace.xamarin.android'] = true;\n\t\t\t}\n\n\t\t\tif (appDelegate && resources) {\n\t\t\t\ttags['workspace.xamarin.ios'] = true;\n\t\t\t}\n\n\t\t\tif (androidManifest && jni) {\n\t\t\t\ttags['workspace.android.cpp'] = true;\n\t\t\t}\n\n\t\t\tfunction getFilePromises(filename: string, fileService: IFileService, contentHandler: (content: IContent) => void): Promise<void>[] {\n\t\t\t\treturn !nameSet.has(filename) ? [] : (folders as URI[]).map(workspaceUri => {\n\t\t\t\t\tconst uri = workspaceUri.with({ path: `${workspaceUri.path !== '/' ? workspaceUri.path : ''}/${filename}` });\n\t\t\t\t\treturn fileService.existsFile(uri).then(exists => {\n\t\t\t\t\t\tif (!exists) {\n\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn fileService.resolveContent(uri, { acceptTextOnly: true }).then(contentHandler);\n\t\t\t\t\t}, err => {\n\t\t\t\t\t\t// Ignore missing file\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction addPythonTags(packageName: string): void {\n\t\t\t\tif (PyModulesToLookFor.indexOf(packageName) > -1) {\n\t\t\t\t\ttags['workspace.py.' + packageName] = true;\n\t\t\t\t}\n\t\t\t\t// cognitive services has a lot of tiny packages. eg. 'azure-cognitiveservices-search-autosuggest'\n\t\t\t\tif (packageName.indexOf('azure-cognitiveservices') > -1) {\n\t\t\t\t\ttags['workspace.py.azure-cognitiveservices'] = true;\n\t\t\t\t}\n\t\t\t\tif (packageName.indexOf('azure-mgmt') > -1) {\n\t\t\t\t\ttags['workspace.py.azure-mgmt'] = true;\n\t\t\t\t}\n\t\t\t\tif (packageName.indexOf('azure-ml') > -1) {\n\t\t\t\t\ttags['workspace.py.azure-ml'] = true;\n\t\t\t\t}\n\t\t\t\tif (!tags['workspace.py.any-azure']) {\n\t\t\t\t\ttags['workspace.py.any-azure'] = /azure/i.test(packageName);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst requirementsTxtPromises = getFilePromises('requirements.txt', this.fileService, content => {\n\t\t\t\tconst dependencies: string[] = content.value.split(/\\r\\n|\\r|\\n/);\n\t\t\t\tfor (let dependency of dependencies) {\n\t\t\t\t\t// Dependencies in requirements.txt can have 3 formats: `foo==3.1, foo>=3.1, foo`\n\t\t\t\t\tconst format1 = dependency.split('==');\n\t\t\t\t\tconst format2 = dependency.split('>=');\n\t\t\t\t\tconst packageName = (format1.length === 2 ? format1[0] : format2[0]).trim();\n\t\t\t\t\taddPythonTags(packageName);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst pipfilePromises = getFilePromises('pipfile', this.fileService, content => {\n\t\t\t\tlet dependencies: string[] = content.value.split(/\\r\\n|\\r|\\n/);\n\n\t\t\t\t// We're only interested in the '[packages]' section of the Pipfile\n\t\t\t\tdependencies = dependencies.slice(dependencies.indexOf('[packages]') + 1);\n\n\t\t\t\tfor (let dependency of dependencies) {\n\t\t\t\t\tif (dependency.trim().indexOf('[') > -1) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t// All dependencies in Pipfiles follow the format: `<package> = <version, or git repo, or something else>`\n\t\t\t\t\tif (dependency.indexOf('=') === -1) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tconst packageName = dependency.split('=')[0].trim();\n\t\t\t\t\taddPythonTags(packageName);\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\tconst packageJsonPromises = getFilePromises('package.json', this.fileService, content => {\n\t\t\t\ttry {\n\t\t\t\t\tconst packageJsonContents = JSON.parse(content.value);\n\t\t\t\t\tif (packageJsonContents['dependencies']) {\n\t\t\t\t\t\tfor (let module of ModulesToLookFor) {\n\t\t\t\t\t\t\tif ('react-native' === module) {\n\t\t\t\t\t\t\t\tif (packageJsonContents['dependencies'][module]) {\n\t\t\t\t\t\t\t\t\ttags['workspace.reactNative'] = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if ('tns-core-modules' === module) {\n\t\t\t\t\t\t\t\tif (packageJsonContents['dependencies'][module]) {\n\t\t\t\t\t\t\t\t\ttags['workspace.nativescript'] = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (packageJsonContents['dependencies'][module]) {\n\t\t\t\t\t\t\t\t\ttags['workspace.npm.' + module] = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\t// Ignore errors when resolving file or parsing file contents\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn Promise.all([...packageJsonPromises, ...requirementsTxtPromises, ...pipfilePromises]).then(() => tags);\n\t\t});\n\t}\n\n\tprivate handleWorkspaceFiles(rootFiles: string[]): void {\n\t\tconst state = this.contextService.getWorkbenchState();\n\t\tconst workspace = this.contextService.getWorkspace();\n\n\t\t// Handle top-level workspace files for local single folder workspace\n\t\tif (state === WorkbenchState.FOLDER && workspace.folders[0].uri.scheme === Schemas.file) {\n\t\t\tconst workspaceFiles = rootFiles.filter(hasWorkspaceFileExtension);\n\t\t\tif (workspaceFiles.length > 0) {\n\t\t\t\tthis.doHandleWorkspaceFiles(workspace.folders[0].uri, workspaceFiles);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate doHandleWorkspaceFiles(folder: URI, workspaces: string[]): void {\n\t\tif (this.storageService.getBoolean(WorkspaceStats.DISABLE_WORKSPACE_PROMPT_KEY, StorageScope.WORKSPACE)) {\n\t\t\treturn; // prompt disabled by user\n\t\t}\n\n\t\tconst doNotShowAgain: IPromptChoice = {\n\t\t\tlabel: localize('never again', \"Don't Show Again\"),\n\t\t\tisSecondary: true,\n\t\t\trun: () => this.storageService.store(WorkspaceStats.DISABLE_WORKSPACE_PROMPT_KEY, true, StorageScope.WORKSPACE)\n\t\t};\n\n\t\t// Prompt to open one workspace\n\t\tif (workspaces.length === 1) {\n\t\t\tconst workspaceFile = workspaces[0];\n\n\t\t\tthis.notificationService.prompt(Severity.Info, localize('workspaceFound', \"This folder contains a workspace file '{0}'. Do you want to open it? [Learn more]({1}) about workspace files.\", workspaceFile, 'https://go.microsoft.com/fwlink/?linkid=2025315'), [{\n\t\t\t\tlabel: localize('openWorkspace', \"Open Workspace\"),\n\t\t\t\trun: () => this.windowService.openWindow([{ uri: joinPath(folder, workspaceFile), typeHint: 'file' }])\n\t\t\t}, doNotShowAgain]);\n\t\t}\n\n\t\t// Prompt to select a workspace from many\n\t\telse if (workspaces.length > 1) {\n\t\t\tthis.notificationService.prompt(Severity.Info, localize('workspacesFound', \"This folder contains multiple workspace files. Do you want to open one? [Learn more]({0}) about workspace files.\", 'https://go.microsoft.com/fwlink/?linkid=2025315'), [{\n\t\t\t\tlabel: localize('selectWorkspace', \"Select Workspace\"),\n\t\t\t\trun: () => {\n\t\t\t\t\tthis.quickInputService.pick(\n\t\t\t\t\t\tworkspaces.map(workspace => ({ label: workspace } as IQuickPickItem)),\n\t\t\t\t\t\t{ placeHolder: localize('selectToOpen', \"Select a workspace to open\") }).then(pick => {\n\t\t\t\t\t\t\tif (pick) {\n\t\t\t\t\t\t\t\tthis.windowService.openWindow([{ uri: joinPath(folder, pick.label), typeHint: 'file' }]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, doNotShowAgain]);\n\t\t}\n\t}\n\n\tprivate findFolders(configuration: IWindowConfiguration): URI[] | undefined {\n\t\tconst folder = this.findFolder(configuration);\n\t\treturn folder && [folder];\n\t}\n\n\tprivate findFolder({ filesToOpen, filesToCreate, filesToDiff }: IWindowConfiguration): URI | undefined {\n\t\tif (filesToOpen && filesToOpen.length) {\n\t\t\treturn this.parentURI(filesToOpen[0].fileUri);\n\t\t} else if (filesToCreate && filesToCreate.length) {\n\t\t\treturn this.parentURI(filesToCreate[0].fileUri);\n\t\t} else if (filesToDiff && filesToDiff.length) {\n\t\t\treturn this.parentURI(filesToDiff[0].fileUri);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate parentURI(uri: URI | undefined): URI | undefined {\n\t\tif (!uri) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst path = uri.path;\n\t\tconst i = path.lastIndexOf('/');\n\t\treturn i !== -1 ? uri.with({ path: path.substr(0, i) }) : undefined;\n\t}\n\n\tprivate reportWorkspaceTags(tags: Tags): void {\n\t\t/* __GDPR__\n\t\t\t\"workspce.tags\" : {\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${WorkspaceTags}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryService.publicLog('workspce.tags', tags);\n\t\tWorkspaceStats.TAGS = tags;\n\t}\n\n\tprivate reportRemoteDomains(workspaceUris: URI[]): void {\n\t\tPromise.all<string[]>(workspaceUris.map(workspaceUri => {\n\t\t\tconst path = workspaceUri.path;\n\t\t\tconst uri = workspaceUri.with({ path: `${path !== '/' ? path : ''}/.git/config` });\n\t\t\treturn this.fileService.existsFile(uri).then(exists => {\n\t\t\t\tif (!exists) {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t\treturn this.fileService.resolveContent(uri, { acceptTextOnly: true }).then(\n\t\t\t\t\tcontent => getDomainsOfRemotes(content.value, SecondLevelDomainWhitelist),\n\t\t\t\t\terr => [] // ignore missing or binary file\n\t\t\t\t);\n\t\t\t});\n\t\t})).then(domains => {\n\t\t\tconst set = domains.reduce((set, list) => list.reduce((set, item) => set.add(item), set), new Set<string>());\n\t\t\tconst list: string[] = [];\n\t\t\tset.forEach(item => list.push(item));\n\t\t\t/* __GDPR__\n\t\t\t\t\"workspace.remotes\" : {\n\t\t\t\t\t\"domains\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.telemetryService.publicLog('workspace.remotes', { domains: list.sort() });\n\t\t}, onUnexpectedError);\n\t}\n\n\tprivate reportRemotes(workspaceUris: URI[]): void {\n\t\tPromise.all<string[]>(workspaceUris.map(workspaceUri => {\n\t\t\treturn getHashedRemotesFromUri(workspaceUri, this.fileService, true);\n\t\t})).then(hashedRemotes => {\n\t\t\t/* __GDPR__\n\t\t\t\t\t\"workspace.hashedRemotes\" : {\n\t\t\t\t\t\t\"remotes\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\t\t\t\t}\n\t\t\t\t*/\n\t\t\tthis.telemetryService.publicLog('workspace.hashedRemotes', { remotes: hashedRemotes });\n\t\t}, onUnexpectedError);\n\t}\n\n\t/* __GDPR__FRAGMENT__\n\t\t\"AzureTags\" : {\n\t\t\t\"node\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n\t\t}\n\t*/\n\tprivate reportAzureNode(workspaceUris: URI[], tags: Tags): Promise<Tags> {\n\t\t// TODO: should also work for `node_modules` folders several levels down\n\t\tconst uris = workspaceUris.map(workspaceUri => {\n\t\t\tconst path = workspaceUri.path;\n\t\t\treturn workspaceUri.with({ path: `${path !== '/' ? path : ''}/node_modules` });\n\t\t});\n\t\treturn this.fileService.resolveFiles(uris.map(resource => ({ resource }))).then(\n\t\t\tresults => {\n\t\t\t\tconst names = (<IFileStat[]>[]).concat(...results.map(result => result.success ? (result.stat!.children || []) : [])).map(c => c.name);\n\t\t\t\tconst referencesAzure = WorkspaceStats.searchArray(names, /azure/i);\n\t\t\t\tif (referencesAzure) {\n\t\t\t\t\ttags['node'] = true;\n\t\t\t\t}\n\t\t\t\treturn tags;\n\t\t\t},\n\t\t\terr => {\n\t\t\t\treturn tags;\n\t\t\t});\n\t}\n\n\t/* __GDPR__FRAGMENT__\n\t\t\"AzureTags\" : {\n\t\t\t\"java\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n\t\t}\n\t*/\n\tprivate reportAzureJava(workspaceUris: URI[], tags: Tags): Promise<Tags> {\n\t\treturn Promise.all(workspaceUris.map(workspaceUri => {\n\t\t\tconst path = workspaceUri.path;\n\t\t\tconst uri = workspaceUri.with({ path: `${path !== '/' ? path : ''}/pom.xml` });\n\t\t\treturn this.fileService.existsFile(uri).then(exists => {\n\t\t\t\tif (!exists) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn this.fileService.resolveContent(uri, { acceptTextOnly: true }).then(\n\t\t\t\t\tcontent => !!content.value.match(/azure/i),\n\t\t\t\t\terr => false\n\t\t\t\t);\n\t\t\t});\n\t\t})).then(javas => {\n\t\t\tif (javas.indexOf(true) !== -1) {\n\t\t\t\ttags['java'] = true;\n\t\t\t}\n\t\t\treturn tags;\n\t\t});\n\t}\n\n\tprivate reportAzure(uris: URI[]) {\n\t\tconst tags: Tags = Object.create(null);\n\t\tthis.reportAzureNode(uris, tags).then((tags) => {\n\t\t\treturn this.reportAzureJava(uris, tags);\n\t\t}).then((tags) => {\n\t\t\tif (Object.keys(tags).length) {\n\t\t\t\t/* __GDPR__\n\t\t\t\t\t\"workspace.azure\" : {\n\t\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\t\"${AzureTags}\"\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tthis.telemetryService.publicLog('workspace.azure', tags);\n\t\t\t}\n\t\t}).then(undefined, onUnexpectedError);\n\t}\n\n\tprivate reportCloudStats(): void {\n\t\tconst uris = this.contextService.getWorkspace().folders.map(folder => folder.uri);\n\t\tif (uris.length && this.fileService) {\n\t\t\tthis.reportRemoteDomains(uris);\n\t\t\tthis.reportRemotes(uris);\n\t\t\tthis.reportAzure(uris);\n\t\t}\n\t}\n\n\tprivate reportProxyStats() {\n\t\tthis.windowService.resolveProxy('https://www.example.com/')\n\t\t\t.then(proxy => {\n\t\t\t\tlet type = proxy ? String(proxy).trim().split(/\\s+/, 1)[0] : 'EMPTY';\n\t\t\t\tif (['DIRECT', 'PROXY', 'HTTPS', 'SOCKS', 'EMPTY'].indexOf(type) === -1) {\n\t\t\t\t\ttype = 'UNKNOWN';\n\t\t\t\t}\n\t\t\t\t/* __GDPR__\n\t\t\t\t\t\"resolveProxy.stats\" : {\n\t\t\t\t\t\t\"type\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" }\n\t\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tthis.telemetryService.publicLog('resolveProxy.stats', { type });\n\t\t\t}).then(undefined, onUnexpectedError);\n\t}\n}\n"]}]}