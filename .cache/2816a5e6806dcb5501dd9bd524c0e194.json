{"remainingRequest":"/home/coding/workspace/node_modules/ts-loader/index.js?{\"happyPackMode\":true,\"compilerOptions\":{\"target\":\"es5\",\"lib\":[\"dom\",\"esnext\"]}}!/home/coding/workspace/lib/vscode/src/vs/workbench/contrib/markers/browser/markersTreeViewer.ts","dependencies":[{"path":"/home/coding/workspace/lib/vscode/src/vs/workbench/contrib/markers/browser/markersTreeViewer.ts","mtime":1555102317000},{"path":"/home/coding/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1555844183884},{"path":"/home/coding/workspace/node_modules/ts-loader/index.js","mtime":1555844217316}],"contextDependencies":[],"result":["\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar dom = require(\"vs/base/browser/dom\");\nvar network = require(\"vs/base/common/network\");\nvar paths = require(\"vs/base/common/path\");\nvar countBadge_1 = require(\"vs/base/browser/ui/countBadge/countBadge\");\nvar highlightedLabel_1 = require(\"vs/base/browser/ui/highlightedlabel/highlightedLabel\");\nvar markers_1 = require(\"vs/platform/markers/common/markers\");\nvar markersModel_1 = require(\"vs/workbench/contrib/markers/browser/markersModel\");\nvar messages_1 = require(\"vs/workbench/contrib/markers/browser/messages\");\nvar instantiation_1 = require(\"vs/platform/instantiation/common/instantiation\");\nvar styler_1 = require(\"vs/platform/theme/common/styler\");\nvar themeService_1 = require(\"vs/platform/theme/common/themeService\");\nvar lifecycle_1 = require(\"vs/base/common/lifecycle\");\nvar actionbar_1 = require(\"vs/base/browser/ui/actionbar/actionbar\");\nvar markersPanelActions_1 = require(\"vs/workbench/contrib/markers/browser/markersPanelActions\");\nvar label_1 = require(\"vs/platform/label/common/label\");\nvar resources_1 = require(\"vs/base/common/resources\");\nvar tree_1 = require(\"vs/base/browser/ui/tree/tree\");\nvar markersFilterOptions_1 = require(\"vs/workbench/contrib/markers/browser/markersFilterOptions\");\nvar event_1 = require(\"vs/base/common/event\");\nvar types_1 = require(\"vs/base/common/types\");\nvar actions_1 = require(\"vs/base/common/actions\");\nvar nls_1 = require(\"vs/nls\");\nvar dnd_1 = require(\"vs/workbench/browser/dnd\");\nvar async_1 = require(\"vs/base/common/async\");\nvar modelService_1 = require(\"vs/editor/common/services/modelService\");\nvar range_1 = require(\"vs/editor/common/core/range\");\nvar codeAction_1 = require(\"vs/editor/contrib/codeAction/codeAction\");\nvar codeActionTrigger_1 = require(\"vs/editor/contrib/codeAction/codeActionTrigger\");\nvar bulkEditService_1 = require(\"vs/editor/browser/services/bulkEditService\");\nvar commands_1 = require(\"vs/platform/commands/common/commands\");\nvar editorService_1 = require(\"vs/workbench/services/editor/common/editorService\");\nvar codeActionCommands_1 = require(\"vs/editor/contrib/codeAction/codeActionCommands\");\nvar MarkersTreeAccessibilityProvider = /** @class */ (function () {\n    function MarkersTreeAccessibilityProvider(labelService) {\n        this.labelService = labelService;\n    }\n    MarkersTreeAccessibilityProvider.prototype.getAriaLabel = function (element) {\n        if (element instanceof markersModel_1.ResourceMarkers) {\n            var path = this.labelService.getUriLabel(element.resource, { relative: true }) || element.resource.fsPath;\n            return messages_1.default.MARKERS_TREE_ARIA_LABEL_RESOURCE(element.markers.length, element.name, paths.dirname(path));\n        }\n        if (element instanceof markersModel_1.Marker) {\n            return messages_1.default.MARKERS_TREE_ARIA_LABEL_MARKER(element);\n        }\n        if (element instanceof markersModel_1.RelatedInformation) {\n            return messages_1.default.MARKERS_TREE_ARIA_LABEL_RELATED_INFORMATION(element.raw);\n        }\n        return null;\n    };\n    MarkersTreeAccessibilityProvider = tslib_1.__decorate([\n        tslib_1.__param(0, label_1.ILabelService)\n    ], MarkersTreeAccessibilityProvider);\n    return MarkersTreeAccessibilityProvider;\n}());\nexports.MarkersTreeAccessibilityProvider = MarkersTreeAccessibilityProvider;\nvar TemplateId;\n(function (TemplateId) {\n    TemplateId[\"ResourceMarkers\"] = \"rm\";\n    TemplateId[\"Marker\"] = \"m\";\n    TemplateId[\"RelatedInformation\"] = \"ri\";\n})(TemplateId || (TemplateId = {}));\nvar VirtualDelegate = /** @class */ (function () {\n    function VirtualDelegate(markersViewState) {\n        this.markersViewState = markersViewState;\n    }\n    VirtualDelegate.prototype.getHeight = function (element) {\n        if (element instanceof markersModel_1.Marker) {\n            var viewModel = this.markersViewState.getViewModel(element);\n            var noOfLines = !viewModel || viewModel.multiline ? element.lines.length : 1;\n            return noOfLines * VirtualDelegate.LINE_HEIGHT;\n        }\n        return VirtualDelegate.LINE_HEIGHT;\n    };\n    VirtualDelegate.prototype.getTemplateId = function (element) {\n        if (element instanceof markersModel_1.ResourceMarkers) {\n            return TemplateId.ResourceMarkers;\n        }\n        else if (element instanceof markersModel_1.Marker) {\n            return TemplateId.Marker;\n        }\n        else {\n            return TemplateId.RelatedInformation;\n        }\n    };\n    VirtualDelegate.LINE_HEIGHT = 22;\n    return VirtualDelegate;\n}());\nexports.VirtualDelegate = VirtualDelegate;\nvar FilterDataType;\n(function (FilterDataType) {\n    FilterDataType[FilterDataType[\"ResourceMarkers\"] = 0] = \"ResourceMarkers\";\n    FilterDataType[FilterDataType[\"Marker\"] = 1] = \"Marker\";\n    FilterDataType[FilterDataType[\"RelatedInformation\"] = 2] = \"RelatedInformation\";\n})(FilterDataType || (FilterDataType = {}));\nvar ResourceMarkersRenderer = /** @class */ (function () {\n    function ResourceMarkersRenderer(labels, onDidChangeRenderNodeCount, themeService, labelService) {\n        this.labels = labels;\n        this.themeService = themeService;\n        this.labelService = labelService;\n        this.renderedNodes = new Map();\n        this.disposables = [];\n        this.templateId = TemplateId.ResourceMarkers;\n        onDidChangeRenderNodeCount(this.onDidChangeRenderNodeCount, this, this.disposables);\n    }\n    ResourceMarkersRenderer.prototype.renderTemplate = function (container) {\n        var data = Object.create(null);\n        var resourceLabelContainer = dom.append(container, dom.$('.resource-label-container'));\n        data.resourceLabel = this.labels.create(resourceLabelContainer, { supportHighlights: true });\n        var badgeWrapper = dom.append(container, dom.$('.count-badge-wrapper'));\n        data.count = new countBadge_1.CountBadge(badgeWrapper);\n        data.styler = styler_1.attachBadgeStyler(data.count, this.themeService);\n        return data;\n    };\n    ResourceMarkersRenderer.prototype.renderElement = function (node, _, templateData) {\n        var resourceMarkers = node.element;\n        var uriMatches = node.filterData && node.filterData.uriMatches || [];\n        if (resourceMarkers.resource.scheme === network.Schemas.file || resourceMarkers.resource.scheme === network.Schemas.untitled) {\n            templateData.resourceLabel.setFile(resourceMarkers.resource, { matches: uriMatches });\n        }\n        else {\n            templateData.resourceLabel.setResource({ name: resourceMarkers.name, description: this.labelService.getUriLabel(resources_1.dirname(resourceMarkers.resource), { relative: true }), resource: resourceMarkers.resource }, { matches: uriMatches });\n        }\n        this.updateCount(node, templateData);\n        this.renderedNodes.set(node, templateData);\n    };\n    ResourceMarkersRenderer.prototype.disposeElement = function (node) {\n        this.renderedNodes.delete(node);\n    };\n    ResourceMarkersRenderer.prototype.disposeTemplate = function (templateData) {\n        templateData.resourceLabel.dispose();\n        templateData.styler.dispose();\n    };\n    ResourceMarkersRenderer.prototype.onDidChangeRenderNodeCount = function (node) {\n        var templateData = this.renderedNodes.get(node);\n        if (!templateData) {\n            return;\n        }\n        this.updateCount(node, templateData);\n    };\n    ResourceMarkersRenderer.prototype.updateCount = function (node, templateData) {\n        templateData.count.setCount(node.children.reduce(function (r, n) { return r + (n.visible ? 1 : 0); }, 0));\n    };\n    ResourceMarkersRenderer.prototype.dispose = function () {\n        this.disposables = lifecycle_1.dispose(this.disposables);\n    };\n    ResourceMarkersRenderer = tslib_1.__decorate([\n        tslib_1.__param(2, themeService_1.IThemeService),\n        tslib_1.__param(3, label_1.ILabelService)\n    ], ResourceMarkersRenderer);\n    return ResourceMarkersRenderer;\n}());\nexports.ResourceMarkersRenderer = ResourceMarkersRenderer;\nvar FileResourceMarkersRenderer = /** @class */ (function (_super) {\n    tslib_1.__extends(FileResourceMarkersRenderer, _super);\n    function FileResourceMarkersRenderer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return FileResourceMarkersRenderer;\n}(ResourceMarkersRenderer));\nexports.FileResourceMarkersRenderer = FileResourceMarkersRenderer;\nvar MarkerRenderer = /** @class */ (function () {\n    function MarkerRenderer(markersViewState, instantiationService) {\n        this.markersViewState = markersViewState;\n        this.instantiationService = instantiationService;\n        this.templateId = TemplateId.Marker;\n    }\n    MarkerRenderer.prototype.renderTemplate = function (container) {\n        var data = Object.create(null);\n        data.markerWidget = new MarkerWidget(container, this.markersViewState, this.instantiationService);\n        return data;\n    };\n    MarkerRenderer.prototype.renderElement = function (node, _, templateData) {\n        templateData.markerWidget.render(node.element, node.filterData);\n    };\n    MarkerRenderer.prototype.disposeTemplate = function (templateData) {\n        templateData.markerWidget.dispose();\n    };\n    MarkerRenderer = tslib_1.__decorate([\n        tslib_1.__param(1, instantiation_1.IInstantiationService)\n    ], MarkerRenderer);\n    return MarkerRenderer;\n}());\nexports.MarkerRenderer = MarkerRenderer;\nvar MarkerWidget = /** @class */ (function (_super) {\n    tslib_1.__extends(MarkerWidget, _super);\n    function MarkerWidget(parent, markersViewModel, instantiationService) {\n        var _this = _super.call(this) || this;\n        _this.parent = parent;\n        _this.markersViewModel = markersViewModel;\n        _this.disposables = [];\n        _this.actionBar = _this._register(new actionbar_1.ActionBar(dom.append(parent, dom.$('.actions')), {\n            actionItemProvider: function (action) { return action.id === markersPanelActions_1.QuickFixAction.ID ? instantiationService.createInstance(markersPanelActions_1.QuickFixActionItem, action) : undefined; }\n        }));\n        _this.icon = dom.append(parent, dom.$('.icon'));\n        _this.multilineActionbar = _this._register(new actionbar_1.ActionBar(dom.append(parent, dom.$('.multiline-actions'))));\n        _this.messageAndDetailsContainer = dom.append(parent, dom.$('.marker-message-details'));\n        _this._register(lifecycle_1.toDisposable(function () { return _this.disposables = lifecycle_1.dispose(_this.disposables); }));\n        return _this;\n    }\n    MarkerWidget.prototype.render = function (element, filterData) {\n        var _this = this;\n        this.actionBar.clear();\n        this.multilineActionbar.clear();\n        if (this.disposables.length) {\n            this.disposables = lifecycle_1.dispose(this.disposables);\n        }\n        dom.clearNode(this.messageAndDetailsContainer);\n        this.icon.className = 'marker-icon ' + MarkerWidget.iconClassNameFor(element.marker);\n        this.renderQuickfixActionbar(element);\n        this.renderMultilineActionbar(element);\n        this.renderMessageAndDetails(element, filterData);\n        this.disposables.push(dom.addDisposableListener(this.parent, dom.EventType.MOUSE_OVER, function () { return _this.markersViewModel.onMarkerMouseHover(element); }));\n        this.disposables.push(dom.addDisposableListener(this.parent, dom.EventType.MOUSE_LEAVE, function () { return _this.markersViewModel.onMarkerMouseLeave(element); }));\n    };\n    MarkerWidget.prototype.renderQuickfixActionbar = function (marker) {\n        var _this = this;\n        var viewModel = this.markersViewModel.getViewModel(marker);\n        if (viewModel) {\n            var quickFixAction = viewModel.quickFixAction;\n            this.actionBar.push([quickFixAction], { icon: true, label: false });\n            dom.toggleClass(this.icon, 'quickFix', quickFixAction.enabled);\n            quickFixAction.onDidChange(function (_a) {\n                var enabled = _a.enabled;\n                if (!types_1.isUndefinedOrNull(enabled)) {\n                    dom.toggleClass(_this.icon, 'quickFix', enabled);\n                }\n            }, this, this.disposables);\n            quickFixAction.onShowQuickFixes(function () {\n                var quickFixActionItem = _this.actionBar.items[0];\n                if (quickFixActionItem) {\n                    quickFixActionItem.showQuickFixes();\n                }\n            }, this, this.disposables);\n        }\n    };\n    MarkerWidget.prototype.renderMultilineActionbar = function (marker) {\n        var viewModel = this.markersViewModel.getViewModel(marker);\n        var multiline = viewModel && viewModel.multiline;\n        var action = new actions_1.Action('problems.action.toggleMultiline');\n        action.enabled = !!viewModel && marker.lines.length > 1;\n        action.tooltip = multiline ? nls_1.localize('single line', \"Show message in single line\") : nls_1.localize('multi line', \"Show message in multiple lines\");\n        action.class = multiline ? 'octicon octicon-chevron-up' : 'octicon octicon-chevron-down';\n        action.run = function () { if (viewModel) {\n            viewModel.multiline = !viewModel.multiline;\n        } return Promise.resolve(); };\n        this.multilineActionbar.push([action], { icon: true, label: false });\n    };\n    MarkerWidget.prototype.renderMessageAndDetails = function (element, filterData) {\n        var marker = element.marker, lines = element.lines;\n        var viewState = this.markersViewModel.getViewModel(element);\n        var multiline = !viewState || viewState.multiline;\n        var lineMatches = filterData && filterData.lineMatches || [];\n        var messageContainer = dom.append(this.messageAndDetailsContainer, dom.$('.marker-message'));\n        dom.toggleClass(messageContainer, 'multiline', multiline);\n        var lastLineElement = messageContainer;\n        for (var index = 0; index < (multiline ? lines.length : 1); index++) {\n            lastLineElement = dom.append(messageContainer, dom.$('.marker-message-line'));\n            var highlightedLabel = new highlightedLabel_1.HighlightedLabel(lastLineElement, false);\n            highlightedLabel.set(lines[index], lineMatches[index]);\n            if (lines[index] === '') {\n                lastLineElement.style.height = VirtualDelegate.LINE_HEIGHT + \"px\";\n            }\n        }\n        this.renderDetails(marker, filterData, multiline ? lastLineElement : this.messageAndDetailsContainer);\n    };\n    MarkerWidget.prototype.renderDetails = function (marker, filterData, parent) {\n        dom.addClass(parent, 'details-container');\n        var sourceMatches = filterData && filterData.sourceMatches || [];\n        var codeMatches = filterData && filterData.codeMatches || [];\n        var source = new highlightedLabel_1.HighlightedLabel(dom.append(parent, dom.$('')), false);\n        source.set(marker.source, sourceMatches);\n        dom.toggleClass(source.element, 'marker-source', !!marker.source);\n        var code = new highlightedLabel_1.HighlightedLabel(dom.append(parent, dom.$('')), false);\n        code.set(marker.code, codeMatches);\n        dom.toggleClass(code.element, 'marker-code', !!marker.code);\n        var lnCol = dom.append(parent, dom.$('span.marker-line'));\n        lnCol.textContent = messages_1.default.MARKERS_PANEL_AT_LINE_COL_NUMBER(marker.startLineNumber, marker.startColumn);\n    };\n    MarkerWidget.iconClassNameFor = function (element) {\n        switch (element.severity) {\n            case markers_1.MarkerSeverity.Hint:\n                return 'info';\n            case markers_1.MarkerSeverity.Info:\n                return 'info';\n            case markers_1.MarkerSeverity.Warning:\n                return 'warning';\n            case markers_1.MarkerSeverity.Error:\n                return 'error';\n        }\n        return '';\n    };\n    return MarkerWidget;\n}(lifecycle_1.Disposable));\nvar RelatedInformationRenderer = /** @class */ (function () {\n    function RelatedInformationRenderer(labelService) {\n        this.labelService = labelService;\n        this.templateId = TemplateId.RelatedInformation;\n    }\n    RelatedInformationRenderer.prototype.renderTemplate = function (container) {\n        var data = Object.create(null);\n        dom.append(container, dom.$('.actions'));\n        dom.append(container, dom.$('.icon'));\n        data.resourceLabel = new highlightedLabel_1.HighlightedLabel(dom.append(container, dom.$('.related-info-resource')), false);\n        data.lnCol = dom.append(container, dom.$('span.marker-line'));\n        var separator = dom.append(container, dom.$('span.related-info-resource-separator'));\n        separator.textContent = ':';\n        separator.style.paddingRight = '4px';\n        data.description = new highlightedLabel_1.HighlightedLabel(dom.append(container, dom.$('.marker-description')), false);\n        return data;\n    };\n    RelatedInformationRenderer.prototype.renderElement = function (node, _, templateData) {\n        var relatedInformation = node.element.raw;\n        var uriMatches = node.filterData && node.filterData.uriMatches || [];\n        var messageMatches = node.filterData && node.filterData.messageMatches || [];\n        templateData.resourceLabel.set(resources_1.basename(relatedInformation.resource), uriMatches);\n        templateData.resourceLabel.element.title = this.labelService.getUriLabel(relatedInformation.resource, { relative: true });\n        templateData.lnCol.textContent = messages_1.default.MARKERS_PANEL_AT_LINE_COL_NUMBER(relatedInformation.startLineNumber, relatedInformation.startColumn);\n        templateData.description.set(relatedInformation.message, messageMatches);\n        templateData.description.element.title = relatedInformation.message;\n    };\n    RelatedInformationRenderer.prototype.disposeTemplate = function (templateData) {\n        // noop\n    };\n    RelatedInformationRenderer = tslib_1.__decorate([\n        tslib_1.__param(0, label_1.ILabelService)\n    ], RelatedInformationRenderer);\n    return RelatedInformationRenderer;\n}());\nexports.RelatedInformationRenderer = RelatedInformationRenderer;\nvar Filter = /** @class */ (function () {\n    function Filter(options) {\n        this.options = options;\n    }\n    Filter.prototype.filter = function (element, parentVisibility) {\n        if (element instanceof markersModel_1.ResourceMarkers) {\n            return this.filterResourceMarkers(element);\n        }\n        else if (element instanceof markersModel_1.Marker) {\n            return this.filterMarker(element, parentVisibility);\n        }\n        else {\n            return this.filterRelatedInformation(element, parentVisibility);\n        }\n    };\n    Filter.prototype.filterResourceMarkers = function (resourceMarkers) {\n        if (resourceMarkers.resource.scheme === network.Schemas.walkThrough || resourceMarkers.resource.scheme === network.Schemas.walkThroughSnippet) {\n            return false;\n        }\n        if (this.options.excludesMatcher.matches(resourceMarkers.resource)) {\n            return false;\n        }\n        var uriMatches = markersFilterOptions_1.FilterOptions._filter(this.options.textFilter, resources_1.basename(resourceMarkers.resource));\n        if (this.options.textFilter && uriMatches) {\n            return { visibility: true, data: { type: FilterDataType.ResourceMarkers, uriMatches: uriMatches } };\n        }\n        if (this.options.includesMatcher.matches(resourceMarkers.resource)) {\n            return true;\n        }\n        return tree_1.TreeVisibility.Recurse;\n    };\n    Filter.prototype.filterMarker = function (marker, parentVisibility) {\n        if (this.options.filterErrors && markers_1.MarkerSeverity.Error === marker.marker.severity) {\n            return true;\n        }\n        if (this.options.filterWarnings && markers_1.MarkerSeverity.Warning === marker.marker.severity) {\n            return true;\n        }\n        if (this.options.filterInfos && markers_1.MarkerSeverity.Info === marker.marker.severity) {\n            return true;\n        }\n        if (!this.options.textFilter) {\n            return true;\n        }\n        var lineMatches = [];\n        for (var _i = 0, _a = marker.lines; _i < _a.length; _i++) {\n            var line = _a[_i];\n            lineMatches.push(markersFilterOptions_1.FilterOptions._messageFilter(this.options.textFilter, line) || []);\n        }\n        var sourceMatches = marker.marker.source && markersFilterOptions_1.FilterOptions._filter(this.options.textFilter, marker.marker.source);\n        var codeMatches = marker.marker.code && markersFilterOptions_1.FilterOptions._filter(this.options.textFilter, marker.marker.code);\n        if (sourceMatches || codeMatches || lineMatches.some(function (lineMatch) { return lineMatch.length > 0; })) {\n            return { visibility: true, data: { type: FilterDataType.Marker, lineMatches: lineMatches, sourceMatches: sourceMatches || [], codeMatches: codeMatches || [] } };\n        }\n        return parentVisibility;\n    };\n    Filter.prototype.filterRelatedInformation = function (relatedInformation, parentVisibility) {\n        if (!this.options.textFilter) {\n            return true;\n        }\n        var uriMatches = markersFilterOptions_1.FilterOptions._filter(this.options.textFilter, resources_1.basename(relatedInformation.raw.resource));\n        var messageMatches = markersFilterOptions_1.FilterOptions._messageFilter(this.options.textFilter, paths.basename(relatedInformation.raw.message));\n        if (uriMatches || messageMatches) {\n            return { visibility: true, data: { type: FilterDataType.RelatedInformation, uriMatches: uriMatches || [], messageMatches: messageMatches || [] } };\n        }\n        return parentVisibility;\n    };\n    return Filter;\n}());\nexports.Filter = Filter;\nvar MarkerViewModel = /** @class */ (function (_super) {\n    tslib_1.__extends(MarkerViewModel, _super);\n    function MarkerViewModel(marker, modelService, instantiationService, bulkEditService, commandService, editorService) {\n        var _this = _super.call(this) || this;\n        _this.marker = marker;\n        _this.modelService = modelService;\n        _this.instantiationService = instantiationService;\n        _this.bulkEditService = bulkEditService;\n        _this.commandService = commandService;\n        _this.editorService = editorService;\n        _this._onDidChange = _this._register(new event_1.Emitter());\n        _this.onDidChange = _this._onDidChange.event;\n        _this.modelPromise = null;\n        _this.codeActionsPromise = null;\n        _this._multiline = true;\n        _this._register(lifecycle_1.toDisposable(function () {\n            if (_this.modelPromise) {\n                _this.modelPromise.cancel();\n            }\n            if (_this.codeActionsPromise) {\n                _this.codeActionsPromise.cancel();\n            }\n        }));\n        return _this;\n    }\n    Object.defineProperty(MarkerViewModel.prototype, \"multiline\", {\n        get: function () {\n            return this._multiline;\n        },\n        set: function (value) {\n            if (this._multiline !== value) {\n                this._multiline = value;\n                this._onDidChange.fire();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MarkerViewModel.prototype, \"quickFixAction\", {\n        get: function () {\n            if (!this._quickFixAction) {\n                this._quickFixAction = this._register(this.instantiationService.createInstance(markersPanelActions_1.QuickFixAction, this.marker));\n            }\n            return this._quickFixAction;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    MarkerViewModel.prototype.showLightBulb = function () {\n        this.setQuickFixes(true);\n    };\n    MarkerViewModel.prototype.showQuickfixes = function () {\n        var _this = this;\n        this.setQuickFixes(false).then(function () { return _this.quickFixAction.run(); });\n    };\n    MarkerViewModel.prototype.getQuickFixes = function (waitForModel) {\n        return tslib_1.__awaiter(this, void 0, Promise, function () {\n            var codeActions;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getCodeActions(waitForModel)];\n                    case 1:\n                        codeActions = _a.sent();\n                        return [2 /*return*/, codeActions ? this.toActions(codeActions) : []];\n                }\n            });\n        });\n    };\n    MarkerViewModel.prototype.setQuickFixes = function (waitForModel) {\n        return tslib_1.__awaiter(this, void 0, Promise, function () {\n            var codeActions;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getCodeActions(waitForModel)];\n                    case 1:\n                        codeActions = _a.sent();\n                        this.quickFixAction.quickFixes = codeActions ? this.toActions(codeActions) : [];\n                        this.quickFixAction.autoFixable(!!codeActions && codeActions.hasAutoFix);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    MarkerViewModel.prototype.getCodeActions = function (waitForModel) {\n        var _this = this;\n        if (this.codeActionsPromise !== null) {\n            return this.codeActionsPromise;\n        }\n        return this.getModel(waitForModel)\n            .then(function (model) {\n            if (model) {\n                if (!_this.codeActionsPromise) {\n                    _this.codeActionsPromise = async_1.createCancelablePromise(function (cancellationToken) {\n                        return codeAction_1.getCodeActions(model, new range_1.Range(_this.marker.range.startLineNumber, _this.marker.range.startColumn, _this.marker.range.endLineNumber, _this.marker.range.endColumn), { type: 'manual', filter: { kind: codeActionTrigger_1.CodeActionKind.QuickFix } }, cancellationToken);\n                    });\n                }\n                return _this.codeActionsPromise;\n            }\n            return null;\n        });\n    };\n    MarkerViewModel.prototype.toActions = function (codeActions) {\n        var _this = this;\n        return codeActions.actions.map(function (codeAction) { return new actions_1.Action(codeAction.command ? codeAction.command.id : codeAction.title, codeAction.title, undefined, true, function () {\n            return _this.openFileAtMarker(_this.marker)\n                .then(function () { return codeActionCommands_1.applyCodeAction(codeAction, _this.bulkEditService, _this.commandService); });\n        }); });\n    };\n    MarkerViewModel.prototype.openFileAtMarker = function (element) {\n        var _a = { resource: element.resource, selection: element.range }, resource = _a.resource, selection = _a.selection;\n        return this.editorService.openEditor({\n            resource: resource,\n            options: {\n                selection: selection,\n                preserveFocus: true,\n                pinned: false,\n                revealIfVisible: true\n            },\n        }, editorService_1.ACTIVE_GROUP).then(function () { return undefined; });\n    };\n    MarkerViewModel.prototype.getModel = function (waitForModel) {\n        var _this = this;\n        var model = this.modelService.getModel(this.marker.resource);\n        if (model) {\n            return Promise.resolve(model);\n        }\n        if (waitForModel) {\n            if (this.modelPromise === null) {\n                this.modelPromise = async_1.createCancelablePromise(function (cancellationToken) {\n                    return new Promise(function (c) {\n                        _this._register(_this.modelService.onModelAdded(function (model) {\n                            if (resources_1.isEqual(model.uri, _this.marker.resource)) {\n                                c(model);\n                            }\n                        }));\n                    });\n                });\n            }\n            return this.modelPromise;\n        }\n        return Promise.resolve(null);\n    };\n    MarkerViewModel = tslib_1.__decorate([\n        tslib_1.__param(1, modelService_1.IModelService),\n        tslib_1.__param(2, instantiation_1.IInstantiationService),\n        tslib_1.__param(3, bulkEditService_1.IBulkEditService),\n        tslib_1.__param(4, commands_1.ICommandService),\n        tslib_1.__param(5, editorService_1.IEditorService)\n    ], MarkerViewModel);\n    return MarkerViewModel;\n}(lifecycle_1.Disposable));\nexports.MarkerViewModel = MarkerViewModel;\nvar MarkersViewModel = /** @class */ (function (_super) {\n    tslib_1.__extends(MarkersViewModel, _super);\n    function MarkersViewModel(multiline, instantiationService) {\n        if (multiline === void 0) { multiline = true; }\n        var _this = _super.call(this) || this;\n        _this.instantiationService = instantiationService;\n        _this._onDidChange = _this._register(new event_1.Emitter());\n        _this.onDidChange = _this._onDidChange.event;\n        _this.markersViewStates = new Map();\n        _this.markersPerResource = new Map();\n        _this.bulkUpdate = false;\n        _this.hoverDelayer = new async_1.Delayer(300);\n        _this._multiline = true;\n        _this._multiline = multiline;\n        return _this;\n    }\n    MarkersViewModel.prototype.add = function (marker) {\n        var _this = this;\n        if (!this.markersViewStates.has(marker.hash)) {\n            var viewModel = this.instantiationService.createInstance(MarkerViewModel, marker);\n            var disposables = [viewModel];\n            viewModel.multiline = this.multiline;\n            viewModel.onDidChange(function () {\n                if (!_this.bulkUpdate) {\n                    _this._onDidChange.fire(marker);\n                }\n            }, this, disposables);\n            this.markersViewStates.set(marker.hash, { viewModel: viewModel, disposables: disposables });\n            var markers = this.markersPerResource.get(marker.resource.toString()) || [];\n            markers.push(marker);\n            this.markersPerResource.set(marker.resource.toString(), markers);\n        }\n    };\n    MarkersViewModel.prototype.remove = function (resource) {\n        var markers = this.markersPerResource.get(resource.toString()) || [];\n        for (var _i = 0, markers_2 = markers; _i < markers_2.length; _i++) {\n            var marker = markers_2[_i];\n            var value = this.markersViewStates.get(marker.hash);\n            if (value) {\n                lifecycle_1.dispose(value.disposables);\n            }\n            this.markersViewStates.delete(marker.hash);\n            if (this.hoveredMarker === marker) {\n                this.hoveredMarker = null;\n            }\n        }\n        this.markersPerResource.delete(resource.toString());\n    };\n    MarkersViewModel.prototype.getViewModel = function (marker) {\n        var value = this.markersViewStates.get(marker.hash);\n        return value ? value.viewModel : null;\n    };\n    MarkersViewModel.prototype.onMarkerMouseHover = function (marker) {\n        var _this = this;\n        this.hoveredMarker = marker;\n        this.hoverDelayer.trigger(function () {\n            if (_this.hoveredMarker) {\n                var model = _this.getViewModel(_this.hoveredMarker);\n                if (model) {\n                    model.showLightBulb();\n                }\n            }\n        });\n    };\n    MarkersViewModel.prototype.onMarkerMouseLeave = function (marker) {\n        if (this.hoveredMarker === marker) {\n            this.hoveredMarker = null;\n        }\n    };\n    Object.defineProperty(MarkersViewModel.prototype, \"multiline\", {\n        get: function () {\n            return this._multiline;\n        },\n        set: function (value) {\n            var changed = false;\n            if (this._multiline !== value) {\n                this._multiline = value;\n                changed = true;\n            }\n            this.bulkUpdate = true;\n            this.markersViewStates.forEach(function (_a) {\n                var viewModel = _a.viewModel;\n                if (viewModel.multiline !== value) {\n                    viewModel.multiline = value;\n                    changed = true;\n                }\n            });\n            this.bulkUpdate = false;\n            if (changed) {\n                this._onDidChange.fire(undefined);\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    MarkersViewModel.prototype.dispose = function () {\n        this.markersViewStates.forEach(function (_a) {\n            var disposables = _a.disposables;\n            return lifecycle_1.dispose(disposables);\n        });\n        this.markersViewStates.clear();\n        this.markersPerResource.clear();\n        _super.prototype.dispose.call(this);\n    };\n    MarkersViewModel = tslib_1.__decorate([\n        tslib_1.__param(1, instantiation_1.IInstantiationService)\n    ], MarkersViewModel);\n    return MarkersViewModel;\n}(lifecycle_1.Disposable));\nexports.MarkersViewModel = MarkersViewModel;\nvar ResourceDragAndDrop = /** @class */ (function () {\n    function ResourceDragAndDrop(instantiationService) {\n        this.instantiationService = instantiationService;\n    }\n    ResourceDragAndDrop.prototype.onDragOver = function (data, targetElement, targetIndex, originalEvent) {\n        return false;\n    };\n    ResourceDragAndDrop.prototype.getDragURI = function (element) {\n        if (element instanceof markersModel_1.ResourceMarkers) {\n            return element.resource.toString();\n        }\n        return null;\n    };\n    ResourceDragAndDrop.prototype.getDragLabel = function (elements) {\n        if (elements.length > 1) {\n            return String(elements.length);\n        }\n        var element = elements[0];\n        return element instanceof markersModel_1.ResourceMarkers ? resources_1.basename(element.resource) : undefined;\n    };\n    ResourceDragAndDrop.prototype.onDragStart = function (data, originalEvent) {\n        var elements = data.elements;\n        var resources = elements\n            .filter(function (e) { return e instanceof markersModel_1.ResourceMarkers; })\n            .map(function (resourceMarker) { return resourceMarker.resource; });\n        if (resources.length) {\n            // Apply some datatransfer types to allow for dragging the element outside of the application\n            this.instantiationService.invokeFunction(dnd_1.fillResourceDataTransfers, resources, originalEvent);\n        }\n    };\n    ResourceDragAndDrop.prototype.drop = function (data, targetElement, targetIndex, originalEvent) {\n    };\n    return ResourceDragAndDrop;\n}());\nexports.ResourceDragAndDrop = ResourceDragAndDrop;\n",{"version":3,"file":"/home/coding/workspace/lib/vscode/src/vs/workbench/contrib/markers/browser/markersTreeViewer.ts","sourceRoot":"","sources":["/home/coding/workspace/lib/vscode/src/vs/workbench/contrib/markers/browser/markersTreeViewer.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from 'vs/base/browser/dom';\nimport * as network from 'vs/base/common/network';\nimport * as paths from 'vs/base/common/path';\nimport { CountBadge } from 'vs/base/browser/ui/countBadge/countBadge';\nimport { ResourceLabels, IResourceLabel } from 'vs/workbench/browser/labels';\nimport { HighlightedLabel } from 'vs/base/browser/ui/highlightedlabel/highlightedLabel';\nimport { IMarker, MarkerSeverity } from 'vs/platform/markers/common/markers';\nimport { ResourceMarkers, Marker, RelatedInformation } from 'vs/workbench/contrib/markers/browser/markersModel';\nimport Messages from 'vs/workbench/contrib/markers/browser/messages';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { attachBadgeStyler } from 'vs/platform/theme/common/styler';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { IDisposable, dispose, Disposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { ActionBar } from 'vs/base/browser/ui/actionbar/actionbar';\nimport { QuickFixAction, QuickFixActionItem } from 'vs/workbench/contrib/markers/browser/markersPanelActions';\nimport { ILabelService } from 'vs/platform/label/common/label';\nimport { dirname, basename, isEqual } from 'vs/base/common/resources';\nimport { IListVirtualDelegate } from 'vs/base/browser/ui/list/list';\nimport { ITreeFilter, TreeVisibility, TreeFilterResult, ITreeRenderer, ITreeNode, ITreeDragAndDrop, ITreeDragOverReaction } from 'vs/base/browser/ui/tree/tree';\nimport { FilterOptions } from 'vs/workbench/contrib/markers/browser/markersFilterOptions';\nimport { IMatch } from 'vs/base/common/filters';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { IAccessibilityProvider } from 'vs/base/browser/ui/list/listWidget';\nimport { isUndefinedOrNull } from 'vs/base/common/types';\nimport { URI } from 'vs/base/common/uri';\nimport { Action, IAction } from 'vs/base/common/actions';\nimport { localize } from 'vs/nls';\nimport { IDragAndDropData } from 'vs/base/browser/dnd';\nimport { ElementsDragAndDropData } from 'vs/base/browser/ui/list/listView';\nimport { fillResourceDataTransfers } from 'vs/workbench/browser/dnd';\nimport { CancelablePromise, createCancelablePromise, Delayer } from 'vs/base/common/async';\nimport { IModelService } from 'vs/editor/common/services/modelService';\nimport { Range } from 'vs/editor/common/core/range';\nimport { getCodeActions, CodeActionSet } from 'vs/editor/contrib/codeAction/codeAction';\nimport { CodeActionKind } from 'vs/editor/contrib/codeAction/codeActionTrigger';\nimport { ITextModel } from 'vs/editor/common/model';\nimport { IBulkEditService } from 'vs/editor/browser/services/bulkEditService';\nimport { ICommandService } from 'vs/platform/commands/common/commands';\nimport { IEditorService, ACTIVE_GROUP } from 'vs/workbench/services/editor/common/editorService';\nimport { applyCodeAction } from 'vs/editor/contrib/codeAction/codeActionCommands';\n\nexport type TreeElement = ResourceMarkers | Marker | RelatedInformation;\n\ninterface IResourceMarkersTemplateData {\n\tresourceLabel: IResourceLabel;\n\tcount: CountBadge;\n\tstyler: IDisposable;\n}\n\ninterface IMarkerTemplateData {\n\tmarkerWidget: MarkerWidget;\n}\n\ninterface IRelatedInformationTemplateData {\n\tresourceLabel: HighlightedLabel;\n\tlnCol: HTMLElement;\n\tdescription: HighlightedLabel;\n}\n\nexport class MarkersTreeAccessibilityProvider implements IAccessibilityProvider<TreeElement> {\n\n\tconstructor(@ILabelService private readonly labelService: ILabelService) { }\n\n\tpublic getAriaLabel(element: TreeElement): string | null {\n\t\tif (element instanceof ResourceMarkers) {\n\t\t\tconst path = this.labelService.getUriLabel(element.resource, { relative: true }) || element.resource.fsPath;\n\t\t\treturn Messages.MARKERS_TREE_ARIA_LABEL_RESOURCE(element.markers.length, element.name, paths.dirname(path));\n\t\t}\n\t\tif (element instanceof Marker) {\n\t\t\treturn Messages.MARKERS_TREE_ARIA_LABEL_MARKER(element);\n\t\t}\n\t\tif (element instanceof RelatedInformation) {\n\t\t\treturn Messages.MARKERS_TREE_ARIA_LABEL_RELATED_INFORMATION(element.raw);\n\t\t}\n\t\treturn null;\n\t}\n}\n\nconst enum TemplateId {\n\tResourceMarkers = 'rm',\n\tMarker = 'm',\n\tRelatedInformation = 'ri'\n}\n\nexport class VirtualDelegate implements IListVirtualDelegate<TreeElement> {\n\n\tstatic LINE_HEIGHT: number = 22;\n\n\tconstructor(private readonly markersViewState: MarkersViewModel) { }\n\n\tgetHeight(element: TreeElement): number {\n\t\tif (element instanceof Marker) {\n\t\t\tconst viewModel = this.markersViewState.getViewModel(element);\n\t\t\tconst noOfLines = !viewModel || viewModel.multiline ? element.lines.length : 1;\n\t\t\treturn noOfLines * VirtualDelegate.LINE_HEIGHT;\n\t\t}\n\t\treturn VirtualDelegate.LINE_HEIGHT;\n\t}\n\n\tgetTemplateId(element: TreeElement): string {\n\t\tif (element instanceof ResourceMarkers) {\n\t\t\treturn TemplateId.ResourceMarkers;\n\t\t} else if (element instanceof Marker) {\n\t\t\treturn TemplateId.Marker;\n\t\t} else {\n\t\t\treturn TemplateId.RelatedInformation;\n\t\t}\n\t}\n}\n\nconst enum FilterDataType {\n\tResourceMarkers,\n\tMarker,\n\tRelatedInformation\n}\n\ninterface ResourceMarkersFilterData {\n\ttype: FilterDataType.ResourceMarkers;\n\turiMatches: IMatch[];\n}\n\ninterface MarkerFilterData {\n\ttype: FilterDataType.Marker;\n\tlineMatches: IMatch[][];\n\tsourceMatches: IMatch[];\n\tcodeMatches: IMatch[];\n}\n\ninterface RelatedInformationFilterData {\n\ttype: FilterDataType.RelatedInformation;\n\turiMatches: IMatch[];\n\tmessageMatches: IMatch[];\n}\n\nexport type FilterData = ResourceMarkersFilterData | MarkerFilterData | RelatedInformationFilterData;\n\nexport class ResourceMarkersRenderer implements ITreeRenderer<ResourceMarkers, ResourceMarkersFilterData, IResourceMarkersTemplateData> {\n\n\tprivate renderedNodes = new Map<ITreeNode<ResourceMarkers, ResourceMarkersFilterData>, IResourceMarkersTemplateData>();\n\tprivate disposables: IDisposable[] = [];\n\n\tconstructor(\n\t\tprivate labels: ResourceLabels,\n\t\tonDidChangeRenderNodeCount: Event<ITreeNode<ResourceMarkers, ResourceMarkersFilterData>>,\n\t\t@IThemeService private readonly themeService: IThemeService,\n\t\t@ILabelService private readonly labelService: ILabelService\n\t) {\n\t\tonDidChangeRenderNodeCount(this.onDidChangeRenderNodeCount, this, this.disposables);\n\t}\n\n\ttemplateId = TemplateId.ResourceMarkers;\n\n\trenderTemplate(container: HTMLElement): IResourceMarkersTemplateData {\n\t\tconst data = <IResourceMarkersTemplateData>Object.create(null);\n\n\t\tconst resourceLabelContainer = dom.append(container, dom.$('.resource-label-container'));\n\t\tdata.resourceLabel = this.labels.create(resourceLabelContainer, { supportHighlights: true });\n\n\t\tconst badgeWrapper = dom.append(container, dom.$('.count-badge-wrapper'));\n\t\tdata.count = new CountBadge(badgeWrapper);\n\t\tdata.styler = attachBadgeStyler(data.count, this.themeService);\n\n\t\treturn data;\n\t}\n\n\trenderElement(node: ITreeNode<ResourceMarkers, ResourceMarkersFilterData>, _: number, templateData: IResourceMarkersTemplateData): void {\n\t\tconst resourceMarkers = node.element;\n\t\tconst uriMatches = node.filterData && node.filterData.uriMatches || [];\n\n\t\tif (resourceMarkers.resource.scheme === network.Schemas.file || resourceMarkers.resource.scheme === network.Schemas.untitled) {\n\t\t\ttemplateData.resourceLabel.setFile(resourceMarkers.resource, { matches: uriMatches });\n\t\t} else {\n\t\t\ttemplateData.resourceLabel.setResource({ name: resourceMarkers.name, description: this.labelService.getUriLabel(dirname(resourceMarkers.resource), { relative: true }), resource: resourceMarkers.resource }, { matches: uriMatches });\n\t\t}\n\n\t\tthis.updateCount(node, templateData);\n\t\tthis.renderedNodes.set(node, templateData);\n\t}\n\n\tdisposeElement(node: ITreeNode<ResourceMarkers, ResourceMarkersFilterData>): void {\n\t\tthis.renderedNodes.delete(node);\n\t}\n\n\tdisposeTemplate(templateData: IResourceMarkersTemplateData): void {\n\t\ttemplateData.resourceLabel.dispose();\n\t\ttemplateData.styler.dispose();\n\t}\n\n\tprivate onDidChangeRenderNodeCount(node: ITreeNode<ResourceMarkers, ResourceMarkersFilterData>): void {\n\t\tconst templateData = this.renderedNodes.get(node);\n\n\t\tif (!templateData) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateCount(node, templateData);\n\t}\n\n\tprivate updateCount(node: ITreeNode<ResourceMarkers, ResourceMarkersFilterData>, templateData: IResourceMarkersTemplateData): void {\n\t\ttemplateData.count.setCount(node.children.reduce((r, n) => r + (n.visible ? 1 : 0), 0));\n\t}\n\n\tdispose(): void {\n\t\tthis.disposables = dispose(this.disposables);\n\t}\n}\n\nexport class FileResourceMarkersRenderer extends ResourceMarkersRenderer {\n}\n\nexport class MarkerRenderer implements ITreeRenderer<Marker, MarkerFilterData, IMarkerTemplateData> {\n\n\tconstructor(\n\t\tprivate readonly markersViewState: MarkersViewModel,\n\t\t@IInstantiationService protected instantiationService: IInstantiationService\n\t) { }\n\n\ttemplateId = TemplateId.Marker;\n\n\trenderTemplate(container: HTMLElement): IMarkerTemplateData {\n\t\tconst data: IMarkerTemplateData = Object.create(null);\n\t\tdata.markerWidget = new MarkerWidget(container, this.markersViewState, this.instantiationService);\n\t\treturn data;\n\t}\n\n\trenderElement(node: ITreeNode<Marker, MarkerFilterData>, _: number, templateData: IMarkerTemplateData): void {\n\t\ttemplateData.markerWidget.render(node.element, node.filterData);\n\t}\n\n\tdisposeTemplate(templateData: IMarkerTemplateData): void {\n\t\ttemplateData.markerWidget.dispose();\n\t}\n\n}\n\nclass MarkerWidget extends Disposable {\n\n\tprivate readonly actionBar: ActionBar;\n\tprivate readonly icon: HTMLElement;\n\tprivate readonly multilineActionbar: ActionBar;\n\tprivate readonly messageAndDetailsContainer: HTMLElement;\n\tprivate disposables: IDisposable[] = [];\n\n\tconstructor(\n\t\tprivate parent: HTMLElement,\n\t\tprivate readonly markersViewModel: MarkersViewModel,\n\t\tinstantiationService: IInstantiationService\n\t) {\n\t\tsuper();\n\t\tthis.actionBar = this._register(new ActionBar(dom.append(parent, dom.$('.actions')), {\n\t\t\tactionItemProvider: (action) => action.id === QuickFixAction.ID ? instantiationService.createInstance(QuickFixActionItem, action) : undefined\n\t\t}));\n\t\tthis.icon = dom.append(parent, dom.$('.icon'));\n\t\tthis.multilineActionbar = this._register(new ActionBar(dom.append(parent, dom.$('.multiline-actions'))));\n\t\tthis.messageAndDetailsContainer = dom.append(parent, dom.$('.marker-message-details'));\n\t\tthis._register(toDisposable(() => this.disposables = dispose(this.disposables)));\n\t}\n\n\trender(element: Marker, filterData: MarkerFilterData | undefined): void {\n\t\tthis.actionBar.clear();\n\t\tthis.multilineActionbar.clear();\n\t\tif (this.disposables.length) {\n\t\t\tthis.disposables = dispose(this.disposables);\n\t\t}\n\t\tdom.clearNode(this.messageAndDetailsContainer);\n\n\t\tthis.icon.className = 'marker-icon ' + MarkerWidget.iconClassNameFor(element.marker);\n\t\tthis.renderQuickfixActionbar(element);\n\t\tthis.renderMultilineActionbar(element);\n\n\t\tthis.renderMessageAndDetails(element, filterData);\n\t\tthis.disposables.push(dom.addDisposableListener(this.parent, dom.EventType.MOUSE_OVER, () => this.markersViewModel.onMarkerMouseHover(element)));\n\t\tthis.disposables.push(dom.addDisposableListener(this.parent, dom.EventType.MOUSE_LEAVE, () => this.markersViewModel.onMarkerMouseLeave(element)));\n\t}\n\n\tprivate renderQuickfixActionbar(marker: Marker): void {\n\t\tconst viewModel = this.markersViewModel.getViewModel(marker);\n\t\tif (viewModel) {\n\t\t\tconst quickFixAction = viewModel.quickFixAction;\n\t\t\tthis.actionBar.push([quickFixAction], { icon: true, label: false });\n\t\t\tdom.toggleClass(this.icon, 'quickFix', quickFixAction.enabled);\n\t\t\tquickFixAction.onDidChange(({ enabled }) => {\n\t\t\t\tif (!isUndefinedOrNull(enabled)) {\n\t\t\t\t\tdom.toggleClass(this.icon, 'quickFix', enabled);\n\t\t\t\t}\n\t\t\t}, this, this.disposables);\n\t\t\tquickFixAction.onShowQuickFixes(() => {\n\t\t\t\tconst quickFixActionItem = <QuickFixActionItem>this.actionBar.items[0];\n\t\t\t\tif (quickFixActionItem) {\n\t\t\t\t\tquickFixActionItem.showQuickFixes();\n\t\t\t\t}\n\t\t\t}, this, this.disposables);\n\t\t}\n\t}\n\n\tprivate renderMultilineActionbar(marker: Marker): void {\n\t\tconst viewModel = this.markersViewModel.getViewModel(marker);\n\t\tconst multiline = viewModel && viewModel.multiline;\n\t\tconst action = new Action('problems.action.toggleMultiline');\n\t\taction.enabled = !!viewModel && marker.lines.length > 1;\n\t\taction.tooltip = multiline ? localize('single line', \"Show message in single line\") : localize('multi line', \"Show message in multiple lines\");\n\t\taction.class = multiline ? 'octicon octicon-chevron-up' : 'octicon octicon-chevron-down';\n\t\taction.run = () => { if (viewModel) { viewModel.multiline = !viewModel.multiline; } return Promise.resolve(); };\n\t\tthis.multilineActionbar.push([action], { icon: true, label: false });\n\t}\n\n\tprivate renderMessageAndDetails(element: Marker, filterData: MarkerFilterData | undefined) {\n\t\tconst { marker, lines } = element;\n\t\tconst viewState = this.markersViewModel.getViewModel(element);\n\t\tconst multiline = !viewState || viewState.multiline;\n\t\tconst lineMatches = filterData && filterData.lineMatches || [];\n\t\tconst messageContainer = dom.append(this.messageAndDetailsContainer, dom.$('.marker-message'));\n\t\tdom.toggleClass(messageContainer, 'multiline', multiline);\n\n\t\tlet lastLineElement = messageContainer;\n\t\tfor (let index = 0; index < (multiline ? lines.length : 1); index++) {\n\t\t\tlastLineElement = dom.append(messageContainer, dom.$('.marker-message-line'));\n\t\t\tconst highlightedLabel = new HighlightedLabel(lastLineElement, false);\n\t\t\thighlightedLabel.set(lines[index], lineMatches[index]);\n\t\t\tif (lines[index] === '') {\n\t\t\t\tlastLineElement.style.height = `${VirtualDelegate.LINE_HEIGHT}px`;\n\t\t\t}\n\t\t}\n\t\tthis.renderDetails(marker, filterData, multiline ? lastLineElement : this.messageAndDetailsContainer);\n\t}\n\n\tprivate renderDetails(marker: IMarker, filterData: MarkerFilterData | undefined, parent: HTMLElement): void {\n\t\tdom.addClass(parent, 'details-container');\n\t\tconst sourceMatches = filterData && filterData.sourceMatches || [];\n\t\tconst codeMatches = filterData && filterData.codeMatches || [];\n\n\t\tconst source = new HighlightedLabel(dom.append(parent, dom.$('')), false);\n\t\tsource.set(marker.source, sourceMatches);\n\t\tdom.toggleClass(source.element, 'marker-source', !!marker.source);\n\n\t\tconst code = new HighlightedLabel(dom.append(parent, dom.$('')), false);\n\t\tcode.set(marker.code, codeMatches);\n\t\tdom.toggleClass(code.element, 'marker-code', !!marker.code);\n\n\t\tconst lnCol = dom.append(parent, dom.$('span.marker-line'));\n\t\tlnCol.textContent = Messages.MARKERS_PANEL_AT_LINE_COL_NUMBER(marker.startLineNumber, marker.startColumn);\n\t}\n\n\tprivate static iconClassNameFor(element: IMarker): string {\n\t\tswitch (element.severity) {\n\t\t\tcase MarkerSeverity.Hint:\n\t\t\t\treturn 'info';\n\t\t\tcase MarkerSeverity.Info:\n\t\t\t\treturn 'info';\n\t\t\tcase MarkerSeverity.Warning:\n\t\t\t\treturn 'warning';\n\t\t\tcase MarkerSeverity.Error:\n\t\t\t\treturn 'error';\n\t\t}\n\t\treturn '';\n\t}\n}\n\nexport class RelatedInformationRenderer implements ITreeRenderer<RelatedInformation, RelatedInformationFilterData, IRelatedInformationTemplateData> {\n\n\tconstructor(\n\t\t@ILabelService private readonly labelService: ILabelService\n\t) { }\n\n\ttemplateId = TemplateId.RelatedInformation;\n\n\trenderTemplate(container: HTMLElement): IRelatedInformationTemplateData {\n\t\tconst data: IRelatedInformationTemplateData = Object.create(null);\n\n\t\tdom.append(container, dom.$('.actions'));\n\t\tdom.append(container, dom.$('.icon'));\n\n\t\tdata.resourceLabel = new HighlightedLabel(dom.append(container, dom.$('.related-info-resource')), false);\n\t\tdata.lnCol = dom.append(container, dom.$('span.marker-line'));\n\n\t\tconst separator = dom.append(container, dom.$('span.related-info-resource-separator'));\n\t\tseparator.textContent = ':';\n\t\tseparator.style.paddingRight = '4px';\n\n\t\tdata.description = new HighlightedLabel(dom.append(container, dom.$('.marker-description')), false);\n\t\treturn data;\n\t}\n\n\trenderElement(node: ITreeNode<RelatedInformation, RelatedInformationFilterData>, _: number, templateData: IRelatedInformationTemplateData): void {\n\t\tconst relatedInformation = node.element.raw;\n\t\tconst uriMatches = node.filterData && node.filterData.uriMatches || [];\n\t\tconst messageMatches = node.filterData && node.filterData.messageMatches || [];\n\n\t\ttemplateData.resourceLabel.set(basename(relatedInformation.resource), uriMatches);\n\t\ttemplateData.resourceLabel.element.title = this.labelService.getUriLabel(relatedInformation.resource, { relative: true });\n\t\ttemplateData.lnCol.textContent = Messages.MARKERS_PANEL_AT_LINE_COL_NUMBER(relatedInformation.startLineNumber, relatedInformation.startColumn);\n\t\ttemplateData.description.set(relatedInformation.message, messageMatches);\n\t\ttemplateData.description.element.title = relatedInformation.message;\n\t}\n\n\tdisposeTemplate(templateData: IRelatedInformationTemplateData): void {\n\t\t// noop\n\t}\n}\n\nexport class Filter implements ITreeFilter<TreeElement, FilterData> {\n\n\tconstructor(public options: FilterOptions) { }\n\n\tfilter(element: TreeElement, parentVisibility: TreeVisibility): TreeFilterResult<FilterData> {\n\t\tif (element instanceof ResourceMarkers) {\n\t\t\treturn this.filterResourceMarkers(element);\n\t\t} else if (element instanceof Marker) {\n\t\t\treturn this.filterMarker(element, parentVisibility);\n\t\t} else {\n\t\t\treturn this.filterRelatedInformation(element, parentVisibility);\n\t\t}\n\t}\n\n\tprivate filterResourceMarkers(resourceMarkers: ResourceMarkers): TreeFilterResult<FilterData> {\n\t\tif (resourceMarkers.resource.scheme === network.Schemas.walkThrough || resourceMarkers.resource.scheme === network.Schemas.walkThroughSnippet) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.options.excludesMatcher.matches(resourceMarkers.resource)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst uriMatches = FilterOptions._filter(this.options.textFilter, basename(resourceMarkers.resource));\n\n\t\tif (this.options.textFilter && uriMatches) {\n\t\t\treturn { visibility: true, data: { type: FilterDataType.ResourceMarkers, uriMatches } };\n\t\t}\n\n\t\tif (this.options.includesMatcher.matches(resourceMarkers.resource)) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn TreeVisibility.Recurse;\n\t}\n\n\tprivate filterMarker(marker: Marker, parentVisibility: TreeVisibility): TreeFilterResult<FilterData> {\n\t\tif (this.options.filterErrors && MarkerSeverity.Error === marker.marker.severity) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.options.filterWarnings && MarkerSeverity.Warning === marker.marker.severity) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.options.filterInfos && MarkerSeverity.Info === marker.marker.severity) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!this.options.textFilter) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst lineMatches: IMatch[][] = [];\n\t\tfor (const line of marker.lines) {\n\t\t\tlineMatches.push(FilterOptions._messageFilter(this.options.textFilter, line) || []);\n\t\t}\n\t\tconst sourceMatches = marker.marker.source && FilterOptions._filter(this.options.textFilter, marker.marker.source);\n\t\tconst codeMatches = marker.marker.code && FilterOptions._filter(this.options.textFilter, marker.marker.code);\n\n\t\tif (sourceMatches || codeMatches || lineMatches.some(lineMatch => lineMatch.length > 0)) {\n\t\t\treturn { visibility: true, data: { type: FilterDataType.Marker, lineMatches, sourceMatches: sourceMatches || [], codeMatches: codeMatches || [] } };\n\t\t}\n\n\t\treturn parentVisibility;\n\t}\n\n\tprivate filterRelatedInformation(relatedInformation: RelatedInformation, parentVisibility: TreeVisibility): TreeFilterResult<FilterData> {\n\t\tif (!this.options.textFilter) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst uriMatches = FilterOptions._filter(this.options.textFilter, basename(relatedInformation.raw.resource));\n\t\tconst messageMatches = FilterOptions._messageFilter(this.options.textFilter, paths.basename(relatedInformation.raw.message));\n\n\t\tif (uriMatches || messageMatches) {\n\t\t\treturn { visibility: true, data: { type: FilterDataType.RelatedInformation, uriMatches: uriMatches || [], messageMatches: messageMatches || [] } };\n\t\t}\n\n\t\treturn parentVisibility;\n\t}\n}\n\nexport class MarkerViewModel extends Disposable {\n\n\tprivate readonly _onDidChange: Emitter<void> = this._register(new Emitter<void>());\n\treadonly onDidChange: Event<void> = this._onDidChange.event;\n\n\tprivate modelPromise: CancelablePromise<ITextModel> | null = null;\n\tprivate codeActionsPromise: CancelablePromise<CodeActionSet> | null = null;\n\n\tconstructor(\n\t\tprivate readonly marker: Marker,\n\t\t@IModelService private modelService: IModelService,\n\t\t@IInstantiationService private instantiationService: IInstantiationService,\n\t\t@IBulkEditService private readonly bulkEditService: IBulkEditService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IEditorService private readonly editorService: IEditorService\n\t) {\n\t\tsuper();\n\t\tthis._register(toDisposable(() => {\n\t\t\tif (this.modelPromise) {\n\t\t\t\tthis.modelPromise.cancel();\n\t\t\t}\n\t\t\tif (this.codeActionsPromise) {\n\t\t\t\tthis.codeActionsPromise.cancel();\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate _multiline: boolean = true;\n\tget multiline(): boolean {\n\t\treturn this._multiline;\n\t}\n\n\tset multiline(value: boolean) {\n\t\tif (this._multiline !== value) {\n\t\t\tthis._multiline = value;\n\t\t\tthis._onDidChange.fire();\n\t\t}\n\t}\n\n\tprivate _quickFixAction: QuickFixAction;\n\tget quickFixAction(): QuickFixAction {\n\t\tif (!this._quickFixAction) {\n\t\t\tthis._quickFixAction = this._register(this.instantiationService.createInstance(QuickFixAction, this.marker));\n\t\t}\n\t\treturn this._quickFixAction;\n\t}\n\n\tshowLightBulb(): void {\n\t\tthis.setQuickFixes(true);\n\t}\n\n\tshowQuickfixes(): void {\n\t\tthis.setQuickFixes(false).then(() => this.quickFixAction.run());\n\t}\n\n\tasync getQuickFixes(waitForModel: boolean): Promise<IAction[]> {\n\t\tconst codeActions = await this.getCodeActions(waitForModel);\n\t\treturn codeActions ? this.toActions(codeActions) : [];\n\t}\n\n\tprivate async setQuickFixes(waitForModel: boolean): Promise<void> {\n\t\tconst codeActions = await this.getCodeActions(waitForModel);\n\t\tthis.quickFixAction.quickFixes = codeActions ? this.toActions(codeActions) : [];\n\t\tthis.quickFixAction.autoFixable(!!codeActions && codeActions.hasAutoFix);\n\t}\n\n\tprivate getCodeActions(waitForModel: boolean): Promise<CodeActionSet | null> {\n\t\tif (this.codeActionsPromise !== null) {\n\t\t\treturn this.codeActionsPromise;\n\t\t}\n\t\treturn this.getModel(waitForModel)\n\t\t\t.then<CodeActionSet | null>(model => {\n\t\t\t\tif (model) {\n\t\t\t\t\tif (!this.codeActionsPromise) {\n\t\t\t\t\t\tthis.codeActionsPromise = createCancelablePromise(cancellationToken => {\n\t\t\t\t\t\t\treturn getCodeActions(model, new Range(this.marker.range.startLineNumber, this.marker.range.startColumn, this.marker.range.endLineNumber, this.marker.range.endColumn), { type: 'manual', filter: { kind: CodeActionKind.QuickFix } }, cancellationToken);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn this.codeActionsPromise;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t});\n\t}\n\n\tprivate toActions(codeActions: CodeActionSet): IAction[] {\n\t\treturn codeActions.actions.map(codeAction => new Action(\n\t\t\tcodeAction.command ? codeAction.command.id : codeAction.title,\n\t\t\tcodeAction.title,\n\t\t\tundefined,\n\t\t\ttrue,\n\t\t\t() => {\n\t\t\t\treturn this.openFileAtMarker(this.marker)\n\t\t\t\t\t.then(() => applyCodeAction(codeAction, this.bulkEditService, this.commandService));\n\t\t\t}));\n\t}\n\n\tprivate openFileAtMarker(element: Marker): Promise<void> {\n\t\tconst { resource, selection } = { resource: element.resource, selection: element.range };\n\t\treturn this.editorService.openEditor({\n\t\t\tresource,\n\t\t\toptions: {\n\t\t\t\tselection,\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpinned: false,\n\t\t\t\trevealIfVisible: true\n\t\t\t},\n\t\t}, ACTIVE_GROUP).then(() => undefined);\n\t}\n\n\tprivate getModel(waitForModel: boolean): Promise<ITextModel | null> {\n\t\tconst model = this.modelService.getModel(this.marker.resource);\n\t\tif (model) {\n\t\t\treturn Promise.resolve(model);\n\t\t}\n\t\tif (waitForModel) {\n\t\t\tif (this.modelPromise === null) {\n\t\t\t\tthis.modelPromise = createCancelablePromise(cancellationToken => {\n\t\t\t\t\treturn new Promise((c) => {\n\t\t\t\t\t\tthis._register(this.modelService.onModelAdded(model => {\n\t\t\t\t\t\t\tif (isEqual(model.uri, this.marker.resource)) {\n\t\t\t\t\t\t\t\tc(model);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn this.modelPromise;\n\t\t}\n\t\treturn Promise.resolve(null);\n\t}\n\n}\n\nexport class MarkersViewModel extends Disposable {\n\n\tprivate readonly _onDidChange: Emitter<Marker | undefined> = this._register(new Emitter<Marker | undefined>());\n\treadonly onDidChange: Event<Marker | undefined> = this._onDidChange.event;\n\n\tprivate readonly markersViewStates: Map<string, { viewModel: MarkerViewModel, disposables: IDisposable[] }> = new Map<string, { viewModel: MarkerViewModel, disposables: IDisposable[] }>();\n\tprivate readonly markersPerResource: Map<string, Marker[]> = new Map<string, Marker[]>();\n\n\tprivate bulkUpdate: boolean = false;\n\n\tprivate hoveredMarker: Marker | null;\n\tprivate hoverDelayer: Delayer<void> = new Delayer<void>(300);\n\n\tconstructor(\n\t\tmultiline: boolean = true,\n\t\t@IInstantiationService private instantiationService: IInstantiationService\n\t) {\n\t\tsuper();\n\t\tthis._multiline = multiline;\n\t}\n\n\tadd(marker: Marker): void {\n\t\tif (!this.markersViewStates.has(marker.hash)) {\n\t\t\tconst viewModel = this.instantiationService.createInstance(MarkerViewModel, marker);\n\t\t\tconst disposables: IDisposable[] = [viewModel];\n\t\t\tviewModel.multiline = this.multiline;\n\t\t\tviewModel.onDidChange(() => {\n\t\t\t\tif (!this.bulkUpdate) {\n\t\t\t\t\tthis._onDidChange.fire(marker);\n\t\t\t\t}\n\t\t\t}, this, disposables);\n\t\t\tthis.markersViewStates.set(marker.hash, { viewModel, disposables });\n\n\t\t\tconst markers = this.markersPerResource.get(marker.resource.toString()) || [];\n\t\t\tmarkers.push(marker);\n\t\t\tthis.markersPerResource.set(marker.resource.toString(), markers);\n\t\t}\n\t}\n\n\tremove(resource: URI): void {\n\t\tconst markers = this.markersPerResource.get(resource.toString()) || [];\n\t\tfor (const marker of markers) {\n\t\t\tconst value = this.markersViewStates.get(marker.hash);\n\t\t\tif (value) {\n\t\t\t\tdispose(value.disposables);\n\t\t\t}\n\t\t\tthis.markersViewStates.delete(marker.hash);\n\t\t\tif (this.hoveredMarker === marker) {\n\t\t\t\tthis.hoveredMarker = null;\n\t\t\t}\n\t\t}\n\t\tthis.markersPerResource.delete(resource.toString());\n\t}\n\n\tgetViewModel(marker: Marker): MarkerViewModel | null {\n\t\tconst value = this.markersViewStates.get(marker.hash);\n\t\treturn value ? value.viewModel : null;\n\t}\n\n\tonMarkerMouseHover(marker: Marker): void {\n\t\tthis.hoveredMarker = marker;\n\t\tthis.hoverDelayer.trigger(() => {\n\t\t\tif (this.hoveredMarker) {\n\t\t\t\tconst model = this.getViewModel(this.hoveredMarker);\n\t\t\t\tif (model) {\n\t\t\t\t\tmodel.showLightBulb();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tonMarkerMouseLeave(marker: Marker): void {\n\t\tif (this.hoveredMarker === marker) {\n\t\t\tthis.hoveredMarker = null;\n\t\t}\n\t}\n\n\tprivate _multiline: boolean = true;\n\tget multiline(): boolean {\n\t\treturn this._multiline;\n\t}\n\n\tset multiline(value: boolean) {\n\t\tlet changed = false;\n\t\tif (this._multiline !== value) {\n\t\t\tthis._multiline = value;\n\t\t\tchanged = true;\n\t\t}\n\t\tthis.bulkUpdate = true;\n\t\tthis.markersViewStates.forEach(({ viewModel }) => {\n\t\t\tif (viewModel.multiline !== value) {\n\t\t\t\tviewModel.multiline = value;\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t});\n\t\tthis.bulkUpdate = false;\n\t\tif (changed) {\n\t\t\tthis._onDidChange.fire(undefined);\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tthis.markersViewStates.forEach(({ disposables }) => dispose(disposables));\n\t\tthis.markersViewStates.clear();\n\t\tthis.markersPerResource.clear();\n\t\tsuper.dispose();\n\t}\n\n}\n\nexport class ResourceDragAndDrop implements ITreeDragAndDrop<TreeElement> {\n\tconstructor(\n\t\tprivate instantiationService: IInstantiationService\n\t) { }\n\n\tonDragOver(data: IDragAndDropData, targetElement: TreeElement, targetIndex: number, originalEvent: DragEvent): boolean | ITreeDragOverReaction {\n\t\treturn false;\n\t}\n\n\tgetDragURI(element: TreeElement): string | null {\n\t\tif (element instanceof ResourceMarkers) {\n\t\t\treturn element.resource.toString();\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetDragLabel?(elements: TreeElement[]): string | undefined {\n\t\tif (elements.length > 1) {\n\t\t\treturn String(elements.length);\n\t\t}\n\t\tconst element = elements[0];\n\t\treturn element instanceof ResourceMarkers ? basename(element.resource) : undefined;\n\t}\n\n\tonDragStart(data: IDragAndDropData, originalEvent: DragEvent): void {\n\t\tconst elements = (data as ElementsDragAndDropData<TreeElement>).elements;\n\t\tconst resources: URI[] = elements\n\t\t\t.filter(e => e instanceof ResourceMarkers)\n\t\t\t.map((resourceMarker: ResourceMarkers) => resourceMarker.resource);\n\n\t\tif (resources.length) {\n\t\t\t// Apply some datatransfer types to allow for dragging the element outside of the application\n\t\t\tthis.instantiationService.invokeFunction(fillResourceDataTransfers, resources, originalEvent);\n\t\t}\n\t}\n\n\tdrop(data: IDragAndDropData, targetElement: TreeElement, targetIndex: number, originalEvent: DragEvent): void {\n\t}\n}\n"]}]}