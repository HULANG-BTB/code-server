{"remainingRequest":"/home/coding/workspace/node_modules/ts-loader/index.js?{\"happyPackMode\":true,\"compilerOptions\":{\"target\":\"es5\",\"lib\":[\"dom\",\"esnext\"]}}!/home/coding/workspace/lib/vscode/src/vs/platform/extensionManagement/common/extensionEnablementService.ts","dependencies":[{"path":"/home/coding/workspace/lib/vscode/src/vs/platform/extensionManagement/common/extensionEnablementService.ts","mtime":1555102317000},{"path":"/home/coding/workspace/node_modules/cache-loader/dist/cjs.js","mtime":1555844183884},{"path":"/home/coding/workspace/node_modules/ts-loader/index.js","mtime":1555844217316}],"contextDependencies":[],"result":["\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar nls_1 = require(\"vs/nls\");\nvar event_1 = require(\"vs/base/common/event\");\nvar lifecycle_1 = require(\"vs/base/common/lifecycle\");\nvar extensionManagement_1 = require(\"vs/platform/extensionManagement/common/extensionManagement\");\nvar extensionManagementUtil_1 = require(\"vs/platform/extensionManagement/common/extensionManagementUtil\");\nvar workspace_1 = require(\"vs/platform/workspace/common/workspace\");\nvar storage_1 = require(\"vs/platform/storage/common/storage\");\nvar environment_1 = require(\"vs/platform/environment/common/environment\");\nvar types_1 = require(\"vs/base/common/types\");\nvar extensions_1 = require(\"vs/platform/extensions/common/extensions\");\nvar DISABLED_EXTENSIONS_STORAGE_PATH = 'extensionsIdentifiers/disabled';\nvar ENABLED_EXTENSIONS_STORAGE_PATH = 'extensionsIdentifiers/enabled';\nvar ExtensionEnablementService = /** @class */ (function (_super) {\n    tslib_1.__extends(ExtensionEnablementService, _super);\n    function ExtensionEnablementService(storageService, contextService, environmentService, extensionManagementService) {\n        var _this = _super.call(this) || this;\n        _this.contextService = contextService;\n        _this.environmentService = environmentService;\n        _this.extensionManagementService = extensionManagementService;\n        _this._onEnablementChanged = new event_1.Emitter();\n        _this.onEnablementChanged = _this._onEnablementChanged.event;\n        _this.storageManger = _this._register(new StorageManager(storageService));\n        _this._register(_this.storageManger.onDidChange(function (extensions) { return _this.onDidChangeStorage(extensions); }));\n        _this._register(extensionManagementService.onDidInstallExtension(_this._onDidInstallExtension, _this));\n        _this._register(extensionManagementService.onDidUninstallExtension(_this._onDidUninstallExtension, _this));\n        return _this;\n    }\n    Object.defineProperty(ExtensionEnablementService.prototype, \"hasWorkspace\", {\n        get: function () {\n            return this.contextService.getWorkbenchState() !== workspace_1.WorkbenchState.EMPTY;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ExtensionEnablementService.prototype, \"allUserExtensionsDisabled\", {\n        get: function () {\n            return this.environmentService.disableExtensions === true;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ExtensionEnablementService.prototype.getDisabledExtensions = function () {\n        return tslib_1.__awaiter(this, void 0, Promise, function () {\n            var result, _loop_1, _i, _a, e, workspaceEnabledExtensions_1, allInstalledExtensions, _loop_2, this_1, _b, allInstalledExtensions_1, installedExtension;\n            return tslib_1.__generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        result = this._getDisabledExtensions(storage_1.StorageScope.GLOBAL);\n                        if (this.hasWorkspace) {\n                            _loop_1 = function (e) {\n                                if (!result.some(function (r) { return extensionManagementUtil_1.areSameExtensions(r, e); })) {\n                                    result.push(e);\n                                }\n                            };\n                            for (_i = 0, _a = this._getDisabledExtensions(storage_1.StorageScope.WORKSPACE); _i < _a.length; _i++) {\n                                e = _a[_i];\n                                _loop_1(e);\n                            }\n                            workspaceEnabledExtensions_1 = this._getEnabledExtensions(storage_1.StorageScope.WORKSPACE);\n                            if (workspaceEnabledExtensions_1.length) {\n                                result = result.filter(function (r) { return !workspaceEnabledExtensions_1.some(function (e) { return extensionManagementUtil_1.areSameExtensions(e, r); }); });\n                            }\n                        }\n                        if (!this.environmentService.disableExtensions) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.extensionManagementService.getInstalled()];\n                    case 1:\n                        allInstalledExtensions = _c.sent();\n                        _loop_2 = function (installedExtension) {\n                            if (this_1._isExtensionDisabledInEnvironment(installedExtension)) {\n                                if (!result.some(function (r) { return extensionManagementUtil_1.areSameExtensions(r, installedExtension.identifier); })) {\n                                    result.push(installedExtension.identifier);\n                                }\n                            }\n                        };\n                        this_1 = this;\n                        for (_b = 0, allInstalledExtensions_1 = allInstalledExtensions; _b < allInstalledExtensions_1.length; _b++) {\n                            installedExtension = allInstalledExtensions_1[_b];\n                            _loop_2(installedExtension);\n                        }\n                        _c.label = 2;\n                    case 2: return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    ExtensionEnablementService.prototype.getEnablementState = function (extension) {\n        if (this._isExtensionDisabledInEnvironment(extension)) {\n            return extensionManagement_1.EnablementState.Disabled;\n        }\n        var identifier = extension.identifier;\n        if (this.hasWorkspace) {\n            if (this._getEnabledExtensions(storage_1.StorageScope.WORKSPACE).filter(function (e) { return extensionManagementUtil_1.areSameExtensions(e, identifier); })[0]) {\n                return extensionManagement_1.EnablementState.WorkspaceEnabled;\n            }\n            if (this._getDisabledExtensions(storage_1.StorageScope.WORKSPACE).filter(function (e) { return extensionManagementUtil_1.areSameExtensions(e, identifier); })[0]) {\n                return extensionManagement_1.EnablementState.WorkspaceDisabled;\n            }\n        }\n        if (this._getDisabledExtensions(storage_1.StorageScope.GLOBAL).filter(function (e) { return extensionManagementUtil_1.areSameExtensions(e, identifier); })[0]) {\n            return extensionManagement_1.EnablementState.Disabled;\n        }\n        return extensionManagement_1.EnablementState.Enabled;\n    };\n    ExtensionEnablementService.prototype.canChangeEnablement = function (extension) {\n        if (extension.manifest && extension.manifest.contributes && extension.manifest.contributes.localizations && extension.manifest.contributes.localizations.length) {\n            return false;\n        }\n        if (extension.type === extensions_1.ExtensionType.User && this.environmentService.disableExtensions) {\n            return false;\n        }\n        return true;\n    };\n    ExtensionEnablementService.prototype.setEnablement = function (extensions, newState) {\n        return tslib_1.__awaiter(this, void 0, Promise, function () {\n            var workspace, result, changedExtensions;\n            var _this = this;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        workspace = newState === extensionManagement_1.EnablementState.WorkspaceDisabled || newState === extensionManagement_1.EnablementState.WorkspaceEnabled;\n                        if (workspace && !this.hasWorkspace) {\n                            return [2 /*return*/, Promise.reject(new Error(nls_1.localize('noWorkspace', \"No workspace.\")))];\n                        }\n                        return [4 /*yield*/, Promise.all(extensions.map(function (e) { return _this._setEnablement(e, newState); }))];\n                    case 1:\n                        result = _a.sent();\n                        changedExtensions = extensions.filter(function (e, index) { return result[index]; });\n                        if (changedExtensions.length) {\n                            this._onEnablementChanged.fire(changedExtensions);\n                        }\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    ExtensionEnablementService.prototype._setEnablement = function (extension, newState) {\n        var currentState = this._getEnablementState(extension.identifier);\n        if (currentState === newState) {\n            return Promise.resolve(false);\n        }\n        switch (newState) {\n            case extensionManagement_1.EnablementState.Enabled:\n                this._enableExtension(extension.identifier);\n                break;\n            case extensionManagement_1.EnablementState.Disabled:\n                this._disableExtension(extension.identifier);\n                break;\n            case extensionManagement_1.EnablementState.WorkspaceEnabled:\n                this._enableExtensionInWorkspace(extension.identifier);\n                break;\n            case extensionManagement_1.EnablementState.WorkspaceDisabled:\n                this._disableExtensionInWorkspace(extension.identifier);\n                break;\n        }\n        return Promise.resolve(true);\n    };\n    ExtensionEnablementService.prototype.isEnabled = function (extension) {\n        var enablementState = this.getEnablementState(extension);\n        return enablementState === extensionManagement_1.EnablementState.WorkspaceEnabled || enablementState === extensionManagement_1.EnablementState.Enabled;\n    };\n    ExtensionEnablementService.prototype._isExtensionDisabledInEnvironment = function (extension) {\n        if (this.allUserExtensionsDisabled) {\n            return extension.type === extensions_1.ExtensionType.User;\n        }\n        var disabledExtensions = this.environmentService.disableExtensions;\n        if (Array.isArray(disabledExtensions)) {\n            return disabledExtensions.some(function (id) { return extensionManagementUtil_1.areSameExtensions({ id: id }, extension.identifier); });\n        }\n        return false;\n    };\n    ExtensionEnablementService.prototype._getEnablementState = function (identifier) {\n        if (this.hasWorkspace) {\n            if (this._getEnabledExtensions(storage_1.StorageScope.WORKSPACE).filter(function (e) { return extensionManagementUtil_1.areSameExtensions(e, identifier); })[0]) {\n                return extensionManagement_1.EnablementState.WorkspaceEnabled;\n            }\n            if (this._getDisabledExtensions(storage_1.StorageScope.WORKSPACE).filter(function (e) { return extensionManagementUtil_1.areSameExtensions(e, identifier); })[0]) {\n                return extensionManagement_1.EnablementState.WorkspaceDisabled;\n            }\n        }\n        if (this._getDisabledExtensions(storage_1.StorageScope.GLOBAL).filter(function (e) { return extensionManagementUtil_1.areSameExtensions(e, identifier); })[0]) {\n            return extensionManagement_1.EnablementState.Disabled;\n        }\n        return extensionManagement_1.EnablementState.Enabled;\n    };\n    ExtensionEnablementService.prototype._enableExtension = function (identifier) {\n        this._removeFromDisabledExtensions(identifier, storage_1.StorageScope.WORKSPACE);\n        this._removeFromEnabledExtensions(identifier, storage_1.StorageScope.WORKSPACE);\n        this._removeFromDisabledExtensions(identifier, storage_1.StorageScope.GLOBAL);\n    };\n    ExtensionEnablementService.prototype._disableExtension = function (identifier) {\n        this._removeFromDisabledExtensions(identifier, storage_1.StorageScope.WORKSPACE);\n        this._removeFromEnabledExtensions(identifier, storage_1.StorageScope.WORKSPACE);\n        this._addToDisabledExtensions(identifier, storage_1.StorageScope.GLOBAL);\n    };\n    ExtensionEnablementService.prototype._enableExtensionInWorkspace = function (identifier) {\n        this._removeFromDisabledExtensions(identifier, storage_1.StorageScope.WORKSPACE);\n        this._addToEnabledExtensions(identifier, storage_1.StorageScope.WORKSPACE);\n    };\n    ExtensionEnablementService.prototype._disableExtensionInWorkspace = function (identifier) {\n        this._addToDisabledExtensions(identifier, storage_1.StorageScope.WORKSPACE);\n        this._removeFromEnabledExtensions(identifier, storage_1.StorageScope.WORKSPACE);\n    };\n    ExtensionEnablementService.prototype._addToDisabledExtensions = function (identifier, scope) {\n        if (scope === storage_1.StorageScope.WORKSPACE && !this.hasWorkspace) {\n            return Promise.resolve(false);\n        }\n        var disabledExtensions = this._getDisabledExtensions(scope);\n        if (disabledExtensions.every(function (e) { return !extensionManagementUtil_1.areSameExtensions(e, identifier); })) {\n            disabledExtensions.push(identifier);\n            this._setDisabledExtensions(disabledExtensions, scope);\n            return Promise.resolve(true);\n        }\n        return Promise.resolve(false);\n    };\n    ExtensionEnablementService.prototype._removeFromDisabledExtensions = function (identifier, scope) {\n        if (scope === storage_1.StorageScope.WORKSPACE && !this.hasWorkspace) {\n            return false;\n        }\n        var disabledExtensions = this._getDisabledExtensions(scope);\n        for (var index = 0; index < disabledExtensions.length; index++) {\n            var disabledExtension = disabledExtensions[index];\n            if (extensionManagementUtil_1.areSameExtensions(disabledExtension, identifier)) {\n                disabledExtensions.splice(index, 1);\n                this._setDisabledExtensions(disabledExtensions, scope);\n                return true;\n            }\n        }\n        return false;\n    };\n    ExtensionEnablementService.prototype._addToEnabledExtensions = function (identifier, scope) {\n        if (scope === storage_1.StorageScope.WORKSPACE && !this.hasWorkspace) {\n            return false;\n        }\n        var enabledExtensions = this._getEnabledExtensions(scope);\n        if (enabledExtensions.every(function (e) { return !extensionManagementUtil_1.areSameExtensions(e, identifier); })) {\n            enabledExtensions.push(identifier);\n            this._setEnabledExtensions(enabledExtensions, scope);\n            return true;\n        }\n        return false;\n    };\n    ExtensionEnablementService.prototype._removeFromEnabledExtensions = function (identifier, scope) {\n        if (scope === storage_1.StorageScope.WORKSPACE && !this.hasWorkspace) {\n            return false;\n        }\n        var enabledExtensions = this._getEnabledExtensions(scope);\n        for (var index = 0; index < enabledExtensions.length; index++) {\n            var disabledExtension = enabledExtensions[index];\n            if (extensionManagementUtil_1.areSameExtensions(disabledExtension, identifier)) {\n                enabledExtensions.splice(index, 1);\n                this._setEnabledExtensions(enabledExtensions, scope);\n                return true;\n            }\n        }\n        return false;\n    };\n    ExtensionEnablementService.prototype._getEnabledExtensions = function (scope) {\n        return this._getExtensions(ENABLED_EXTENSIONS_STORAGE_PATH, scope);\n    };\n    ExtensionEnablementService.prototype._setEnabledExtensions = function (enabledExtensions, scope) {\n        this._setExtensions(ENABLED_EXTENSIONS_STORAGE_PATH, enabledExtensions, scope);\n    };\n    ExtensionEnablementService.prototype._getDisabledExtensions = function (scope) {\n        return this._getExtensions(DISABLED_EXTENSIONS_STORAGE_PATH, scope);\n    };\n    ExtensionEnablementService.prototype._setDisabledExtensions = function (disabledExtensions, scope) {\n        this._setExtensions(DISABLED_EXTENSIONS_STORAGE_PATH, disabledExtensions, scope);\n    };\n    ExtensionEnablementService.prototype._getExtensions = function (storageId, scope) {\n        if (scope === storage_1.StorageScope.WORKSPACE && !this.hasWorkspace) {\n            return [];\n        }\n        return this.storageManger.get(storageId, scope);\n    };\n    ExtensionEnablementService.prototype._setExtensions = function (storageId, extensions, scope) {\n        this.storageManger.set(storageId, extensions, scope);\n    };\n    ExtensionEnablementService.prototype.onDidChangeStorage = function (extensionIdentifiers) {\n        return tslib_1.__awaiter(this, void 0, Promise, function () {\n            var installedExtensions, extensions;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.extensionManagementService.getInstalled()];\n                    case 1:\n                        installedExtensions = _a.sent();\n                        extensions = installedExtensions.filter(function (installedExtension) { return extensionIdentifiers.some(function (identifier) { return extensionManagementUtil_1.areSameExtensions(identifier, installedExtension.identifier); }); });\n                        this._onEnablementChanged.fire(extensions);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    ExtensionEnablementService.prototype._onDidInstallExtension = function (event) {\n        if (event.local && event.operation === extensionManagement_1.InstallOperation.Install) {\n            var wasDisabled = !this.isEnabled(event.local);\n            this._reset(event.local.identifier);\n            if (wasDisabled) {\n                this._onEnablementChanged.fire([event.local]);\n            }\n        }\n    };\n    ExtensionEnablementService.prototype._onDidUninstallExtension = function (_a) {\n        var identifier = _a.identifier, error = _a.error;\n        if (!error) {\n            this._reset(identifier);\n        }\n    };\n    ExtensionEnablementService.prototype._reset = function (extension) {\n        this._removeFromDisabledExtensions(extension, storage_1.StorageScope.WORKSPACE);\n        this._removeFromEnabledExtensions(extension, storage_1.StorageScope.WORKSPACE);\n        this._removeFromDisabledExtensions(extension, storage_1.StorageScope.GLOBAL);\n    };\n    ExtensionEnablementService = tslib_1.__decorate([\n        tslib_1.__param(0, storage_1.IStorageService),\n        tslib_1.__param(1, workspace_1.IWorkspaceContextService),\n        tslib_1.__param(2, environment_1.IEnvironmentService),\n        tslib_1.__param(3, extensionManagement_1.IExtensionManagementService)\n    ], ExtensionEnablementService);\n    return ExtensionEnablementService;\n}(lifecycle_1.Disposable));\nexports.ExtensionEnablementService = ExtensionEnablementService;\nvar StorageManager = /** @class */ (function (_super) {\n    tslib_1.__extends(StorageManager, _super);\n    function StorageManager(storageService) {\n        var _this = _super.call(this) || this;\n        _this.storageService = storageService;\n        _this.storage = Object.create(null);\n        _this._onDidChange = _this._register(new event_1.Emitter());\n        _this.onDidChange = _this._onDidChange.event;\n        _this._register(storageService.onDidChangeStorage(function (e) { return _this.onDidStorageChange(e); }));\n        return _this;\n    }\n    StorageManager.prototype.get = function (key, scope) {\n        var value;\n        if (scope === storage_1.StorageScope.GLOBAL) {\n            if (types_1.isUndefinedOrNull(this.storage[key])) {\n                this.storage[key] = this._get(key, scope);\n            }\n            value = this.storage[key];\n        }\n        else {\n            value = this._get(key, scope);\n        }\n        return JSON.parse(value);\n    };\n    StorageManager.prototype.set = function (key, value, scope) {\n        var newValue = JSON.stringify(value.map(function (_a) {\n            var id = _a.id, uuid = _a.uuid;\n            return ({ id: id, uuid: uuid });\n        }));\n        var oldValue = this._get(key, scope);\n        if (oldValue !== newValue) {\n            if (scope === storage_1.StorageScope.GLOBAL) {\n                if (value.length) {\n                    this.storage[key] = newValue;\n                }\n                else {\n                    delete this.storage[key];\n                }\n            }\n            this._set(key, value.length ? newValue : undefined, scope);\n        }\n    };\n    StorageManager.prototype.onDidStorageChange = function (workspaceStorageChangeEvent) {\n        if (workspaceStorageChangeEvent.scope === storage_1.StorageScope.GLOBAL) {\n            if (!types_1.isUndefinedOrNull(this.storage[workspaceStorageChangeEvent.key])) {\n                var newValue = this._get(workspaceStorageChangeEvent.key, workspaceStorageChangeEvent.scope);\n                if (newValue !== this.storage[workspaceStorageChangeEvent.key]) {\n                    var oldValues_1 = this.get(workspaceStorageChangeEvent.key, workspaceStorageChangeEvent.scope);\n                    delete this.storage[workspaceStorageChangeEvent.key];\n                    var newValues_1 = this.get(workspaceStorageChangeEvent.key, workspaceStorageChangeEvent.scope);\n                    var added = oldValues_1.filter(function (oldValue) { return !newValues_1.some(function (newValue) { return extensionManagementUtil_1.areSameExtensions(oldValue, newValue); }); });\n                    var removed = newValues_1.filter(function (newValue) { return !oldValues_1.some(function (oldValue) { return extensionManagementUtil_1.areSameExtensions(oldValue, newValue); }); });\n                    if (added.length || removed.length) {\n                        this._onDidChange.fire(added.concat(removed));\n                    }\n                }\n            }\n        }\n    };\n    StorageManager.prototype._get = function (key, scope) {\n        return this.storageService.get(key, scope, '[]');\n    };\n    StorageManager.prototype._set = function (key, value, scope) {\n        if (value) {\n            this.storageService.store(key, value, scope);\n        }\n        else {\n            this.storageService.remove(key, scope);\n        }\n    };\n    return StorageManager;\n}(lifecycle_1.Disposable));\n",{"version":3,"file":"/home/coding/workspace/lib/vscode/src/vs/platform/extensionManagement/common/extensionEnablementService.ts","sourceRoot":"","sources":["/home/coding/workspace/lib/vscode/src/vs/platform/extensionManagement/common/extensionEnablementService.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { IExtensionManagementService, DidUninstallExtensionEvent, IExtensionEnablementService, IExtensionIdentifier, EnablementState, DidInstallExtensionEvent, InstallOperation } from 'vs/platform/extensionManagement/common/extensionManagement';\nimport { areSameExtensions } from 'vs/platform/extensionManagement/common/extensionManagementUtil';\nimport { IWorkspaceContextService, WorkbenchState } from 'vs/platform/workspace/common/workspace';\nimport { IStorageService, StorageScope, IWorkspaceStorageChangeEvent } from 'vs/platform/storage/common/storage';\nimport { IEnvironmentService } from 'vs/platform/environment/common/environment';\nimport { isUndefinedOrNull } from 'vs/base/common/types';\nimport { ExtensionType, IExtension } from 'vs/platform/extensions/common/extensions';\n\nconst DISABLED_EXTENSIONS_STORAGE_PATH = 'extensionsIdentifiers/disabled';\nconst ENABLED_EXTENSIONS_STORAGE_PATH = 'extensionsIdentifiers/enabled';\n\nexport class ExtensionEnablementService extends Disposable implements IExtensionEnablementService {\n\n\t_serviceBrand: any;\n\n\tprivate _onEnablementChanged = new Emitter<IExtension[]>();\n\tpublic readonly onEnablementChanged: Event<IExtension[]> = this._onEnablementChanged.event;\n\n\tprivate readonly storageManger: StorageManager;\n\n\tconstructor(\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@IEnvironmentService private readonly environmentService: IEnvironmentService,\n\t\t@IExtensionManagementService private readonly extensionManagementService: IExtensionManagementService\n\t) {\n\t\tsuper();\n\t\tthis.storageManger = this._register(new StorageManager(storageService));\n\t\tthis._register(this.storageManger.onDidChange(extensions => this.onDidChangeStorage(extensions)));\n\t\tthis._register(extensionManagementService.onDidInstallExtension(this._onDidInstallExtension, this));\n\t\tthis._register(extensionManagementService.onDidUninstallExtension(this._onDidUninstallExtension, this));\n\t}\n\n\tprivate get hasWorkspace(): boolean {\n\t\treturn this.contextService.getWorkbenchState() !== WorkbenchState.EMPTY;\n\t}\n\n\tget allUserExtensionsDisabled(): boolean {\n\t\treturn this.environmentService.disableExtensions === true;\n\t}\n\n\tasync getDisabledExtensions(): Promise<IExtensionIdentifier[]> {\n\n\t\tlet result = this._getDisabledExtensions(StorageScope.GLOBAL);\n\n\t\tif (this.hasWorkspace) {\n\t\t\tfor (const e of this._getDisabledExtensions(StorageScope.WORKSPACE)) {\n\t\t\t\tif (!result.some(r => areSameExtensions(r, e))) {\n\t\t\t\t\tresult.push(e);\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst workspaceEnabledExtensions = this._getEnabledExtensions(StorageScope.WORKSPACE);\n\t\t\tif (workspaceEnabledExtensions.length) {\n\t\t\t\tresult = result.filter(r => !workspaceEnabledExtensions.some(e => areSameExtensions(e, r)));\n\t\t\t}\n\t\t}\n\n\t\tif (this.environmentService.disableExtensions) {\n\t\t\tconst allInstalledExtensions = await this.extensionManagementService.getInstalled();\n\t\t\tfor (const installedExtension of allInstalledExtensions) {\n\t\t\t\tif (this._isExtensionDisabledInEnvironment(installedExtension)) {\n\t\t\t\t\tif (!result.some(r => areSameExtensions(r, installedExtension.identifier))) {\n\t\t\t\t\t\tresult.push(installedExtension.identifier);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetEnablementState(extension: IExtension): EnablementState {\n\t\tif (this._isExtensionDisabledInEnvironment(extension)) {\n\t\t\treturn EnablementState.Disabled;\n\t\t}\n\t\tconst identifier = extension.identifier;\n\t\tif (this.hasWorkspace) {\n\t\t\tif (this._getEnabledExtensions(StorageScope.WORKSPACE).filter(e => areSameExtensions(e, identifier))[0]) {\n\t\t\t\treturn EnablementState.WorkspaceEnabled;\n\t\t\t}\n\n\t\t\tif (this._getDisabledExtensions(StorageScope.WORKSPACE).filter(e => areSameExtensions(e, identifier))[0]) {\n\t\t\t\treturn EnablementState.WorkspaceDisabled;\n\t\t\t}\n\t\t}\n\t\tif (this._getDisabledExtensions(StorageScope.GLOBAL).filter(e => areSameExtensions(e, identifier))[0]) {\n\t\t\treturn EnablementState.Disabled;\n\t\t}\n\t\treturn EnablementState.Enabled;\n\t}\n\n\tcanChangeEnablement(extension: IExtension): boolean {\n\t\tif (extension.manifest && extension.manifest.contributes && extension.manifest.contributes.localizations && extension.manifest.contributes.localizations.length) {\n\t\t\treturn false;\n\t\t}\n\t\tif (extension.type === ExtensionType.User && this.environmentService.disableExtensions) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tasync setEnablement(extensions: IExtension[], newState: EnablementState): Promise<boolean[]> {\n\n\t\tconst workspace = newState === EnablementState.WorkspaceDisabled || newState === EnablementState.WorkspaceEnabled;\n\t\tif (workspace && !this.hasWorkspace) {\n\t\t\treturn Promise.reject(new Error(localize('noWorkspace', \"No workspace.\")));\n\t\t}\n\n\t\tconst result = await Promise.all(extensions.map(e => this._setEnablement(e, newState)));\n\t\tconst changedExtensions = extensions.filter((e, index) => result[index]);\n\t\tif (changedExtensions.length) {\n\t\t\tthis._onEnablementChanged.fire(changedExtensions);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _setEnablement(extension: IExtension, newState: EnablementState): Promise<boolean> {\n\n\t\tconst currentState = this._getEnablementState(extension.identifier);\n\n\t\tif (currentState === newState) {\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\tswitch (newState) {\n\t\t\tcase EnablementState.Enabled:\n\t\t\t\tthis._enableExtension(extension.identifier);\n\t\t\t\tbreak;\n\t\t\tcase EnablementState.Disabled:\n\t\t\t\tthis._disableExtension(extension.identifier);\n\t\t\t\tbreak;\n\t\t\tcase EnablementState.WorkspaceEnabled:\n\t\t\t\tthis._enableExtensionInWorkspace(extension.identifier);\n\t\t\t\tbreak;\n\t\t\tcase EnablementState.WorkspaceDisabled:\n\t\t\t\tthis._disableExtensionInWorkspace(extension.identifier);\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn Promise.resolve(true);\n\t}\n\n\tisEnabled(extension: IExtension): boolean {\n\t\tconst enablementState = this.getEnablementState(extension);\n\t\treturn enablementState === EnablementState.WorkspaceEnabled || enablementState === EnablementState.Enabled;\n\t}\n\n\tprivate _isExtensionDisabledInEnvironment(extension: IExtension): boolean {\n\t\tif (this.allUserExtensionsDisabled) {\n\t\t\treturn extension.type === ExtensionType.User;\n\t\t}\n\t\tconst disabledExtensions = this.environmentService.disableExtensions;\n\t\tif (Array.isArray(disabledExtensions)) {\n\t\t\treturn disabledExtensions.some(id => areSameExtensions({ id }, extension.identifier));\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _getEnablementState(identifier: IExtensionIdentifier): EnablementState {\n\t\tif (this.hasWorkspace) {\n\t\t\tif (this._getEnabledExtensions(StorageScope.WORKSPACE).filter(e => areSameExtensions(e, identifier))[0]) {\n\t\t\t\treturn EnablementState.WorkspaceEnabled;\n\t\t\t}\n\n\t\t\tif (this._getDisabledExtensions(StorageScope.WORKSPACE).filter(e => areSameExtensions(e, identifier))[0]) {\n\t\t\t\treturn EnablementState.WorkspaceDisabled;\n\t\t\t}\n\t\t}\n\t\tif (this._getDisabledExtensions(StorageScope.GLOBAL).filter(e => areSameExtensions(e, identifier))[0]) {\n\t\t\treturn EnablementState.Disabled;\n\t\t}\n\t\treturn EnablementState.Enabled;\n\t}\n\n\tprivate _enableExtension(identifier: IExtensionIdentifier): void {\n\t\tthis._removeFromDisabledExtensions(identifier, StorageScope.WORKSPACE);\n\t\tthis._removeFromEnabledExtensions(identifier, StorageScope.WORKSPACE);\n\t\tthis._removeFromDisabledExtensions(identifier, StorageScope.GLOBAL);\n\t}\n\n\tprivate _disableExtension(identifier: IExtensionIdentifier): void {\n\t\tthis._removeFromDisabledExtensions(identifier, StorageScope.WORKSPACE);\n\t\tthis._removeFromEnabledExtensions(identifier, StorageScope.WORKSPACE);\n\t\tthis._addToDisabledExtensions(identifier, StorageScope.GLOBAL);\n\t}\n\n\tprivate _enableExtensionInWorkspace(identifier: IExtensionIdentifier): void {\n\t\tthis._removeFromDisabledExtensions(identifier, StorageScope.WORKSPACE);\n\t\tthis._addToEnabledExtensions(identifier, StorageScope.WORKSPACE);\n\t}\n\n\tprivate _disableExtensionInWorkspace(identifier: IExtensionIdentifier): void {\n\t\tthis._addToDisabledExtensions(identifier, StorageScope.WORKSPACE);\n\t\tthis._removeFromEnabledExtensions(identifier, StorageScope.WORKSPACE);\n\t}\n\n\tprivate _addToDisabledExtensions(identifier: IExtensionIdentifier, scope: StorageScope): Promise<boolean> {\n\t\tif (scope === StorageScope.WORKSPACE && !this.hasWorkspace) {\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\t\tlet disabledExtensions = this._getDisabledExtensions(scope);\n\t\tif (disabledExtensions.every(e => !areSameExtensions(e, identifier))) {\n\t\t\tdisabledExtensions.push(identifier);\n\t\t\tthis._setDisabledExtensions(disabledExtensions, scope);\n\t\t\treturn Promise.resolve(true);\n\t\t}\n\t\treturn Promise.resolve(false);\n\t}\n\n\tprivate _removeFromDisabledExtensions(identifier: IExtensionIdentifier, scope: StorageScope): boolean {\n\t\tif (scope === StorageScope.WORKSPACE && !this.hasWorkspace) {\n\t\t\treturn false;\n\t\t}\n\t\tlet disabledExtensions = this._getDisabledExtensions(scope);\n\t\tfor (let index = 0; index < disabledExtensions.length; index++) {\n\t\t\tconst disabledExtension = disabledExtensions[index];\n\t\t\tif (areSameExtensions(disabledExtension, identifier)) {\n\t\t\t\tdisabledExtensions.splice(index, 1);\n\t\t\t\tthis._setDisabledExtensions(disabledExtensions, scope);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _addToEnabledExtensions(identifier: IExtensionIdentifier, scope: StorageScope): boolean {\n\t\tif (scope === StorageScope.WORKSPACE && !this.hasWorkspace) {\n\t\t\treturn false;\n\t\t}\n\t\tlet enabledExtensions = this._getEnabledExtensions(scope);\n\t\tif (enabledExtensions.every(e => !areSameExtensions(e, identifier))) {\n\t\t\tenabledExtensions.push(identifier);\n\t\t\tthis._setEnabledExtensions(enabledExtensions, scope);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _removeFromEnabledExtensions(identifier: IExtensionIdentifier, scope: StorageScope): boolean {\n\t\tif (scope === StorageScope.WORKSPACE && !this.hasWorkspace) {\n\t\t\treturn false;\n\t\t}\n\t\tlet enabledExtensions = this._getEnabledExtensions(scope);\n\t\tfor (let index = 0; index < enabledExtensions.length; index++) {\n\t\t\tconst disabledExtension = enabledExtensions[index];\n\t\t\tif (areSameExtensions(disabledExtension, identifier)) {\n\t\t\t\tenabledExtensions.splice(index, 1);\n\t\t\t\tthis._setEnabledExtensions(enabledExtensions, scope);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _getEnabledExtensions(scope: StorageScope): IExtensionIdentifier[] {\n\t\treturn this._getExtensions(ENABLED_EXTENSIONS_STORAGE_PATH, scope);\n\t}\n\n\tprivate _setEnabledExtensions(enabledExtensions: IExtensionIdentifier[], scope: StorageScope): void {\n\t\tthis._setExtensions(ENABLED_EXTENSIONS_STORAGE_PATH, enabledExtensions, scope);\n\t}\n\n\tprivate _getDisabledExtensions(scope: StorageScope): IExtensionIdentifier[] {\n\t\treturn this._getExtensions(DISABLED_EXTENSIONS_STORAGE_PATH, scope);\n\t}\n\n\tprivate _setDisabledExtensions(disabledExtensions: IExtensionIdentifier[], scope: StorageScope): void {\n\t\tthis._setExtensions(DISABLED_EXTENSIONS_STORAGE_PATH, disabledExtensions, scope);\n\t}\n\n\tprivate _getExtensions(storageId: string, scope: StorageScope): IExtensionIdentifier[] {\n\t\tif (scope === StorageScope.WORKSPACE && !this.hasWorkspace) {\n\t\t\treturn [];\n\t\t}\n\t\treturn this.storageManger.get(storageId, scope);\n\t}\n\n\tprivate _setExtensions(storageId: string, extensions: IExtensionIdentifier[], scope: StorageScope): void {\n\t\tthis.storageManger.set(storageId, extensions, scope);\n\t}\n\n\tprivate async onDidChangeStorage(extensionIdentifiers: IExtensionIdentifier[]): Promise<void> {\n\t\tconst installedExtensions = await this.extensionManagementService.getInstalled();\n\t\tconst extensions = installedExtensions.filter(installedExtension => extensionIdentifiers.some(identifier => areSameExtensions(identifier, installedExtension.identifier)));\n\t\tthis._onEnablementChanged.fire(extensions);\n\t}\n\n\tprivate _onDidInstallExtension(event: DidInstallExtensionEvent): void {\n\t\tif (event.local && event.operation === InstallOperation.Install) {\n\t\t\tconst wasDisabled = !this.isEnabled(event.local);\n\t\t\tthis._reset(event.local.identifier);\n\t\t\tif (wasDisabled) {\n\t\t\t\tthis._onEnablementChanged.fire([event.local]);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _onDidUninstallExtension({ identifier, error }: DidUninstallExtensionEvent): void {\n\t\tif (!error) {\n\t\t\tthis._reset(identifier);\n\t\t}\n\t}\n\n\tprivate _reset(extension: IExtensionIdentifier) {\n\t\tthis._removeFromDisabledExtensions(extension, StorageScope.WORKSPACE);\n\t\tthis._removeFromEnabledExtensions(extension, StorageScope.WORKSPACE);\n\t\tthis._removeFromDisabledExtensions(extension, StorageScope.GLOBAL);\n\t}\n}\n\nclass StorageManager extends Disposable {\n\n\tprivate storage: { [key: string]: string } = Object.create(null);\n\n\tprivate _onDidChange: Emitter<IExtensionIdentifier[]> = this._register(new Emitter<IExtensionIdentifier[]>());\n\treadonly onDidChange: Event<IExtensionIdentifier[]> = this._onDidChange.event;\n\n\tconstructor(private storageService: IStorageService) {\n\t\tsuper();\n\t\tthis._register(storageService.onDidChangeStorage(e => this.onDidStorageChange(e)));\n\t}\n\n\tget(key: string, scope: StorageScope): IExtensionIdentifier[] {\n\t\tlet value: string;\n\t\tif (scope === StorageScope.GLOBAL) {\n\t\t\tif (isUndefinedOrNull(this.storage[key])) {\n\t\t\t\tthis.storage[key] = this._get(key, scope);\n\t\t\t}\n\t\t\tvalue = this.storage[key];\n\t\t} else {\n\t\t\tvalue = this._get(key, scope);\n\t\t}\n\t\treturn JSON.parse(value);\n\t}\n\n\tset(key: string, value: IExtensionIdentifier[], scope: StorageScope): void {\n\t\tlet newValue: string = JSON.stringify(value.map(({ id, uuid }) => (<IExtensionIdentifier>{ id, uuid })));\n\t\tconst oldValue = this._get(key, scope);\n\t\tif (oldValue !== newValue) {\n\t\t\tif (scope === StorageScope.GLOBAL) {\n\t\t\t\tif (value.length) {\n\t\t\t\t\tthis.storage[key] = newValue;\n\t\t\t\t} else {\n\t\t\t\t\tdelete this.storage[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._set(key, value.length ? newValue : undefined, scope);\n\t\t}\n\t}\n\n\tprivate onDidStorageChange(workspaceStorageChangeEvent: IWorkspaceStorageChangeEvent): void {\n\t\tif (workspaceStorageChangeEvent.scope === StorageScope.GLOBAL) {\n\t\t\tif (!isUndefinedOrNull(this.storage[workspaceStorageChangeEvent.key])) {\n\t\t\t\tconst newValue = this._get(workspaceStorageChangeEvent.key, workspaceStorageChangeEvent.scope);\n\t\t\t\tif (newValue !== this.storage[workspaceStorageChangeEvent.key]) {\n\t\t\t\t\tconst oldValues = this.get(workspaceStorageChangeEvent.key, workspaceStorageChangeEvent.scope);\n\t\t\t\t\tdelete this.storage[workspaceStorageChangeEvent.key];\n\t\t\t\t\tconst newValues = this.get(workspaceStorageChangeEvent.key, workspaceStorageChangeEvent.scope);\n\t\t\t\t\tconst added = oldValues.filter(oldValue => !newValues.some(newValue => areSameExtensions(oldValue, newValue)));\n\t\t\t\t\tconst removed = newValues.filter(newValue => !oldValues.some(oldValue => areSameExtensions(oldValue, newValue)));\n\t\t\t\t\tif (added.length || removed.length) {\n\t\t\t\t\t\tthis._onDidChange.fire([...added, ...removed]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _get(key: string, scope: StorageScope): string {\n\t\treturn this.storageService.get(key, scope, '[]');\n\t}\n\n\tprivate _set(key: string, value: string | undefined, scope: StorageScope): void {\n\t\tif (value) {\n\t\t\tthis.storageService.store(key, value, scope);\n\t\t} else {\n\t\t\tthis.storageService.remove(key, scope);\n\t\t}\n\t}\n}\n"]}]}